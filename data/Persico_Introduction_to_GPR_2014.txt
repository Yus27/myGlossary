Persico
Introduction to ground penetrating radar
2014
IEEE Press

445 Hoes Lane Piscataway, NJ 08854 IEEE Press Editorial Board Tariq Samad, Editor in Chief George W. Arnold Dmitry Goldgof Ekram Hossain  Mary Lanzerotti Pui-In Mak Ray Perez  Linda Shafer MengChu Zhou George Zobrist  Kenneth Moore, Director of IEEE Book and Information Services (BIS)  INTRODUCTION TO GROUND PENETRATING RADAR Inverse Scattering and Data Processing Raffaele Persico  Cover Design: Wiley Cover Images: Francesco Gabellone/Courtesy of the author Copyright © 2014 by The Institute of Electrical and Electronics Engineers, Inc. Published by John Wiley & Sons, Inc., Hoboken, New Jersey. All rights reserved. Published simultaneously in Canada. No part of this publication may be reproduced, stored in a retrieval system, or transmitted in any form or by any means, electronic, mechanical, photocopying, recording, scanning, or otherwise, except as permitted under Section 107 or 108 of the 1976 United States Copyright Act, without either the prior written permission of the Publisher, or authorization through payment of the appropriate per-copy fee to the Copyright Clearance Center, Inc., 222 Rosewood Drive, Danvers, MA 01923, (978) 750-8400, fax (978) 750-4470, or on the web at www.copyright.com. Requests to the Publisher for permission should be addressed to the Permissions Department, John Wiley & Sons, Inc., 111 River Street, Hoboken, NJ 07030, (201) 748-6011, fax (201) 748-6008, or online at http://www.wiley.com/go/permission. Limit of Liability/Disclaimer of Warranty: While the publisher and author have used their best efforts in preparing this book, they make no representations or warranties with respect to the accuracy or completeness of the contents of this book and specifically disclaim any implied warranties of merchantability or fitness for a particular purpose. No warranty may be created or extended by sales representatives or written sales materials. The advice and strategies contained herein may not be suitable for your situation. You should consult with a professional where appropriate. Neither the publisher nor author shall be liable for any loss of profit or any other commercial damages, including but not limited to special, incidental, consequential, or other damages. For general information on our other products and services or for technical support, please contact our Customer Care Department within the United States at (800) 762–2974, outside the United States at (317) 572-3993 or fax (317) 572-4002. Wiley also publishes its books in a variety of electronic formats. Some content that appears in print may not be available in electronic formats. For more information about Wiley products, visit our web site at www.wiley.com. Library of Congress Cataloging-in-Publication Data: Persico, Raffaele, 1969– Introduction to ground penetrating radar: inverse scattering and data processing/Raffaele Persico. pages cm Includes bibliographical references and index. ISBN 978-1-118-30500-3 (hardback) 1. Ground penetrating radar. I. Title. TK6592.G7P47 2014 621.38480 5–dc23 2013039737 Printed in the United States of America. 10 9 8 7 6 5 4 3 2 1  To my wife Grazia Maria and my daughter Luisa Anna  CONTENTS  Foreword  xiii  Acknowledgments  xvii  About the Author  xix  Contributors  xxi  1  INTRODUCTION TO GPR PROSPECTING 1.1 What Is a GPR? 1.2 GPR Systems and GPR Signals 1.3 GPR Application Fields 1.4 Measurement Configurations, Bands, and Polarizations 1.5 GPR Data Processing  2  CHARACTERIZATION OF THE HOST MEDIUM 2.1 The Characteristics of the Host Medium 2.2 The Measure of the Propagation Velocity in a Masonry 2.3 The Measure of the Propagation Velocity in a Homogeneous Soil 2.3.1 Interfacial Data in Common Offset Mode with a Null Offset: The Case of a Point-like Target 2.3.2 Interfacial Data in Common Offset Mode with a Null Offset: The Case of a Circular Target 2.3.3 Interfacial Data in Common Offset Mode with a Non-null Offset: The Case of a Point-like Target 2.3.4 Noninterfacial Data in Common Offset Mode with a Null Offset: The Case of a Point-like Target 2.3.5 Interfacial Data in Common Midpoint (CMP) Mode 2.4 Lossy, Magnetic, and Dispersive Media Questions  1 1 4 5 6 8 10 10 11 13 13 17 18 22 25 27 31  vii  CONTENTS  viii  3  4  5  6  GPR DATA SAMPLING: FREQUENCY AND TIME STEPS 3.1 Stepped Frequency GPR Systems: The Problem of the Aliasing and the Frequency Step 3.2 Shape and Thickness of the GPR Pulses 3.3 Stepped Frequency GPR Systems: The Problem of the Demodulation and the Frequency Step 3.4 Aliasing and Time Step for Pulsed GPR Systems Questions  32  THE 2D SCATTERING EQUATIONS FOR DIELECTRIC TARGETS 4.1 Preliminary Remarks 4.2 Derivation of the Scattering Equations Without Considering the Effect of the Antennas 4.3 Calculation of the Incident Field Radiated by a Filamentary Current 4.4 The Plane Wave Spectrum of an Electromagnetic Source in a Homogeneous Space 4.5 The Insertion of the Source Characteristics in the Scattering Equations 4.6 The Far Field in a Homogeneous Lossless Space in Terms of Plane Wave Spectrum 4.7 The Effective Length of an Electromagnetic Source in a Homogeneous Space 4.8 The Insertion of the Receiver Characteristics in the Scattering Equations Questions  48 48  THE 5.1 5.2 5.3 5.4  2D SCATTERING EQUATIONS FOR MAGNETIC TARGETS The Scattering Equations with Only Magnetic Anomalies The Contribution of the x-Component of the Fitzgerald Vector The Contribution of the z-Component of the Fitzgerald Vector The Joined Contribution of Both the x- and z-Components of the Fitzgerald Vector 5.5 The Case with Both Dielectric and Magnetic Anomalies Questions  79 79 83 88  ILL-POSEDNESS AND NONLINEARITY 6.1 Electromagnetic Inverse Scattering 6.2 Ill-Posedness 6.3 Nonlinearity  96 96 97 97  32 36 40 45 47  51 61 61 65 69 73 75 77  93 94 95  CONTENTS  6.4 6.5  ix  The Ill-Posedness of the Inverse Scattering Problem The Nonlinearity of the Inverse Scattering Problem Questions  100 103 103  7  EXTRACTION OF THE SCATTERED FIELD DATA FROM THE GPR DATA 7.1 Zero Timing 7.2 Muting of Interface Contributions 7.3 The Differential Configuration 7.4 The Background Removal Questions  105 105 106 110 111 115  8  THE BORN APPROXIMATION 8.1 The Classical Born Approximation 8.2 The Born Approximation in the Presence of Magnetic Targets 8.3 Weak and Nonweak Scattering Objects Questions  116 116 119 120 121  9  DIFFRACTION TOMOGRAPHY 9.1 Introduction to Diffraction Tomography 9.2 Diffraction Tomography for Dielectric Targets 9.3 Diffraction Tomography for Dielectric Targets Seen Under a Limited View Angle 9.4 The Effective Maximum and Minimum View Angle 9.5 Horizontal Resolution 9.6 Vertical Resolution 9.7 Spatial Step 9.8 Frequency Step 9.9 Time Step 9.10 The Effect of a Non-null Height of the Observation Line 9.11 The Effect of the Radiation Characteristics of the Antennas 9.12 DT Relationship in the Presence of Magnetic Targets 9.13 DT Relationship for a Differential Configuration 9.14 DT Relationship in the Presence of Background Removal Questions  122 122 123 130 140 142 145 147 148 149 150 156 158 160 163 168  CONTENTS  x  10  TWO-DIMENSIONAL MIGRATION ALGORITHMS 10.1 Migration in the Frequency Domain 10.2 Migration in the Time Domain (Raffaele Persico and Raffaele Solimene) Questions  169 169  THREE-DIMENSIONAL SCATTERING EQUATIONS Lorenzo Lo Monte, Raffaele Persico, and Raffaele Solimene 11.1 Scattering in Three Dimensions: Redefinition of the Main Symbols 11.2 The Scattering Equations in 3D 11.3 Three-Dimensional Green’s Functions 11.4 The Incident Field 11.5 Homogeneous 3D Green’s Functions 11.6 The Plane Wave Spectrum of a 3D Homogeneous Green’s Fucntion 11.7 Half-Space Green’s Functions Questions  182  12  THREE-DIMENSIONAL DIFFRACTION TOMOGRAPHY 12.1 Born Approximation and DT in 3D 12.2 Ideal and Limited-View-Angle 3D Retrievable Spectral Sets 12.3 Spatial Step and Transect 12.4 Horizontal Resolution (Raffaele Persico and Raffaele Solimene) 12.5 Vertical Resolution, Frequency and Time Steps Questions  205 205 210 212 213 217 218  13  THREE-DIMENSIONAL MIGRATION ALGORITHMS 13.1 3D Migration Formulas in the Frequency Domain 13.2 3D Migration Formulas in the Time Domain 13.3 3D Versus 2D Migration Formulas in the Time Domain Questions  219 219 222 226 228  14  THE 14.1 14.2 14.3 14.4  229 229 231 234  11  SINGULAR VALUE DECOMPOSITION The Method of Moments Reminders About Eigenvalues and Eigenvectors The Singular Value Decomposition The Study of the Inverse Scattering Relationship by Means of the SVD Questions  175 181  182 184 184 185 187 192 197 204  238 241  CONTENTS  15  NUMERICAL AND EXPERIMENTAL EXAMPLES 15.1 Examples with Regard to the Measure of the Propagation Velocity 15.1.1 Common Offset Interfacial Data with Null Offset on a Homogeneous Soil 15.1.2 Common Offset Interfacial Data on a Wall, Neglecting the Offset Between the Antennas 15.1.3 Interfacial Common Offset Data on a Homogeneous Soil: The Effect on the Offset Between the Antennas 15.1.4 Noninterfacial Common Offset Data with a Null Offset Between the Antennas 15.1.5 Common Midpoint Data 15.2 Exercises on Spatial Step and Horizontal Resolution 15.3 Exercises on Frequency Step and Vertical Resolution 15.4 Exercises on the Number of Trial Unknowns 15.5 Exercises on Spectral and Spatial Contents 15.6 Exercises on the Effect of the Height of the Observation Line 15.7 Exercises on the Effect of the Extent of the Investigation Domain 15.8 Exercises on the Effects of the Background Removal 15.9 2D and 3D Migration Examples with a Single Set and Two Crossed Sets of B-Scans (Marcello Ciminale, Giovanni Leucci, Loredana Matera, and Raffaele Persico) 15.10 2D and 3D Inversion Examples (Ilaria Catapano and Raffaele Persico)  APPENDICES  xi  242 242 242 245 247 249 250 252 264 271 274 280 284 295  304 311  327  APPENDIX A (Raffaele Persico and Raffaele Solimene)  329  APPENDIX B  334  APPENDIX C  335  APPENDIX D  337  APPENDIX E  340  APPENDIX F (Raffaele Persico and Raffaele Solimene)  346  APPENDIX G: ANSWERS TO QUESTIONS  349  References  358  Index  365  FOREWORD  Ground penetrating (or probing) radar (GPR) is a vital technique on which the day-to-day safety of literally millions of people depend. The technology allows a very wide range of verifications, the most common being the safe and accurate location of the position of buried pipes and utilities, investigating the reinforcement and condition of roads, bridges, and airport runways, and identifying the structural integrity of buildings. Other important applications include locating buried potential hazards such as mine shafts and voids, investigating environmental and geological conditions (both of natural and man-made origin), studying glaciology, locating, identifying, and investigating archaeological sites, and uncovering forensic evidence including buried human remains and weapons. Although the technology is widely used, it is a highly specialized area that requires a good understanding of the underlying science if it is to be applied successfully. In addition to the technical journals that regularly carry scientific papers on both the theory and application of GPR, there are two major biennial international conferences, namely the International GPR Conference and, in the intervening years, the International Workshop on Advanced GPR. In terms of books, the fundamental cornerstone of GPR in all its applications has long been David J. Daniels’ Ground Penetrating Radar. However, one book, regardless of how well it is researched and written and how comprehensively it addresses its subject matter, cannot cover all aspects of the science to the equal satisfaction of all users. This current volume is not intended for the general reader or for anyone for whom this is a completely new subject. Rather it is aimed primarily at doctoral and post-doctoral students who wish to develop their understanding of the technology and, in particular, how the results may be developed and interpreted. Dr. Persico has been a practitioner and researcher in GPR for many years, primarily interested in the resolution of inverse problems, with particular application to archaeological investigations and the conservation of cultural heritage. From his background in Physics and Mathematics and the expertise he has built up, he applies processing and interpretative techniques to GPR data collected with the primary aim of conserving, preserving, and rehabilitating buildings of historical importance and also archaeological remains. In 2010 he chaired the 13th International GPR Conference, held in Lecce, Italy. He is also an active member of the European GPR Association within which he has worked to build a virtual library, accessible to the membership through the Association website (www.eurogpr.org). His considerable expertise makes him an ideal candidate to share his knowledge and understanding of GPR interpretative techniques with other researchers and users.  xiii  xiv  FOREWORD  This book consists of 15 chapters and 7 appendices, the aim being to introduce the reader to the complexities of using and interpreting GPR data step by step. An important feature of this book is the inclusion of questions at the end of almost all of the chapters, allowing the reader to assess his or her progress in understanding the subject. The answers to questions are in Appendix G. Beginning with a general definition and description of GPR technology, this book goes on to consider an important basic characteristic of GPR operation, namely the interdependence of the nature of the survey medium with the transmission of the electromagnetic pulses through that medium. Chapter 3 considers the time and frequency aspects of GPR transmission and their implications. The following two chapters concentrate on the mathematical aspects of GPR transmission including Maxwell’s equations, the effects of incident fields, and the relevant scattering equations considered in two dimensions for dielectric and magnetic materials (Chapters 4 and 5). Continuing into methods of making the interpretation of GPR data more accessible, the next section describes a number of mathematically based constructs that can be used for this purpose. Chapter 6 introduces the reader to the nature of inverse scattering problems and the associated mathematical uncertainties to be addressed in resolution. In Chapter 7, data processing steps typically associated with improving raw GPR data are described in detail and their effects are illustrated. The Born approximation has become a standard algorithm to apply to GPR data and has also formed the basis of much of Dr. Persico’s own research work. The Born approximation and its application to magnetic targets and also to weak and strong signal reflectors is described in full in Chapter 8. Leading on from this, the theoretical basis and application of diffraction tomography is the next topic, including: the consideration of horizontal and vertical resolution of targets; related sampling issues in space, frequency, and time; and the radiation characteristics of radar antennas (Chapter 9). Chapter 10 deals with two-dimensional migration algorithms in the frequency domain and the time domain. Chapter 11, contributed by Drs. Lo Monte and Solimene together with Dr. Persico, extends data treatment into the development of three-dimensional scattering equations based on Maxwell’s equations and includes particular consideration of Green’s function applied to three-dimensional space. This is followed by extending the analysis of diffraction tomography into three dimensions with careful consideration of the sampling parameters required for the application of the technique in order to reconstruct the target(s) reliably from the GPR data (Chapter 12). This is important because improving target resolution from appropriate survey parameters is of primary importance in all GPR applications. Building on the previous chapters, Chapter 13 considers the corresponding derivation of three-dimensional migration algorithms, first in the frequency domain and subsequently in the time domain before comparing two-dimensional and threedimensional migration formulas in the time domain by means of a worked and illustrated example. Chapter 14 considers the alternative technique of singular value decomposition. The same careful mathematical logic is used to derive the singular value decomposition before considering its application to GPR data.  FOREWORD  xv  Finally, Chapter 15 provides a variety of worked examples and exercises to illustrate some of the concepts covered in the preceding chapters. This begins with an examination of measuring propagation velocities followed by two sets of exercises dealing with target resolution, namely the interrelation of spatial sampling and horizontal resolution and the effects of frequency sampling on vertical resolution. Both of these latter two concepts are integral to understanding the capability of any GPR. The next set of exercises is concerned with trialing the number and categories of unknowns treated in the equations in order to optimize the quality of the GPR data without undue processing simply for the sake of it. This is followed by exercises examining frequency and spatial content of the data and consideration of the effects of measurement from above the soil–air interface (instead of directly coupled). Extending the area of investigation provides the basis for the next set of exercises, an important consideration given that this varies extensively from one survey to another. This is followed by exercises using background removal, the single most extensively applied processing technique for all GPR surveys since, by definition, it is the anomalous material that forms the targets. The added complication of complementary data sets in different orientations is then considered, based on a real archaeological example and including contributions from Drs. Ciminale, Leucci, and Matera. Lastly, the results of further 2D and 3D inversion techniques are compared (with the collaboration of Dr. Catapano). Detailed mathematical workings in support of the content of the chapters are provided in full in the appendices. This is not a volume for a beginner, but it is a careful and comprehensive enumeration and explanation of the mathematical concepts inherent to GPR. It should provide a useful platform for those who wish to delve deeper into the subsurface of the technology and equip themselves with the mathematical tools for handling their own data sets. ERICA CARRICK UTSI November 2013  ACKNOWLEDGMENTS  I sincerely thank the six contributors—Dr. Ilaria Catapano, Professor Marcello Ciminale, Dr. Giovanni Leucci, Dr. Lorenzo Lo Monte, Dr. Loredana Matera, and Dr. Raffaele Solimene—who helped me write this book. Their contributions were of the utmost importance to me, and the interaction with them has enhanced and deepened my knowledge of the covered topic. Moreover, I am grateful for the fruitful and interesting scientific discussions with Professor Massimiliano Pieraccini of the University of Florence and with his research group, with a special mention to Dr. Filippo Parrini and Dr. Devis Dei. These discussions inspired me to think about the calculation of the Hermitian images in a closed form, detailed in Chapter 3. I also would like to thank Dr. Jacopo Sala of 3d-Radar for our scientific collaboration, which in particular inspired me to write Section 15.7. I also would like to thank Dr. Erica Utsi of Utsi Electronics Ltd, Chair of the European GPR Association. She wrote the Foreword for this book, and this is an honor for me. Finally, I am grateful to Dr. Francesco Gabellone for his valuable aid in conceiving the cover for this book. RAFFAELE PERSICO  xvii  ABOUT THE AUTHOR  Raffaele Persico was born in Napoli, Italy in 1969. After humanistic secondary school studies, he achieved his degree in Electronic Engineering from the University of Napoli Federico II and then his Ph.D. in Information Engineering from the Second University of Napoli. He has been Fellow Student at the Second University of Napoli, Research Scientist at the Consortium CO.RI.S.T.A., and then Research Scientist at the Institute for the Electromagnetic Sensing of the Environment IREA-CNR. Since 2007, he has been affiliated with the Institute for Archaeological and Monumental Heritage IBAM-CNR. Dr. Persico’s research activity has been devoted to microwave imaging, inverse problems, GPR data processing, and GPR systems. He has co-authored about 150 papers in international journals and conference proceedings and holds an Italian patent on the reconfigurability of the GPR systems. He is reviewer for several international journals and is Associate Editor of Near Surface Geophysics. He chaired the 13th International Conference on Ground Penetrating Radar, held in Lecce, Italy in 2010, and has devised a prototypal reconfigurable stepped-frequency GPR system together with the IDS Corporation and the University of Florence. Since 2009 he has been a Member of the EuroGPR Association.  xix  CONTRIBUTORS  Ilaria Catapano, Institute for Electromagnetic Sensing of the Environment IREA-CNR, Italy Marcello Ciminale, University of Bari Aldo Moro, Italy Giovanni Leucci, Institute of Archeological Heritage–Monuments and Sites IBAM-CNR, Italy Lorenzo Lo Monte, University of Dayton, USA Loredana Matera, University of Bari Aldo Moro, Italy Raffaele Solimene, Second University of Napoli, Italy  xxi  1 INTRODUCTION TO GPR PROSPECTING  1.1  WHAT IS A GPR?  Ground-penetrating radar (GPR), also known as surface-penetrating radar (SPR) (Daniels, 2004), is literally meant as a radar to look underground. Actually, it is used to look into both soils and walls and, recently, even beyond walls.1 In principle, the GPR can be viewed as composed by a central unit, a transmitting antenna, a receiving antenna, and a computer. The central unit generates an electromagnetic pulse or, more generally, an electromagnetic signal that is radiated into the soil by the transmitting antenna. The signal is radiated in all directions, but most energy is radiated within a conic volume under the antenna, as shown in Figure 1.1. When the electromagnetic waves meet any buried discontinuity (a buried object but also the interface between two geological layers, a cavity, a zone with different humidity, etc.), they are scattered in all directions according to some pattern depending on the buried scenario. Consequently, they are partially reflected also toward the receiving Actually the instruments that perform the so-called “through wall imaging” are not customarily considered GPR systems. However, we can say that conceptually they are at least a hybrid between a radar and a GPR.  1  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  1  INTRODUCTION TO GPR PROSPECTING  2  –1 Tx Antenna Rx Antenna  –0.5  Air  0  Soil  z [m]  0.5 1 1.5 2 Target 2.5 3 –2.5  –2  –1.5  –1  –0.5  0 x [m]  0.5  1  1.5  2  2.5  Figure 1.1. The working principle of a GPR.  antenna, again according to Figure 1.1. More precisely, Figure 1.1 is intended to be the central cut of a three-dimensional scenario. Usually, both the transmitting and the receiving antennas are incorporated into a rigid structure2 and move together. The gathered signal is customarily represented in real time on the screen of the computer3 and is stored in the hard disk of the computer. It is implicit that the equipment of a GPR also includes suitable cables to connect the central unit, the antennas, and the computer, along with a device to provide energy in the field. The energy is usually supplied by rechargeable batteries in the form of a zero-frequency electrical voltage. The central unit transforms this energy into a signal in the microwave frequency range. Modern systems are often also equipped with a GPS, in order to geo-reference the probed areas. In Figure 1.2, a photograph of a GPR is shown, and the main components are put into evidence. The trolley is facultative, but extremely useful for prospecting on the soil. Usually, the antennas are also equipped with an odometer that allows us to measure the covered distance.  The couple of antennas is often enclosed in a unique box, and the whole box is improperly called the “GPR antenna.” 3 In the past, other recording systems were exploited as described in Daniels (2004) and in Jol (2009), because the GPR was invented much earlier than the laptop. 2  WHAT IS A GPR?  3  Laptop  Central unit  Batteries Antennas  Figure 1.2. Photograph of a GPR (a Ris Hi Mode system) equipped with a double antenna at 200 and 600 MHz antenna.  The odometer is an important detail, because it allows us to compensate for the natural nonuniformity of the velocity of the human operator while driving the GPR: that is, it allows us to achieve a uniform sampling of the GPR signal along the observation line. However, in some cases it is impossible to make use of the odometer—for example, because the prospecting is on a sandy area that hinders the rotation of the wheel. In these cases, periodical markers have to be recorded along the observation line, which is partitioned into segments of known length. The velocity of the instrument (and thus also the sampling) is considered constant within each segment but not along the entire observation line. The working principle of a GPR is the same as that of a conventional radar. However, there are meaningful differences between the two instruments, in terms of technologies, exigencies, applications, and frequency bands (Daniels, 2004; Levanon, 1988). In particular, unlike the conventional radar, usually a GPR has to identify static targets, and in most cases the interpretation of the data is not requested in real time. On the other hand, in GPR prospecting the electromagnetic waves do not propagate in air but instead propagate in more complicated host media, customarily lossy and inhomogeneous, possibly dispersive, and in some cases anisotropic and/or magnetic (Daniels, 2004; Jol, 2009; Conyers, 2004). Last but not least, in GPR prospecting the characteristics of the host medium are usually not known a priori and have to be estimated from the data, as described in more depth in the next chapter.  INTRODUCTION TO GPR PROSPECTING  4  1.2  GPR SYSTEMS AND GPR SIGNALS  There are essentially two kinds of GPR systems: the pulsed one and the stepped-frequency one. A pulsed GPR system radiates and receives the echoes to electromagnetic pulses. On the other hand, a stepped-frequency GPR decomposes the electromagnetic pulse into its spectral components and radiates them sequentially. Consequently, it radiates and receives trains of sinusoidal signals. The soil and the buried targets usually have a linear behavior with respect to the radiated GPR signal, in the sense that the signal scattered by the buried targets is a linear quantity (more details will be given in Chapter 6) with respect to the incident signal. Moreover, the soil can usually be considered a time-invariant medium within the time needed for the GPR measurement campaign. This makes the pulsed and the stepped-frequency GPRs theoretically equivalent. In practical terms, however, stepped-frequency systems are generally claimed more performing (Noon, 1996), even if the pulsed systems are quite more common and their technology has been assessed for a longer time. So, the debate about what kind of system is really the best one (or at least the most convenient one in dependence of the application) is still open. In this text we will not enter such a debate, which is mainly based on technological aspects, but will deal with both some analytical and practical aspects of the GPR prospecting in relationship with both systems. In particular, whatever the system, the GPR signal can be regarded as a function of the spatial point and of the time or the frequency indifferently, because of course we can Fourier transform pulsed GPR data in frequency domain and we can back-Fourier transform stepped-frequency GPR data in time domain. Following a widely accepted terminology (Daniels, 2004), the GPR data relative to a single spatial point will be labeled as an A-scan or just a GPR trace, and the comprehensive set of GPR traces relative to an entire scanned line will be labeled as a B-scan. A B-scan corresponds to a matrix of numbers: N time (or frequency) samples times M spatial positions—that is, M traces each of which discretized into N samples. This is equivalent to assuming that the GPR “stops” in each A-scan position, gathers the data in that position, and goes on to the next position. Actually, in most cases the data are gathered in continuous mode—that is, the GPR gathers the data while moving—but the model “stop-gather-and-go-on” is in most cases acceptable because of the huge difference between the velocity of propagation of the electromagnetic signal and the velocity of the human operator, even if the time required to store an A-scan is actually quite longer than its formal time bottom scale. This happens because of several reasons such as sequential sampling (for pulsed systems), integration time of the harmonics (for stepped frequency systems), and stacking (for both). Here, we will not focus on these aspects, which are mainly technological and already explained elsewhere (Noon, 1996; Daniels, 2004; Jol, 2009). Let us just restrict ourselves to say that a nonexcessive (the quantification is case-dependent) and constant velocity during the data acquisition is always a good rule of thumb. The comprehensive set of GPR data relative to a series of parallel B-scans is usually labeled as a C-scan. In general, what is immediately visualized in the field is a B-scan in some color or gray tone scale. These data, usually called raw data, can allow us to identify targets of interest, but in general the image and its interpretation can improve meaningfully after a suitable processing.  GPR APPLICATION FIELDS  1.3  5  GPR APPLICATION FIELDS  A meaningful overview about the GPR applications is beyond the purposes of this book and is not its goal. Notwithstanding, for sake of self-consistency, a brief outlook is provided. Within the field of the archaeology (Conyers, 2004), GPR can allow us to identify the areas with alleged interesting buried remains, which in turn allows us to avoid an exhaustive and expensive (sometimes too expensive) excavation. Another issue of interest is the field of the preventive archaeology—that is, the preventive prospecting of areas where something is going to be built (a road, a building, an underground station, etc.). This mitigates the risk of destroying archaeological sites and also mitigates the economic risk that the works will be stopped by some Cultural Heritage Institution. Monitoring of monuments as historical buildings, statues (Sambuelli et al., 2011), ancient fountains, historical bridges (Solla et al., 2011), and so on, is another subject of interest. In particular, GPR monitoring (possibly integrated with other geophysical investigations) can give information about the state of preservation of the monuments and can provide useful information in order to address a restoration project properly. In some cases, information of historical interest can also be achieved—for example, about the presence of walled rooms, crypts, hypogeum rooms, tombs, hidden frescoes, and so on (Pieraccini et al., 2006; Grasso et al., 2011). GPR prospecting is also exploited in civil engineering (Grandjean et al., 2000; Utsi and Utsi, 2004). In particular, it can be used to identify structural damages and to investigate about hidden structures like sewers or water and gas pipes, whose presence is in many cases not precisely documented. Demining is another important application. In particular, modern mines are customarily built with plastic materials with only little or even no metallic parts. Therefore, they are often hardly visible or completely invisible to a metal detector. Moreover, a metal detector is not able to provide all the details possibly available from a GPR system, namely the position (in particular the depth), the size, and (among certain limits) the shape of the buried target. Demining has been dealt with for years within the GPR community (Groenenboom and Yarovoy, 2002), and it has also been successfully performed many times (Sato and Takahashi, 2009). GPR prospecting is also exploited for asphalt monitoring.4 In particular, it is possible to identify subsidences or damaging before they become worse or even dangerous for drivers and pedestrians. These problems are even more pressing in areas where the roads frost in the winter and thaw in the spring (Hugenschmidt et al., 1998; Villain et al. 2010). In several application fields, it can be particularly useful to make use of advanced GPR systems equipped with a large array of antennas (Sala and Linford, 2010; Böniger and Tronicke, 2010). These systems can gather simultaneously several (up to 14 and more) measurement lines with a unique going through. On the other hand, these systems need a quite flat scenario to provide good performances, because the arrays are rigid and possibly quite large (up to 2 m and larger).  4  In this case, the antennas are usually mounted on a car.  6  INTRODUCTION TO GPR PROSPECTING  GPR prospecting is also applied with regard to mines and pits. In particular, it can help to identify shallow veins of the mineral of interest (Ralston and Hainsworth, 2000; Francke, 2010) and can even help with regard to some safety issues. In fact, fractures, water infiltrations, or just obsolescence can badly affect the stability of the structure, in mines as well as in tunnels (Grodner, 2001; Cardarelli et al., 2003). In some cases, even explosive gases trapped in natural cruets can be met while digging, especially in coal mines (Cook, 1975). Another application of interest is GPR prospecting on the ice (Arcone et al., 2005). In particular, polar ice contains information about the geological history of our planet and can also provide information about the occurring climatic and environmental changes. GPR prospecting can be successfully performed on both fresh and salty ice. GPR prospecting on fresh water is a field of interest too—for example, for sedimentology applications in relationship with the bottom of lakes, ponds, or rivers5 (Smith and Jol, 1997). Liquid seawater, instead, is customarily too lossy to allow a reliable GPR prospecting. Industrial agriculture is another applicative field where it is of interest to devise an intelligent exploitation and distribution of the water (Friedman, 2005). In this framework, GPR can be a useful tool for the evaluation of the electromagnetic characteristic of the shallower layers of the soil, and in particular its dielectric permittivity. Some semiempirical relationships (Topp et al., 1980) can in some cases allow us to estimate the water content from the dielectric permittivity. Let us also mention the subject of the GPR investigation on Mars,6 where unmanned vehicles are gathering data, mainly looking for water and, consequently, the possible (current or past) presence of life (Picardi et al., 2005). Finally, let us also prompt (a) forensic applications, where, for example, buried corpses or hidden weapons are looked for (Hammon et al., 2000), and (b) borehole prospecting (Ebihara et al., 2000), where antennas are lowered in one (reflection mode) or two (transmission mode) carrot-holes.  1.4 MEASUREMENT CONFIGURATIONS, BANDS, AND POLARIZATIONS GPR data are mostly taken in reflection mode and, if possible, the antennas are preferably in contact with or at very short distance from the structure to be probed. However, in some cases the data are necessarily moved in a contactless configuration—as, for example, in demining (Sato and Takahashi, 2009) and asphalt monitoring (Hugenschmidt et al., 1998) or also for the monitoring of works of art that cannot be touched (Pieraccini et al., 2006). In most cases, the antennas are rigidly placed in a unique box and move together, but in some cases the two antennas can be moved separately from each other. This is a 5  In this case, the antennas are usually mounted on a boat.  6  In the past also GPR data from the Moon have been analyzed.  MEASUREMENT CONFIGURATIONS, BANDS, AND POLARIZATIONS  7  valuable resource, especially in order to measure the electromagnetic characteristics of the soil by gathering common midpoint (CMP), wide angle reflection and refraction (WARR), or trans-illumination data (Davis and Annan, 1989; Daniels, 2004; Conyers, 2004; Jol, 2009). Actually, sometimes the WARR configuration (also called multistatic multiview) is exploited not only to measure the characteristics of the soil but also to improve the image of the buried scenario. However, this is unpractical on a large scale, and the improvement achievable on the image is usually quite marginal, because the information achievable from the spatial diversity is not independent from that achievable from the frequency diversity (Persico et al., 2005; Persico, 2006). Customarily, the electromagnetic characteristics of the soil and/or of the buried targets also depend on the frequency. This is expressed by saying that the soil (more in general the propagation medium) and/or the targets are dispersive. Several dispersion laws are known (Lambot et al., 2004), but it might be not easy to establish in the field what is the most suitable dispersion law for the application at hand. Therefore, as a matter of fact, in most cases the dispersion is not accounted for in the data processing. More precisely, we can say that the dispersion phenomenon is more often considered if the purpose is to characterize the propagation medium in itself, and more rarely if the purpose is to focus the targets embedded in it. In general, the needed band of frequencies depends on the particular application. Customarily, as is well known, lower frequencies penetrate the opaque structures better than higher frequencies but provide a worse image of the targets. This drives us to use low frequencies (below 200 MHz) if the required investigation depth overcomes 5–7 m or more (e.g., in some geological applications), radio frequencies (200–700 MHz) for applications where the depth to reach is of the order of 3 m (e.g., in most archaeological prospecting), higher radio frequencies (700–3000 MHz) for applications where the maximum required depth of investigation is of the order of 1 m (e.g., detections of fractures or asphalt monitoring), and sometime even higher microwave frequencies if the maximum investigated depth can be limited to the order of 50 cm (e.g., demining or determination of the water content in the shallower layers of the soil). This classification is sketchy: It just indicates an average distribution, and many exceptions might be found. In particular, it refers to GPR application in “temperate” soils: The ice constitutes an exception and can allow a much deeper penetration of the GPR signal. In general, the maximum penetration depth depends on the current case history and can be estimated in the field, on the basis of the data. Several kinds of antennas are exploited in GPR prospecting. For the low-frequency cases, below 200 MHz, the antennas are customarily unshielded loaded dipoles, often quite long (depending on the central frequency, they can be up to 3 m long and even longer). The fact that the antennas are unshielded makes them gather reflections from targets in air too, and it makes the results more vulnerable to the electromagnetic interferences from external sources. On the other hand, a shield would make them quite weighty. Instead, beyond 200 MHz the GPR antennas are customarily shielded. In the range 200–1000 MHz, the most widely exploited antennas are probably the bow ties (Lestari et al., 2004), that are linearly polarized and customarily are fed with a coaxial cable. Sometimes a circular polarization can help for the discrimination of some targets. In these cases, large band spiral antennas (Daniels, 2004) can be used, even if their use is  INTRODUCTION TO GPR PROSPECTING  8  more rare. At higher frequencies, Vivaldi antennas and horns (Gentili and Spagnolini, 2000; Pieraccini et al., 2006) can be exploited too. They are linearly polarized and can be fed by a waveguide, which makes them more robust and suitable for highfrequency applications (Stutzman and Thiele, 1998). In some cases, the GPR system is equipped with an array rather than just a pair of antennas (Sala and Linford, 2010; Böniger and Tronicke, 2010). In these cases the single elements of the arrays are usually dipole-like antennas.  1.5  GPR DATA PROCESSING  The processing of GPR data is a large topic, and in particular the current application can require or at least can make more suitable some strategy with respect to some other. In particular, two fundamental categories of processing can be distinguished, namely deconvolution-based (Jol, 2009) processing and SAR effect-based processing. In deconvolution-based algorithms (also called 1D), one essentially processes the single GPR traces trying to retrieve the shape of the radiated pulse—that is, trying to equalize the distortion that the radiated pulse suffers because of the propagation in a dispersive inhomogeneous medium and because of the scattering from the target. This kind of processing is important especially in cases when the targets looked for have a foreseeable “signature” and tend to distort the impinging pulse in a known way. Examples of deconvolution-based processing in relationship with demining problems are probably the most common ones: In particular, usually the main trouble in this case is not to identify the mine (even if the difference between the dielectric characteristics of a plastic mine and those of the surrounding soil might be low), but rather to reduce the false alarm probability—this is, the probability to confuse the mine with any other target characterized by the same order of size and average depth (Timofei and Sato, 2004). In such a situation, a deconvolution can help in discriminating the nature of the reflecting target. The second category, which here will be labeled as SAR effect-based [the acronym stands for synthetic aperture radar, (Daniels, 2004)], is concerned with a processing that regards all of the traces within a B-scan or a C-scan and is aimed to focus within a vertical plane (2D models) or in a buried volume (3D models) the targets embedded in the host medium at hand. Within these SAR processing, it is then possible to distinguish a plethora of models and related algorithm, based on different kinds of approximation of the scattered field. In particular, there are linear algorithms based on the Born approximation (Chew, 1995), on the Rytov approximation (Devaney, 1981), on the extended Born approximation (Torres-Verdin and Habashy, 2001), on the Kirchhoff approximation (Liseno et al., 2004), and so on. Moreover, there are nonlinear approximations as the second-order Born approximation (Leone et al., 2003) or iterative algorithms that update up to convergence (according with some Cauchy-like criterion) the result of a single-step processing. Customarily, in these cases the single-step processing is linear (Moghaddam and Chew, 1992), but the comprehensive algorithm is nonlinear. There are also fully nonlinear approaches, based (for example) on the statistical minimization of some cost functional (Caorsi et al., 1991). Finally, let us list also the linear sampling  GPR DATA PROCESSING  9  method (Colton et al., 2003), a fast nonlinear inversion algorithm based on singlefrequency multiview data that has been becoming popular in recent years. Actually, most of these 2D and 3D models have been developed in a context wider than that of GPR data processing, which is the literature on microwave inverse scattering. Notwithstanding, they can be applied (in several cases they have been already applied) to the reconstruction of targets embedded in the soil or in masonry, which we can classify as a GPR application. Their utility and the trade-offs between them are related to the many possible specific applications. In this text, we will focus only on GPR data processing based on the Born approximation. In particular, the core of the processing dealt with here will be the migration (Stolt, 1978; Schneider, 1978; Yilmaz, 1987) and the linear Born model-based inversion (Colton and Kress, 1992) algorithms, both of which considered either in a 2D or in a 3D framework. Let us also specify that, commonly, the 3D processing is meant as the suitable joining of several 2D results achieved from several B-scans. This is useful and practical, especially (but not only) in order to image horizontal buried layers where the plan of built structures can be identified (Conyers, 2004). However, rigorously this is not a 3D processing method. We will label it a pseudo-3D approach, in order to distinguish this method from a real 3D approach, that will be dealt within Chapters 11–13. A 3D approach is theoretically more refined than a pseudo-3D one, but it is also more difficult and computationally more demanding. Let us outline, however, that, even if only these linear data processing will be dealt with, the complete scattering equations are derived, so that the intrinsic nonlinear nature of the scattering phenomenon is shown. Several reasons underlie the choice to limit our discussion to linear Born modelbased processing. First, an adequate discussion of all the listed techniques would require a book quite long (at least four times the size of the current book). Second, in the common GPR praxis the most exploited focusing algorithm is undoubtedly the migration, also because there are several commercial codes able to implement it. Third, we have preferred to give space to some extra topics that are not inverse scattering issues but, in the real world, are inseparable aspects of GPR data processing, namely the indirect measure of the characteristics of the embedding medium (that in general are not known a priori), the extraction of the scattered field data from the total field data, and some aspects specifically related to the gathering of the data either with a pulsed- or a stepped-frequency GPR system. Let us outline that the GPR processing is not constituted by a mere focusing. For example, data filtering and gain variable versus the depth are often very important passages. It is also worth outlining that some practice in the field is unavoidably essential (better if the starting phase is performed with the assistance of a more skilled user): there is no book that can replace it. The main aim of this text is to focus on some of the theoretical aspects that seem to the author particularly important for an “aware”execution of a GPR measurement campaign, followed by a proper processing and, when possible, a reasonable interpretation.  2 CHARACTERIZATION OF THE HOST MEDIUM  2.1  THE CHARACTERISTICS OF THE HOST MEDIUM  For a correct interpretation of the GPR signal, it is important to have some estimation of the electromagnetic characteristics of the background medium. A complete characterization theoretically means a measure of the dielectric permittivity and of the magnetic permeability, both meant as complex quantities to account for losses (in particular, in this way the dielectric permittivity can account for the electric conductivity too) and variables versus the frequency. These quantities are also functions of the buried point because in general the medium at hand is not homogeneous; and possibly they are tensor quantities instead of scalar ones, because the medium might be anisotropic (Slob et al., 2010). A complete characterization of the soil, therefore, is not an easy task. Fortunately, however, a complete characterization is usually not needed, and in many cases an average value of the propagation velocity of the electromagnetic waves in the soil is sufficient in order to focus and interpret satisfyingly the buried targets. In general, the propagation medium is lossy too. However, in many cases it is a low-lossy medium; that is, the real part of the wavenumber is much larger (one order of magnitude) than the imaginary part. In these conditions, we can neglect the influence  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  10  THE MEASURE OF THE PROPAGATION VELOCITY IN A MASONRY  11  of the losses on the propagation velocity and the dispersion that they arise (Daniels, 2004; Jol, 2009). This means that we can assume that (a) the GPR waves propagate at a velocity that can be evaluated neglecting the losses and (b) they don’t get deformed while propagating, even if they attenuate exponentially versus the distance. Most propagation media encountered in practical cases do not show magnetic properties. However, some exception can occur—for examples, in the case of a strongly polluted soil (Nabighian, 1987), in the case of some Martian soil (Stillman and Olhoeft, 2004), or in presence of some particular mineral, containing iron (Nabighian, 1987; Jol, 2009). Under the hypothesis of a homogeneous, isotropic, nonmagnetic and low-loss medium, the propagation velocity of the electromagnetic waves, c, is related to the relative dielectric permittivity of the medium, εs (real), by means of the relationship pﬃﬃﬃﬃﬃﬃ c = c0 = εsr (Stutzman and Thiele, 1998), where c0 is the propagation velocity of the electromagnetic waves in free space, about equal to 3 × 108 m/s. εsr is the relative permittivity of the soil, whereas the complex (absolute) dielectric permittivity of the soil is given by εeq = ε0 εsr − jεsim − jðσ=ωÞ, where ε0 is the dielectric permittivity of the free space, equal to 8.854 × 10−12 Farad/m, εsim is the imaginary part of the dielectric permittivity (which accounts for dielectric losses), σ is the electric conductivity of the background medium (which accounts for conduction losses), and ω is the circular frequency. Actually, it is not easy to distinguish the nature of the losses experimentally, and so the two terms that compose the imaginary part of the dielectric permittivity can be also expressed by either an equivalent conductivity or an equivalent imaginary permittivity. For many materials, expected values of the relative dielectric permittivity are presented in tabular form (Daniels, 2004; Jol, 2009; Conyers, 2004). However, it is customarily better to measure the propagation velocity of the waves in the background medium at hand from the data, because the current values of the soil characteristics depend on several environmental parameters, which usually are not known a priori (such as the water content, the compactness of the soil, the presence of mineral salts, and possibly even the temperature). Notwithstanding, some awareness of the average values found in tables can be useful in order to check the likelihood of the values retrieved in the field. There are also tables regarding the exponential attenuation rate of the signal in several media (which is essentially related to the equivalent conductivity), but usually the range of possible values is much larger than that achievable for the relative permittivity.  2.2 THE MEASURE OF THE PROPAGATION VELOCITY IN A MASONRY The electromagnetic characteristics of the propagation medium depends on its chemical composition, its water content, its porosity, its mineralogy, and possibly its temperature. These dependences are in general a complicated matter, as described (for example) in Daniels (2004); and Jol (2009). Consequently, in most cases one does not have at one’s disposal all the instruments and competencies to retrieve the electromagnetic characteristics of the soil starting from a microscopic approach. Therefore, we will focus the attention on the subject of the measure of these characteristics from GPR (or at most TDR) data.  CHARACTERIZATION OF THE HOST MEDIUM  12  In order to measure the propagation velocity of the electromagnetic waves in the background medium, the first possibility is to make use of a cooperative target—that is, a known object placed on purpose. This is easily performed in the case of a masonry or a pillar, or even a column.1 In particular, in these cases a metallic sheet or a metallic bar2 can be placed and removed at the opposite site of the structure, gathering a GPR scan for each of the two cases, as depicted in Figure 2.1. The average propagation velocity can be measured from the simple relationship c=  2d t  ð2:1Þ  where t is the return time of the echo corresponding to the opposite side of the structure and d is the depth of the reflector (i.e., the thickness of the structure). The factor 2 is due to the round-trip of the signal from the antenna to the reflector and vice versa. The time t is identified by comparing the two GPR traces gathered with and without the metal target behind the structure. Let us outline that, in many cases, the second interface of the masonry is visible as a flat anomaly from the GPR data, even without any metallic marker. At any rate, the marker can be helpful because the GPR image might show several flat anomalies, possibly due to internal layers within the wall, ringing of the antennas (Conyers, 2004), multiple reflections (Daniels, 2004), or possibly some large obstacle beyond the probed masonry. In such a case, the cooperative target allows us to identify which one among the visible layers is specifically due to the opposite side of the wall. In many cases, the thickness d can be measured directly with a tape or (more rarely) from a reliable scaled map of the building. The measure of the propagation velocity from the return time and the thickness of the structure can be also applied to pillars and columns (Masini et al., 2010). However, there are cases where the direct measure of the thickness of the masonry is not immediate, because (for example) the masonry is long or it ends in contact with another orthogonal wall, or possibly its thickness is not uniform so that the two air– masonry interfaces are not parallel to each other (this can happen, especially in ancient buildings). In these cases, it might be more reliable to work out the propagation velocity of the signal in the masonry from the behavior of the gathered GPR signal, with the marker placed behind the wall. This can be done in the same way as described in the following section with regard to the case of a homogeneous soil. There are also cases where the masonry is quite thick and/or lossy, so that that the signal from the far interface is hardly (or not at all) perceivable. A marker might be useful even in some of these cases. In particular, without the check of a marker we might misinterpret some interface internal to the masonry as being the opposite interface. In other cases, the metallic marker might make stronger the reflection from the far interface 1 A masonry, if homogeneous, can be modeled as a homogeneous half-space for intra-wall imaging purposes. This is not mathematically rigorous but works for any layered medium if the targets of interest are embedded in the first (shallower) layer. 2 The metallic sheet provides a stronger returned signal with respect to the bar, but a bar allows a slightly more refined analysis of the returned signal, as will be shown later.  THE MEASURE OF THE PROPAGATION VELOCITY IN A HOMOGENEOUS SOIL  13  Figure 2.1. Upper panel: A metallic road is placed horizontally on the other side of the prospected wall. Lower panel: The metallic road is removed. The antennas have been moved in both cases downward along a vertical line.  so that it becomes more clearly perceivable as a result. In this last case, a metallic sheet is likely to work better than just a rod.  2.3 THE MEASURE OF THE PROPAGATION VELOCITY IN A HOMOGENEOUS SOIL 2.3.1 Interfacial Data in Common Offset Mode with a Null Offset: The Case of a Point-like Target The measure of the propagation velocity of the electromagnetic waves in a homogeneous soil might be done, in principle, with a buried marker, similarly to what is described for the case of a wall. However, the excavation needed to put a metallic marker at a known  CHARACTERIZATION OF THE HOST MEDIUM  14  depth would modify the compactness of the soil in that zone, and this would modify the electromagnetic characteristics of the soil in that point (Conyers, 2004; Soldovieri et al., 2009). For the same reason, also laboratory analyses (Afsar et al., 1986) of soil or rocks samples require a particular attention: The samples should reach the laboratory with the same compactness and water content they had in the field; otherwise the result of the measure is not reliable. Sometimes a ground truthing (i.e., a limited set of localized excavations on some specific targets identified from the data) can be used to calibrate the propagation velocity (Conyers, 2004). These are useful when possible, but in some cases might be time-consuming, unauthorized, or not well-advised. So, in many cases the propagation velocity has to be estimated noninvasively from the same GPR data. The most common methods to do this is based on the diffraction curves, more commonly called diffraction hyperbolas. To expose the method of the diffraction curves, let us start considering a point-like target—that is, a buried object small with respect to the minimum involved wavelength in the soil. In particular, let us refer to the scheme in Figure 2.2. The transmitting antenna illuminates the target not only when it passes exactly over it, but also from a certain distance before it and up to a certain distance beyond it. So, the receiving antenna gathers an echo from the target not only when it crosses over –1 Signal path  –0.5  x0  x  0  Air Soil  z0 = 0.5ct0  0.5 0.5ct  Target  1  1.5 2 Resulting curve 2.5 3 –2.5  –2  –1.5  –1  –0.5  0  0.5  1  1.5  2  2.5  Figure 2.2. Measure of the permittivity of the soil from a diffraction hyperbola from a point-like target. The hyperbola is represented after time depth conversion (the units are arbitrary).  THE MEASURE OF THE PROPAGATION VELOCITY IN A HOMOGENEOUS SOIL  15  it, but usually within a segment centered on the target. The length of this segment depends on directivity of the antennas, the characteristics of the soil, and the depth of the target. If the antennas are moved at the air–soil interface, and the offset between them is neglected, then the distance from the position of the source-observation point (x,0) qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ and the buried target in the position (x0,z0) is given by ðx − x0 Þ2 + z20 . This quantity corresponds to the apparent depth at the abscissa x, which in terms of propagation velocity is given by zðxÞ = ct=2, where t = t(x) the return time of the echo recorded at the position x. In the point x = x0, the apparent depth of the target reaches its minimum value z = z0 = ct0 =2, where t0 is the minimum recorded return time. Putting together these equalities, we have ct = 2  rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ct 2 ct 2 t 2 ðx − x Þ2 2 0 0 0 2 ðx − x0 Þ + ðx − x0 Þ2 + =1 ,t= ) 2− c 2 2 t0 0:25c2 t02  ð2:2Þ  Relationship (2.2) is the equation of a hyperbola (but of course only one of the two branches is considered) with the vertex at the target position (x0,t0). Equation (2.2) is parametric with respect to the propagation velocity c, and so c can be estimated from Eq. (2.2). In principle, this might be done even just from two points, but of course a more extended fitting provides a more reliable result. There are commercial codes that allow us to do this fitting in an immediate graphical way [e.g., the GPRslices (Goodman and Piro, 2013) and the Reflexw (Sandmeier, 2003)] by depicting the model diffraction hyperbola at variance of a trial c on the data. As is well known, by replacing 1 with 0 in the second term of Eq. (2.2) we achieve the equation of the asymptotes of the hyperbola, that is, 2 t = ± ðx − x0 Þ c  ð2:3Þ  Equation (2.3) shows that the asymptotes do not depend on the time depth of the target, and the two lines cross each other at the point (x0,0)—that is, over the point target and at the air–soil interface. Theoretically, the propagation velocity might be estimated just from the slant of the asymptotes, that is, ± 2=c. This evaluation, however, is rarely possible, because the visible portion of the hyperbola is usually too short to allow a reliable identification of the asymptotes. However, the tangent line to the “tail” of the hyperbola—that is, the tangent to the hyperbola in a point far from the vertex—can also provide an estimation of the propagation velocity. In fact, from Eq. (2.2), the slant of the tangent to the diffraction hyperbola is given by dt 2 ðx − x0 Þ = rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ct 2 dx c 0 ðx − x0 Þ2 + 2  ð2:4Þ  16  CHARACTERIZATION OF THE HOST MEDIUM  The limit value of the expression (2.4) for jxj >> jx0j is ± 2=c, where sign depends on whether we consider positive or negative abscissas. Of course, this means that the tangent to the diffraction hyperbola becomes progressively more parallel to the asymptote. Equation (2.4) also allows us to quantify the closeness between the slants of these two lines. In particular, if jx − x0 j ≥ 3 ðct0 =2Þ, it is easy to recognize that to confound the tangent with the asymptote allows an evaluation of the propagation velocity with an error of about 5.5%. The shape of the diffraction hyperbola depends also on the time depth of the target. In particular, for very shallow point targets (t0 ! 0), the diffraction hyperbola tends to coincide with its asymptotes. This is the reason why shallow and small targets appear as little roofs in the raw GPR. In some cases, it can be of interest to visualize the diffraction hyperbola in the (x,z) plane rather than in the (x,t) plane. This is trivial after evaluating the propagation velocity. In this case, the diffraction hyperbola becomes equilateral; that is, the asymptotes are orthogonal to each other. In fact, Eq. (2.2) in the plane (x,z) is just rewritten as qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ z2 ðx − x0 Þ2 z = ðx − x0 Þ2 + z20 ) 2 − =1 ð2:5Þ z0 z20 and consequently the equation of the asymptotes is z = ± ðx − x0 Þ  ð2:6Þ  whose slants with respect to the x-axis are 45 and −45 degrees, respectively. This means that the actual propagation velocity can be also viewed as that value that makes equilateral the diffraction hyperbola in the plane (x,z). Let us note that because the real scenario is three-dimensional and the position of the buried target is not known a priori, the observation line may not pass exactly over the point-like object. In this case, the minimal distance z0 between the target and the antennas is no longer equal to the depth of the target, and the scenario in Figure 2.2 should be tilted around the measurement line. However, the evaluation of the permittivity is not affected by this possibility, being essentially based on the distance–time correspondence and on Pythagoras’ theorem. In the performed evaluation, some approximations and/or assumptions are implicit. A first approximation is the use of an essentially optical model of the propagation. Actually, the propagation of the waves is not described just by means of rays: The physics of the phenomenon is more complicated and, as will be shown, can be fully described only by making use of Maxwell’s equations. The hypothesis that the target is point-like can be a strong assumption. Practically, the non-null size of the target tends to make larger the diffraction curve, thereby resulting in an underestimation of the propagation velocity. Consequently, in a real scenario, one should heuristically choose the narrower and “cleaner” hyperbolas among those visible at any given time depth: They are those most likely to be ascribable to electrically small targets.  THE MEASURE OF THE PROPAGATION VELOCITY IN A HOMOGENEOUS SOIL  17  2.3.2 Interfacial Data in Common Offset Mode with a Null Offset: The Case of a Circular Target Circular targets of any size also provide a hyperbolic signature in the data (Li et al., 2012). In fact, with reference to Figure 2.3, let us consider a buried circular target with center C and radius R. In Figure 2.3, A is the source-observation point and E is the interfacial point at minimum distance from the target. Thus, with reference to Figure 2.3 and making use of the same symbols exploited in the case of a point-like target (plus the radius R of the buried circular target), we have   AE 2 + EC 2 = AC2 ) AE 2 + ðED + DC Þ2 = ðAB + BC Þ2 ) ðx − x0 Þ2 +  2  2  ct0 ct +R +R = 2 2     2R 2 c ðx − x0 Þ2 2 = 1 2 −  ) 2R ct0 +R t0 + 2 c t+  ð2:7Þ  Equation (2.7) describes the diffraction curve relative to a circular target. One can immediately recognize that this diffraction curve is still a hyperbola and reduces to  A  E  Air Soil  B  D  C  Figure 2.3. Measure of the permittivity of the soil from a diffraction hyperbola from a circular target.  CHARACTERIZATION OF THE HOST MEDIUM  18  the hyperbola of Eq. (2.2) for R ! 0. The vertex of the hyperbola is in the point (x0,t0), and the minimum time depth t0 refers to the top of the target. Replacing 1 with 0 in the last form of Eq. (2.7), we work out the equation of the asymptotes, which in this case is t= −  2R 2 ± ðx − x0 Þ c c  ð2:8Þ  Equation (2.8) shows that the slant of the asymptotes of the hyperbola remains unchanged with respect to the case of point targets [see Eq. (2.3)], but they are rigidly translated so that they cross each other “in air” at the negative time t = − 2R=c. This proves that it is not possible to find two different couples (R1,c1) and (R2,c2) that lead to the same diffraction hyperbola. In fact, in this case the slant of the asymptotes should be the same, so that necessarily c1 = c2, and then the intercept point between the asymptotes should be the same too, which leads to R1 = R2. Consequently, the problem of retrieving of the couple (R,c) from the data by means of a least square matching has a unique solution. Notwithstanding, usually the portion of visible hyperbola is not so long and noise-free to allow a clear identification of the asymptotes and thus, depending on the particular situation, the retrieving of both parameters (R,c) can be more or less difficult. In some cases (e.g., in the cases of buried pipes) the radius of the pipe can be known a priori, and it is possible to perform an immediate graphical matching between model and data that allows us to look for the propagation velocity c accounting for the correct value of the radius. This matching can be performed by means of commercial codes—as, for example, the Reflexw. From Eq. (2.8), we can also appreciate that, if the circular target is not small but its real size is not accounted for, we overestimate the propagation velocity. In fact, for a given time depth t0, for increasing values of the radius, the diffraction hyperbola keeps the same vertex but its asymptotes translate vertically toward the air half-space. Therefore, it becomes larger near the vertex. In the limit for R ! ∞ the cross point between the asymptotes, equal to − 2R=c, tends to −∞ and so the hyperbola degenerates into a flat interface.  2.3.3 Interfacial Data in Common Offset Mode with a Non-null Offset: The Case of a Point-like Target In the presented evaluations we have considered data gathered at the air–soil interface and have neglected the offset between the antennas.3 If one or both these hypotheses are removed, then the signature of the target is no longer a hyperbola. This is the reason why we prefer the more general term “diffraction curve” instead of the more specific one “diffraction hyperbola.” In particular, in this section we consider again a point-like target but remove the hypothesis of null offset between the antennas, considering an 3 Actually, an authentic monostatic (i.e., zero offset) measure occurs only when the same antenna is switched alternatively from transmitting to receiving mode. This solution is possible but rarely employed.  THE MEASURE OF THE PROPAGATION VELOCITY IN A HOMOGENEOUS SOIL  19  –1 Transmitting antenna at x0 – 0.5Δ –0.5  Receiving antenna at x0 – 0.5Δ Air Soil  Backward path Target  Outward path  0.5  1  x0  x  0  Arithmetic average between outward and backward paths  1.5  2  Resulting curve Offset Δ  2.5  3 –2.5  –2  –1.5  –1  –0.5  0  0.5  1  1.5  2  2.5  Figure 2.4. The diffraction curve with a non-null offset between the antennas. The curve is meant under time depth conversion with z = ct=2. The units are arbitrary.  offset Δ 6¼ 0 between the transmitting and the receiving antennas. With reference to Figures 2.4 and 2.5, it can be recognized that Eq. (2.2) evolves into sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ    2ﬃ s   2 Δ 2 ct0Δ 2 Δ Δ 2 ct0Δ 2 Δ ct = x − x0 − + x − x0 + + − + − 2 2 2 2 2 2  ð2:9Þ  where x is the midpoint between the transmitting antenna and the receiving antenna, so that the abscissa of the transmitting antenna (source point) is x − Δ=2 and that of the receiving antenna (observation point) is x + Δ=2). It is not important which one between the two antennas comes geometrically first, because the offset can be considered either positive or negative. Moreover, x0 is the abscissa of the target and t0Δ is the return time recorded when x = x0—that is, when the source point is equal to x = x0 − Δ=2 and the observation point is equal to x = x0 + Δ=2. With reference to Figure 2.5, we see that, when t = t0Δ, the source point, the observation point, and the target compose an isosceles triangle, whose height is the depth of the target. This height, in terms of propagation time, is given by  CHARACTERIZATION OF THE HOST MEDIUM  20  –1 Transmitting antenna at x0 – 0.5Δ Receiving antenna at x0 + 0.5Δ  –0.5  x0  0  Air Soil  0.5Δ  0.5ct0Δ  0.5  0.5ct0Δ  0.5ct0Δ  1 0.5ct0  1.5  2 Resulting curve 2.5  3 –2.5  –2  –1.5  –1  –0.5  0  0.5  1  1.5  2  2.5  Figure 2.5. The scenario for x = x0 —that is, when the midpoint between the antennas is over the target. The curve refers to the result after the time-apparent depth conversion z = ct=2.  sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ﬃ ct 2 Δ2 0Δ z0 = − 2 2  ð2:10Þ  Equation (2.10) makes it clear that Eq. (2.9) is just the sum of two distances, each of which is evaluated by means of Pythagoras’ theorem. By studying the function t(x) provided by Eq. (2.9), t0Δ is recognized to be minimum recorded time along the scan, so that it is provided by the data. Squaring Eq. (2.9) twice, after some algebra we work out the following polynomial equation for the diffraction curve:   c2 t 2 c4 t 4 − 4c2 t 2 ðx− x0 Þ2 + 0Δ + Δ2 ðx − x0 Þ2 = 0 4  ð2:11Þ  As can be seen, Eq. (2.11) is not a hyperbola but a fourth-degree curve. It reduces to the hyperbola of Eq. (2.2) if and only if the offset between the antennas is equal to zero. Note that the diffraction curve (2.11) admits the same two asymptotes of the diffraction hyperbola corresponding to a null offset between the antennas. In fact, considering high  Return time [sec.]  THE MEASURE OF THE PROPAGATION VELOCITY IN A HOMOGENEOUS SOIL  0  21  ×10–8  1 2 3 –1.5  –1  –0.5  0  0.5  1  1.5  0.5  1  1.5  Return time [sec.]  x [m] 0  ×10–8  1 2 3 –1.5  –1  –0.5  0 x [m]  Figure 2.6. Quantitative comparison between the diffraction curve with offset equal to 0 cm (blue line), 10 cm (red line), and 50 cm (black line). The propagation velocity is 108 m/s. The depth of the target is 12.5 in the upper panel and 75 cm in the lower panel. For color detail, please see color plate section.  values of x (either positive and negative) and consequently of t [see Eq. (2.9)], we have 2 that in Eq. (2.11) we can neglect the constant term c2 t0Δ =4, so that Eq. (2.11) reduces to   c4 t 4 − 4c2 t 2 ðx − x0 Þ2 + Δ2 ðx − x0 Þ2 = c4 t 4 − ðx − x0 Þ2 4c2 t 2 − Δ2 = 0  ð2:12Þ  However, in Eq. (2.12) we can neglect the constant term Δ2, so that it still reduces to c4 t 4 − 4c2 t 2 ðx − x0 Þ2 = 0 ) c2 t 2 − 4ðx − x0 Þ2 = 0  ð2:13Þ  which is equivalent to Eq. (2.3). This means that if the portion of the diffraction curve visible from the data is large enough, the slant of the asymptotes (and thus also the slant of the tangent to the diffraction curve far from the vertex) allows us to identify the propagation velocity independently of the value of the offset. In order to provide a picture of the real “weight” of the offset, in Figure 2.6 three diffraction curves are shown, corresponding to three offsets respectively equal to 0 cm (blue line), 10 cm (red line), and 50 cm (black line). The target is at depth 12.5 cm in the upper panel and at depth 75 cm in the lower panel. In these examples, the propagation velocity of the electromagnetic waves is 108 m/s. In the end, the effect of the offset is not dramatic in most cases. In particular, from the upper image of Figure 2.6, we can appreciate that even in a case when the offset is of the same order of the depth of the target, the two curves with null and non-null offset are quite similar. The physical reason of this similarity can be explained on the basis of  CHARACTERIZATION OF THE HOST MEDIUM  22  Figure 2.4. In fact, let us consider first the optical path with null offset, where the source and observation point collapse in the middle point of the segment between them. In this case, the optical path is the sum of a forward and a back half-path equal to each other. Instead, when considering a non-null offset, we have that the two half-paths are different from each other. However, if the forward half–path gets longer with respect to the case of null offset, then the back half-path becomes shorter and vice versa, and this partially counteracts (except just over the target) the variation of the comprehensive round-trip time of the signal.  2.3.4 Noninterfacial Data in Common Offset Mode with a Null Offset: The Case of a Point-like Target Let us now consider the case with data gathered at fixed height h > 0 instead of at the air–soil interface. We restore for simplicity the hypothesis of null offset between the antennas. The target is point-like. In this case, the path of the signal from the source–receiver point to the buried target and vice versa is not a linear segment but a bent line, as shown in Figure 2.7, because of the refraction of the wave at the air–soil interface. In particular, with reference to Figure 2.7, we have that the return time is given by 2 t= c0  rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ct 2 2 2 2 ðx − x1 Þ + h + ðx1 − x0 Þ2 + 01 2 c  ð2:14Þ  where x is the abscissa of the source–receiver point, x1 is the abscissa of the point at the air–soil interface where the optical path gets bent, x0 is the abscissa of the target, c0 and c are respectively the propagation velocity in free space and in the soil, and t01 is the minimum round-trip time from the air–soil interface to the target. This is a share of –0.9 Observation line  –0.6 h  –0.3 Air  0  θ1  x  x1  x0  Soil  0.3  θ2 0.5ct01  0.6 0.9 1.2  * Target  1.5 1.8  1  2  3  4  5  6  7  8  9  10  Figure 2.7. The bent optical path between the source–observation point and the buried target and vice versa (arbitrary length units).  THE MEASURE OF THE PROPAGATION VELOCITY IN A HOMOGENEOUS SOIL  23  the minimum recorded return time (from the source to the target and vice versa) corresponding to the path in the soil. In particular, the minimum recorded round-trip time is equal to tmin =  2 2 h + t01 ) t01 = tmin − h c0 c0  ð2:15Þ  In particular, t01 is also experimentally distinguishable from tmin because the air–soil interface is usually very visible in raw contactless data. In order to express the diffraction curve, we have to establish the value of x1 versus x. This can be retrieved from the well-known Snell’s law for the refraction (Franceschetti, 1997). In particular (see Figure 2.7), we have sin ðθ1 Þ =  c0 jx − x 1 j c0 jx1 − x0 j sin ðθ2 Þ , qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ = rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ct 2ﬃ c c 2 01 ðx− x1 Þ + h2 ðx1 − x0 Þ2 + 2  ð2:16Þ  with the physical constraint that x1 belongs to the interval [x,xo] if x ≤ x0 and to the interval [x0,x] if x ≥ x0. A mathematical discussion of Eq. (2.16) might be done: in particular, considering the square of both members and multiplying both sides times the product of the denominators, after some algebra Eq. (2.16) becomes 0 1 2 c4 t01 2 2 − c0 h C B 2 2 4 C x + x + 4xx + x41 − 2x31 ðx + x0 Þ + x21 B 0 0 @ c2 − c20 A 0  1 2 2 c4 t01 c4 t01 2 2 x − c x2 − c20 h2 x20 h x 0C 0 B 2 4 4 2 2 2 C+x x + =0 − 2x1 B 0 @x x0 + xx0 + A c2 −c20 c2 − c20  ð2:17Þ  which is a fourth-degree equation in x1 and is even resoluble in a closed form.4 However, to deal with Eq. (2.17) analytically is not comfortable (Persico et al., 2013a), and in this text we will consider only a numerical solution of Eq. (2.16). Note that the monotonies of the involved functions allow us to easily infer that the solution of Eq. (2.16), under the said physical constraint, is unique. Therefore, Eq. (2.16) defines in a nonambiguous way a function x1(x,c). Thus, the formal expression of the diffraction curve in the case at hand is given by 2 t= c0 4  rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ct 2 2 2 ðx1 ðx, cÞ −x0 Þ2 + 01 ðx − x1 ðx, cÞÞ + h2 + 2 c  ð2:18Þ  The solution of third- and fourth-degree equations was published for the first time in the treatise Ars Magna, written by Gerolamo Cardano in the year 1545.  CHARACTERIZATION OF THE HOST MEDIUM  24  Note that in the limit when the target is very deep—that is, for t01 ! +∞, since |x1 − x0| is a limited quantity (in particular, it is minorated by |x − x0|) from Eq. (2.16)—we have that necessarily x1 ! x. Substituting into Eq. (2.18), we obtain 2 2 t! h+ c0 c  rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ct 2 ðx − x0 Þ2 + 01 2  ð2:19Þ  which means that the limit path of the received GPR signal is composed by a vertical path in air from the source–receiver point to the interface followed the same path that the signal would show if the measurements were interfacial. Thus, this limit path is a hyperbola. On the other hand, in the limit for very shallow targets (i.e., for t01 ! 0), we have from Eq. (2.16) rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ct 2 c0 01 2 ! jx − x1 jjx1 − x0 j = jx1 − x0 j ðx − x1 Þ2 + h2 jx − x1 j ðx1 − x0 Þ + 2 c  ð2:20Þ  Therefore, x1 should either tend to x0 or solve asymptotically the equation c0 jx − x1 j = c   2  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ  c0 2 2 2 ðx − x1 Þ + h ) ðx − x1 Þ = ðx − x1 Þ2 + h2 c   2   2 c0 c0 2 ) ðx − x1 Þ2 1 − h = c c  ð2:21Þ  However, since necessarily we have c < c0, the only physical solution is that x1 ! x0. Substituting into Eq. (2.18), we obtain t!  2 c0  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ðx − x0 Þ2 + h2  ð2:22Þ  Moreover, from Eq. (2.15) we have that h ! c0 tmin =2, which substituted into Eq. (2.22) provides 2 t! = c0  rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ c t 2 0 min ðx − x0 Þ2 + 2  ð2:23Þ  which is the diffraction hyperbola of a target “embedded in air,” because the propagation of the signal actually occurs in air. Thus, in this opposite limit case the diffraction curve is again a hyperbola. However, in the intermediate cases between the two extremes, the diffraction curve is not a hyperbola in general. Incidentally, Eq. (2.23) also means that a very shallow target does not provide any information about the propagation velocity of the waves in the soil, because the propagation occurs entirely in air. In general, the measure of the propagation velocity from noninterfacial data is more critical than  THE MEASURE OF THE PROPAGATION VELOCITY IN A HOMOGENEOUS SOIL  25  the measure from interfacial data: some more details on this aspect are provided in Persico et al. (2013b).  2.3.5  Interfacial Data in Common Midpoint (CMP) Mode  Let us now describe the measure of the propagation velocity of the electromagnetic waves from common midpoint (CMP) data (Daniels, 2004; Conyers, 2004), also reported as common depth point (CDP) data. Let us assume that a buried point-like target has been identified at the abscissa x0. In CMP mode, one records the return times achieved by placing the transmitting and the receiving antennas at the two positions x and 2x0 − x symmetrical with respect to the target. According to Figure 2.8, the length of the comprehensive path from the transmitting antenna to the target and then from the target to the observation point is given by rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ct 2 t 2 ðx − x Þ2 0 0 ct = 2 ðx − x0 Þ2 + ) 2− =1 2 t0 0:25c2 t02  ð2:24Þ  As can be seen, Eq. (2.24) is the same as Eq. (2.2). This is because (see Figures 2.2 and 2.8) the length of the path traveled by the signal is the same in the two cases even if, of course, only one-half of the diffraction curve is retrieved in CMP mode. –1 –0.5 –0  –x2  Air  x0  –x1  Soil  0.5ct1  [m]  0.5ct2  0.5ct2 0.5ct2  0.5ct1  Target  Signal path  x2  0.5ct1 0.5ct0  0.5 1  x1  1.5 2 2.5 3 –2.5  Resulting curve  –2  –1.5  –1  –0.5  0 [m]  0.5  1  1.5  Figure 2.8. Scheme for common midpoint measurements.  2  2.5  CHARACTERIZATION OF THE HOST MEDIUM  26  Actually, in the case of CMP measurements, one doesn’t need to assume that the target is point-like. In particular, a plane buried interface parallel to the air–soil interface provides similar results, as well as any roundish surface if its top is not tilted with respect to the air–soil interface. This is based on Snell’s law on the reflected waves (Franceschetti, 1997), which assures (as is well known) the equality of the incident and reflected angles. Due to the unknown shape and size of the buried targets, this states the theoretical better performances of the CMP measure of the propagation velocity with respect to the common offset one. Actually, CMP data can provide information about the electromagnetic characteristics of a stratified medium with horizontal layers even without any localized reflector [but in this case some care has to be taken with regard to possible waveguide effects (Yilmaz, 1987)]. Another possible advantage is that the increased distance between the antennas prevents the risk of saturation of the receiver. Theoretically, this allows us to increase the radiated power and can make visible a larger portion of the diffraction hyperbola, even if the radiated power has to respect some legal (further than technical) limits (Chignell, 2004). Actually, in CMP mode we don’t even need to identify a suitable buried target. In fact, the direct coupling signal between the antennas is somehow equivalent to a target at the air–soil interface put in the midpoint between source and receiver (see Figure 2.9). In particular, with reference to Figure 2.9, in CMP the receiving antenna gathers both a direct signal traveling in air and a direct signal traveling in the shallowest part of the soil. The signal traveling in air propagates at about the velocity of propagation of the waves in free space c0.  Direct surface signal through the air TX  RX Midpoint *  Signal scattered by a buried target in the midpoint  Direct surface signal through the soil  Figure 2.9. Geometric scheme for the received CMP signal. Beyond the signal scattered from the target (if any) buried under the midpoint, there is the direct signal between the antennas, propagating partly in air and partly in the shallowest part of the soil.  LOSSY, MAGNETIC, AND DISPERSIVE MEDIA  27  So, if the receiving antenna is at the generic (positive) abscissa x, the radiated pulse propagating in air is received at the time instant t=  2 ðx− x0 Þ c0  ð2:25Þ  Instead, the pulse propagating in the soil at shallow depth propagates at the propagation velocity c of the waves in the soil and therefore is received at the time instant 2 t = ðx − x0 Þ c  ð2:26Þ  Equations (2.25)–(2.26) show that the same interface generates two diffraction curves t = t(x), which are two straight lines with slants 2=c0 and 2=c, respectively. Since c < c0 the line relative to the propagation in the soil is the most tilted one. In particular, since both the distance between the antennas and the pulse arrival time are known, it is possible and well-advised to check whether the upper line is really relative to the propagation in air. Incidentally, the straight line relative to the propagation just below the surface corresponds to the degenerated diffraction hyperbola of a point-like target placed at the air–soil interface. However, it is well-advised to make use not only of the surface reflections but also, if possible, of the reflection from some suitable buried target. In fact, the shallower layers of the soil might show a propagation velocity different from the average propagation velocity in the first 1–3 m, which in most cases is the depth range of interest. Moreover, the roughness of the soil might affect the superficial apparent propagation velocity. An obvious drawback of CMP mode with respect to the common offset one is the fact that CMP requires two antennas that can be moved independently from each other. Moreover, the CMP procedure is intrinsically discrete in the sense that, customarily, the antennas are not moved in a continuous mode (keeping the two velocities equal and also keeping the directions constant can be a critical issue), which makes the measurement quite slower than that usually achievable in common offset mode. In Section 15.1, the reader will find some exercises on the retrieving of the propagation velocity in the medium embedding the targets from the data.  2.4  LOSSY, MAGNETIC, AND DISPERSIVE MEDIA  Up to now we have devoted attention to the measure of the propagation velocity of the waves in the soil, which is in most cases the parameter of utmost interest. Let now devote some attention to other electromagnetic characteristics of the background medium. With regard to the amount of the losses, in general they are more difficult to be measured with respect to the propagation velocity. Actually, since the attenuation due to the losses is exponential versus the length of propagation path, one can think of measuring it directly from the GPR data. However, in general we don’t know the radar cross section (Levanon, 1988) of the buried targets and therefore in general we  28  CHARACTERIZATION OF THE HOST MEDIUM  are not able to distinguish, from the mere amplitude of a received signal, the share of the transmitted energy that has been attenuated by the electromagnetic losses of the soil and the share that has been scattered by the target away from the receiving antenna. Thus, the simple comparison between the amplitude of the transmitted pulse and that of the received one might not be sufficient to establish the amount of the losses, and incidentally the amplitude of the transmitted pulse might be unknown too. This makes the measure of the losses from usual GPR data in common offset a hard task. CMP data can offer some more possibilities, because we can create in a controlled way different propagation paths where the signal is reflected by the same target and so we can make a comparison between the amplitude of two or more different received pulses (Leucci, 2008). The radar cross section (even if unknown in general) is assumed to be the same for different position of the antennas. This is reasonable, even if not rigorous, especially if the reflector is a flat interface. Some care has to be taken with regard to the range of distances considered between the two antennas: If this range is electrically large, the amplitude of the received pulse is influenced also by the radiation pattern of the antennas, which should be therefore taken into account. In the case of a homogeneous masonry, we can perform two measurements: the first one in transmission mode with the two antennas equal to each other on the opposite faces of the wall, and the second one in reflection mode with a metallic sheet put on one side of the masonry and the GPR antennas on the other side. Actually, in this case, it would be more correct to exploit the same antenna to transmit the pulse and to receive the echo. Then, we can compare the amplitude of a signal propagated in transmission mode with the amplitude of the same signal propagated in reflection mode along a path twice as long. No effect due to the antenna pattern is expected in this case, because both propagation paths develop in the broadside direction. An alternative possibility is based on the use of a time domain reflectometry (TDR) probe (O’Connor and Dowding, 1999; Cataldo et al., 2011), briefly described in the following. The TDR technique is in most cases a method in time domain. However, since now we are dealing with the measurement of losses in the soil, it is convenient for our purposes to propose an analysis of the TDR signal in frequency domain. With reference to Figure 2.10, a TDR equipment is substantially a transmission line-based structure. Therefore, the basic theory is easily understood on the basis of the theory of the transmission lines (Franceschetti, 1997), which is (necessarily) taken for granted here. With reference to Figure 2.10, suppose that an incident wave at fixed frequency propagates from the left-hand side along line 1. Line 1 is considered infinitely long in this scheme, which practically means that it is matched to the generator. Incidentally, this also means that the intrinsic impedance Zc of line 1 is a given (non modifiable) parameter. After line 1, there is a piece of a different line, labeled 2, that has a fixed length L and is knocked in the soil. This second line is open at the end, which is schematized by means of a lumped load Zload with infinite impedance (this amounts to neglect the energy radiated in the soil by the TDR probe). The intrinsic impedance of line 2 depends also on the soil where it is knocked in. In particular, if we label Zl0 the intrinsic impedance of line 2 in free space, then the intrinsic impedance of the same transmission line embedded in the soil  LOSSY, MAGNETIC, AND DISPERSIVE MEDIA  29  Soil  Air Zc  Zl0  1  2  Zload = inf.  L  Figure 2.10. Circuital scheme for a TDR probe.  is given by Zl = ςZl0, where ς is the relative (dimensionless) impedance of the soil, given by rﬃﬃﬃﬃﬃﬃ μsr ς= ð2:27Þ εsr By means of the TDR probe, one can gather the reflection coefficient versus the frequency at the air–soil interface. To relate this quantity to the characteristics of the soil, we can first make use of the classical formula for the impedance transportation along the line (Franceschetti, 1997). Thus, the impedance seen at that air–soil interface, looking toward the soil, is given by Z = Zl  Zload + jZl tgðks LÞ Zl + jZload tgðks LÞ  ð2:28Þ  where ks is the wavenumber of the propagation medium that embeds line 2. The wavenumber is linked to the properties of the medium by means of the relationships ks =  pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2πf εsr μsr c0  ð2:29Þ  where f is the frequency and c0 is, as usual, the propagation velocity of the electromagnetic waves in free space. In Eq. (2.29), εsr and μsr are meant as complex quantities, to account for losses. At this point, the reflection coefficient at the air–soil interface, looking underground, is given by (Franceschetti, 1997) Γ= where Z is given by Eq. (2.28).  Z − Zc Z + Zc  ð2:30Þ  CHARACTERIZATION OF THE HOST MEDIUM  30  After substituting Eq. (2.28) in Eq. (2.30) and after some algebraic manipulations, the following alternative expression for the reflection coefficient at the air–soil interface is achieved: Γ=  Γ12 + Γload expð − j2ks LÞ 1 + Γ12 Γload expð − j2ks LÞ  ð2:31Þ  where Γload is the reflection coefficient at the load and Γ12 is given by Γ12 =  Zl − Zc ςZl0 − Zc = Zl + Zc ςZl0 + Zc  ð2:32Þ  Γ12 represents the reflection coefficient between lines 1 and line 2—that is, the reflection coefficient that we would record at the air–soil interface if line 2 were infinite. As said, the load is an open circuit, and therefore we have Γload = 1  ð2:33Þ  Substituting Eqs. (2.29), (2.32), and (2.33) in Eq. (2.31), eventually we retrieve the expression of the TDR datum versus the characteristics of the probed soil at fixed frequency, which is rﬃﬃﬃﬃﬃﬃ  rﬃﬃﬃﬃﬃﬃ    μsr μsr 4πf pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ Zl0 − Zc + Zl0 + Zc exp − j εsr μsr L εsr εsr c0    rﬃﬃﬃﬃﬃ  ﬃ Γ = rﬃﬃﬃﬃﬃﬃ μsr μsr 4πf pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ Zl0 + Zc + Zl0 − Zc exp − j εsr μsr L εsr εsr c0  ð2:34Þ  Equation (2.34) can provide more information than that retrievable from the diffraction curves provided by GPR data. In particular, all the presented diffraction curves, either in common offset or in CMP mode, are based on the propagation velocity of the waves. The propagation velocity, in low lossy soils (Jol, 2009), is related to the real part of the product μsrεsr, and consequently the diffraction curves do not allow us to identify a contribution of the imaginary parts of the dielectric permittivity and/or of the magnetic permeability to the signal, and of course they do not allow us to distinguish the contribution of the dielectric permittivity from that of the magnetic permeability to the propagation velocity. In Eq. (2.34), instead, the datum depends on both the impedance and the propagation velocity along the transmission line, which means that we have a decoupled dependence on the possibly complex dielectric permittivity and magnetic permeability. Consequently, a TDR probe can help in measuring both the dielectric permittivity and the magnetic permeability. In particular, for a magnetic nondispersive soil, the measure can be performed by matching Eq. (2.34) at several frequencies with the experimentally retrieved reflection coefficients.  LOSSY, MAGNETIC, AND DISPERSIVE MEDIA  31  If we can neglect the magnetic properties, Eq. (2.34) provides instead a relationship where the unknown is the complex equivalent dielectric permittivity, from which both the real dielectric permittivity and the equivalent conductivity can be retrieved (Daniels, 2004; Jol, 2009). Often, in these case, one matches a known dispersion law to the data at more frequencies, looking for some specific parameters involved in the predetermined dispersion law, such as the relaxation time (Cataldo et al., 2011). In any lossy case, some attention has to be devoted to the determination of the square roots to be retained, and this depends on the convention adopted for expressing the waves propagating in the positive version of the chosen abscissas. In particular, in this section we have implicitly adopted the convention exp( j2πft) to express temporal dependence. Consequently, since the signal has to attenuate far from the sources, we have that the imaginary part of ks is nonpositive and the real part of the intrinsic impedance of the line is nonnegative. In the more general case of a soil dispersive (with a meaningful but unknown dispersion law) and magnetic, even a TDR probe is theoretically insufficient, because Eq. (2.34) provides, at each frequency, one complex datum and two complex unknowns. In this “extreme” case, two or more TDR probes of different length and/or intrinsic free-space impedance can provide, in principle, the needed diversities in order to provide at least as many equations as unknowns or more equations than unknowns (but the reliability of the achievable results is another issue).  QUESTIONS 1. Can the electromagnetic characteristics of the soil be completely retrieved from GPR data? 2. Do conductivity losses influence the propagation velocity of the waves in the soil? 3. Can we retrieve the propagation velocity of the waves in the soil from two points of a diffraction curve from interfacial data? 4. Why can the evaluation of the propagation velocity in the soil from CMP data be superior to that achieved from common offset data? 5. In what aspect can the measure of the characteristics of the soil by means of a TDR probe be superior to that achieved from GPR data? 6. In what aspect can the measure of the characteristics of the soil by means of GPR data be superior to that achieved from a TDR probe?  3 GPR DATA SAMPLING: FREQUENCY AND TIME STEPS  3.1 STEPPED FREQUENCY GPR SYSTEMS: THE PROBLEM OF THE ALIASING AND THE FREQUENCY STEP The working principle of a GPR system described in the previous chapter essentially refers to the “pulsed” GPR. Alternatively, it is possible to transmit a train of harmonic signals instead of a pulse. This procedure essentially involves transmitting the harmonic components of the pulse sequentially rather than at the same time. The systems that do that are, as well known, the stepped frequency GPRs (Robinson et al., 1974; Iizuka et al., 1984; Stickley et al., 1999; Alberti et al., 2002). The theoretical advantages of a stepped frequency system with respect to a pulsed one are essentially based on the possibility to have a trade-off between the duration of the harmonic signals (the so-called integration time) and the noise on the data. This allows us to improve the signal-to-noise ratio without being compelled to radiate a stronger signal (which might saturate the receiver). Of course, this is impossible for a pulsed system. Essentially, the “trick” of a stepped frequency GPR is that one can transmit more energy rather than more power. For a deeper discussion of these aspects, the interested reader is referred to Noon (1996). Furthermore, in Persico and Prisco (2008) and Persico et al. (2011), it is possible to find some recent  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  32  THE PROBLEM OF THE ALIASING AND THE FREQUENCY STEP  33  studies about further possibilities related to the flexibility of a stepped frequency system, and in particular to the possibility to reconfigure the system versus the frequency. Here, with regard to data processing aspects, it is of interest to deal with the effects of the frequency sampling, in order to provide the calculation of the needed frequency step. To introduce this subject, let us consider the Fourier transform, or spectrum, of a finite energy real signal g(t), given by +∞ ð  g^ð f Þ =  gðt Þ expð − j2πft Þ dt  ð3:1Þ  −∞  where g(t) a real function and g^ð f Þ is a Hermitian function, that is, it has the property that g^ð− f Þ = g^∗ ð f Þ, where the asterisk stands for the conjugate value. Equation (3.1) is inverted as +∞ ð  g^ð f Þ expð j2πft Þ df  gðt Þ =  ð3:2Þ  −∞  Due to the Hermitianity of g^ð f Þ, Eq. (3.2) can be also written as 8 +∞ 9 <ð = gðt Þ = 2Re g^ð f Þ expð j2πft Þ df : ;  ð3:3Þ  0  where Re indicates the real part of the quantity within accolades. Equation (3.3) expresses the signal as a sum of elementary harmonic functions. At this point, let us suppose to have at our disposal a sampled version of the spectrum of the signal g^ð f Þ—that is, a sequence of samples g^ðfn Þ spaced from each other by a fixed frequency step Δf—and let us try to calculate the signal in time domain from these samples. In a first moment, let us suppose that we have at our disposal an odd number of samples 2 N + 1, starting from the initial frequency f0. Thus, the considered frequency band ranges from f0 up to f0 + 2NΔ, and the extension of this band is B = 2NΔf. The central frequency is given by fc = f0 + NΔf. The nth frequency sample is equal to fn = f0 + (n − 1)Δf, with n ranging from 1 to 2N + 1, which is the same as fn = fc + nΔf with n ranging from − N to N. From the discretization of Eq. (3.3), we have that the corresponding signal in time domain (customarily labeled as the synthetic time) is given by1  1  It is well known that the Fourier direct and inverse transforms can be performed by means of fast numerical FFT and IFFT algorithms. However, for simplicity of exposition, we follow the method of a formal discretization of the Fourier integral.  GPR DATA SAMPLING: FREQUENCY AND TIME STEPS  34  ( gðt Þ ≈ 2Re  2N +1 X  ) g^ð fn Þexpðj2πfn t ÞΔf  (  N X  = 2Δf Re  ) g^n expðj2π ½ fc + nΔf t Þ  n = −N  n=1  (  = 2Δf Re expð j2πfc t Þ  N X  ) g^n expð j2πnΔft Þ  ð3:4Þ  n = −N  where g^n = g^ðfn + N + 1 Þ. Let us now write g1 ðt Þ =  N X  g^n expð j2πnΔft Þ = g1r ðt Þ + jg1i ðt Þ  ð3:5Þ  n = −N  where g1 is a complex quantity, and thus in Eq. (3.5) the real and imaginary parts have been put into evidence. At this point, we can express our signal in synthetic time as follows: gðt Þ ≈2Δf cos ð2πfc t Þg1r ðt Þ− 2Δf sin ð2πfc t Þg1i ðt Þ  ð3:6Þ  Let us now put (  g1r ðt Þ = ρðt Þ cos ðθðt ÞÞ, g1i ðt Þ = ρðt Þsin ðθðt ÞÞ  ð3:7Þ  After some straightforward calculations, we obtain gðt Þ ≈2Δf     qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ g1i ðt Þ g21r ðt Þ + g21i ðt Þ cos 2πfc t + tg− 1 g1r ðt Þ  ð3:8Þ  Let us now consider the behavior of g(t) at the time t + 1=Δf . Furthermore, let us preliminarily note that the function g1(t) is periodical with period 1=Δf , as can be easily checked directly from Eq. (3.5). Consequently, we have       qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 1 − 1 g1i ðt Þ 2 2 = 2Δf g1r ðt Þ + g1i ðt Þ cos 2πfc t + tg g t+ + Δϕ Δf g1r ðt Þ  ð3:9Þ  where Δϕ = 2π  fc Δf  ð3:10Þ  Equations (3.9) and (3.10) show that when transforming in time domain a stepped frequency signal, ideally “conceived” as the spectrum of a synthetic pulsed signal, we don’t obtain a single pulse but rather a train of pulses spaced 1=Δf from each other. It is sometimes loosely said that the signal in time domain is a periodic train of pulses. Actually, from Eqs. (3.9)–(3.10), we see that actually the pulses of the train don’t have the same shape,  THE PROBLEM OF THE ALIASING AND THE FREQUENCY STEP  35  unless the central frequency fc is an integer multiple of the frequency step Δf. At any rate, the physically relevant phenomenon is the repetition of the pulses, called as well-known aliasing. Due to the aliasing, the maximum synthetic time at which we can retrieve the signal reliably is 1=Δf , and consequently the maximum reliably investigable depth [the so-called nonambiguous depth (Noon, 1996)] is given by the maximum depth from which we can receive a signal within the time interval 1=Δf starting from the beginning of the radiation of the synthetic time pulse. Beyond this time interval, the radar answer in synthetic time is ambiguous because any received echo might be due both to a deeper target that reflects a previously transmitted pulse or a shallower target that reflects a subsequently transmitted pulse. The nonambiguous depth D is therefore given by D=  c 2Δf  ð3:11Þ  The factor 2 is due to the round-trip of the GPR signal (the offset between the antennas has been neglected). Actually, one establishes a priori the depth up to which he/she thinks there are perceivable targets. So, Eq. (3.11) provides the needed frequency step (i.e., the maximum allowed value of the frequency step) that allows us to reach nonambiguously the chosen maximum depth. This frequency step is achieved simply inverting Eq. (3.11): Δf =  c 2D  ð3:12Þ  If the propagation medium is lossless or low lossy and does not show magnetic properties, Eq. (3.12) can still be rewritten as c0 Δf = pﬃﬃﬃﬃﬃﬃ 2 εsr D  ð3:13Þ  where c0 is the propagation velocity of the electromagnetic waves in free space and εsr is the relative dielectric permittivity of the host medium. It might be thought that the maximum reachable depth can be chosen arbitrarily within the maximum depth “visible” by the system [which depends on the noise level and on the dynamic of the system (Noon, 1996)], and then the frequency step given by Eqs. (3.12) or (3.13) guarantees a nonambiguous result, but there is a subtlety to be considered: In particular, for a given chosen maximum depth D, the frequency step given in Eqs. (3.12) or (3.13) guarantees that any object enclosed within the depth range up to D will not provide spurious replicas of its real echo within the probed depth. However, any actual target deeper than D is a potential source of aliasing, because its echo is in any case replicated with time periodicity 1=Δf . The only way to mitigate this phenomenon is to choose D large enough so that the signal scattered by a target deeper than D reaches the surface very attenuated and is not perceived by the receiving antenna. This means to guarantee that the entire duration in the time domain of the perceivable signal is accounted for. In particular, it is an error to choose D on the mere basis of the expected depth range of the targets of interest; insteads, the choice should be based on the expected perceivable maximum depth.  GPR DATA SAMPLING: FREQUENCY AND TIME STEPS  36  Up to now, we have considered an odd number of frequency samples. Let us now consider the case with an even number of frequency samples 2 N. This time, the considered frequency band ranges from some f0 up to f0 + (2N − 1)Δf and the extension of this band is B = (2N − 1)Δf. The central frequency is fc = f0 + NΔf − Δf =2. Consequently, Eq. (3.4) can be rewritten as gðt Þ ≈ 2Re  ( 2N X  ) g^ðfn Þexpðj2πfn t ÞΔf  n=1  1 3 19 = 1 = 2Δf Re g^n exp@j2π 4fc + @n − AΔf 5t A ; :n = −N + 1 2 8 < X N  8 <  0  2  0  ð3:14Þ  1 19 = 1 = 2Δf Re expðj2πfc t Þ g^n exp@j2π @n − AΔft A : ; 2 n = −N + 1 N X  0  0  where g^n = g^ðfn + N Þ. Let us now write g 1 ðt Þ =      1 g^n exp j2π n − Δft = g1r ðt Þ + jg1i ðt Þ 2 n = −N + 1 N X  ð3:15Þ  At this point, the calculations steps are the same as those exposed in the case of an odd number of samples. Actually, this time the period of g1(t) is not 1=Δf but 2=Δf . However, it is easily recognized from Eq. (3.15) that g1 ðt + k=Δf Þ = ð − 1Þk g1 ðt Þ, and thus expression (3.9) keeps unchanged with respect with the previous case. This shows that the considerations exposed or for an odd number of frequency samples hold also for an even number of frequency samples.  3.2  SHAPE AND THICKNESS OF THE GPR PULSES  The previous section suggests to insert a brief description of what kind of shape and above all what order of thickness the GPR pulses are expected to show. From Eq. (3.8), we see that the received pulse can be formally described as a sinusoidal quantity with amplitude and phase changing versus the time. In the case of GPR pulses, the central frequency fc and the band are roughly of the same order (Jol, 2009). Starting from this basic consideration, let us provide an example considering a case where the   1 3 frequency band of the pulse is found in the interval fc , fc ; in this way, fc represents 2 2 both the central frequency and the extension of the band. In a first moment, let us suppose to deal with a pulsed GPR. The shape of the pulse depends of course on the function g^ð f Þ. Let us investigate the case where g^ð f Þ is a constant function. This constant is generally  SHAPE AND THICKNESS OF THE GPR PULSES  37  complex, and thus we will indicate it as g^ð f Þ = K expð jθÞ. Therefore, the pulse in the time domain is given by 8 > <  1:5f ðc  gðt Þ = 2K Re expð jθÞ > :  expðj2πft Þdf 0:5fc  9 > = > ;  = 2Kfc sincðπfc t Þ cos ð2πfc t + θÞ  ð3:16Þ  where the sinc function is defined as sincðxÞ = sin ðxÞ=x. In Figure 3.1 the graphs of the pulses relative to four different values of θ are provided. The graphs are expressed versus the dimensionless variable tfc: As can be seen, the duration in this normalized time is about unitary; that is, the actual duration of the pulse is inversely proportional to its central frequency (and thus to its band). Moreover, the pulses have an oscillatory time behavior, due to the fact that their spectrum does not extend up to the zero frequency and thus their average value is substantially equal to zero. This is experimentally well known too.  (a)  (b) 1  1  0.5  0.5  0  0  –0.5  –0.5  –1 –10  –5  0  5  10  –1 –10  –5  tfc  0  5  10  5  10  tfc  (c)  (d) 1  1  0.5  0.5  0  0  –0.5  –0.5  –1 –10  –5  0 tfc  5  10  –1 –10  –5  0 tfc  Figure 3.1. Graphs of expression (3.16), normalized to 2Kfc and represented versus the dimensionless variable tfc. Panel a: θ = 0. Panel b: θ = π=4. Panel c: θ = π=2. Panel d: θ = 3π=4.  GPR DATA SAMPLING: FREQUENCY AND TIME STEPS  38  Let us now discuss the case of a stepped frequency system. In this case, we are interested in achieving the shape of the synthetic pulse starting from a sampled version of its spectrum. We will limit ourselves to the case of an odd number of samples for sake of brevity, but the case with an even number of samples is analogous. Thus, we particularize Eq. (3.4) to the case g^n =K expð jθÞ. The lower  and  upper frequencies of the band are equal to fc − NΔf =  1 2  fc and fc + NΔf =  3 2  fc , which is to say  that Δf = fc =2N. After this premix, the synthetic pulse in time domain is given by ( ) N X expðj2πnΔft Þ gðt Þ≈ 2ΔfK Re expðj2πfc t + jθÞ  ð3:17Þ  n = −N  and we have N X  expðj2πnΔft Þ = expð − j2πNΔft Þ  n = −N  2N X  expðj2πnΔft Þ  n=0  = expð − j2πNΔft Þ =  expð − j2πNΔft Þ expðjð2N + 1ÞπΔft Þ expðjπΔft Þ ×  =  1 − expðjð2N + 1Þ2πΔft Þ 1 − expðj2πΔft Þ  expð −jð2N + 1ÞπΔft Þ − expðjð2N + 1ÞπΔft Þ expð − jπΔft Þ − expðjπΔft Þ  sin ðð2N + 1ÞπΔft Þ sin ðπΔft Þ  ð3:18Þ  Equation (3.18) shows that the result of the summation is a real function given by the ratio of two sines. This ratio is known as the sine of Dirichlet (Collin, 1985). The sine of the Dirichlet in Eq. (3.18) is a periodic function with period 1=Δf and with main lobes large 2=ð2N + 1ÞΔf = 4N=ð2N + 1Þfc . Substituting Eq. (3.18) in Eq. (3.17), we obtain   2N + 1 sin πfc t 2N   gðt Þ ≈2KΔf cos ð2πfc t + θÞ πfc t sin 2N   2N + 1 sin πfc t 2N   cos ð2πfc t + θÞ = 2Kfc πfc t 2N sin 2N  ð3:19Þ  SHAPE AND THICKNESS OF THE GPR PULSES  39  A graph of this function is provided in Figure 3.2, for several values of N, fc, and θ. The result can be compared with the result in the “continuous case” only within the nonambiguous interval      1 1 N N , = − , I= − 2Δf 2Δf fc fc  (a) 2 0 –2  –5  –4  –3  –2  –1  0  1  2  3  4  5  –5  –4  –3  –2  –1  0  1  2  3  4  5  –5  –4  –3  –2  –1  0  1  2  3  4  5  ×10–8  (b) 2 0 –2  ×10–8  (c) 2 0 –2  ×10–8  (d) 2 0 –2  –5  –4  –3  –2  –1  0 t [sec.]  1  2  3  4  5 ×10–8  Figure 3.2. Graphs of the synthetic pulses of Eq. (3.19), normalized to 2Kfc , represented versus the synthetic time in seconds. Panel a: fc = 500 MHz, N = 13, θ = π=4. Panel b: fc = 250 MHz, N = 13, θ = π=4 (the replicas are 200% farther and the pulses are 200% larger with respect to panel a). Panel c: fc = 500 MHz, N = 7, θ = π=4 (the replicas are closer with respect to panel a, because of the larger frequency step). Panel d: fc = 500 MHz, N = 13, θ = − π=4 (the pulses have equal thickness but different shape with respect to panel a, because of the different constant phase term).  40  GPR DATA SAMPLING: FREQUENCY AND TIME STEPS  Even within the nonambiguous time interval, the two functions (3.16) and (3.19) are not equal to each other.2 However, in the limit for high values of N (i.e., for Δf ! 0) the expression (3.19) tends uniformly3 to the expression (3.16) within the nonambiguous interval, which in turn enlarges progressively toward the entire real axis. In fact, if t < < N=fc and N > > 1, we can approximate   πfc t πfc t 2N + 1 ≈ ; ≈1 sin ð3:20Þ 2N 2N 2N which, when substituted in Eq. (3.19), provides Eq. (3.16). Of course, the first approximation in Eq. (3.20) is not licit any longer when t becomes comparable with N=fc , but in this case both expressions (3.16) and (3.19) vanish and so the convergence of (3.19) to (3.16) is guaranteed all over the nonambiguous interval. The nonambiguous interval, in turn, enlarges progressively versus N. Thus, in the end there is a punctual convergence4 of the expression (3.19) to the expression (3.16) for any time instant.  3.3 STEPPED FREQUENCY GPR SYSTEMS: THE PROBLEM OF THE DEMODULATION AND THE FREQUENCY STEP The digression on shape and thickness of the pulses facilitates the introduction of the problem of the Hermitian images, which arises from the possibility of an imprecise demodulation of the received signal. This is a technical problem regarding the hardware of a stepped frequency system. However, it can influence the choice of a suitable frequency step, and therefore it is relevant to our discussion. That said let us consider a case when the harmonic component of the synthetic pulse of Eq. (3.17) are sequentially transmitted. Thus, the transmitted signal is a train of harmonics, whose time behavior (apart the temporal truncation) is given by stx ðtÞ = K cos ð2πfN + n + 1 t + θÞ = K cos ð2π ðfc + nΔf Þt + θÞ, n = − N,…, N  ð3:21Þ  Let us now consider a target that produces an echo after a time t (smaller than the nonambiguous time interval 1=Δf ). Let us neglect the variation versus the frequency of the reflection behavior of this target. Thus, the received signal is a train of harmonic 2  Actually, due to the hypothesis of a rigorously limited band, the theoretical support of the signal in time domain is infinite, and this makes it impossible to retrieve perfectly the function from its spectral samples in frequency domain. 3 Which means that the maximum modulus of the difference between the two expressions vanishes for a large N. 4  However, neither uniform convergence nor a convergence in the least square sense.  THE PROBLEM OF THE DEMODULATION AND THE FREQUENCY STEP  41  functions equally attenuated and shifted in time, with respect to the transmitted harmonics. The harmonics sequentially received are given by srx ðtÞ = K1 cos ð2πfN + n + 1 ðt −t Þ + θ1 Þ = K1 cos ð2π ðfc + nΔf Þðt −t Þ + θ1 Þ, n = − N, …,N ð3:22Þ where K1 is the level of the received harmonic (smaller than the level K of the transmitted one) and a generic θ1 6¼ θ accounts for a possible difference of phase between the incident and the reflected harmonics. In order to work out the received synthetic pulse, we have to extract the amplitude and the phase of each received harmonic function. This is accomplished by means of a demodulation. Here, for simplicity we will refer to a homodyne demodulation scheme even if an heterodyne scheme, making use of an intermediate frequency, is more common [the interested reader is referred to Noon (1996) for deeper technological details]. The block diagram of a homodyne system is provided in Figure 3.3. With reference to Figure 3.3, the received harmonic is multiplied times the carrier (i.e., a reference signal at the same frequency of the transmitted harmonic function) on one branch and multiplied times the carrier delayed by π=2 on the other branch of the flux diagram. Consequently, at point A the signal will be equal to spn ðt Þ = 2K1 cos ð2πfN + n + 1 ðt −t Þ + θ1 Þ cos ð2πfN + n + 1 t Þ = K1 cos ½2π ð2fn + N + 1 Þt − 2πfn + N + 1t + θ1  + K1 cos ½2πfn + N + 1t − θ1   ð3:23Þ  where the subscript p stands for “in phase” and the subscript n refers to the current nth harmonic. Thus, the signal is the sum of a constant quantity plus a signal oscillating at frequency 2fn + N + 1. The filter in cascade erases the oscillating term, and at point B the signal is equal to pn = K1 cos ð2πfn + N + 1t − θ1 Þ A  ð3:24Þ B  2 cos(2πfN+n+1t) K1 cos(2πfN+n+1(t – t)+θ1)  π/2  C  Figure 3.3. Homodyne demodulation scheme.  D  GPR DATA SAMPLING: FREQUENCY AND TIME STEPS  42  Similarly, at point C the signal is given by sqn ðtÞ = − 2K1 cos ð2πfN + n + 1 ðt −t Þ + θ1 Þ sin ð2πfN + n + 1 t Þ = − K1 sin ½2π ð2fn + N + 1 Þt − 2πfn + N + 1t + θ1 − K1 sin ½2πfn + N + 1t − θ1   ð3:25Þ  where the subscript q stands for “in quadrature.” Again, the filter in cascade erases the oscillating term, and at point D the signal is equal to qn = − K1 sin ð2πfn + N + 1t − θ1 Þ  ð3:26Þ  After storing the components in phase and in quadrature for all the received harmonics, the synthetic received signal is constructed making use of the complex quantities pn + jqn = K1 cos ð2πfn + N + 1t − θ1 Þ − jK1 sin ð2πfn + N + 1t − θ1 Þ = K1 expð −jð2πfn + N + 1t − θ1 ÞÞ = K1 expð −jð2π ðfc + nΔf Þt − θ1 ÞÞ, n = − N,…, N ð3:27Þ The quantities (3.27) constitute the values of g^n to be substituted in Eq. (3.4). This substitution provides in fact ( grec ðt Þ = 2Δf Re expðj2πfc t Þ (  N X  ) g^n expðj2πnΔft Þ  n = −N  = 2Δf K1 Re expðj2πfc ðt −t Þ + θ1 Þ  N X  ) expðj2πnΔðt −t ÞÞ  ð3:28Þ  n = −N  = 2Δf K1 cos ð2πfc ðt −t Þ + θ1 Þ  sin ðð2N + 1ÞπΔf ðt −t ÞÞ sin ðπΔf ðt −t ÞÞ  where the subscript rec stands for received. Now, the transmitted equivalent train of pulses is given by Eq. (3.17). Therefore, accounting also for Eq. (3.18), the transmitted synthetic train of pulses is expressed as gtr ðt Þ = 2ΔfK cos ð2πfc t + θÞ  sin ðð2N + 1ÞπΔft Þ sin ðπΔft Þ  ð3:29Þ  where the subscript tr stands for transmitted. Apart from an unimportant phase difference between θ and θ1 (which means that in general the received pulses don’t have the same shape as the transmitted ones), and apart from the obvious attenuation, the comparison between Eq. (3.28) and Eq. (3.29) shows that, within the nonambiguous interval, the GPR receives a synthetic pulse about as large as the transmitted one and centered at the time t, as expected in a nondispersive medium.  THE PROBLEM OF THE DEMODULATION AND THE FREQUENCY STEP  A  43  B  2 cos(2πfN+n+1t) K1 cos(2πfN+n+1(t – t)+θ1) π/2+α  1+ε  C  D  Figure 3.4. Homodyne demodulation scheme with a small phase and amplitude error.  At this point, let us introduce a demodulation error as shown in Figure 3.4. In particular, Figure 3.4 schematizes the fact that, for some technological imprecision, in general the phase shift between the two carriers sent to the p and q channels might be not exactly equal to π=2, and also some difference in the two amplitudes can occur. These phenomena are accounted for by means of an extra phase shifting and an “undesired” amplifier-attenuator on the q channel. Both the spurious phase factor α and the spurious amplitude factor ε are dimensionless quantities. Their modulus is in general much smaller than 1, and both can be either positive or negative. In the same way exposed before, it can be worked out that in this case we have at point B pn = K1 cos ð2πfn + N + 1t − θ1 Þ  ð3:30Þ  whereas at point D we have qn = − K1 ð1 + εÞsin ð2πfn + N + 1t − θ1 + αÞ = − K1 ð1 + εÞ½ sin ð2πfn + N + 1t − θ1 Þ cos ðαÞ + cos ð2πfn + N + 1t − θ1 Þ sin ðαÞ  ð3:31Þ  At this point, we can substitute in Eq. (3.31) the first-order approximations sin ðαÞ ≈α and cos ðαÞ ≈ 1  ð3:32Þ  thereby obtaining qn ≈ − K1 sin ð2πfn + N + 1t − θ1 Þ −αK1 cos ð2πfn + N + 1t − θ1 Þ − εK1 sin ð2πfn + N + 1t − θ1 Þ ð3:33Þ where we have also neglected the higher-order term proportional to the product αε.  GPR DATA SAMPLING: FREQUENCY AND TIME STEPS  44  Consequently, the complex quantities retrieved from the demodulation become g^n = pn + jqn ≈ − K1 cos ð2πfn + N + 1t − θ1 Þ− jK1 sin ð2πfn + N + 1t − θ1 Þ − jαK1 cos ð2πfn + N + 1t − θ1 Þ − jεK1 sin ð2πfn + N + 1t − θ1 Þ = K1 expð − jð2πfn + N + 1t − θ1 ÞÞ − −  jαK1 expðjð2πfn + N + 1t − θ1 ÞÞ 2  jαK1 εK1 expð − jð2πfn + N + 1t − θ1 ÞÞ − expðjð2πfn + N + 1t − θ1 ÞÞ 2 2  εK1 expð − jð2πfn + N + 1t − θ1 ÞÞ 2     jα ε jα ε expð − jð2πfn + N + 1t − θ1 ÞÞ − K1 + expðjð2πfn + N + 1t − θ1 ÞÞ = K1 1 − + 2 2 2 2   jα ε = K1 1 − + expð − jð2π ðfc + nΔf Þt −θ1 ÞÞ 2 2   jα ε − K1 + expðjð2π ðfc + nΔf Þt − θ1 ÞÞ ð3:34Þ 2 2 +  Substituting Eq. (3.34) into Eq. (3.4), we have grec ðtÞ  (  )   N jα ε X ≈ 2Δf K1 Re expðjð2πfc ðt −t Þ + θ1 ÞÞ 1 − + expðj2πnΔf ðt −t ÞÞ 2 2 n = −N ( )   N jα ε X − 2Δf K1 Re expðjð2πfc ðt + t Þ − θ1 ÞÞ expðj2πnΔf ðt + t ÞÞ + 2 2 n = −N 8 9 < ε  = sin ðð2N + 1ÞπΔf ðt −t ÞÞ α = 2Δf K1 1 + cos ½2πfc ðt −t Þ + θ1  + sin ½2πfc ðt −t Þ + θ1  : ; 2 2 sin ðπΔf ðt −tÞÞ 8 <ε  9 = sin ðð2N + 1ÞπΔf ðt + t ÞÞ α − 2Δf K1 cos ½2πfc ðt + t Þ − θ1  + sin ½2πfc ðt + t Þ − θ1  :2 ; 2 sin ðπΔf ðt + t ÞÞ s ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ    ε 2 α2 α sin ðð2N + 1ÞπΔf ðt −t ÞÞ = 2Δf K1 1+ + cos 2πfc ðt −t Þ + θ1 − tg − 1 4 2 2+ε sin ðπΔf ðt −t ÞÞ sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ   ε2 α 2 α sin ðð2N + 1ÞπΔf ðt + t ÞÞ + cos 2πfc ðt + t Þ −θ 1 − tg − 1 − 2Δf K1 4 4 ε sin ðπΔf ðt + tÞÞ  ð3:35Þ  ALIASING AND TIME STEP FOR PULSED GPR SYSTEMS  45  Equation (3.35) shows that the demodulation error essentially provides two Dirichlet sines, that is, two trains of pulses. Apart from some unimportant amplitude and phase change in the carrier, the first train of pulses is the same achieved without any demodulation error; and, in particular, within the nonambiguous time interval I = ½0, 1=Δf , it provides the due echo at t = t. Instead, the second term provides a train of pulses shifted in the opposite verse. Consequently, within the nonambiguous interval, it provides a spurious echo at the time instant t = 1=Δf −t . This echo provides a false target called Hermitian image (Noon, 1996). The amplitude of the Hermitian image depends on the amounts of the amplitude and phase errors of the demodulation system. Neglecting the effect of the relative shifts between the two carriers and the relative Dirichlet sines (that incidentally depend also on t, i.e., depend on the position of the target), the average ratio between the level of the “true” pulse and that of its Hermitian image is given by rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ  ε 2 α2 1+ + 2 2 4 ≈ pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2 2 ε + α2 ε2 α + 4 4  ð3:36Þ  The inverse of Eq. (3.36) provides the average weight of the Hermitian image of a target with respect to the authentic image of the same target. Whether the Hermitian image is tolerable or not depends on the application and on the dynamic range of the system. In particular, if the Hermitian image is below the minimum signal perceivable by the system it does not cause any problem. In the case where we need to avoid the possibility of any Hermitian image, instead, we have to halve the frequency step at a parity of nonambiguous depth. In this way, all the Hermitian images relative to the investigated depth range will occur beyond it. Consequently, in order to account for demodulation errors, Eq. (3.12) evolves into Δf =  c 4D  ð3:37Þ  Under the further hypothesis that the propagation medium does not show magnetic properties, Eq. (3.37) can be still rewritten as c0 Δf = pﬃﬃﬃﬃﬃﬃ 4 εsr D  3.4  ð3:38Þ  ALIASING AND TIME STEP FOR PULSED GPR SYSTEMS  The aliasing is a problem to be accounted also for pulsed GPR systems. In particular, in this case the received signal is sampled in time domain; thus, because the direct and the inverse Fourier integrals are formally similar, we will have replicas of the spectrum of the  46  GPR DATA SAMPLING: FREQUENCY AND TIME STEPS  signal in the frequency domain. The replicas in frequency domains occurs with frequency step 1=Δt and therefore we have to guarantee that Δt =  1 1 ≈ B fc  ð3:39Þ  where B is the total band of the signal, roughly equal to its central frequency fc.5 This time step is called the Nyquist rate, as is well known. Actually, both the needed frequency step for a stepped frequency system and the time step for a pulsed system are driven by the Nyquist rate, of course with respect to the duration in time domain in the first case and to the band (i.e., the duration in frequency domain) in the second case. An important difference consists in the fact that the band of the antennas is in general apriori known (actually, the behavior of the antennas depends on the background scenario, but the band variation versus the background are in general quite marginal), whereas the maximum depth really reached by the signal is much more case-dependent. This makes the aliasing more difficult to be controlled apriori for a stepped frequency GPR system. On the other hand, the effects of the aliasing for a stepped frequency system are more easily recognizable from the achieved data because, after transformation in time domain and processing, aliased data would provide duplications of the actual targets along the depth and at a fixed distance from the real objects. Usually, in pulsed systems we have the possibility to set the time bottom scale and the number of time samples, which implicitly defines the time step. Generally, several hundred time samples can be chosen without any computational problems, and this prevents us from aliasing in most situation if one chooses a reasonable time bottom scale with respect to the expected penetration of the signal. Thus, for pulsed systems, the traces are likely to be oversampled (an exercise that shows this is proposed in question 2). However, even if the case is rare from a practical point of view, it is well advised to have some awareness about the problem of the aliasing for a pulsed GPR system. In stepped frequency systems, usually one can set directly the frequency step, and customarily the maximum option is of the order of 5 MHz (in most cases the available choices are very few, two, or even only one). In this way, the nonambiguous depth is kept very deep (depending on the soil at hand, it often goes beyond 10 m), and the targets deeper than this range should provide echoes too weak to be perceived. Thus, in both cases, the parameter setting options are usually conceived to provide some oversampling with respect to the Nyquist rate. This is also useful in order to amortize possible uncertainties that we can have about the band of the antennas, the depth of the targets of interest, the characteristics of the soil, and so on. However, it is also useful for practitioners to be aware of the fact that it is useless to exaggerate the oversampling, maybe thinking that more data provide an indefinitely better resolution. Actually, any band-limited function can be perfectly reconstructed from its samples in the time domain, and dually any time-limited function can be perfectly It is often reported that Δt = 1=2B, but the question is conventional depending on what we mean by B. Here we mean the range of positive frequencies of a modulated signal, which, after demodulation, extends from − B=2 to B=2.  5  ALIASING AND TIME STEP FOR PULSED GPR SYSTEMS  47  reconstructed by its samples in the frequency domain if the samples are gathered at the Nyquist rate (Higgins, 1996). Therefore, it is substantially useless (further than time-consuming and computationally burdening) to oversample the GPR traces with a time (or a frequency) step an order of magnitude smaller than that prescribed by the Nyquist rate.  QUESTIONS 1. Let us suppose we have to perform a measurement campaign where the targets of interest are embedded in the first 50 cm. Let us also suppose that the soil is dry and sandy, with no magnetic properties and with relative permittivity equal to 4. Finally, let us suppose we have a stepped-frequency system. Is a frequency step of 75 MHz presumably adequate? 2. Suppose we handle the same scenario of question 1 and also suppose we have at our disposal a pulsed GPR system, equipped with antennas at 2 GHz. Which is the required time step? How many time samples are needed? 3. What is the effect of the aliasing for a stepped-frequency GPR system? 4. What is the effect of the aliasing for a pulsed GPR system? 5. Given a stepped-frequency GPR system, can we mitigate the effects of an undersampling in the frequency domain by means of a truncation of the data in the time domain? 6. Given a pulsed GPR system, can we mitigate the effects of an undersampling in the time domain by means of a truncation of the data in the frequency domain?  4 THE 2D SCATTERING EQUATIONS FOR DIELECTRIC TARGETS  4.1  PRELIMINARY REMARKS  The behavior of the electromagnetic signal radiated by a GPR and scattered by buried targets is governed by Maxwell’s equations. So, in order to provide a hopefully deep enough and self-consistent discussion of GPR data processing, we start here from the beginning and derive the whole formulation up to the migration and the linear inversion; this necessarily implies some nontrivial mathematics. In this chapter we introduce the subject within a two-dimensional framework, as often done in the literature (Colton and Kress, 1992; Chew, 1995; Pastorino, 2010). Therefore, with reference to Figure 4.1, we will suppose the reference scenario, the buried targets, and the sources invariant along the y-axis, which outgoes from the sheet. The problem of retrieving the shape, the position, and the electromagnetic nature of the buried targets (or more in general of the buried scenario) is mathematically expressed as the problem of reconstructing the absolute (possibly complex) dielectric permittivity ε(x,z) and the absolute (possibly complex) magnetic permeability μ(x,z), both varying with the buried point. In particular, it is comfortable to recast the problem in terms of the dielectric and magnetic contrasts as follows:  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  48  PRELIMINARY REMARKS  49  χ e ðx, z; f Þ =  εðx, zÞ − εs εs  ð4:1Þ  χ m ðx, z; f Þ =  μðx,zÞ− μs μs  ð4:2Þ  where εs is the absolute dielectric permittivity of the soil (in particular εs = εsrε0, where ε0 = 8.85 × 10− 12 Farad/m is the absolute permittivity of the free space), and μs is the absolute magnetic permeability of the soil (in particular μs = μ0μsr, where μ0 = 1.26 × 10− 6 Henry/m is the absolute permeability of the free space). The contrasts are functions of the frequency, because of the dispersion. In many cases the dependence of the contrasts on the frequency is just neglected, also because it is not easy to have at one’s disposal a reliable dispersion law for the case history at hand. So, we also will not consider this dependence. At this point, with reference to the scenario depicted in Figure 4.1, let us consider Maxwell’s equations in the frequency domain. In particular, following the most common convention adopted within the electromagnetic literature, differently from Chapter 2, this time we will make use of the circular frequency ω = 2πf instead of the angular frequency f. Consequently, the Fourier transform is now meant as f^ðωÞ =  +∞ ð  f ðt Þ expð − jωt Þ dt  ð4:3Þ  −∞  –0.2 Air ε 0 , μ0  –0.1  Tx-Rx  Observation domain Σ  0  a  Soil  0.1  x  εs, μs  0.2 0.3  b  0.4 0.5  Targets  Investigation domain D  0.6 0.7  z  0  0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9  Figure 4.1. Geometry of the problem, invariant along the y-axis that comes out from the sheet. The axes are in meters.  THE 2D SCATTERING EQUATIONS FOR DIELECTRIC TARGETS  50  and the inverse Fourier transform is given by 1 f ðt Þ = 2π  +∞ ð  f^ðωÞexpð jωt Þ dω  ð4:4Þ  −∞  Let us consider a spatially isotropic time-invariant medium, possibly dispersive, given by two homogeneous half-spaces separated from a plane interface. The upper half-space (z < 0) is built up of free space. The Maxwell’s equations, in their differential form in frequency domain, are given by !  !  !  r × E = − jωμ H − J m , !  !  !  r × H = jωε E + J , !  r εE = ρ,  ð4:5Þ  !  r μH = ρm !  !  !  !  where E, H , J , and J m are the electric field, the magnetic field, the electric impressed density of current, and the magnetic impressed density of current. Beyond the impressed currents, there are induced electric currents too, which are proportional to the electric field by means of !the conductivity, and so they have been implicitly considered within the term jωεE , because ε is the complex equivalent dielectric permittivity. The quantities ρ and ρm are the density of electric and magnetic charges, respectively. Actually, magnetic currents and magnetic charges do not exist in nature, but some sources can be conveniently described by means of equivalent magnetic current and charges (Franceschetti, 1997). In the following we also will make use of this possibility, and so we consider already from now the most complete form of the Maxwell’s equations. The charge densities ρ and ρm are scalar quantities and are linked to the homologous current densities by means of the continuity equations rJ + jωρ = 0,  ð4:6Þ  rJm + jωρm = 0  ð4:7Þ  The continuity equations descend from the Maxwell’s equations. In fact, in order to achieve them, it is sufficient to consider the divergence of the first two Maxwell’s equations together with the vector identity r  r × v = 0 8v. Physically, the continuity equations mean that the charges are neither created nor destroyed. So, if in a given volume the charges augment (or decrease), it means that the difference entered from outside (exited from inside). All the considered quantities are, in general, functions of the spatial point and of the frequency.  EQUATIONS WITHOUT CONSIDERING THE EFFECT OF THE ANTENNAS  51  4.2 DERIVATION OF THE SCATTERING EQUATIONS WITHOUT CONSIDERING THE EFFECT OF THE ANTENNAS Let us now consider as source a filamentary current, directed along the y-axis and concentrated at the point (x0,z0) in air. Moreover, let us consider the case when no magnetic anomaly is present (χ m = 0) but dielectric anomalies can be looked for (χ e 6¼ 0). The source is given by !  J = I0 δðx − x0 Þδðz− z0 Þiy  ð4:8Þ  where I0 is the level of the current. In this case, the symmetries of the system allow us to state a priori that the electric field has the form !  E = E ðx, zÞiy  ð4:9Þ  Consequently, the magnetic field, from the first Maxwell’s equation, can be expressed as !  H = Hx ðx,zÞix + Hz ðx, zÞiz  ð4:10Þ  The permittivity is equal to ε0 in air and is a generic function of the point ε(x,z) in the soil, whereas the magnetic permeability is a piecewise constant function given by  μb =  μ0 , μs ,  z < 0, z>0  ð4:11Þ  !  In this case, the quantity εðx, zÞ E ðx, zÞ is immediately recognized to be solenoidal—that is, with a null divergence. Thus, the Maxwell equations can be rewritten as !  !  r × E = − jωμb H, !  !  r × H = jωεE + I0 δðx − x0 Þδðz− z0 Þiy , !  r εE = 0,  ð4:12Þ  !  r μbH = 0 At this point, let us write εðx, zÞ = εb + Δεðx, zÞ  ð4:13Þ  where εb is the background permittivity, given by the piecewise constant function  THE 2D SCATTERING EQUATIONS FOR DIELECTRIC TARGETS  52   εb =  ε0 , εs ,  z < 0, z>0  ð4:14Þ  Clearly, the quantity Δε(x,z) is the contribution to the permittivity function given by the buried objects; that is, it somehow represents the targets. At this point, let us write !  !  !  E = E inc + Es = Einc ðx,zÞiy + Es ðx,zÞiy , !  !  !  H = H inc + H s = Hincx ðx,zÞix + Hincz ðx, zÞiz + Hsx ðx, zÞix + Hsz ðx, zÞiz  ð4:15Þ ð4:16Þ  that is, let us decompose the field as the!sum!of two contributions: the incident field plus the scattered field. The incident field ðE inc , H inc Þ, or unperturbed field, is defined as the field that we would have in absence of buried targets—that is, the field that we would have in! correspondence of Δε(x,z) = 0. Consequently, the scattered field, or anomalous ! field ðE s , H s Þ, is the contribution due to the buried targets. With these substitutions, the Maxwell’s equations (4.12) can be rewritten as !  !  !  !  !  !  r × Einc + r × E s = − jωμb H inc − jωμb H s , !  !  !  r × H inc + r × H s = jωεb Einc + jωεb E s + jωΔε E + Io δðx − xo Þδðz − zo Þiy , !  !  !  rεb E inc + rεb E s + rΔεE = 0, !  ð4:17Þ  !  rμb H inc + rμb H s = 0 Now, each piece of the third equation in Eqs. (4.17) is a null quantity, given the direction of the electrical field and its functional dependence [see Eqs. (4.9)– (4.13)]. From Eqs. (4.17), we can extract the Maxwell’s equations for the incident field, which are !  !  r × Einc = − jωμb H inc , !  !  r × H inc = jωεb E inc + Io δðx − xo Þδðz − zo Þiy , !  rεb Einc = 0, !  rμb H inc = 0 Consequently, the scattered field satisfies the following equations:  ð4:18Þ  EQUATIONS WITHOUT CONSIDERING THE EFFECT OF THE ANTENNAS  !  !  !  !  r × Es = − jωμb H s ,  53  !  r × H s = + jωεb E s + jωΔεE, !  rεb Es = 0,  ð4:19Þ  !  rμb H s = 0 !  In Eqs. (4.19) the quantity rΔεE has not been considered because, as already said, it is a null function. At this point, we can recognize that the scattered field is “really” an electromagnetic field, because it is a solution of the Maxwell’s equations, relative to the equivalent source !  !  J eq = jωΔεE  ð4:20Þ  By means of Eqs. (4.19)–(4.20), the buried targets become equivalent to buried sources instead of discontinuities of the medium. So, formally, the scattered field is generated by the equivalent buried sources (also called secondary sources) and not directly by the actual (also called primary) sources. The secondary sources radiate in a homogeneous half-space. Of course, the secondary sources depend, in turn, on the primary ones. The fact that the secondary sources are solenoidal makes it possible to have a nonnull density of current without any accumulation of electrical charges anywhere. Physically, this is possible because of the infinite length of the filamentary current, which makes it an infinite tank for the charges. Let us now deal with Maxwell’s equations relative to the scattered field. To do this, let us use the sampling property of Dirac’s function and let us express the secondary sources as follows: !  ðð  J eq ðx, zÞ =  !  J eq ðx0 ,z0 Þδðx − x0 Þδðz− z0 Þ dx0 dz0  ð4:21Þ  D  Equation (4.21) expresses the distributed source as an integral sum of concentrated sources. Due to the linearity of Maxwell’s equations and also due to the homogeneous radiation conditions that we will impose, we can calculate the field relative to the elemen! tary source J eq ðx0 ,z0 Þδðx − x0 Þδðz− z0 Þ dx0 dz0 and then integrate all over the investigation domain. So, let us rewrite!Maxwell’s equations for the scattered field, this time relative to the elementary source J eq ðx0 ,z0 Þδðx − x0 Þδðz− z0 Þ dx0 dz0 : !  !  !  !  r × dE s = − jωμb dH s , r × dH s = + jωεb dE s + Jeq ðx0 ,z0 Þδðx − x0 Þδðz − z0 Þ dx0 dz0 iy , !  rεb dEs = 0, !  rμb dH s = 0 !  In Eqs. (4.22), the obvious substitution J eq ðx0 ,z0 Þ = Jeq ðx0 ,z0 Þiy has been done.  ð4:22Þ  THE 2D SCATTERING EQUATIONS FOR DIELECTRIC TARGETS  54  Since both the upper (z < 0) and lower (z > 0) half-spaces are homogeneous, we can look for two solutions in the two half spaces separately and then match them at the interface. So, considering the curl of the first equation and substituting it in the second one, we have   ! ! 0 0 0 0 0 0 = −jωμ r × dH = − jωμ jωε dE + J ð x ,z Þδ ð Þδ ð Þ dz i x − x z− z dx s b s eq y r × r × dE s b b !  !  = kb2 dEs − jωμb Jeq ðx0 ,z0 Þδðx − x0 Þδðz − z0 Þ dx0 dz0 iy  ð4:23Þ   ! ! ! Let us now use the definition of Laplacian vector: r2 v = r r v − r × r × v. Applied in Eq. (4.23), this becomes   ! ! ! r rdE s − r2 dE s = kb2 dE s − jωμb Jeq ðx0 ,z0 Þδðx − x0 Þδðz− z0 Þ dx0 dz0 iy  ð4:24Þ    ! However, r rdE s = 0, because of the third of the Maxwell equations (4.22) (the permittivity εb is constant in both the upper and lower half-spaces). Consequently, Eq. (4.24) can be rewritten as !  !  r2 dEs + kb2 dE s = jωμs Jeq ðx0 ,z0 Þδðx − x0 Þδðz − z0 Þ dx0 dz0 iy  ð4:25Þ  In Eq. (4.25), the background magnetic permeability has been substituted by the absolute magnetic permeability of the soil, because the secondary sources are null in air. Equation (4.25) is a Helmholtz vector equation. This equation can be projected along the Cartesian axes to produce, in general, three scalar Helmholtz equations. In our case, the electric field has only one component, so we just have a scalar Helmholtz equation along the y-axis. The component of the Laplacian vector operator along the Cartesian axes are just the scalar Laplacians (defined as the divergence of the gradient r2Φ = r  rΦ) of the homologous components. Thus, in a Cartesian system, the scalar Laplacian is given by the sum of the second-order nonmixed partial derivatives of the function. Therefore, considering the only y-directed component of the electric scattered field, we have ∂2 dEs ∂2 dEs + + kb2 dEs = jωμs Jeq ðx0 ,z0 Þδðx − x0 Þδðz − z0 Þ dx0 dz0 ∂x2 ∂z2  ð4:26Þ  At this point, we consider the Fourier transform of Eq. (4.26) with respect the x variable, for which we will follow the convention f^ðu, zÞ =  +∞ ð  f ðx,zÞ expð − juxÞ dx  ð4:27Þ  −∞  and consequently the inverse Fourier transform will be given by f ðx,zÞ =  1 2π  +∞ ð  −∞  f^ðu, zÞ expð juxÞ du  ð4:28Þ  EQUATIONS WITHOUT CONSIDERING THE EFFECT OF THE ANTENNAS  55  Let us also remember the formula of the Fourier transform of the first derivative f 0 ðx, zÞ = ∂f =∂x: f^0 ðu, zÞ =  +∞ ð  −∞  ∂f +∞ ðx, zÞ expð − juxÞ dx = ½f ðx,zÞexpð − juxÞxx == −∞ ∂x  +∞ ð  −  +∞ ð  f ðx,zÞð − juÞ expð − juxÞ dx = ju −∞  ð4:29Þ f ðx, zÞ expð − juxÞ dx = juf^ðu, zÞ  −∞  where the quantity in square brackets vanishes at infinity because f is a square integrable function. As is customary, we will denote the Fourier transform of the usual operators translated into the (u,z) plane with the same name they had in the (x,z)  plane: For example, the gradient of a function f^ðu, zÞ will be expressed as rf^ = juf^ix + ∂f^=∂z iz and, coherently, all the other common differential operators. Actually, this is a loose, even common, language, the gradient in the plane (u,z) would be rigorously equal  because  (for  example)  to rf^= ∂f^=∂u iu + ∂f^=∂z iz . Due to the implicit different semantic of the operators, in general we don’t have, in the (u,z) domain, the validity of all the results relative to Maxwell’s equations in the (x,z) domain. Notwithstanding, the continuity of tangent component of both the electric and magnetic fields at the air–soil interface holds both in the (x,z) and in the (u,z) domain, because of the continuity of the Fourier operator. At this point, considering the Fourier transform of Eq. (4.26) with respect to x, we have ∂2 d E^s + kz2 d E^s = jωμb Jeq ðx0 ,z0 Þexpð − jux0 Þδðz− z0 Þ dx0 dz0 ∂z2 with  ( kz2  = kb2 − u2  =  2 kz0 = k02 − u2 ,  z < 0,  kzs 2 = ks2 − u2 ,  0<z  ð4:30Þ  ð4:31Þ  Let us now consider, in the plane (u,z), the three regions z < 0, 0 < z < z0 , and z0 < z, that is, the air half-space, the interval between the air–soil interface and the secondary elementary source, and all the depth range below, respectively. In each of these areas we don’t have sources and the propagation medium is homogeneous. So, we can look for a solution of the homogeneous equation ∂2 d E^s + kz2 d E^s = 0 ∂z2  ð4:32Þ  Equation (4.32) is a harmonic equation, whose solution is well known. Therefore, accounting also for the radiation condition to infinity, we can write a formal solution of Eq. (4.32) as follows:  56  THE 2D SCATTERING EQUATIONS FOR DIELECTRIC TARGETS  8 z < 0, dAexpðjkz0 zÞ, > > < ^ s = dBexpðjkzs zÞ + dC expð − jkzs zÞ, dE 0 < z < z0 , ð4:33Þ > > : z0 < z dDexpð − jkzs zÞ, qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ where kz0 , zs = k02, s − u2 , and the square root is meant as the determination with nonpositive imaginary part, so that the solution will not diverge at infinity. As already said, in Eqs. (4.33) the radiation condition have been accounted for too, because we have a priori excluded contributions that propagate from the infinite toward the source. At this point, we have to determine the four (differential) constants dA, dB, dC, and dD. In order to do that, we need to impose four independent conditions on them. This is possible, remembering that the tangential components of the fields at the air–soil interface have to be continuous. Moreover, Eq. (4.30) has to be satisfied also at z = z0 , and this is possible only imposing an impulsive behavior to the second derivative of the field in that point. Consequently, the electric field has to be continuous at z = z0 , whereas its first derivative has to show a discontinuity of the first kind, whose value [integrating Eq. (4.30) between z = z0 − and z = z0 +] is just jωμbJeq (x0 ,z0 )exp(−jux0 ) dx0 dz0 . All this reasoning leads to four mathematical conditions as follows: 1. Continuity of the tangential electric field at the air–soil interface: The electric field is directed along the y-axis, and so it is entirely tangential to the interface. Therefore, this condition means dE^s jz = 0 − = d E^s jz = 0 + , which from Eqs. (4.33) immediately provides dA = dB + dC. 2. Continuity of the tangential component of the magnetic field at the interface: To quantify this condition, we have to express the tangent magnetic field versus the electric one. This can be done from the first of Eqs. (4.22) in the transformed domain. So, we have   ix i y  ! ! j j  ju 0 ^ ^ dHs = r × d Es = ωμb ωμb   0 dE^s   iz  	   ∂  ∂d E^s = j ^ − + ju d E i i x s z : ∂z  ωμ ∂z b   0  Consequently, the second condition is  1 ∂d E^s   μ0 ∂z   z = 0−   1 ∂dE^s  =  μs ∂z   z = 0+  which, when expressed in terms of the Eqs. (4.33), becomes kz0 dA kzs kzs = dB − dC: μs μs μ0  EQUATIONS WITHOUT CONSIDERING THE EFFECT OF THE ANTENNAS  57  3. Continuity of the electric field about the source point: This condition means d E^s jz = z0 − = dE^s jz = z0 + , which, when substituted in Eqs. (4.33), provides dB exp (jkzsz0 ) + dC exp(−jkzsz0 ) = dD exp(−jkzsz0 ). 4. Integrability of Eq. (4.30) about the singular point: This means ∂d E^s  ∂dE^s   0+ −  = jωμs Jeq ðx0 ,z0 Þ expð −jux0 Þ dx0 dz0 ∂z z ∂z z0 − In terms of Eqs. (4.33), this is rewritten as follows: − kzs dD expð −jkzs z0 Þ − ðkzs dB expðjkzs z0 Þ − kzs dC expð − jkzs z0 ÞÞ = ωμs Jeq ðx0 ,z0 Þ expð −jux0 Þ dx0 dz0  Thus, in the end we work out the following algebraic system: dA = dB + dC, μs kz0 dA = dB −dC, μ0 kzs  ð4:34Þ  0  dD − dB expðj2kzs z Þ − dC = 0, − ωμs dD + dBexpðj2kzs z0 Þ −dC = expðjkzs z0 Þ expð − jux0 ÞJeq ðx0 ,z0 Þ dx0 dz0 kzs Let us now solve the system. From the difference between the fourth and the third equation, we have immediately dB =  − ωμs expð − jkzs z0 Þexpð − jux0 ÞJeq ðx0 ,z0 Þ dx0 dz0 2kzs  ð4:35Þ  From the sum of the first two equations we obtain dA =  2dB 2dBμ0 kzs = μs kz0 μ0 kzs + μs kz0 1+ μ0 kzs  =  2μ0 kzs ð − 1Þωμs expð − jkzs z0 Þexpð − jux0 ÞJeq ðx0 ,z0 Þ dx0 dz0 μ0 kzs + μs kz0 2kzs  =  − ωμ0 μs expð −jkzs z0 Þ expð − jux0 ÞJeq ðx0 ,z0 Þ dx0 dz0 μ0 kzs + μs kz0  Then, from the first equation we get  ð4:36Þ  THE 2D SCATTERING EQUATIONS FOR DIELECTRIC TARGETS  58  dC = dA − dB = =  2dBμ0 kzs − dB μ0 kzs + μs kz0  μ0 kzs − μs kz0 − ωμs μ0 kzs −μs kz0 dB = expð − jkzs z0 Þ expð − jux0 ÞJeq ðx0 ,z0 Þ dx0 dz0 μ0 kzs + μs kz0 2kzs μ0 kzs + μs kz0 ð4:37Þ  Finally, from the third equation we obtain dD = dBexpðj2kzs z0 Þ + dC 20 3 1 − ωμs 4@ μ0 kzs − μs kz0 A 0 0 5 = expð − jkzs z Þ + expðjkzs z Þ expð − jux0 ÞJeq ðx0 ,z0 Þ dx0 dz0 2kzs μ0 kzs + μs kz0 ð4:38Þ Substituting these values in Eqs. (4.33), we have  d E^s =  8 − ωμ μ 0 s > expð − jkzs z0 Þ expðjkz0 zÞ expð − jux0 ÞJeq ðx0 ,z0 Þ dx0 dz0 , z < 0, > > > μ k + μ k zs z0 0 s > > > > > 2 3 > > > > > − ωμ μ k − μ k zs s s z0 > > expð −jux0 Þ4 expð − jkzs ðz0 − zÞÞ + 0 expð − jkzs ðz0 + zÞÞ5 > > μ0 kzs + μs kz0 > 2kzs > < > × Jeq ðx0 ,z0 Þ dx0 dz0 , 0 < z < z0 , > > > > 2 3 0 1 > > > > − ωμ μ k − μ k > zs s s z0 A > > expð −jux0 Þ4 expð − jkzs ðz − z0 ÞÞ + @ 0 expð − jkzs ðz0 + zÞÞ5 > > 2k μ k + μ k > zs zs z0 0 s > > > > > : × Jeq ðx0 ,z0 Þdx0 dz0 , z0 < z ð4:39Þ  The second and the third expressions can be joined by considering the absolute value of z − z0 , thereby providing the more compact formula 8 − ωμ μ 0 s > expð − jkzs z0 Þexpðjkz0 zÞ expð − jux0 ÞJeq ðx0 ,z0 Þdx0 dz0 , z < 0, > > > μ0 kzs + μs kz0 > > > > > 2 3 < ^ dE s ðu, z;ωÞ = − ωμs μ kzs − μs kz0 > expð − jux0 Þ4 expð − jkzs jz − z0 jÞ + 0 expð − jkzs ðz0 + zÞÞ5 > > 2k μ k + μ k > zs 0 zs s z0 > > > > > : × Jeq ðx0 ,z0 Þ dx0 dz0 , 0 < z ð4:40Þ  EQUATIONS WITHOUT CONSIDERING THE EFFECT OF THE ANTENNAS  59  At this point we can calculate the element of scattered field in the spatial domain (x,z) by back transforming Eq. (4.40). Thus we obtain 8 +∞ ð > − ωμ0 μs expð − jkzs z0 Þ expðjkz0 zÞ expð − juðx0 − xÞÞ > 0 0 0 0 > > ð x ,z Þ dx dz du, J eq > > μ0 kzs + μs kz0 > > 2π > −∞ > > > > z < 0, > > > < +∞ ð dEs ðx, z; ωÞ = − ωμs expð − juðx0 −xÞÞ 0 0 0 0 > Jeq ðx ,z Þ dx dz > > 4π kzs > > > −∞ > > 2 3 > > > > > μ0 kzs − μs kz0 > 0 0 4 5 > > : × expð − jkzs jz − z jÞ + μ0 kzs + μs kz0 expð − jkzs ðz + zÞÞ du, 0 < z ð4:41Þ The overall scattered field is the integral over the investigation domain of the quantity in Eq. (4.41), with the substitution of the value of the equivalent current density, as given in Eq. (4.20). Thus we have: 8 +∞ ð ðð > − jω2 μ0 μs expð − jkzs z0 Þ expðjkz0 zÞ expð −juðx0 −xÞÞ > 0 0 0 0 0 0 > > Δε ð x ,z ÞE ð x ,z Þ dx dz du, > > μ0 kzs + μs kz0 2π > > > −∞ D > > > > > > z < 0, > > > < +∞ ð Es ðx,z;ωÞ = − jω2 μs ð ð expð − juðx0 − xÞÞ 0 0 0 0 0 0 > Δε ð x ,z ÞE ð x ,z Þ dx dz > > > kzs 4π > > −∞ D > > > > 2 3 > > > > μ k −μ k > > > × 4 expð −jkzs jz −z0 jÞ + 0 zs s z0 expð −jkzs ðz0 + zÞÞ5du, 0 < z > : μ0 kzs + μs kz0  ð4:42Þ At this point, by making use of the dielectric contrast as defined in Eq. (4.1), Eqs. (4.42) can be still rewritten as 8 +∞ ðð ð > 2 > expð − jkzs ðuÞz0 Þexpðjkz0 ðuÞzÞ expð − juðx0 −xÞÞ > > − jks μ0 χ ðx0 ,z0 ÞE ðx0 ,z0 Þ dx0 dz0 > du, e > > 2π μ0 kzs ðuÞ + μs kz0 ðuÞ > > > −∞ D > > > > z<0 > > > < +∞ ðð ð Es ðx, z; ωÞ = − jks2 expð −juðx0 − xÞÞ 0 0 0 0 0 0 > χ e ðx ,z ÞE ðx ,z Þ dx dz > > 4π kzs ðuÞ > > > −∞ D > > 3 > 2 > > > > > × 4 expð − jk ðuÞjz− z0 jÞ + μ0 kzs ðuÞ −μs kz0 ðuÞ expð − jk ðuÞðz0 + zÞÞ5du, 0 < z > > zs zs > μ0 kzs ðuÞ + μs kz0 ðuÞ :  ð4:43Þ  THE 2D SCATTERING EQUATIONS FOR DIELECTRIC TARGETS  60  Adding the incident field to both sides of the second of equations (4.43), eventually we retrieve the scattering equations, in the case of only dielectric anomalies ( χ m = 0): ðð Eðx,xs , z,zs Þ = Einc ðx,xs ,z,zs Þ + ks2  χ e ðx0 ,z0 ÞE ðx0 ,xs ,z0 ,zs ÞGi ðx,x0 , z,z0 Þ dx0 dz0 ,  D  ð4:44Þ  ðx, zÞ 2 D, ðxs ,zs Þ 2 Σ ðð Es ðx0 ,xs ,z0 ,zs Þ = ks2 ðxs ,zs Þ, ðx0 ,z0 Þ 2 Σ  χ e ðx0 ,z0 ÞEðx0 ,xs ,z0 ,zs ÞGe ðx0 ,x0 ,z0 ,z0 Þ dx0 dz0 ,  D  ð4:45Þ  where (x,z) 2 D is the generic point within the investigation domain, (xs,zs) 2 Σ is the source point within the observation domain, and (x0,z0) 2 Σ is the observation point within the observation domain. Gi and Ge are the dielectric internal and external Green’s functions, respectively. Their value, based on Eq. (4.43), is given by −j Gi ðx,x0 , z,z0 Þ = 4π  +∞ ð  −∞  " expð − juðx0 − xÞÞ expð − jkzs jz − z0 jÞ kzs  3 μ0 kzs − μs kz0 + expð − jkzs ðz0 + zÞÞ5du, ðx,zÞ, ðx0 ,z0 Þ 2 D μ0 kzs + μs kz0 − jμ0 Ge ðx0 ,x ,z0 ,z Þ = 2π 0  0  ðx0 ,z0 Þ 2 Σ,  +∞ ð  −∞  expð − jkzs z0 Þexpðjkz0 zÞexpð − juðx0 − xo ÞÞ du, μ0 kzs + μs kz0  ð4:46Þ  ð4:47Þ  ðx0 ,z0 Þ 2 D  The proposed procedure expresses the field in terms of Sommerfeld’s integrals (Sommerfeld, 1912) and corresponds to the usual procedure to retrieve the classical scattering equations, with the addition that possible magnetic properties of the soil (usually neglected) have also been accounted for. So, for a correct comparison, these results correspond to those already published [e.g., in Lesselier and Duchene (1996); Chew (1995)] only under the further hypothesis that μs = μ0. The exposed calculations have also shown that Green’s functions are proportional to the electric field generated by a spatially impulsive source buried in a homogeneous soil. More specifically, the internal Green’s function is proportional to the field in the soil, and the external Green’s function is proportional to the field in air. This makes the Green’s functions square integrable functions, because they are essentially electromagnetic fields generated by finite energy sources.  THE PLANE WAVE SPECTRUM OF AN ELECTROMAGNETIC SOURCE  61  4.3 CALCULATION OF THE INCIDENT FIELD RADIATED BY A FILAMENTARY CURRENT In order to calculate the incident field, we have to consider an impulsive source in air instead of an impulsive source in the soil, but the procedure is fully analogous to that just followed, except for the final integration on the investigation domain, which this time is not needed because the source is actually concentrated. The explicit calculation steps are left as an exercise, and the final result is 8 +∞ ð > > − ωIo μ0 expð − jvðxs −xÞÞ > > > > > 4π kz0 ðvÞ > > −∞ > > > > 2 3 > > > > μ k ð v Þ − μ k ð v Þ > z0 zs 0 < × 4 expð − jkz0 ðvÞjz− zs jÞ + s expð − jkzs ðvÞðz + zs ÞÞ5dv, μ0 kzs ðvÞ + μs kz0 ðvÞ Einc ðx, z;ωÞ = > > > > > > > > 0 < z, > > > +∞ > ð > > − ωI0 μ0 μs expð −jkzs ðvÞzÞ expðjkz0 ðvÞzs Þexpð − jvðxs − xÞÞ > > dv, z < 0 > > : 2π μ0 kzs ðvÞ + μs kz0 ðvÞ −∞  ð4:48Þ  4.4 THE PLANE WAVE SPECTRUM OF AN ELECTROMAGNETIC SOURCE IN A HOMOGENEOUS SPACE It is possible, even under a 2D model, to enhance the scattering equation by inserting in them the characteristic of a source more similar to the actual one with respect to the filamentary current adopted in the previous sections. In order to do this, however, we preliminarily need to introduce the concepts of plane wave spectrum. This is a well-known topic in electromagnetism (Collin, 1985; Franceschetti, 1997). Notwithstanding, a resume is useful both for self-consistency purposes and (above all) in order to have the possibility to outline some subtleties specifically relevant to GPR prospecting. With regard to the plane wave spectrum, let us initially deal with the most general three-dimensional case, and let us consider a source at height h above the soil and at the coordinatives xs = 0, ys = 0. In a reference system with the z-axis directed downward (as that of Figure 4.1) this means that the source is at a negative height zs = − h. Let us first consider a homogeneous (possibly lossy) medium instead of a half-space. The propagation medium is also assumed to be isotropic and time-invariant. Thus, we have that, for any z > − h, the field is the solution of the homogeneous Maxwell’s equations.  THE 2D SCATTERING EQUATIONS FOR DIELECTRIC TARGETS  62  !  !  r × E = − jωμ H, !  !  r × H = jωε E,  ð4:49Þ  !  rε E = 0, !  rμ H = 0 Following calculation steps very similar to those presented in Section 4.2, it is straightforward to retrieve from Eq. (4.49) a vector Helmholtz equation of the kind !  !  !  r2 E + k 2 E = 0  ð4:50Þ  where k is the wavenumber of the medium. In scalar terms, Eq. (4.50) is expressed as ∂2 Ei ∂2 Ei ∂2 Ei + 2 + 2 + k 2 Ei = 0 ∂x2 ∂y ∂z  ð4:51Þ  where the subscript i indicates any among the three x- y- or z-directed components. At this point, we consider the two-dimensional Fourier transform with respect to the x and y variables, for which we will follow the convention: ^ f^ðu,v,zÞ =  +∞ ð ð +∞  f ðx, y, zÞ expð − juxÞexpð − jvyÞ dxdy  ð4:52Þ  −∞ −∞  Consequently, the inverse Fourier transform is given by 1 f ðx,y,zÞ = 2 4π  +∞ ð +∞ ð  f^^ðu, v, zÞexpð juxÞexpð jvxÞ dudv  ð4:53Þ  −∞ −∞  The Fourier transform of the partial derivative of the function follows the homologous rule of Eq. (4.29). Consequently, considering the two-dimensional Fourier transform of Eq. (4.51), we obtain − u2 E^^i − v2 E^^i +  ∂2 d E^^i + k2 E^^i = 0 ∂z2  ð4:54Þ  whose formal solution, accounting for the radiation condition at infinity (which prevents the presence of waves propagating from the infinite toward the sources), can be expressed as E^^i ðu, v, zÞ = A^^i ðu,vÞexpð − jkz1 ðu, vÞzÞ  ð4:55Þ  THE PLANE WAVE SPECTRUM OF AN ELECTROMAGNETIC SOURCE  63  or, in vector terms, ^^ ^^ ! ! E i ðu,v,zÞ = A ðu, vÞ expð − jkz1 ðu,vÞzÞ  ð4:56Þ  pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ kz1 ðu, vÞ = k2 − u2 − v2  ð4:57Þ  where  In Eq. (4.56) the determination of the square root with nonpositive imaginary part has to be retained, in order to have a solution where the field vanishes far from the sources (in particular for z ! + ∞).1 We have labeled the quantity in Eq. (4.57) as kz1 in order to distinguish it from the quantity kz previously defined [Eq. (4.31)] in the twodimensional half-space scalar case. At any rate, physically, both kz and kz1 represent the z-component of the wavevector. Equation (4.56) tells us that it is sufficient to know the field on any plane z = const > − h in order to know it (theoretically) everywhere in the half-space z > − h. In particular, let ^^ us suppose to know the field at the height z = z1 > − h. In this case we can calculate ! E ðu, v,z1 Þ as the two-dimensional Fourier transform of the field on the plane z = z1. Then, according to Eq. (4.56), we have ^^ ^^ ^^ ^^ ! ! ! ! E ðu,v,z1 Þ = A ðu, vÞ expð − jkz1 ðu,vÞz1 Þ ) A ðu, vÞ = E ðu, v,z1 Þexpðjkz1 ðu, vÞz1 Þ ð4:58Þ Consequently, for any other z = z2 > − h, we have ^^ ^^ ! ! ! ^^ E ðu, v,z2 Þ = A ðu, vÞ expð − jkz1 ðu, vÞz2 Þ = E ðu,v,z1 Þ expð − jkz1 ðu, vÞðz2 −z1 ÞÞ  ð4:59Þ  At this ^^ point, the field in the plane z = z2 is the inverse two-dimensional Fourier transform ! of E ðu, v,z2 Þ according to Eq. (4.53). Thus, we can refer the plane wave spectrum to any fixed height. Here, we choose the height of the source z = zs > − h,2 so we calculate the plane wave spectrum as +∞ ð +∞ ð ^^ ! ! ^^ Eðx, y,zs Þexp½ − jðxu + yvÞ dxdy E ðu, vÞ = E ðu, v,zs Þ = !  ð4:60Þ  −∞ −∞  The plane wave spectrum expresses the behavior of the sources, acquired either experimentally or theoretically or numerically.  Let us remind that the solution looked for is valid only for z > − h. In most texts, there is a default choice at z = 0 for the definition of the plane wave spectrum. This is the most natural choice if the propagation medium is a homogeneous medium. However, we will have to pass to the case of a medium composed by two homogeneous half-spaces. 1 2  THE 2D SCATTERING EQUATIONS FOR DIELECTRIC TARGETS  64  The field for any point with z > zs is given by 1 E ðx, y, zÞ = 2 4π !  +∞ ð +∞ ð  ^^ ! E ðu,vÞexp½ jðux + vy − kz1 ðu,vÞðz− zs ÞÞ dudv  ð4:61Þ  −∞ −∞  Equation (4.61) has been worked out under the condition that xs = 0 and ys = 0. Due to the homogeneity of the considered medium, a shift of the source amounts to the same shift for the field. Thus, if we consider a source placed in a generic (reference) point (xs,ys), the field assumes the more general expression: 1 E ðx, y, zÞ = 2 4π !  +∞ ð +∞ ð  ^^ ! E ðu, vÞ exp½jðuðx − xs Þ + vðy − ys Þ − kz1 ðu,vÞðz− zs ÞÞ dudv z > zs  −∞ −∞  ð4:62Þ The quantity integrated in Eq. (4.62) is a plane wave that propagates along the direction − uix − viy + kz1(u,v)iz. So, Eq. (4.62) expresses the field as a sum of plane waves (for any fixed frequency).3 Equivalently, the field can be also expressed as 1 E ðx, y, zÞ = 2 4π !  +∞ ð +∞ ð  ^^ ! E ðu,vÞexp½ − jðuðx − xs Þ + vðy − ys Þ + kz1 ðu, vÞðz − zs ÞÞ dudv z > zs  −∞ −∞  ð4:63Þ The reader can easily check that the integrals (4.62) and (4.63) provide the same result, but in Eq. (4.63) the generic plane wave component propagates along the direction uix + viy + kz1(u,v)iz. In the following, we will adopt the expression (4.63). In the 2D case at hand, it is an easy exercise to check that Eq. (4.63) reduces to 1 E ðx, zÞ = 2π !  +∞ ð  ! ^ E ðuÞ exp½ − jðuðx − xs Þ + kz ðuÞðz− zs ÞÞ duz > zs  ð4:64Þ  −∞  pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ where kz ðuÞ = k 2 − u2 and ! ^ ^ E ðuÞ = E ðu,zs Þ = !  +∞ ð  !  Eðx,zs Þ expð − juxÞ dx  ð4:65Þ  −∞ 3  Let us outline that the reader can find different expressions of the plane wave spectrum, corresponding to different conventional choices about the definition of the Fourier transform. In particular, Eq. (4.63) might be equivalently expressed with the minus sign before the terms ux and vy in the exponential. Moreover, sometimes the factor 1=4π 2 is included by definition in the plane wave spectrum and thus does not appear explicitly outside the integral.  THE INSERTION OF THE SOURCE CHARACTERISTICS  65  Moreover, in Eqs. (4.64) and (4.65) both the field and the plane wave spectrum have only the y-component.4 Let us now consider a lossless medium. In this case, if the couple (u,v) is internal to the circle of equation C : u2 + v2 = k2, then kz1 is a real quantity [see Eq. (4.57)] and the plane wave (i.e., a homogeneous plane wave) propagates along a direction with a real component along the z-axis. Instead, if the couple (u,v) is external to the circle C, kz1 becomes an imaginary quantity. In this case the plane wave propagates along a direction belonging to the xy plane and vanishes exponentially along the z-axis. The circle C allows us to distinguish the so-called visible plane wave spectrum from the invisible plane wave spectrum. Clearly, at some distance from the sources, only the visible plane wave spectrum gives a meaningful contribution to the field. In the case of a low lossy medium (as in many case the soil is) we cannot distinguish rigorously a visible plane wave spectrum from an invisible one. However, if we define a pseudo-visible plane wave spectrum on the basis of the real part of the wavenumber kr = Real(k) (i.e., we consider the circle C : u2 + v2 = kr2 ), we still recognize that the attenuation along the z-axis increases meaningfully for couples (u,v) outside the pseudo-visible circle. Thus, in any case we have that the field for high values of z contains fewer plane waves than does the field for small values of z.  4.5 THE INSERTION OF THE SOURCE CHARACTERISTICS IN THE SCATTERING EQUATIONS Let us now come back to the 2D scalar case, but let us consider the case of two homogeneous half-spaces (the upper one made up of free space), and let us start from Eqs. (4.64)–(4.65) written in free space: !  E ðx, zÞ =  1 2π  +∞ ð  ! ^ E ðuÞexp½ − jðuðx − xs Þ + kz0 ðuÞðz − zs ÞÞ du,  −∞  ! ^ ^ E ðuÞ = E ðu,zs Þ = !  ð4:66Þ  +∞ ð  !  Eðx,zs Þ expð − juxÞ dx  ð4:67Þ  −∞  pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ where kz0 ðuÞ = k02 − u2 is the imaginary part of the nonpositive square root. Both the electric field and the plane wave spectrum have only one component, y-directed—that is, coming out from the sheet according with the geometry of the problem represented in Figure 4.1. When the incident field of Eq. (4.66) meets the interface between two homogeneous half-spaces, the comprehensive field can be calculated reflecting and refracting the generic plane wave composing the incident field and then calculating the integral sum of the reflected and refracted waves. The superposition is licit because both the involved 4 The reason why we have considered the more general 3D case instead of directly the 2D case at hand will be clear after reading Section 4.8.  THE 2D SCATTERING EQUATIONS FOR DIELECTRIC TARGETS  66  propagation media are linear with respect to the incident field and time invariant. So we have: !  dE I ðx, zÞ = dEI ðx, zÞiy = =  1 !^ E ðuÞexp½ jðuðx − xs Þ − kz0 ðuÞðz− zs ÞÞ du 2π 1 ^ E ðuÞexp½ jðuðx − xs Þ − kz0 ðuÞðz− zs ÞÞ duiy 2π  ð4:68Þ  This incident wave generates both a reflected and a refracted (or transmitted) wave at the air–soil interface, at z = 0. The reflected elementary wave will have the general form !  dE R ðx, zÞ = dER ðx, zÞiy = =  1 !^ E R ðu1 Þ exp½ jðu1 x + kz0 ðu1 ÞzÞ du1 2π 1 ^ ER ðu1 Þ exp½ jðu1 x + kz0 ðu1 ÞzÞ du1 iy 2π  ð4:69Þ  whereas the elementary transmitted wave will have the general form !  dE T ðx, zÞ = dET ðx, zÞiy = =  1 !^ E T ðu2 Þ exp½jðu2 x − kzs ðu2 ÞzÞ du2 2π 1 ^ E T ðu2 Þ exp½jðu2 x − kzs ðu2 ÞzÞ du2 iy 2π  ð4:70Þ  where kzs is defined according to Eq. (4.31). Equations (4.69) and (4.70) also account for the fact that Maxwell’s equations impose to any plane wave (in any homogeneous isotropic propagation medium) the constraint u2 + kz2 = k 2 , that is, they impose that the modulus of the wavevector is equal to the wavenumber of the local propagation medium. Moreover, in the expression of the reflected wave, it has been shown that the wavevector has to have its arrow directed in the air, which accounts for the plus sign before kz0(u1)z. At this point, let us impose the continuity of the tangent components of both the electric and the magnetic field at the air–soil interface, which, as already stated, is also a consequence of Maxwell’s equations. With respect to the electric field, we have 1 ^ 1 E ðuÞexp½jðuðx − xs Þ− kz0 ðuÞhÞ du + E^R ðu1 Þ expðju1 xÞ du1 2π 2π 1 ^ = ET ðu2 Þ expðju2 xÞ du2 2π  ð4:71Þ  Since the equality has to hold for any value of x, we have as a first result the equality at u = u1 = u2; that is, the x component of the three wavenumbers is the same. Consequently, Eqs. (4.69)–(4.70) evolve into  THE INSERTION OF THE SOURCE CHARACTERISTICS  !  dE R ðx,zÞ = dER ðx, zÞiy = = !  dE T ðx, zÞ = dET ðx,zÞiy = =  67  1 !^ E R ðuÞ exp½jðux + kz0 ðuÞzÞ du 2π 1 ^ ER ðuÞ exp½jðux + kz0 ðuÞzÞ duiy 2π  ð4:72Þ  1 !^ E T ðuÞ exp½jðux − kzs ðuÞzÞ du 2π 1 ^ ET ðuÞexp½jðux − kzs ðuÞzÞ duiy 2π  ð4:73Þ  Equations (4.71)–(4.73) express an equivalent formulation of the Snell’s law (Franceschetti, 1997). However, let us outline that, in the case at hand, part of the incident plane waves are homogeneous and part are inhomogeneous. In other words, the spectral formulation allows us to account for all the involved real and complex incidence, reflection and refraction angles in a compact and smart way. Substituting Eqs. (4.72)–(4.73) into Eq. (4.71), the condition of continuity of the tangent electric field at the interface becomes E^ðuÞexpð − jkz0 ðuÞhÞexpð − juxs Þ + E^R ðuÞ = E^T ðuÞ  ð4:74Þ  The magnetic field is expressed versus the electric one from Maxwell’s, equations, in the same formal way followed with regard to the scattered field in Section 4.2; thus we have   ix iy  ! ! j j  ju 0 dH I = r × dE I =  ωμ0 ωμ0    0 dE! i   iz  	   ∂ ! j ∂dEI  = − + judE i i  x I z ∂z  ωμ ∂z 0  0  ð4:75Þ  As a result, the tangent component of the incident magnetic field is given by j ∂dEI ωμ0 ∂z  ð4:76Þ  j ∂dER , ωμ0 ∂z  ð4:77Þ  j ∂dET ωμs ∂z  ð4:78Þ  dHIx = − and analogously dHRx = −  dHTx = −  Consequently, the continuity of the tangent component of the magnetic field at the air–soil interface is expressed as  THE 2D SCATTERING EQUATIONS FOR DIELECTRIC TARGETS  68   1 ∂dEI   μ0 ∂z   z = 0−   1 ∂dER  +  μ0 ∂z   z = 0−   1 ∂dET  =  μs ∂z   ð4:79Þ  z = 0+  Substituting Eqs. (4.68), (4.72), and (4.73) into Eq. (4.79), we obtain kz0 ðuÞ ^ kz0 ðuÞ ^ kzs ðuÞ ^ E ðuÞexpð − juxs Þexpð − jkz0 ðuÞhÞ− ER ðuÞ = E T ðu Þ μ0 μ0 μs  ð4:80Þ  Equations (4.74) and (4.80) allow us to solve the reflected and the transmitted plane wave spectra versus the incident one. Thus, we have μ kz0 ðuÞ− μ0 kzs ðuÞ ^ E^R ðuÞ = s E ðuÞ expð − juxs Þ expð − jkz0 ðuÞhÞ, μs kz0 ðuÞ + μ0 kzs ðuÞ  ð4:81Þ  2μs kz0 ðuÞ E^ðuÞ expð − juxs Þ expð − jkz0 ðuÞhÞ μs kz0 ðuÞ + μ0 kzs ðuÞ  ð4:82Þ  E^T ðuÞ =  μs kz0 ðuÞ − μ0 kzs ðuÞ has the μs kz0 ðuÞ + μ0 kzs ðuÞ physical meaning of an air–soil reflection coefficient, whereas the quantity 2μs kz0 ðuÞ has the physical meaning of an air–soil transmission coefficient. μs kz0 ðuÞ + μ0 kzs ðuÞ Therefore, the (unique) y-component of the field, which is the incident field for the inverse scattering problem related to the reconstruction of buried targets, is given by Equations (4.81)–(4.82) make it clear that the quantity  Einc ðx,zÞ =  8 +∞ ð > > 1 > > E^ðuÞexpð juxÞexpð − juxs Þexpð − jkz0 ðuÞhÞ > > 2π > > > −∞ > > > 3 > 2 > > > μ k ð u Þ − μ k ð u Þ > z0 0 zs > × 4 expð − jkz0 ðuÞzÞ + s expðjkz0 ðuÞzÞ5 du, > > < μs kz0 ðuÞ + μ0 kzs ðuÞ  z < 0,  > +∞ > ð > > 1 > > > E^ðuÞexpð juxÞexpð − juxs Þexpðjkz0 ðuÞzs Þ > > 2π > > > −∞ > > > > > 2μs kz0 ðuÞ > > > : × μ kz0 ðuÞ + μ kzs ðuÞ expð −jkz0 ðuÞzÞ du, z > 0 s  0  ð4:83Þ Equation (4.83) provides the incident field everywhere in a medium composed of two homogeneous half-spaces, with interface at z = 0. Equation (4.83) constitutes the generalization of Eq. (4.48), where the incident field is calculated in the case that the source is a filamentary current. In order to distinguish the characteristics of the source from those of  THE FAR FIELD IN A HOMOGENEOUS LOSSLESS SPACE  69  the receiving antenna, from now on we will relabel E^ as E^Tx , where the suffix Tx stands for transmitting antenna. Thus, Eq. (4.83) is rewritten as  Einc ðx, zÞ =  8 +∞ ð > > 1 > > E^Tx ðuÞ expð juxÞ expð − juxs Þ expð − jkz0 ðuÞhÞ > > 2π > > > −∞ > > > 3 > 2 > > > μ k ð u Þ − μ k ð u Þ > z0 0 zs > > × 4 expð − jkz0 ðuÞzÞ + s expðjkz0 ðuÞzÞ5du, > < μs kz0 ðuÞ + μ0 kzs ðuÞ  z < 0,  > +∞ > ð > > 1 > > > E^Tx ðuÞ expð juxÞ expð − juxs Þ expðjkz0 ðuÞzs Þ > > 2π > > > −∞ > > > > > 2μs kz0 ðuÞ > > > : × μ kz0 ðuÞ + μ kzs ðuÞ expð − jkz0 ðuÞzÞ du, z > 0 s  0  ð4:84Þ To account for the characteristics of the source in the scattering equation just means to insert the incident field given by Eq. (4.84) in them instead of the incident field related to a filamentary current, given by Eq. (4.48). In particular, the plane wave spectrum of a filamentary current I0 is given by (Clemmow, 1996; Harrington, 1961) − ωμ0 I0 1 E^Tx ðvÞ = kz0 ðvÞ 2  ð4:85Þ  which, when substituted in Eq. (4.84), gives back Eq. (4.48). Before closing this section, a further observation is proposed: Since the calculations are based on Maxwell’s equations, the primary source of the field is some given current density, and this is considered unchanged passing from the case of a homogeneous space to the case of a half-space. Actually, the density current that generates the field is provided by the currents that arise on the exploited transmitting antenna. These currents in general are not the same when the antenna radiates in free space and when it radiates near the soil. So, if we somehow measure or simulate the plane wave spectrum of the transmitting antenna in free space, and then we make use of it in Eq. (4.84), then we are implicitly neglecting the different behavior of the antenna in free space and close to the soil.  4.6 THE FAR FIELD IN A HOMOGENEOUS LOSSLESS SPACE IN TERMS OF PLANE WAVE SPECTRUM Let us now devote attention to the insertion of the characteristics of the receiver into the scattering equations. In order to do that, we need another digression starting from the 3D plane wave spectrum of a transmitting antenna. So, let us consider the polar reference  THE 2D SCATTERING EQUATIONS FOR DIELECTRIC TARGETS  70  system of Figure 4.2, and let us express the involved vectors by means of their projections along the Cartesian axes, in turn expressed in terms of polar coordinates. So we have !  r = xix + yiy + ziz = r sin ðθÞ cos ðφÞix + r sin ðφÞ sin ðφÞiy + r cos ðθÞiz ,  ð4:86Þ  rs = xs ix + ys iy + zs iz = rs sin ðθs Þcos ðφs Þix + rs sin ðθs Þsin ðφs Þiy + rs cos ðθs Þiz ,  ð4:87Þ  !  !  k ðu, vÞ = uix + viy + kz1 ðu, vÞiz = w cos ðφ1 Þix + wsin ðφ1 Þiy + kz1 ðw cos ðφ1 Þ, wsin ðφ1 ÞÞiz   = k wn cos ðφ1 Þix + wn sin ðφ1 Þiy + kz1n ðwn Þiz ð4:88Þ where we have introduced the following normalized (with respect to the wavenumber) quantities: wn =  w , k  kz1 ðwcos ðφ1 Þ, wsin ðφ1 ÞÞ = kz1n ðwn Þ = k pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ k 2 − w2 = 1 −w2n = k  pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ k 2 − w2 cos 2 ðφ1 Þ − w2 sin 2 ðφ1 Þ k  ð4:89Þ  z=0 z = zs  → rs z θ  φ x  → r → k(u,v)  y  Figure 4.2. Polar and Cartesian reference system at hand. The angular coordinates φ1, θs, and φs are easily inferred.  THE FAR FIELD IN A HOMOGENEOUS LOSSLESS SPACE  71  After doing that, expressing the integral of Eq. (4.63) in planar polar variables, we have !  E ðr, θ,φÞ =  2ðπ +∞ ð ^^ ! k2 dφ wn dwn E ðkwn cos ðφ1 Þ,kwn sin ðφ1 ÞÞ 1 2 4π 0  0  × exp½ − jkr ðwn cos ðφ1 Þ sin ðθÞcos ðφÞ + wn sin ðϕ1 Þ sin ðθÞ sin ðφÞ + kz1n ðwn Þcos ðθÞÞ × exp½jkrs ðwn cos ðφ1 Þ sin ðθs Þcos ðφs Þ + wn sin ðφ1 Þ sin ðθs Þsin ðφs Þ + kz1n ðwn Þcos ðθs ÞÞ  ð4:90Þ Since the expression is considered only for great values of the distance r, the integral (4.90) can be calculated with the method of the stationary phase method. This method is based on the fact that the exponential term related to the observation point constitutes a strongly oscillating function versus the integration variables, unless the derivatives of the argument of the exponential is equal to zero. Thus, the most important contributions to the results are expected to be related to the neighbors of the roots of derivatives of that argument, which are called “stationary points” (Felsen and Marcuvitz, 1994). In order to provide the general stationary phase formula for integrals in two variables, let us consider two “slowly varying” functions f(x,y) and g(x,y), where g(x,y) is a real function (instead, f(x,y) can be either a real or a complex function), and let us consider a real parameter Ω ! + ∞. In this case, for any quadruple of real values X1, X2 > X1, Y1, Y2 > Y1 we can approximate X ð2  Yð2  dx f ðx,yÞexp½ jΩgðx, yÞ dy≈ X1  Y1  2πjf ðx0 ,y0 Þexp½ jΩgðx0 ,y0 Þ sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ∂2 g ∂2 g Ω ð x ,y Þ ðx0 ,y0 Þ 0 0 ∂x2 ∂y2  ð4:91Þ  where the point (x0,y0) is the (supposed unique) stationary point enclosed in the integrated area. Moreover, in Eq. (4.91), it is implicitly supposed that the stationary point is of the first order; that is, the second-order derivatives do not vanish in it. If more than one first-order stationary points are present, each of them provides an additive contribution of the kind of Eq. (4.91) to the field. If higher-order stationary points are present (i.e., point where the first-, the second- and possibly also higher-order derivatives vanish), they provide further additive contributions, even if these will be not expressed by means of Eq. (4.91). That said, let us label the phase terms at hand as follows: ψ ðwn ,φ1 ; θ, φÞ = wn sin ðθÞ cos ðφÞcos ðφ1 Þ + wn sin ðθÞsin ðφÞsin ðφ1 Þ + k1zn ðwn Þ cos ðθÞ ð4:92Þ and similarly ψ s ðw,φ1 ;θs ,φs Þ = wn sin ðθs Þcos ðφs Þ cos ðφ1 Þ + wn sin ðθs Þ sin ðφs Þ sin ðφ1 Þ−k1zn ðwn Þ cos ðθ s Þ  ð4:93Þ  THE 2D SCATTERING EQUATIONS FOR DIELECTRIC TARGETS  72  Let us now calculate the first-order derivatives, in order to look for the stationary points: ∂ψ = − wn sin ðθÞ cos ðφÞsin ðφ1 Þ + wn sin ðθÞ sin ðφÞ cos ðφ1 Þ ∂φ1 = wn sin ðθÞsin ðφ − φ1 Þ, ∂ψ wn = sin ðθÞcos ðφÞ cos ðφ1 Þ + sin ðθÞsin ðφÞsin ðφ1 Þ − cos ðθÞ pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ∂wn 1 − w2n wn = sin ðθÞ cos ðφ− φ1 Þ − cos ðθÞ pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 1 − w2n  ð4:94Þ  Looking for the roots of the gradient, the first of Eq. (4.94) admits two distinct solutions (apart from the periodicity, which is not influent here). They are φ1 = φ and φ1 = φ + π. However, due to the geometrical condition that the observation point is beyond the source (which means that 0 ≤ θ ≤ π=2 (see Figure 4.2), so that both sin(θ) and cos(θ) are nonnegative quantities), and due to the already quoted radiation conditions, the reader can test that the stationary point with φ1 = φ + π would lead to a wavevector with negative z-component, which corresponds to an unacceptable wave coming from the infinite toward the sources. Thus, substituting φ1 = φ in the second of Eqs. (4.94), we determine that there is a unique acceptable stationary point (wn,φ1) = (sin θ, φ). This means that the main contribution is given by the plane wave that propagates in the same direction of the observation point. Let us now calculate the second derivatives of the phase term ψ: ∂2 ψ = − wn sin ðθÞ cos ðφ − φ1 Þ ∂φ21 pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ w2n ﬃ 1 − w2n + pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 1 − w2n ∂2 ψ 1 = − cos ðθÞ = − cos ðθÞ  3=2 2 2 ∂wn 1 − wn 1 − w2  ð4:95Þ  n  which provides the following in the stationary point: vﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ﬃ  u 2 u∂ ψ ∂2 ψ  t = tg ðθÞ  ∂w2n ∂φ21  ðwn ,φ1 Þ = ð sin ðθÞ, φÞ  ð4:96Þ  Thus, the stationary point is of the first order and we can apply (4.94) thereby obtaining the following in far field: !  j k cos ðθÞ !^^ E ðk sin ðθÞcos ðφÞ, k sin ðθÞ sin ðφÞÞ expð − jkr Þexpðjkrs ir Þ r 2π  !  ! j expð − jkr Þ exp j k r s ^^ ! cos ðθÞE ðk sin ðθÞ cos ðφÞ,k sin ðθÞ sin ðφÞÞ ð4:97Þ = λr  E ðr,θ, φÞ≈  THE EFFECTIVE LENGTH OF AN ELECTROMAGNETIC SOURCE  73  This equation shows that in far field the angular dependence becomes uncoupled with respect to the radial dependence. In particular, the radial dependence of the far field is independent from the specific source at hand. Let us stress that the hypothesis of the lossless medium was central in the application of the stationary phase. Actually, to speak about far-field pattern in a lossy medium does not have a rigorous sense, even if it is loosely done in some case. However, the plane wave spectrum expresses the characteristic of the source even in a lossy medium.  4.7 THE EFFECTIVE LENGTH OF AN ELECTROMAGNETIC SOURCE IN A HOMOGENEOUS SPACE Let us now return to a three-dimensional geometry and to a homogeneous medium. The effective length in transmission mode of an antenna is defined as a vector such as the far field radiated by the antenna can be written, in polar coordinates (see Figure 4.2), as !  E ðr, θ, ϕÞ ≈  jkς ! e − jkr IR hT ðθ, ϕÞ 4π r  ð4:98Þ  where ς is the intrinsic impedance of the medium. In the case of free space, it is equal to pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ς0 = μ0 =ε0 ≈ 377 ohms. In the case of wire antennas fed at the gap, IR is the current at the gap; otherwise it is, more in general, a reference current. In the case that IR is a reference current, there is some degree of arbitrariness in its choice. However, this will reflect in an inverse proportionality of the value of the effective length so that the electromagnetic field (which is the physical quantity) will not depend on this. The effective length is a complex vector, independent on the distance between the source and the observation point in far field, and has the physical dimension of a length. Let us outline that Eq. (4.98) is valid at a fixed frequency; that is, the effective length (as well as the plane wave spectrum and the far-field pattern) is a function of the frequency too. By comparing Eq. (4.98) with Eq. (4.97), we discover the relationship between the effective length and the plane wave spectrum: !  hT ðθ, φÞ =   !  ! 2 exp j k r s IR ς  ^^ ! cos ðθÞE ðk sin ðθÞ cos ðφÞ, k sin ðθÞsin ðφÞÞ  ð4:99Þ  In free space, Eq. (4.99) can be still rewritten as !  hT ðθ, ϕÞ =  !  ! λ0 exp jk0 rs πIR ς0  ^^ ! k0 cos ðθÞE ðk0 sin ðθÞcos ðϕÞ, k0 sin ðθÞ sin ðϕÞÞ  ð4:100Þ  If we consider only homogeneous waves, then Eq. (4.99) is meant with θ varying in the range ð0,π=2Þ and φ varying in the range (0, 2π). If we also consider inhomogeneous waves, attenuating along the z-axis, then complex angles should be accounted for; or,  THE 2D SCATTERING EQUATIONS FOR DIELECTRIC TARGETS  74  alternatively, Eq. (4.100) can be smartly expressed versus the planar component of the wavevector as follows: !  hT ðu,vÞ =   !  ! λ0 exp j kr s πIR ς0   !  ! λ exp j k rs qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ !^^ ^ 0 ! ^ k02 − u2 − v2 E ðu, vÞ ð4:101Þ kz1 ðu, vÞE ðu,vÞ = πIR ς0  Let us now consider the antenna in reception mode, on which impinges an incident plane ! wave, which we will express versus its propagation direction as Einc ðu, vÞ, and let us label as V0 the open-circuit voltage at the clamps5 of the gap. The effective length in reception mode of the antenna is defined by means of the equality !  !  !  !  V0 ðx, y, zÞ = − hR ðu, vÞE inc ðu, vÞ = −hR ðu,vÞE 0 exp½jðux + vy ± kz1 ðu, vÞzÞ  ð4:102Þ  The sign before the third term in the exponential depends on whether the plane wave at ! hand propagates toward the positive or the negative z-axis. Let us outline that Einc ðu,vÞ is not the electric field at the gap but instead the incident field—that is, the field that we would have at that point in absence of the receiving antenna. The presence of the receiving antenna, of course, influences and modifies the field—in particular, reirradiating part of the impinging energy. Now, if the incident field is not given by a single plane wave, then it can be expressed as a superposition of plane waves. In this case, due to the linearity of the problem at hand and due to the time-invariant behavior of the receiving antenna, the open-circuit voltage will be expressed as the integral sum of the contribution of all the plane waves composing the incident field, so that we have V0 ðx, y, zÞ = −  1 4π 2  +∞ ð +∞ ð  ^^ ! ! hR ðu, vÞE ðu,vÞexp½jðux + vy ± kz1 ðu, vÞzÞ dudv  ð4:103Þ  −∞ −∞  At this point, a well-known result in electromagnetism, which is a consequence of the reciprocity theorem (Franceschetti, 1997), is that the effective length in reception mode is the same as the effective length in transmission mode. Therefore, this quantity will now be referred to as just the effective length of the antenna: !  !  !  h ðu,vÞ = hT ðu, vÞ = hR ðu,vÞ  ð4:104Þ  and so we can rewrite Eq. (4.103) as 1 V0 ðx,y,zÞ = − 2 4π  +∞ ð +∞ ð  ^^ ! ! hðu, vÞE ðu, vÞexp½jðux + vy ± kz1 ðu, vÞzÞ dudv  ð4:105Þ  −∞ −∞  5 There are antennas where we cannot identify physical clamps, but even in this case it is possible to consider an equivalent voltage at equivalent clamps (Stutzman and Thiele, 1998).  THE INSERTION OF THE RECEIVER CHARACTERISTICS  75  4.8 THE INSERTION OF THE RECEIVER CHARACTERISTICS IN THE SCATTERING EQUATIONS We can now consider the problem of inserting the receiver characteristics into the scattering operator. To consider the receiver means to consider as output the “scattered voltage” instead of the scattered field—that is, to consider the voltage at the gap (or at some equivalent gap) of the receiving antenna, instead of the scattered field in the same point. Unlike the case of the source characteristics, where the plane wave spectrum could be easily restricted into a 2D framework, the insertion of the receiver characteristics makes it theoretically hard to remain rigorously into a two-dimensional dealing. In particular, let us note that the filamentary current is a physical abstraction and is a source without clamps, either actual or equivalent. This does not prevent the fact that in many cases a two-dimensional model of the incident and scattered field can be satisfying and convenient. In order to solve this theoretical “embarrassment,” we can suppose that a twodimensional source radiates the field and two-dimensional targets scatter it. However, we will consider momentarily a “real” three-dimensional antenna as receiver. That said, let us reconsider the first in Eqs. (4.41), reported here to simplify the reading: !  dE s ðx, y, zÞ = iy  − ωμ0 μs Jeq ðx0 ,z0 Þ dx0 dz0 2π +∞ ð  × −∞  expð − jkzs z0 Þexpðjkz0 zÞ expð − juðx0 − xÞÞ du, μ0 kzs + μs kz0  ð4:106Þ z<0  With respect to Eq. (4.41), in Eq. (4.106) we have taken implicit the dependence on the frequency and have instead explicitly shown the fact that the elementary contribution to the field is directed along the y-axis. We have also introduced an artful formal dependence along the y-axis, even if the function at hand is by definition constant along the y-axis. Let us now consider the three-dimensional plane wave spectrum of this electrical field with reference to the air-soil interface. Considering that +∞ ð  expð − jvyÞ dy = 2πδðνÞ  ð4:107Þ  −∞  and considering that Eq. (4.106) has the structure of an inverse Fourier transform in the variable x, the plane wave spectrum of Eq. (4.106) is given by ^^ ! expð − jkzs ðuÞz0 Þexpð − jux0 Þ d E s ðu, vÞ = − iy 2πωμ0 μs Jeq ðx0 ,z0 Þ dx0 dz0 δðvÞ μ0 kzs ðuÞ + μs kz0 ðuÞ  ð4:108Þ  Therefore, the contribution of the elementary buried source to the scattered voltage can be expressed according to Eq. (4.105) as  THE 2D SCATTERING EQUATIONS FOR DIELECTRIC TARGETS  76  ωμ0 μs Jeq ðx0 ,z0 Þ dx0 dz0 2π  dV0 = −  =−  ωμ0 μs Jeq ðx0 ,z0 Þ dx0 dz0 2π  +∞ ð ð +∞  hy ðu,vÞ −∞ −∞ +∞ ð  hy ðu,0Þ −∞  expð − jkzs ðuÞz0 Þ expðjkz0 ðuÞzÞ expð −juðx0 −xÞÞ δðvÞ dudv μ0 kzs ðuÞ + μs kz0 ðuÞ  expð − jkzs ðuÞz0 Þ expðjkz0 ðuÞzÞ expð −jux0 Þ du μ0 kzs ðuÞ + μs kz0 ðuÞ  ð4:109Þ  !  Accounting for Eq. (4.101) [wherein the source point is r s = ðx0 ,z0 Þ], Eq. (4.109) can be expressed versus the plane wave spectrum of the receiving antenna as follows: ωμ0 μs Jeq ðx0 ,z0 Þλ0 dx0 dz0 2π 2 IR ς0 +∞ ð expð − jkzs ðuÞz0 Þ expðjkz0 ðuÞzÞ expð − juðx0 − xÞÞ du E^^y ðu,0Þkzo ðuÞ μ0 kzs ðuÞ + μs kz0 ðuÞ  dV0 = −  ð4:110Þ  −∞  The comprehensive scattered voltage is determined by integrating on x0 and z0 after substituting the equivalent buried current density according to Eq. (4.20). So we have +∞ ð +∞ ð jω2 μ0 μs εs λ0 Eðx0 ,z0 ;xs ,zs Þχ e ðx0 ,z0 Þ V0 ðx, zÞ = − 2π 2 I R ς0 2 +∞ 3 −∞ −∞ ð 0 0 exp ð − jk ð u Þz Þexp ð jk ð u Þz Þ exp ð − ju ð x − x Þ Þ zs z0 ^ × 4 E^y ðu,0Þkzo ðuÞ du5 dx0 dz0 μ0 kzs ðuÞ + μs kz0 ðuÞ −∞  ð4:111Þ In Eq. (4.111), E is the internal (i.e., underground) field due to a 2D primary source placed in (xs,zs), and it is dealt with as a scalar because it is implied that it has the only y-component. Instead, E^^y is the y-component of the plane wave spectrum of the receiving antenna in air, which in general has also the x- and the z-components. At this point, we define the pseudo-2D plane wave spectrum of the receiver as E^^y ðu,0Þ E^Rx ðuÞ = m  ð4:112Þ  where m is a constant dimensional quantity equal to 1 m. After doing this, Eq. (4.111) can be rewritten as +∞ ð +∞ ð jmks2 μ0 λ0 V0 ðx,zÞ = − E ðx0 ,z0 ;xs ,zs Þχ e ðx0 ,z0 Þ 2π 2 IR ς0 −∞ −∞ 2 +∞ 3 ð 0 0 expð − jkzs ðuÞz Þ expðjkz0 ðuÞzÞexpð − juðx − xÞÞ 5 0 0 × 4 E^Rx ðuÞkzo ðuÞ du dx dz μ0 kzs ðuÞ + μs kz0 ðuÞ −∞  ð4:113Þ  THE INSERTION OF THE RECEIVER CHARACTERISTICS  77  Equation (4.113) can be expressed in the form +∞ ð +∞ ð  V0 ðx, zÞ = ks2  Gev ðx0 ,z0 ;x,zÞE ðx0 ,z0 ;xs ,zs Þχ e ðx0 ,z0 Þ dx0 dz0  ð4:114Þ  −∞ −∞  where, for comparison, we have jmμ λ0 Gev ðx ,z ; x, zÞ = − 2 0 2π IR ς0 0 0  +∞ ð  E^Rx ðuÞkzo ðuÞ  −∞  expð − jkzs ðuÞz0 Þexpðjkz0 ðuÞzÞ expð − juðx0 − xÞÞ × du μ0 kzs ðuÞ + μs kz0 ðuÞ  ð4:115Þ  Equations (4.115) expresses the 2D external Green’s function accounting for the characteristics of the receiving antenna. Eventually, to insert the characteristics of the receiver into the scattering equation means to substitute the expression (4.115) for the external Green’s function into the scattering equation (4.45) instead of the expression (4.47). Note that the internal Green’s function, instead, remains unchanged and is given by Eq. (4.46). In fact, the internal Greens function represents the field underground resulting from a buried spatially impulsive source and is therefore not influenced by the characteristics of the antennas.  QUESTIONS 1. Can we say that the scattering equations essentially are the mathematical relationships between the buried targets and the electric field in the observation point? 2. Suppose that the shielding of the antennas is perfect, so that no energy is radiated in or received from the upper half-space. Is this sufficient to assimilate the propagation medium to a homogeneous medium instead of a medium composed by two adjacent half-spaces? 3. In the expression of Green’s function and of the incident field [Eqs. (4.46–4.48)] the magnetic permittivity of both the air and the soil appears explicitly, whereas the dielectric permittivities of the air and of the soil appear only implicitly by means of the wave-numbers. What is the reason for this dissymmetry? What should happen in order to have a formulation where the quantities that appear explicitly are the permittivities? 4. In order to achieve a filamentary current at microwave frequency, might we make use of a long wire with lossy nonreflective terminations and then detach the wire in the middle and apply there a microwave voltage?  78  THE 2D SCATTERING EQUATIONS FOR DIELECTRIC TARGETS  5. In order to implement a two-dimensional receiver, might we follow the same method described in question 4? 6. Should we expect that the central cut of the field radiated by a three-dimensional antenna is coincident with the 2D field radiated by a filamentary current displaced along the same line of the 3D wire antenna?  5 THE 2D SCATTERING EQUATIONS FOR MAGNETIC TARGETS  5.1 THE SCATTERING EQUATIONS WITH ONLY MAGNETIC ANOMALIES Let us now consider the case dual to that dealt with in the previous chapter, when no dielectric anomaly is present ( χ e = 0), but instead magnetic anomalies are looked for ( χ m 6¼ 0). Actually, this is an extremely rare case, but the relative calculations are preliminary to considering the case with both dielectric and magnetic anomalies, which is less “exceptional.” At the moment, we consider a filamentary electric current as primary source and consider the scattered field as datum. So, let us start again from Maxwell’s equations, repeated here for simplification. !  !  r × E = −jωμ H, !  !  r × H = jωεbE + I0 δðx − x0 Þδðz − z0 Þiy , !  rεbE = 0,  ð5:1Þ  !  rμH = 0  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  79  THE 2D SCATTERING EQUATIONS FOR MAGNETIC TARGETS  80  The magnetic permeability is schematized as the sum of the background permeability plus some discrepancy, as follows: μðx, zÞ = μb + Δμðx, zÞ  ð5:2Þ  where the background magnetic permeability μb is the piecewise constant function described by Eq. (4.11). Instead, the dielectric permittivity is equal to the background permittivity εb, which is the piecewise constant function given in Eq. (4.14). In the same way that we considered the case with only dielectric anomalies, we can decompose the field into an incident field plus a scattered field, and then we can extract Maxwell’s equations for the incident field [which are the same as for the previous chapter and thus are given in Eqs. (4.18)] and those for the scattered field, which now are given by !  !  !  !  !  r × E s = − jωμb H s − jωΔμH , r × H s = + jωεb E s ,  ð5:3Þ  !  rεb Es = 0, !  !  rμb H s = − rΔμ H Thus, the scattered field can be viewed as generated by magnetic secondary (equivalent) sources, given by !  !  J meq = jωΔμ H  ð5:4Þ  The equivalent sources are not directed along the y-axis, but they have an x-directed component and a z-directed component, as does the magnetic field [see Eq. (4.10)]. Consequently, the secondary sources are not solenoidal in general and, coherently, the fourth equation in Eqs. (5.3) is not homogeneous but just states the continuity equation (4.7) with respect to the secondary (magnetic) sources. This is a crucial point that prevents us from performing the calculations in the same way followed in Section 4.2 and makes them more complicated. Physically, the point is that, in this case, the secondary source is an equivalent continuous array of magnetic Hertzian dipoles instead of a filamentary electric current. The array is infinitely extended along the y-axis but is directed in the transverse plane and is infinitesimally long in this plane. This implies that the equivalent magnetic charges can move only along an infinitesimal path, and consequently some accumulation of them occurs. After this premix, Eqs. (5.3) can be solved by means of suitable potential functions. In particular, we can start again from the consideration that the electric field is solenoidal. This assures (Franceschetti, 1997) the existence of a potential vector (also called !  Fitzgerald vector) F such as !  Es =  ! 1 r× F εb  ð5:5Þ  THE SCATTERING EQUATIONS WITH ONLY MAGNETIC ANOMALIES  81  Substituting Eq. (5.5) in the second of Eqs. (5.3), we have !  ! ! ! r × H s = + jωr × F , r × H s − jω F = 0 !  ð5:6Þ  !  This assures that the irrotational quantity H s − jω F is the gradient of some scalar potential function Φ (Franceschetti, 1997). So we have !  !  H s = jω F + rΦ  ð5:7Þ  Equations (5.5) and (5.7) express the fields in terms of two potential functions, so that we can think of recasting the problem in terms of these two potential functions, and then the fields will be derived from them. However, it is to be emphasized that, while the fields are physical quantities, which makes them univocally determined, the potential functions are mathematical quantities not univocally determined. In particular, suppose that we  !  have found a couple of potential functions F 0 ,Φ0 that solve the problem, and let us consider any well-behaved scalar function ϕ. It is easy that the couple    !to recognize  ! F 0 + rϕ, Φ0 − jωϕ gives rise to the same fields as F 0 ,Φ0 , and so it is another solution. In fact, we have !  1 ! 1 ! r × F 0 + rϕ = r × F 0 + 1 r × rϕ = 1 r × F , εb εb εb εb !  !  ð5:8Þ  jωF 0 + jωrϕ + rΦ0 − jωrϕ = jωF 0 + rΦ0 In the first Eq. (5.8), we have exploited the well-known vector identity r × rf ≡ 0. At this point, let us substitute Eqs. (5.5) and (5.7) in the first equation of Eqs. (5.3). r×   !  ! ! 1 r × F s = − jωμb jω F + rΦ − J meq εb  ð5:9Þ  From Eq. (5.9), extracting the background permittivity (in both the homogeneous half-spaces separately) from the curl symbol and considering again the Laplacian vector, we have  ! ! ! ! r r F − r2 F = k 2b F − jωεb μb rΦ− εb J meq ð5:10Þ  !  ! ! ! , r2 F + k 2b F = r r F + jωεb μb Φ + εb J meq !  At this point, we can decide to look for a couple F , Φ such as we obtain the following result:  THE 2D SCATTERING EQUATIONS FOR MAGNETIC TARGETS  82     ! r F + jωεb μb Φ = 0  ð5:11Þ  This possibility is related to the generalnonuniqueness of the potentials. In particular,  ! suppose again to have found a solution F 0 ,Φ0 . To find another solution that verifies the condition (5.11) amounts to looking for a scalar function ϕ such as !  ! r F 0 + rϕ + jωεb μb ðΦ0 − jωϕÞ = 0 , r2 ϕ + kb2 ϕ = − rF 0 − jωεb μb Φ0  ð5:12Þ  That is, the couple that verifies Eq. (5.12) can be found solving a scalar Helmholtz equation in ϕ. Condition (5.11) is known as the gauge of Lorentz (Franceschetti, 1997). Having shown that it is licit, let us impose it on the solution, so that Eq. (5.10) reduces to !  !  !  r2 F + k2b F = εb J meq  ð5:13Þ  that is, eventually we have achieved again a vector Helmholtz equation, which allows manipulations that are analogous to those in Section 4.2. However, the equation is not in terms of the unknown “field” but in terms of the unknown potential vector. Moreover, from Eq. (5.11) we have !  r F Φ= − jωεb μb  ð5:14Þ  Substituting Eq. (5.14) into Eq. (5.7), we have !  !  H s = jω F −   ! r r F jωεb μb  ð5:15Þ  Under the gauge of Lorentz, Eqs. (5.5) and (5.15) express the fields in terms of the only the Fitzgerald vector, which makes it formally redundant to look also for the scalar potential. Now, from Eq. (5.5), we know a priori that the Fitzgerald vector has the following form: !  F ðx, zÞ = Fx ðx, zÞix + Fz ðx, zÞiz  ð5:16Þ  Due to the linearity of the relationships between the fields and the Fitzgerald vector, we can consider separately the two components of the Fitzgerald vector, as two separated potentials. Each of the them will be associated with an electromagnetic field, and the final  THE CONTRIBUTION OF THE X-COMPONENT OF THE FITZGERALD VECTOR  83  solution will be given by the sum of these two electromagnetic fields. So, we will proceed considering separately the two components.  5.2 THE CONTRIBUTION OF THE X-COMPONENT OF THE FITZGERALD VECTOR Let us now consider the only x-component of the potential vector: !  F 1 ðx, zÞ = Fx ðx, zÞix  ð5:17Þ  It can be seen as generated by the x-component of the magnetic density current. Thus the equivalent magnetic density current to be considered is !  J meq1 = jωΔμðx, zÞHx ðx, zÞix = Jmeqx ðx,zÞix  ð5:18Þ  This can be decomposed into the sum of concentrated sources as !  ðð  J meq1 = Jmeqx ðx, zÞix = ix  Jmeqx ðx0 ,z0 Þδðx − x0 Þδðz− z0 Þ dx0 dz0  ð5:19Þ  D  So, after Fourier transforming Eq. (5.13) along the x-axis and considering the element of Fitzgerald vector generated by an element of magnetic current !  dJ meq1 = Jmeqx ðx0 ,z0 Þδðx −x0 Þδðz − z0 Þ dx0 dz0 ix , we achieve the scalar equation ∂2 d F^x + kz2 d F^x = εb Jmeqx ðx0 ,z0 Þ expð − jux0 Þδðz − z0 Þ dx0 dz0 ∂z2  ð5:20Þ  Since the secondary sources are buried, Eq. (5.20) can be still rewritten as ∂2 d F^x + kz2 d F^x = εs Jmeqx ðx0 ,z0 Þ expð − jux0 Þδðz − z0 Þ dx0 dz0 ∂z2  ð5:21Þ  And so its formal solution, accounting also for the radiation condition at infinity, is 8 dA expðjkz0 zÞ, z < 0, > > < 1 d F^x = dB1 expðjkzs zÞ + dC1 expð − jkzs zÞ, > > : dD1 expð − jkzs zÞ, z0 < z  0 < z < z0 ,  ð5:22Þ  At this point we have to express the same four conditions considered in Section 4.2 in terms of the Fitzgerald vector.  THE 2D SCATTERING EQUATIONS FOR MAGNETIC TARGETS  84  In particular, the first two conditions are given by the continuity of the tangential component of both electric and magnetic field at the interface. So, in order to impose them, we have to express the fields in terms of Eqs. (5.22) using Eqs. (5.5) and (5.15). In particular, the electric field is equal to 8   1 ∂d F^x > iy iz   ix > > i,   > < ε0 ∂z y ! ! 1 1  ju 0 ∂  1 ∂dF^x ^ d E s1 = r × dF 1 =  ∂z  = εb ∂z iy = > 1 ∂d F^x εb εb   > > >  ^  : εs ∂z iy , dFx 0 0  z<0 ð5:23Þ z>0  So, the continuity of the tangential component of the electric field is expressed as  1 ∂d F^x   ε0 ∂z   z = 0−   1 ∂d F^x  =  εs ∂z   , z = 0+  εs kz0 dA1 = dB1 − dC1 ε0 kzs  ð5:24Þ  With regard to the condition about the scattered magnetic field, we have ! ^ rd F 1 = ju d F^x ,     ! ∂ dF^x ^ iz r rd F1 = jurdF^x = ju judF^x ix + ∂z  ð5:25Þ ð5:26Þ  So, the tangential component of the element of the scattered magnetic field (i.e., its x-component) is given by   d H^ sx1 = jωd F^x −  ^ r rdF 1 !  jωεb μb     2 2 u − kb kz2 u2 dF^x ^ ix = jω dF x + = d F^x = − dF^x jωεb μb jωεb μb jωεb μb ð5:27Þ  So, the continuity of the tangential scattered magnetic field translates into   kz2  ^ dFx   ε 0 μ0  z = 0−   kz2 ^  = dF x   ε s μs  z = 0+  ,  2 εs μs kz0 dA1 = dB1 + dC1 2 ε0 μ0 kzs  ð5:28Þ  The third condition is the continuity of the Fitzgerald vector at the source point z = z0 (because the Helmholtz equation (5.20) is expressed versus the Fitzgerald vector). So we have dD1 − dB1 expðj2kzs z0 Þ − dC1 = 0  ð5:29Þ  The fourth condition is given by the integration of Eq. (5.20) about the source point z = z0 , so we have  THE CONTRIBUTION OF THE X-COMPONENT OF THE FITZGERALD VECTOR  dD1 + dB1 expðj2kzs z0 Þ − dC1 = − εs  expðjkzs z0 Þ expð − jux0 Þ Jmeqx ðx0 ,z0 Þ dx0 dz0 jkzs  85  ð5:30Þ  So, we retrieve the following algebraic system: εs kz0 dA1 = dB1 − dC , ε0 kzs ð5:31Þ  2 εs μs kz0 dA1 = dB1 + dC1 , 2 ε0 μ0 kzs  dD1 −dB1 expð j2kzs z0 Þ− dC1 = 0, dD1 + dB1 expð j2kzs z0 Þ − dC1 = jεs  expð jkzs z0 Þ expð − jux0 Þ Jmeqx ðx0 ,z0 Þdx0 dz0 kzs  The system is formally similar to the system (4.34). So, following the same calculation steps, the final result is given by dA1 =  jε0 μ0 kzs expð −iux0 Þ expð − jkzs z0 Þ Jmeq ðx0 ,z0 Þdx0 dz0 , kz0 μ0 kzs + μs kz0  expð − iux0 Þexpð − jkzs z0 Þ Jmeq ðx0 ,z0 Þdx0 dz0 , 2kzs 1 μs kz0 − μ0 kzs expð − iux0 Þ expð − jkzs z0 ÞJmeq ðx0 ,z0 Þdx0 dz0 , dC1 = jεs 2kzs μs kz0 + μ0 kzs 2 3 expð − iux0 Þ 4 μ k − μ k z0 0 zs dD1 = jεs expðjkzs z0 Þ + s expð − jkzs z0 Þ5Jmeq ðx0 ,z0 Þdx0 dz0 2kzs μs kz0 + μ0 kzs dB1 = jεs  ð5:32Þ  Substituting into Eqs. (5.22), we have 8 jε0 μ0 kzs expð − iux0 Þexpð − jkzs z0 Þ expðjkz0 zÞ > > − Jmeq ðx0 ,z0 Þdx0 dz0 , z < 0 > > μ0 kzs + μs kz0 kz0 > > > > < 2 3 ^ 0 d F x ðu, zÞ = exp ð − iux Þ μ k −μ k > 4 expð − jkzs jz− z0 jÞ + s z0 0 zs expð − jkzs ðz + z0 ÞÞ5 −jεs > > > μs kz0 + μ0 kzs 2kzs > > > > : × Jmeq ðx0 ,z0 Þdx0 dz0 , z > 0 ð5:33Þ Substituting Eq. (5.33) into Eq. (5.23), we achieve the elementary component of the scattered electric field in the transformed domain:  86  THE 2D SCATTERING EQUATIONS FOR MAGNETIC TARGETS  8 expð − iux0 Þ expð − jkzs z0 Þ expðjkz0 zÞ > > Jmeq ðx0 ,z0 Þ dx0 dz0 ix , z < 0 − μ0 kzs > > > μ0 kzs + μs kz0 > > > > > < expð − iux0 Þ Jmeq ðx0 ,z0 Þ dx0 dz0 ix ^ dE s1 ðu, zÞ = 2 > 2 3 > > > > > μ kz0 − μ0 kzs > > × 4 sgnðz − z0 Þ expð − jkzs jz − z0 jÞ + s expð − jkzs ðz + z0 ÞÞ5, z > 0 > > : μs kz0 + μ0 kzs ð5:34Þ where sgn stands for the signum functions, equal to −1 if its argument is negative and equal to +1 if its argument is positive. Note that the signum is the derivative of the absolute value, which will be exploited in the following. After inverse Fourier transformation and integration all over the investigation domain, eventually the contribution to the scattered field is the following [directed along the y-axis accordingly to Eq. (5.23)]: Es1 ðx,zÞ 8 +∞ ðð ð > μ0 kzs expð − iuðx0 −xÞÞ expð − jkzs z0 Þ expðjkz0 zÞ > 0 0 0 0 > > − J ð x ,z Þ dx dz du, z < 0 meqx > > 2π μ0 kzs + μs kz0 > > > −∞ D > > +∞ > ð < 1 ðð = Jmeqx ðx0 ,z0 Þ dx0 dz0 expð −iuðx0 − xÞÞ > 4π > > −∞ > 2D 3 > > > > > 4 μs kz0 −μ0 kzs > 0 0 0 5 > > : × sgnðz − z Þ expð − jkzs jz −z jÞ + μs kz0 + μ0 kzs expð −jkzs ðz + z ÞÞ du, z > 0  ð5:35Þ Substituting the expression of the magnetic current according to Eq. (5.4), and accounting for the first Maxwell’s equation for the total field (5.1),1 we have Jmeqx ðx0 ,z0 Þ = jωΔμðx0 ,z0 ÞHx ðx0 ,z0 Þ = jωΔμðx0 ,z0 Þ  ! 1 r × E ðx0 ,z0 Þix − jωμðx0 ,z0 Þ     ix iy iz  Δμðx0 ,z0 Þ 0 1   0 0   ∂ ∂ Δμðx ,z Þ  μb i = − @ − ∂E ix Aix = χ m ∂E 0 =− ∂z0  x Δμðx0 ,z0 Þ 1 + χ m ∂z0 μb + Δμðx0 ,z0 Þ  ∂x0 ∂z0 1+  0 E 0 μb  ð5:36Þ  1 Let us remind that the considered magnetic current density is a secondary source; there is no primary magnetic source.  THE CONTRIBUTION OF THE X-COMPONENT OF THE FITZGERALD VECTOR  87  Substituting Eq. (5.36) into Eq. (5.35), we have Es1 ðx,zÞ 8 +∞ ð ðð > μ0 χ m ∂E 0 0 kzs expð − iuðx0 − xÞÞ expð −jkzs z0 Þ expðjkz0 zÞ > > > − dx dz du, z < 0 > 0 > μ0 kzs + μs kz0 > > 2π D 1 + χ m ∂z > −∞ > > > +∞ > ð < 1 ðð χ ∂E 0 0 m dx dz expð − iuðx0 − xÞÞ = > 4π 1 + χ m ∂z0 > > −∞ > 2D > 3 > > > > > μ k − μ k z0 zs s 0 > 0 5 0 0 4 > > : × sgnðz − z Þ expð − jkzs jz − z jÞ + μs kz0 + μ0 kzs expð − jkzs ðz + z ÞÞ du, z > 0  ð5:37Þ Equation (5.37) expresses the element of electric scattered field in terms of the internal scattered field and in terms of magnetic contrast. At this point, let us calculate the first partial derivative of the internal and external electric Green’s functions, expressed by Eqs. (4.46) and (4.47), versus the variable z0 : 8 +∞ ð ∂ ∂ < −j expð − juðx0 − xÞÞ 0 0 Gi ðx,x ,z,z Þ = 0 0 ∂z ∂z :4π kzs −∞  2  × 4 expð − jkzs jz − z0 jÞ + +ð∞  −1 = 4π 2  3  μ0 kzs − μs kz0 expð −jkzs ðz0 + zÞÞ5 du ; μ0 kzs + μs kz0  expð − juðx0 − xÞÞ  −∞  3  × 4ð − 1Þ sgnðz −z0 Þ expð − jkzs jz − z0 jÞ +  1 = 4π  9 =  +ð∞  μ0 kzs − μs kz0 expð − jkzs ðz0 + zÞÞ5du μ0 kzs + μs kz0  expð −juðx0 −xÞÞ  −∞  2  3 μ k − μ k z0 0 zs expð −jkzs ðz0 + zÞÞ5 du, × 4 sgnðz −z0 Þ expð − jkzs jz − z0 jÞ + s μ0 kzs + μs kz0 8ðx, zÞ, ðx0 ,z0 Þ 2 D  ð5:38Þ  THE 2D SCATTERING EQUATIONS FOR MAGNETIC TARGETS  88  ∂ Ge ðx,x0 , z,z0 Þ ∂z0 8 9 +ð∞ ∂ < − jμ0 expð − jkzs z0 Þ expðjkz0 zÞ expð − juðx0 − xÞÞ = du = 0 ; ∂z : 2π μ0 kzs + μs kz0 =  − μ0 2π  −∞  +∞ ð  kzs −∞  expð − jkzs z0 Þ expðjkz0 zÞ expð − juðx0 −xÞÞ du, ðx, zÞ 2 Ω, ðx0 ,z0 Þ 2 D μ0 kzs + μs kz0 ð5:39Þ  Comparing Eqs. (5.38) and (5.39) with Eq. (5.37), we can express the contribution Es1(x,z) as 8ð ð χm > > > > < 1 + χm Es1 ðx, zÞ = ðDð χm > > > > : 1 + χm D    ðð ∂E ∂Ge 0 0 2 χm 1 ∂E ∂Ge 0 0 dx dz = k dx dz , s ∂z0 ∂z0 1 + χ m ks2 ∂z0 ∂z0   ðDð ∂E ∂Gi 0 0 2 χm 1 ∂E ∂Gi 0 0 dx dz = k dx dz , s 0 0 ∂z ∂z 1 + χ m ks2 ∂z0 ∂z0  z<0 z>0  D  ð5:40Þ  5.3 THE CONTRIBUTION OF THE Z-COMPONENT OF THE FITZGERALD VECTOR Let us consider the second component of the Fitgerald vector. The calculations proceed in the same way as before, so that we can reduce to a minimum the exposed passages. This time, the potential vector is given by !  F 2 ðx, zÞ = Fz ðx, zÞiz  ð5:41Þ  The equivalent magnetic density of current is given by ðð  !  J meq2 = jωΔμðx, zÞHz ðx, zÞiz = Jmeqz ðx, zÞiz = iz  Jmeqz ðx0 ,z0 Þδðx − x0 Þδðz− z0 Þ dx0 dz0  D  ð5:42Þ The element of magnetic density of current is given by !  dJ meq2 = Jmeqz ðx0 ,z0 Þδðx − x0 Þδðz − z0 Þ dx0 dz0 iz  ð5:43Þ  The scalar Helmholtz equation in the element of potential vector in the transformed domain (u,z) is given by  THE CONTRIBUTION OF THE Z-COMPONENT OF THE FITZGERALD VECTOR  89  ∂2 d F^z + kz2 dF^z = εs Jmeqz ðx0 ,z0 Þexpð − jux0 Þδðz − z0 Þdx0 dz0 ∂z2  ð5:44Þ  whose formal solution is 8 dA expðjkz0 zÞ, z < 0, > > < 2 d F^z = dB2 expðjkzs zÞ + dC2 expð − jkzs zÞ, > > : dD2 expð − jkzs zÞ, z0 < z  0 < z < z0 ,  ð5:45Þ  The element of the electric field versus the element of the Fitzgerald vector is expressed as follows: 8   ju  ix iy iz  > > − dF^z iy ,   > < ε ∂  0 ! ! 1 1 ju ^ ^ d E s2 = r × dF 2 =  ju 0 ∂z  = − dF^z iy = ju > εb εb  εb ^  > >   : − εs d F z iy , 0 0 d F^z  z<0 ð5:46Þ z>0  The continuity of the unique (and tangent) component of the electric field at the interface is expressed as follows:   1 ^  1 ^  εs dF z  = dF z  , dA2 = dB2 + dC2 ð5:47Þ  − εs  + ε0 ε0 z=0  z=0  With regard to the continuity of the tangential component of the scattered magnetic field, we have ! ^ ∂ d F^z rd F 2 = ∂z  !  ∂ d F^z ∂ dF^z ∂2 d F^z ^ = ju ix + r rd F 2 = r iz ∂z ∂z ∂z2   ! ^ r rd F 2 ju ∂d F^z u ∂d F^z ix = − =− d H^ sx2 = − jωεb μb ∂z ωεb μb ∂z jωεb μb   !  Thus, the continuity of the tangential scattered magnetic field is expressed as   1 ∂d F^z  1 ∂d F^z  εs μ kz0 = , s dA2 = dB2 − dC2   ε0 μ0 kzs ε0 μ0 ∂z  − εs μs ∂z  + z=0  z=0  The continuity of the Fitzgerald vector at the source point z = z0 is expressed as  ð5:48Þ ð5:49Þ  ð5:50Þ  ð5:51Þ  THE 2D SCATTERING EQUATIONS FOR MAGNETIC TARGETS  90  dD2 − dB2 expðj2kzs z0 Þ − dC2 = 0  ð5:52Þ  The integration of Eq. (5.44) about the source point z = z0 is expressed as dD2 + dB2 expðj2kzs z0 Þ− dC2 = − εs  expð jkzs z0 Þexpð − jux0 Þ Jmeqz ðx0 ,z0 Þdx0 dz0 jkzs  ð5:53Þ  Thus, we have the algebraic system: εs dA2 = dB2 + dC2 , ε0 εs μs kz0 dA2 = dB2 − dC2 , ε0 μ0 kzs  ð5:54Þ  dD2 − dB2 expðj2kzs z0 Þ − dC2 = 0, dD2 + dB2 expðj2kzs z0 Þ − dC2 = jεs  expð jkzs z0 Þ expð − jux0 Þ Jmeqz ðx0 ,z0 Þ dx0 dz0 kzs  The solution of the system is  dA2 = jε0 μ0 dB2 = jεs  expð − iux0 Þexpð − jkzs z0 Þ Jmeqz ðx0 ,z0 Þ dx0 dz0 , μ0 kzs + μs kz0  expð − iux0 Þ expð − jkzs z0 Þ Jmeqz ðx0 ,z0 Þ dx0 dz0 , 2kzs  ð5:55Þ  1 μ0 kzs − μs kz0 expð − iux0 Þ expð − jkzs z0 ÞJmeqz ðx0 ,z0 Þ dx0 dz0 , 2kzs μ0 kzs + μs kz0 2 3 0 expð − iux Þ 4 μ kzs − μs kz0 dD2 = jεs expðjkzs z0 Þ + 0 expð − jkzs z0 Þ5Jmeqz ðx0 ,z0 Þ dx0 dz0 μs kz0 + μ0 kzs 2kzs dC2 = jεs  Substituting Eqs. (5.55) into Eqs. (5.45), we have 8 expð − iux0 Þ expð − jkzs z0 Þexpðjkz0 zÞ > > jε0 μ0 Jmeqz ðx0 ,z0 Þ dx0 dz0 iz , z < 0 > > > μ0 kzs + μs kz0 > > > > < 2 3 0 d F^z ðu, zÞ = exp ð − iux Þ μ k − μ k zs z0 s 4 expð − jkzs jz − z0 jÞ + 0 > expð − jkzs ðz + z0 ÞÞ5 jεs > > > μs kz0 + μ0 kzs 2kzs > > > > > : × Jmeqz ðx0 ,z0 Þ dx0 dz0 iz , z > 0 ð5:56Þ  THE CONTRIBUTION OF THE Z-COMPONENT OF THE FITZGERALD VECTOR  91  from which, substituting Eq. (5.56) into Eq. (5.46), we have 8 expð − jux0 Þ expð − jkzs z0 Þ expðjkz0 zÞ > > Jmeqz ðx0 ,z0 Þdx0 dz0 , z < 0, uμ0 > > > μ0 kzs + μs kz0 > > > > > < 2 3 d E^s2 ðu, zÞ = u expð − iux0 Þ μ k − μ k zs z0 s > 4 expð − jkzs jz −z0 jÞ + 0 expð − jkzs ðz + z0 ÞÞ5 > > > 2kzs μs kz0 + μ0 kzs > > > > > > : × Jmeqz ðx0 ,z0 Þdx0 dz0 , z > 0 ð5:57Þ After inverse Fourier transform and integration all over the investigation domain, eventually the contribution to the scattered field can be expressed as Es2 ð8 x, zÞ = +ð∞ ðð > > jμ0 − ju expð − iuðx0 − xÞÞexpð − jkzs z0 Þ expðjkz0 zÞ > 0 0 0 0 > > J ð x ,z Þdx dz du, z < 0, meqz > > μ0 kzs + μs kz0 2π > > > −∞ D > > > > > +ð∞ > < j ðð − ju 0 0 0 0 Jmeqz ðx ,z Þdx dz expð − iuðx0 − xÞÞ = > 4π kzs > > −∞ D > > > > 2 3 > > > > > μ k − μ k z0 0 zs > > × 4 expð − jkzs jz − z0 jÞ + s expð − jkzs ðz + z0 ÞÞ5 du, z > 0 > > μs kz0 + μ0 kzs : ð5:58Þ Expressing the z-component of the equivalent magnetic current in terms of internal electric field and magnetic contrast, we have Jmeqz ðx0 ,z0 Þ = jωΔμðx0 ,z0 ÞHz ðx0 ,z0 Þ = jωΔμðx0 ,z0 Þ   ix iy  0 0 Δμðx ,z Þ  ∂ 0 =− μb + Δμðx0 ,z0 Þ  ∂x0  0 E 1  ! 1 r × E ðx0 ,z0 Þiz − jωμðx0 ,z0 Þ   Δμðx0 ,z0 Þ iz   ∂  ∂E χ ∂E μb i = − i i = − m ∂z0  z Δμðx0 ,z0 Þ ∂x0 z z 1 + χ m ∂x0 1+ 0  μb ð5:59Þ  Substituting Eq. (5.59) into Eq. (5.58), we have  THE 2D SCATTERING EQUATIONS FOR MAGNETIC TARGETS  92  Es2 ðx, zÞ 8 +∞ ðð ð > > jμ0 χ m ∂E 0 0 − juexpð −iuðx0 − xÞÞ expð −jkzs z0 Þ expðjkz0 zÞ > > > − dx dz du, z < 0, > 0 > μ0 kzs + μs kz0 2π 1 + χ m ∂x > > > −∞ D > > > > > +∞ > ðð ð < j χ m ∂E 0 0 − ju dx dz expð − iuðx0 − xÞÞ − = 0 > 4π ∂x k 1 + χ zs m > > −∞ D > > > > 2 3 > > > > > μ k − μ k z0 zs > × 4 expð − jk jz −z0 jÞ + s 0 > expð − jkzs ðz + z0 ÞÞ5 du, z>0 > zs > μs kz0 + μ0 kzs :  ð5:60Þ At this point, let us consider the derivatives of the internal and external Green’s functions, as given by Eqs. (4.46) and (4.47), with respect to the variable x0 : 8 +∞ < − j ð expð −juðx0 −xÞÞ ∂ ∂ 0 0 G ð x,x , z,z Þ = i ∂x0 ∂x0 :4π kzs −∞ 2 3 ) μ k −μ k zs z0 s expð − jkzs ðz0 + zÞÞ5 du × 4 expð − jkzs jz −z0 jÞ + 0 μ0 kzs + μs kz0 =  +ð∞ −j −ju expð −juðx0 − xÞÞ 4π kzs 2− ∞ 3 μ k −μ k zs s z0 × 4 expð − jkzs jz −z0 jÞ + 0 expð − jkzs ðz0 + zÞÞ5 du, μ0 kzs + μs kz0  ðx, zÞ, ðx0 ,z0 Þ 2 D ð5:61Þ  ∂ Ge ðx,x0 , z,z0 Þ ∂x0 8 9 +∞ ð ∂ < − jμ0 expð − jkzs z0 Þ expðjkz0 zÞexpð − juðx0 − xÞÞ = du = 0 ; ∂x : 2π μ0 kzs + μs kz0 −∞  − jμ0 = 2π  +∞ ð  −∞  − ju expð − jkzs z0 Þexpðjkz0 zÞ expð −juðx0 − xÞÞ du, μ0 kzs + μs kz0  ðx,zÞ 2 Ω, ðx0 ,z0 Þ 2 D ð5:62Þ  Comparing Eq. (5.60) with Eqs. (5.61) and (5.62), the contribution to the electric scattered field of the z-component of the Fitzgerald vector can be rewritten as  THE JOINED CONTRIBUTION OF BOTH THE X- AND Z-COMPONENTS  8ð ð χm > > > > > < D 1 + χm Es2 ðx, zÞ = ð ð > χm > > > > : 1 + χm D  ∂E ∂Ge 2 = ks ∂x0 ∂x0 ∂E ∂Gi 2 = ks ∂x0 ∂x0  ðð D  ðð D  93    χm 1 ∂E ∂Ge , 1 + χ m ks2 ∂x0 ∂x0  z < 0,    χm 1 ∂E ∂Gi , 1 + χ m ks2 ∂x0 ∂x0  z>0  ð5:63Þ  5.4 THE JOINED CONTRIBUTION OF BOTH THE X- AND Z-COMPONENTS OF THE FITZGERALD VECTOR As already stated, this case can be dealt with as the superposition of the cases considered in Sections 5.2 and 5.3. Therefore, the comprehensive scattered field due to the buried magnetic anomalies is given by   8 ðð χm 1 ∂E > 2 > ks > 2 0 > k ∂x 1 + χ > m s < D Es ðx, zÞ =   > ð ð χm 1 ∂E > 2 > > ks > 2 : ∂x0 1 + χ m ks D   ∂Ge ∂E ∂Ge + dx0 dz0 , ∂x0 ∂z0 ∂z0  ∂Gi ∂E ∂Gi + dx0 dz0 , ∂x0 ∂z0 ∂z0  z < 0, ð5:64Þ z>0  which can be more compactly rewritten as 8 ðð   χm 1 > 2 > r0 Er0 Ge dx0 dz0 , k > s > 2 > 1 + χ k m < s D Es ðx,zÞ =   ðð > χm 1 > > r0 Er0 Gi dx0 dz0 , ks2 > > : 1 + χ m ks2  z < 0, ð5:65Þ z>0  D  where the gradient symbols have been primed to indicate that they are calculated with respect to the variables of integration x0 and z0 . Since the internal field is given by the sum of the incident and scattered internal fields, in the end the complete scattering equations for only magnetic targets are given by ðð E ðx,zÞ = Einc + ks2 D  ðð Es ðx, zÞ = ks2 D    χm 1 r0 Er0 Gi dx0 dz0 , 1 + χ m ks2    χm 1 r0 Er0 Ge dx0 dz0 , 1 + χ m ks2  z > 0,  z<0  ð5:66Þ  ð5:67Þ  THE 2D SCATTERING EQUATIONS FOR MAGNETIC TARGETS  94  5.5 THE CASE WITH BOTH DIELECTRIC AND MAGNETIC ANOMALIES In this chapter we have shown that the product of the magnetic field underground times the magnetic contrast of the buried target can be interpreted as an equivalent buried magnetic density of current (apart from the factor jω) radiating into a homogeneous half-space. Similarly, in Chapter 4 we showed that the product of the underground electric field times the dielectric contrast can be can as an equivalent electric density of current. As already stated, these two equivalent sources are usually labeled as secondary sources, whereas the real source of the field (i.e., the GPR antennas) are usually labeled as primary sources. Now, the scattered field (both underground and in air) depends on the primary sources only through the secondary ones. This implies that if we “forget” the presence of the primary sources for a while, the scattered field is only a function of the secondary sources. Now, any electric field is a linear function of its sources, and thus the comprehensive scattered field in the presence of both a magnetic and a dielectric contrast is given by the sum of the scattered fields obtained by each of the corresponding secondary sources, respectively. In formulas, this means in particular that the internal (underground) scattered field, which is equal to the internal electric field minus the internal incident field, is given by the sum of the contributions to it by the electric secondary sources [contribution given by Eq. (4.44)] and the magnetic secondary sources [contribution given by Eq. (5.66)]. The internal scattered field is therefore given by Eq. (5.68). ðð	 Es ðx, zÞ = ks2 D    1 χm 0 0 χ e EGi + 2 r Er Gi dx0 dz0 , ks 1 + χ m  z>0  ð5:68Þ  The total internal field is achieved by adding the internal incident field to the scattered internal field, thereby obtaining E ðx,zÞ = Einc ðx, zÞ + ks2    ðð	 1 χm χ e EGi + 2 r0 Er0 Gi dx0 dz0 , ks 1 + χ m  z>0  ð5:69Þ  D  Equation (5.69) is the internal scattering equation in the case of both dielectric and magnetic anomalies, or (which is the same) in the presence of targets with both dielectric and magnetic properties different from those of the embedding soil. From Eq. (5.69), we appreciate that, even if the Maxwell’s equations are linear with respect to the sources, the relationships between the contrasts and the internal field is not linear, and in particular the dielectric and magnetic contrasts interfere with each other, in the sense that the resulting internal field is not given by the sum of the internal field that we would separately have if only one kind of anomaly (dielectric or magnetic) were present. Once the internal field is given (of course implicitly, because Eq. (5.69) is an equation to be solved in order to retrieve the internal field versus the contrasts), the external scattered field can be retrieved. In fact, because of the linearity of the scattered  THE CASE WITH BOTH DIELECTRIC AND MAGNETIC ANOMALIES  95  field with respect to the secondary sources, the external scattered field is provided by the sum of the contributions of the electric secondary sources, given by Eq. (4.45), and the contribution of the magnetic secondary sources, given by Eq. (5.67). The result is Es ðx, zÞ = ks2    ðð	 1 χm 0 0 χ e EGe + 2 r Er Ge dx0 dz0 , ks 1 + χ m  z<0  ð5:70Þ  D  Equation (5.70) constitutes the external scattering equation in the general 2D case of both dielectric and magnetic anomalies. It is possible to include the characteristics of the antennas also in the case of magnetic targets, and this is done in the same way as revealed in Chapter 4. In fact, the incident field does not depend on the nature of buried anomalies, and the passage from the scattered field to the scattered voltage also does not depend on what kind of anomaly generated the gathered scattered field. Thus, in the more general case the expression of the incident field is given by Eq. (4.84) instead of Eq. (4.48), and the expression of the external Green’s function is given by Eq. (4.115) instead of Eq. (4.47), but Eqs. (5.69) and (5.70) remain formally the same.  QUESTIONS 1. Is the electric field solenoidal in any physical case? 2. Is the magnetic field solenoidal in any physical case? 3. Does the magnetic permeability of the targets interact with the dielectric permittivity for determining the incident field? 4. Does the magnetic permeability of the targets interact with the dielectric permittivity for determining the scattered field? 5. Does the magnetic permeability of the targets interact with the dielectric permittivity for determining the total field? 6. Is it theoretically possible to have a 2D geometry where the electric field is not parallel to the axis of invariance?  6 ILL-POSEDNESS AND NONLINEARITY  6.1  ELECTROMAGNETIC INVERSE SCATTERING  Electromagnetic inverse scattering is the branch of the science that studies how to reconstruct the electromagnetic characteristics of a given volume (e.g., its dielectric permittivity and/or electrical conductivity and/or magnetic permeability) starting from measurements of electric (and/or the magnetic) scattered field data, gathered outside the probed volume and generated by known sources. The reason why this problem is called “inverse” is historical, and it is due to the fact that it reverses the point of view with respect to another problem conventionally labeled as the “direct” or “forward” scattering problem. The direct (or forward) problem consists in the calculation of the field scattered from a known dielectric permittivity (and/or electrical conductivity and/or magnetic permeability) profile, under the radiation of electromagnetic waves radiated by known sources. The definitions of direct and inverse scattering problem, within the framework of the GPR prospecting, are explained with the aid of Figure 4.1. In particular, with reference to Figure 4.1, the direct scattering problem consists of the calculation of the scattered field if we know the underground scenario, whereas the inverse scattering problem consists in  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  96  NONLINEARITY  97  the reconstruction of the underground scenario if we know the scattered field. In both the direct and the inverse problem the characteristics of the antennas and of the soil are assumed to be known. Indeed, there are several inverse problems of interest, not only in electromagnetism but also in acoustics, in heat conduction and so on, and customarily the inverse problems present some additional difficulties with respect to the corresponding direct ones. In particular, unlike the direct ones, the inverse problems are usually ill-posed (Colton and Kress, 1992). Moreover, if the direct problem is nonlinear, also the corresponding inverse problem is nonlinear. In particular, the electromagnetic inverse scattering problem is both ill-posed and nonlinear.  6.2  ILL-POSEDNESS  Direct problems, and in particular the forward scattering problem, are customarily well-posed. Mathematically, this means that one has the guarantee that the solution exists, is unique, and has a continuous dependence on the data (Hadamard, 1923). The solution’s continuous dependence on the data involves the fact that a small (meant in a limit sense, i.e., infinitesimal) error on the data translates into a small error on the retrieved solution. Regarding the issue of the GPR prospecting, this means (for example) that a small error in the evaluation of the permittivity of the underground scenario will produce a small error in the evaluation of the scattered field. This condition is necessary (but not sufficient) in order to have a solution with a physical sense, because it is impossible to have completely error-free data. A problem is said to be “ill-posed” when at least one of the conditions for the well-posedness fails. With regard to inverse problem of the GPR data processing, the most relevant issue (and the only one that we will focus on) is the solution’s noncontinuous dependence on the data. This means that even a small error on the scattered field can reverse in a meaningful error in the reconstruction of the dielectric (conductive or magnetic) characteristics of the background scenario. Such being the case, one is tempted to say that an ill-posed problem does not make any physical sense, because it is impossible to retrieve any physically reliable solution. However, this difficulty is overcome by means of the regularization. To regularize a problem substantially means to renounce to look for its ideal “perfect” solution and to look instead for a suitable, not fully detailed but more robust, solution. The regularization is not a specific protocol written once and for all. There are endless possibilities and “degrees” of regularization, and one has to choose the regularization for the case at hand as a compromise between the exigencies to achieve a refined (not overregularized) and, at the same time, robust (not underregularized) solution. This is a key point, on which we will come back again.  6.3  NONLINEARITY  Any mathematical relationship R between two quantities is said to be linear when, for any two arguments x1 and x2 and for any two scalar quantities a and b, the following property holds:  ILL-POSEDNESS AND NONLINEARITY  98  Rðax1 + bx2 Þ = aRðx1 Þ + bRðx2 Þ  ð6:1Þ  Otherwise it is said to be nonlinear. The inversion of a nonlinear relationship is in general more difficult than the inversion of a linear relationship, because of the possible presence of false solutions or local minima (Persico et al., 2002). In order to introduce the problem of the local minima, let us consider a generic (nonlinear) equation: F ðxÞ = y  ð6:2Þ  Suppose also that we know a priori that Eq. (6.2) has a unique ideal (i.e., for error-free data) solution. Even under these hypotheses, in many problems of physical relevance (including the inversion of GPR data) we are not able to find this solution in a closed form, and we can’t even be sure to find an exact solution at all, because the actual data are not error-free. So, customarily one looks for a numerical solution, that is, the value of x that makes minimum the quantity |F(x) − y|2. In order to provide a graphical example regarding local minima, let us consider a case where F ðxÞ = 0:002x5 + 0:005x4 − 0:0585x3 − 0:08875x2 + 0:47725x + 0:25325 y = 0:05  ð6:3Þ  In this case, Eq. (6.2) reduces to 0:002x5 + 0:005x4 − 0:0585x3 − 0:08875x2 + 0:47725x + 0:25325 = 0:05  ð6:4Þ  Equation (6.4) cannot be solved in a closed form.1 Thus, we look for a least square solution, given by the value of the variable x that provides the minimum value of the quantity  2 jF ðxÞ− 0:05j2 = 0:002x5 + 0:005x4 − 0:0585x3 − 0:08875x2 + 0:47725x + 0:20325 ð6:5Þ In Figure 6.1 the graph of the cost function (6.5) is depicted. Being a function of a single variable, the absolute minimum point is approximately but immediately identified by eye; in the case at hand, it is about equal to −0.4. However, in the more general case of a function of several (possibly thousands) variables it is not possible to identify the global minimum among the local minima by eye. Thus, in the more general case, one looks for the minimum by making use of the gradient of the function2 in any point, and he/she “follows” the direction opposite to that of the gradient3 up to finding a point where the gradient is equal to zero. In this way, at a 1 The Abel–Ruffini theorem states that it is impossible to solve by radicals algebraic equations of the fifth or higher degree. 2  For a scalar function, the gradient reduces to the first derivative times the unitary vector directed along the x-axis. 3 More in general a direction depending on the gradient is followed (Press et al., 1987), but we will not include these specific aspects.  NONLINEARITY  99  0.4 0.35 0.3 0.25 y  0.2 0.15 0.1 0.05 0  * –5 LM1 –4  * –3 p1 –2  * –1 GM 0  * p0 1 x  * 2 p2  * 3 LM2 4  5  Figure 6.1. The graph of the cost function 6.5. Beyond the global minimum GM, there are two local minima LM1 and LM2.  certain point one reaches a minimum of the function. If the starting point of the procedure is in a suitable position (e.g., p0 in Figure 6.1), the procedure will produce the actual (global) minimum; but if the starting point is not “suitable” (e.g., p1 or p2 in Figure 6.1), the procedure will converge toward a local minimum, and this will be erroneously interpreted as the solution of the problem. The suitability of the starting point is not merely given by the distance between it and the global minimum; the question is whether the starting point lies or not in the “valley” of the global minimum, which is virtually never quantifiable a priori. The problem of the local minima can be mitigated by repeating the minimization procedure starting from several starting points, chosen and updated by means of stochastic criteria (Pastorino, 2010). In this way, it becomes more probable (at the price of an increased computational burden) that one of the achieved minima (of course the one that provides the smaller value of the cost function) is really the global minimum. Under either a deterministic or a statistical minimization procedure, a nonlinear approach can be computationally burdening, and this hinders the application of nonlinear approaches toward large-scale problems. In the framework of GPR data processing, often the problem at hand is a large-scale one (with respect to the involved wavelengths), and therefore approximated linear algorithms are exploited in most cases. In particular, the common migration algorithms are based on a linear approximation of the scattering equations, as will be shown in Chapter 10. Notwithstanding, it is important to be aware of the intrinsic nonlinearity of the inverse scattering problem. Let us explicitly note that the problem of the local minima is intrinsically related to the nonlinearity, because linear problems do not suffer the presence of local minima. To show this in a simple way, let us consider the linear function F(x) = ax, where a is some constant. In this case, the cost function to be minimized is quadratic, and its graph is a parabola with the concavity toward the positive side of the y-axis. Such a function does  ILL-POSEDNESS AND NONLINEARITY  100  not show any local minimum, and any starting point is suitable in order to look for its minimum numerically. Let us also note that not necessarily a nonlinear function produces a cost functional showing local minima. An immediate counterexample is given by the case F(x) = ax + b, where a and b are two constants, which is not a linear relationship. More in general, the research of conditions for the disappearing of the local minima within a nonlinear approach is itself an issue of scientific interest [see Persico et al. (2002) and references therein] because this makes more reliable (possibly also faster) the result of a numerical nonlinear inversion.  6.4 THE ILL-POSEDNESS OF THE INVERSE SCATTERING PROBLEM To show the ill-posedness of the electromagnetic inverse scattering problem at hand, let us provide some preliminary observations: 1. At each position, the incident field is a finite energy (square integrable) function, because the sources can radiate only a finite energy. 2. The internal field is a finite energy function too, because it is produced by the interaction of the finite energy incident field with a passive medium. 3. The internal and external Green’s functions are finite energy functions too, because (as has been shown in Chapter 4) they correspond to an equivalent field generated by impulsive (with finite energy) buried sources. Therefore, labeling as f any among the listed quantities, we have that +∞ ð +∞ ð 2 j f ðx0 ,z0 Þj dx0 dz0 is a finite quantity. Moreover, let us consider the following −∞ +∞  specific class of dielectric contrasts: ( 0 0  χ e ðx ,z Þ =  sin ðkxÞ sin ðkyÞ jx0 j < 1m, 0  0 < z0 < 1m  elsewhere  ð6:6Þ  where k is a spatial circular frequency. Let us now consider the limit value of the scattering equations when the oscillations of the contrast become faster and faster. To do this, let us first particularize the internal scattering Equation (4.44) to the case at hand: ð1 ð1 Eðx,xs , z,zs Þ = Einc ðx,xs , z,zs Þ + ks2 ðx, zÞ 2 D, ðxs ,zs Þ 2 Σ  −10  Gi ðx,x0 ,z,z0 ÞEðx0 ,xs ,z0 ,zs Þχ e ðx0 ,z0 Þ dx0 dz0 , ð6:7Þ  THE ILL-POSEDNESS OF THE INVERSE SCATTERING PROBLEM  101  We will now show that, when the oscillations of the contrast become faster and faster (i.e., for k ! ∞), the integral term in Eq. (6.7) vanishes. To accomplish this task, let us define a sequence of functions as follows (the functional dependence of the integrands are left implicit): E1 = Einc , ð1 ð1 E2 = Einc + ks2  Gi E1 χ e dx0 dz0 ,  −1 0  ð1 ð1 E3 = Einc + ks2  ð6:8Þ  Gi E2 χ e dx0 dz0 ,  −1 0  …  ð1 ð1  En = Einc + ks2  Gi En− 1 χ e dx0 dz0  −1 0  Clearly, if this sequence converges, its limit is the internal field. In this case, the limit value of the sequence (6.8) can be also rewritten as the sum of the following series: ð1 ð1 E = Einc + ks2 ð1 ð1  Gi Einc χ e dx0 dz0  −10 0  Gi χ e dx dz  + ks4 −10 ð1 ð1  0  Gi χ e dx dz  + ks6 −10  ð1 ð1    + ks2n  0  0  ð1 ð1  Gi Einc χ e dx00 dz00  −10 ð1 ð1  00  Gi χ e dx dz −10  Gi χ e dx0 dz0  −1 0  ð1 ð1  00  ð1 ð1 −1 0  Gi χ e dx00 dz00    −10  000  000  Gi Einc χ e dx dz + ð1 ð1 Gi Einc χ e dx n dz n +    ð6:9Þ  −1 0  For simplicity of notation, the functional dependence has been left implicit in Eq. (6.9). In order to specify it, let us note that the observation point of the subsequent nested integral becomes the integration variable of the previous integral. For example, the second integral term is extendedly written as ð1 ð1  0 0  0 0  0  Gi ðx, z,x ,z Þχ e ðx ,z Þ dx dz  ks4 −1 0  and so on  0  ð1 ð1 −1 0  Gi ðx0 ,z0 ,x00 ,z00 ÞEinc ðx00 ,z00 Þχ e ðx00 ,z00 Þ dx00 dz00 ð6:10Þ  ILL-POSEDNESS AND NONLINEARITY  102  Equation (6.9) expresses the so-called Born series of the field (Born and Wolf, 1999) in the case at hand. ð1 ð1 2 Let us now consider the first integral term ks Gi Einc χ e dx0 dz0. Its integrand is −1 0  composed of the contrast times a square integrable function independent from it. Therefore, this integral vanishes for k ! ∞ (it’s the same principle underlying the stationary phase method illustrated in Chapter 4). Consequently, for any small positive and dimensionless ε we can find a value of k high enough to guarantee  1 1   ðð   2  V that ks Gi Einc χ e dx0 dz0 < ε × 1 . m   −1 0  ð1 ð1  Let us now consider the integral term  ks4  0  Gi χ e dx dz  0  ð1 ð1  Gi Einc χ e dx00 dz00. It’s  −1 0  1 1  −1 0  ðð    V Gi χ e dx0 dz0 × 1 , and we can find a value of k modulus is smaller than εks2 m   −1 0  that (further than the previous inequality) also guarantees the inequality  1 1   1 1   ðð  ðð   ð1 ð1  2    0 0 0 0 00 00  4 k  Gi χ e dx dz  < ε. This guarantees that ks Gi χ e dx dz Gi Einc χ e dx dz   s     −1 0  −1 0  −1 0  V < ε × 1 . At this point, it is easily shown iteratively that the same k guarantees that m 2  jEn − Einc j < 1   V  × ε + ε2 + ε3 +   + ε n m  ð6:11Þ  Passing to the limit value, we have  jE ∞ − Einc j ≤ 1  +∞ X  V  V V ε × ε + ε2 + ε3 +   = 1 × ε εn = 1 × m m n=0 m 1− ε  ð6:12Þ  where in Eq. (6.12) we have substituted the sum of the geometrical series of common ratio ε. Given the arbitrary level of ε, Eq. (6.12) shows that, in the limit case at hand, the Born series converges uniformly and the final result in the limit for k ! + ∞ is E = Einc, which is to say that very fast oscillating and limited contrasts are transparent to the radiation or, equivalently, the internal field cannot “follow” any contrast variation. The reasoning could be repeated also with a contrast given by the sum of a “slow varying” contrast and a fast oscillating contrast, and in the limit we would determine that the internal field is influenced only by the “slowly varying” portion of the contrast profile.  THE NONLINEARITY OF THE INVERSE SCATTERING PROBLEM  103  Substituting E = Einc in the external scattering equation [see Eq. (4.45)], we have ð1 ð1 Es ≈ks2  Ge Einc χ e dx0 dz0  ð6:13Þ  −1 0  At this point, since both the external Green’s function and the incident field square integrable functions are independent from the contrast, we have that in the limit for k ! ∞ the contrast χ e produces a null scattered field; that is, it represents an invisible target. Now, any square integrable contrast target can be expanded, within the investigation domain D, along its Fourier series, and so any target can be generically seen as composed by a slow varying part plus a fast varying part. We have shown that at a certain point the fast oscillating part becomes more and more transparent, and in the considered limit completely transparent, and consequently it becomes more and more difficult (because of the uncertainties on the data) and eventually impossible to retrieve it. This demonstrates that the inverse scattering problem at hand is ill-posed, and it also shows that the ill-posedness involves the impossibility to retrieve all the details of the buried scenario. For a wider and deeper dealing about the ill-posedness, the interested reader is referred to Colton and Kress, (1992), Tikhonov and Arsenine (1977), and Kirsh (1996). In particular, let us clearly say that the invisible targets are not necessarily only those oscillating in a fast way, even if this is probably the aspect of main interest in the framework of GPR prospecting.  6.5 THE NONLINEARITY OF THE INVERSE SCATTERING PROBLEM The nonlinearity of the problem can immediately be shown. In fact, the electric field inside the investigation domain depends on the contrast, due to Eq. (4.44). Consequently, if in Eq. (4.44) the contrast is multiplied times any constant, the scattered field will be not just be multiplied for the same constant, because the internal field has changed too, and so Eq. (6.1) does not hold. Physically, the nonlinearity is due to the electromagnetic interferences among the scattering objects embedded in the soil, which makes the internal field change in accordance with them; we will explain this more completely in Chapter 8.  QUESTIONS 1. In this chapter the Born series has been introduced. Does a truncation of the series at the second order necessarily provide a better approximation of the field with respect to one at the first order? And if this happens, does the truncation at the third order necessarily provide a still better approximation of the field?  104  ILL-POSEDNESS AND NONLINEARITY  2. Is the scattered field due to two imposed density currents radiating at the same time given by the sum of the scattered fields achieved under the radiation of any of the sources independently from the other one? 3. Is the scattered field due to two antennas radiating at the same time given by the sum of the scattered fields achieved under the radiation of any of the sources independently from the other one? 4. Is the scattered field due to two targets illuminated at the same time given by the sum of the scattered fields achieved from each of the two targets independently from the other one? 5. Does the distance between two targets make weaker the nonlinear effects? 6. Do the losses in the soil make weaker the nonlinear effects?  7 EXTRACTION OF THE SCATTERED FIELD DATA FROM THE GPR DATA  7.1  ZERO TIMING  Before extracting the scattered field data, we have to first discuss the problem of the zero timing. In particular, the choice of the zero time is a problem arising from a physical constraint, namely the fact that any GPR system has a finite band and, consequently, it cannot radiate or receive “correctly” an impulse with an immediate rising up. Moreover, there is necessarily some propagation of the signal inside the instrument before the impulse is “launched” outside. So, there is a delay between the time instant when the generator begins to produce the impulse and the time instant when the propagation of the signal in the external environment begins. This problem involves both real and synthetic pulses—this is, both impulsive and stepped frequency systems. The practical consequence is that we have to choose, on the basis of the received data, the moment when we assume that the signal was launched outside from the GPR system, which is the also the reference origin of the time for each trace (Yelf, 2004). This operation is called zero timing and necessarily involves some degree of arbitrariness. The zero timing is important, because it influences the retrieving of the time depth of the targets and formally also the evaluation of the propagation  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  105  EXTRACTION OF THE SCATTERED FIELD DATA FROM THE GPR DATA  Level (arbitrary units)  106  4000 2000 0 –2000  0  0.5  1  1.5  2  2.5  3  3.5 ×10–8  2  2.5  3  3.5 ×10–8  Level (arbitrary units)  t (sec) 4000 2000 0 –2000  0  0.5  1  1.5 t (sec)  Figure 7.1. Example of zero timing on a GPR trace simulated with the code GPRmax. The upper panel shows the trace as it comes out, and the lower panel shows the zero timed trace. The bottom scale is 35 ns, but it reduces to 32.9 for the zero timed trace. The source is a Ricker pulse with central frequency 500 MHz. The source is in contact with a soil that shows a relative permittivity εsr = 5 and an electric conductivity σ = 0.001 S/m and with no magnetic properties.  velocity of the waves. In particular, a different choice of the zero time corresponds to a rigid shift of the diffraction curves along the t-axis, which amounts to an alteration of the retrieved value of propagation velocity, as is easily understood from Chapter 2. In turn, an incorrect evaluation of the electromagnetic characteristics of the soil affects the retrieved depth of the targets as well as the result of any focusing algorithm, because these characteristics enter as parameters in the scattering equations (see Chapters 4 and 5). A common (and generally reasonable) choice is to fix the zero time at the first maximum modulus of the received signal, so that we gate out all the energy received before this instant. Actually, the value of this maximum changes from trace to trace, even if the height of the antennas is kept constant along the B-scan, because of clutter and noise. However, the relative discrepancies are usually minimal, and a heuristic average value of the time of this maximum is sufficiently accurate in most cases. Figure 7.1 shows the result of such a gating on simulated data.  7.2  MUTING OF INTERFACE CONTRIBUTIONS  After the preliminary zero timing, the datum observed in the observation point is the voltage related to the total field in that point, which is roughly proportional to the total field in that point.  MUTING OF INTERFACE CONTRIBUTIONS  107  Eventually, we can therefore write the datum in the time domain as E ðx, t Þ = Einc ðx, t Þ + Es ðx,t Þ  ð7:1Þ  or equivalently we can write the datum in frequency domain as E ðx, ωÞ = Einc ðx, ωÞ + Es ðx, ωÞ  ð7:2Þ  Equation (7.1) or (7.2) accounts for the fact that the height of the data is usually a fixed parameter, not varied along the scan. The data in time and in frequency domain are linked by Fourier direct or inverse transforms; but we have not made use of hat symbols, which have been reserved for the Fourier transforms with respect to the spatial variables. Now, the data that we want to process are the scattered field data, that is, the Es quantities. In fact, as shown by means of the scattering equations, the contrasts (i.e., the buried targets) are specifically related to the scattered field data and not to the total field data. In Chapter 4 we have provided expressions for the incident field both in the case of a filamentary current and in the case of a source characterized by a given plane wave spectrum. So, one might think of subtracting the calculated incident field data from the measured total field data. This operation is mathematically correct, but is not robust against the uncertainties present with regard to both the properties of the soil and the characteristics of the transmitting antenna (Persico and Soldovieri, 2006). In order to show this, an exercise is now proposed, with data simulated with GPRMAX2D. In particular, a 30 × 30 cm2 cavity is buried at the depth of 1 m in a lossless nonmagnetic soil with relative permittivity εs = 5ε0. The source is a Ricker pulse with central frequency 500 MHz; it is moved along a path 2.5 m long, centered on the target, at height 30 cm above the air–soil interface, with a spatial step of 5 cm. The offset between the source and the observation point is equal to zero. Figure 7.2a shows the total field result; as can be seen, the diffraction curve is almost invisible. In fact, as often happens, the contribution of the incident field is quite stronger than that of the scattered field and masks it. The result of the subtraction of the incident field from the total one without any uncertainties on the data is shown in Figure 7.2b. To do this, the total and the incident field have been calculated in two distinct simulations, the second of which differs from the first one only for the absence of the buried target. This result shows the diffraction curve in a clear fashion. However, the procedure has worked because we have implicitly assumed that we have a perfect knowledge of the characteristics of the soil, of the source, and of the receiver, so that we could model the incident field perfectly. In real cases we don’t have a perfect knowledge of any among the involved parameters, and so a reliable and precise calculation of the incident field is not a trivial matter. In order to simulate the effect of the uncertainties, the incident field has been calculated a second time for a soil with relative permittivity equal to 5.35 instead of 5. Moreover, the amplitude of the Ricker source has been changed times a factor 1.05 and the central frequency has been shifted at 502 MHz. Then, we have subtracted this incident field to the total field data of Figure 7.2a. In this way, we have simulated an uncertainty about the permittivity, the intensity of the source, and the central frequency. The result is shown in Figure 7.2c, and it clearly shows that the involved uncertainties meaningfully  EXTRACTION OF THE SCATTERED FIELD DATA FROM THE GPR DATA  108  (a)  (b) 0  × 10–8  0 1 t [sec]  1 t [sec]  × 10–8  2  2 3  3  4  4 0  0.25  0.5  0.75  1  0  1.25  0.25  (c)  0.75  1  1.25  1  1.25  (d) 0  × 10–8  0  × 10–8  1 t [sec]  1 t [sec]  0.5  x [m]  x [m]  2  2  3  3  4  4 0  0.25  0.5  0.75  x [m]  1  1.25  0  0.25  0.5  0.75  x [m]  Figure 7.2. Panel a: Total field data. Panel b: Scattered field data worked out by the difference between the total and the incident field data with no parametric uncertainty. Panel c: Scattered field data worked out by the difference between the total and the incident field data with some parametric uncertainty. Panel d: Scattered field data worked out by muting. In all the panels the data have been previously zero-timed at the first maximum of the received total field data.  mask the buried targets. Let us also emphasize that the introduced errors are minimal with respect to realistic situations: and, in particular, no clutter due to the surface roughness has been synthesized, and there is no uncertainty about the kind of radiated pulse and about the antenna pattern, which further enforces the statement. In Figure 7.2d, instead, we have muted (i.e., we have put equal to zero) the received signal up to the second horizontal band visible in Figure 7.2a. In fact, the first (shallower) horizontal band is due to the direct coupling between the source and the receiver, whereas the second (deeper) one is due to the reflection of the signal from the air–soil interface. If the antennas are moved in common offset at the air–soil interface (in the presented example they are instead at 30 cm from the air–soil interface), these two signals are generally superposed and indistinguishable from each other.  MUTING OF INTERFACE CONTRIBUTIONS  109  In the absence of buried targets, the gathered datum would consist exclusively of these horizontal bands, which is to say that the two horizontal belts are essentially the incident field data. More in general, in the case of any layered medium (and in particular in the case of a masonry) the incident field data amount to several quasi-horizontal bands, caused either by horizontal physical interfaces or by obstacles that move synchronically with the antennas (e.g., a trolley or a car or the same human operator). Finally, a further possible cause of horizontal bands is some undesired reflection of the currents within the arms of the antenna, which is known as ringing (Daniels, 2004). Whatever the cause, these bands might be erased from the data by trivially muting them. However, in this way, we pay the price to erase, partially or totally, also the signal scattered by targets located within those belts. So, there is some trade-off between the “pureness” of the scattered field worked out and the range of depths filtered out. The optimal choice for the thickness of the erased time-belts is, in general, case-dependent and, in particular, depends on the band of the antennas and on the depth range of the targets of interest. In the end, the muting of the interfaces can be seen as an imperfect filtering of the incident field. This muting damps down a little share of the scattered field and preserves some “tail” of the incident field; this is a price to pay in order to have a more robust procedure with respect to a formal subtraction of the incident field form the total one. As said, in Figure 7.2d the result of the muting is shown. As can be seen, the results of Figures 7.2d and 7.2b differ only by a weak residual horizontal band.1 Another theoretical possibility might be to gather a B-scan in an area where no meaningful buried target is registered. In this way, we would have a measured version of the incident field to be subtracted from the total field. However, also this procedure is not robust against the uncertainties on the characteristics of the soil. In particular, it is virtually impossible to have at one’s disposal (unless in a test site built up on purpose) a B-scan where one gathers only the interfaces (and the same interfaces of a B-scan that has to be processed) under the same characteristics of the soil, the same surface roughness, and so on. Indeed, in microwave imaging there are cases where the scattered field data can be reliably achieved experimentally by subtraction of an incident field measured apart. This happens, in particular, when the structure to be probed is a mobile opaque body. In fact, in such a situation we can perform two measurements with the antennas in the same position, one in the presence of the body and another one after removing it, which provides experimentally and rigorously the incident field data (Otto and Chew, 1994). The “trick” is that in such a case we are assuming that the air is the (homogeneous) background medium, and so we don’t have any meaningful uncertainty about it (in GPR applications it can be assimilated to the free space all the times). In the case of GPR prospecting, instead, the background medium is commonly chosen as the air–soil couple of half-spaces, and so we cannot remove the investigation domain in order to measure the incident field. Going on in this theoretical speculation, at this point let us also say that we might think of assimilating the underground zone to be investigated to a “big box”containing the targets of interest and comprehensively embedded in air. 1 Actually, in Figure 7.2d, also two oblique “X”-shaped lines are visible, but this a mere numerical effect due to the limitedness of the simulated domain.  110  EXTRACTION OF THE SCATTERED FIELD DATA FROM THE GPR DATA  So, we might retrieve the incident field, measuring it in air—that is, making the antennas radiate and receive in the same relative positions but without any obstacle. There is nothing formally incorrect in assuming that the air (instead of the air–soil couple) is the background medium also in the case of GPR data. However, under such a choice, the quantity to be reconstructed would not be constituted by the buried targets, but rather by the investigated “soil box” with inside the targets of interest. In other words, the soil itself would compose the contrast (with respect to the air) to be reconstructed. It is intuitive (but in the next chapter this will be formalized more completely), that in this way the quantity to be retrieved is somehow “farther” from the background medium with respect to the quantity achieved under the choice of the air–soil couple as background medium. This can cause problems in relationship with the intrinsic nonlinearity of the scattering phenomenon, as will be shown in the next chapter. Therefore, the common praxis in GPR data processing is to refer to a background medium composed by a couple of half-spaces. That said, in order to give a rough quantification of the targets erased by the muting, we have to quantify the thickness of the “horizontal bands” related to the incident field. In general, they depend on the frequency band of the signal and on the propagation velocity of the waves. In particular, physically, the thickness of the horizontal band is essentially the “spatial duration” of the propagating pulses. Therefore, it is given by the temporal duration of the pulse times the propagation velocity in the soil divided by two (because of the round-trip). The temporal duration of the pulse is roughly given by the inverse of its band or, still more roughly (see Chapter 3), by the inverse of its central frequency. So, by restricting our attention to the case of a homogeneous soil, all the targets shallower than c Dmin = ð7:3Þ 2B will be meaningfully erased, where B is the band of the antennas. It is often reported that a large band is desirable in order to have a good resolution. From Eq. (7.3), we can appreciate that a large band can also reduce the drawbacks related to the muting of the interface.  7.3  THE DIFFERENTIAL CONFIGURATION  There are alternative possibilities to the muting of the horizontal bands, in order to extract scattered field data from the total field data. One of them is to make use of a differential configuration (Gurel and Oguz, 2003; Persico and Soldovieri, 2006). It consists in assuming as datum the difference between the total field gathered at two different positions with an opposite offset with respect to the source. In other words, if xs is the position of the source and Δ is a fixed offset, then the datum is given by ΔE = E ðxs + Δ, t Þ − E ðxs − Δ, t Þ or, in the frequency domain  ð7:4Þ  THE BACKGROUND REMOVAL  ΔE = E ðxs + Δ, ωÞ − Eðxs − Δ, ωÞ  111  ð7:5Þ  at variance of xs. The differential configuration can be also implemented dually with two transmitting antennas and a receiving one in the middle point between them, with the two transmitted signals equal in shape and amplitude but reversed in phase. In a layered medium, and in particular in a homogeneous half-space, the incident field is constant along xs, and so it is immediate to see that the difference between the total field in the two symmetrical points reduces to the difference between the scattered fields in those two points.2 In this way, we have erased the contribution of the incident field without needing any muting. This has the advantage that we don’t erase the targets embedded in the horizontal belts, and in particular we don’t erase the shallowest targets. However, the achieved datum is not any longer the scattered field but the differential scattered field in the observation point, given by ΔE = Es ðxs + Δ, t Þ − Es ðxs − Δ, t Þ  ð7:6Þ  ΔE = Es ðxs + Δ, ωÞ − Es ðxs − Δ, ωÞ  ð7:7Þ  or in the frequency domain  This implies that the mathematical model to achieve the reconstruction should change too. In other words, the scattering operator at hand changes and has different mathematical properties. In Chapter 9, we will show that this somehow worsens the ill-posedness of the inverse scattering problem.  7.4  THE BACKGROUND REMOVAL  Another possibility is that of applying a background removal (BKGR). The background removal is a well-known procedure in geophysics (Daniels, 2004; Conyers, 2004; Jol, 2009). However, it is rarely thought that, in terms of physics-mathematics, it can be viewed as a heuristic way to filter out the contribution of the incident field from the data (Persico and Soldovieri, 2008; Persico and Soldovieri, 2010). The reasoning that shows this is substantially the same shown with regard to the differential configuration. In fact, let us consider a BKGR with moving average: It consists in taking as datum the difference between the current trace and the average value of a set of traces symmetrically centered around the current one. So, let us suppose that the averaging is performed on 2N + 1 traces, starting from the Nth traces before the current one and ending at the Nth traces after the current one. Let us label as s the spatial step of the measurements. So, the datum is given by  2 Indeed, the roughness of the interface does not make this statement rigorous, but the discrepancy is usually marginal on the spatial scale of a reasonable offset (expected to be of the order of 10 cm)  EXTRACTION OF THE SCATTERED FIELD DATA FROM THE GPR DATA  112  Eb ðx,t Þ = E ðx, t Þ −  N 1 X Eðx − ns, t Þ 2N + 1 n = − N  ð7:8Þ  N 1 X Eðx − ns, ωÞ 2N + 1 n = − N  ð7:9Þ  In the time domain, or alternatively Eb ðx, ωÞ = Eðx, ωÞ −  in the frequency domain. The subscript b stands for background removal. Again, considering the incident field invariant along the horizontal abscissa, the contribution of the incident field to the average trace and to the current trace are the same and so they erase each other, and the result is rewritten as Eb ðx, t Þ = Es ðx, t Þ −  N 1 X Es ðx − ns, t Þ 2N + 1 n = − N  ð7:10Þ  N 1 X Es ðx − ns,ωÞ 2N + 1 n = − N  ð7:11Þ  In the time domain or Eb ðx, ωÞ = Es ðx, ωÞ −  in the frequency domain. BKGR is automatically implementable by several commercial software. Often, one can choose either the number of traces or the “horizontal extension” to be averaged—that is, the distance between the first and the last averaged traces. The two quantities are related to each other, because this distance is equal to 2Ns. The definition of BKGR presents a problem with regard to both the initial trace and to final trace. In fact, for example, when considering the first trace of the GPR scan, of course we don’t have N traces before it, and when considering the last one we don’t have N further traces beyond it. So, an artificial prolongation (implicit or explicit) of the B-scan is needed both before its beginning and beyond its end.3 To this pros, several choices are possible, and in general the best choice depends on the situation at hand. One of the possible choices is to place M times the comprehensive average trace of the whole B-scan before the B-scan and M times the same average trace after the B-scan, where M is the total number of traces of the gathered B-scan. In this way, we create an equivalent B-scan three times longer than the actual one. At this point, if one performs a mobile averaging on 2M + 1 traces on the real B-scan, it can be checked that the result is equal to the well-known background removal procedure performed on all the traces—this is, a background removal where the datum is given by the current traces minus the average of all the traces. This shows that the background removal on all 3 Alternatively, one should avoid reconstructing the scenario under the first and last part of the gathered B-scan, but this is never convenient.  THE BACKGROUND REMOVAL  113  the traces is substantially a particular case of the BKGR with moving average, and so the properties that we will investigate about the moving average background removal procedure hold also in the case of BKGR on all the traces. Similar to the differential configuration, BKGR can be implemented in either the time domain or the frequency domain, and it is a way to filter out the incident field without erasing the targets embedded in the horizontal bands related to the layers present in the raw data. Moreover, again similar to the differential configuration, BKGR erases the constant returns from any target that moves together with the antennas. Of course, also this time the returned datum is not the scattered field in the observation point but rather a function of the scattered field in the observation point, and this changes the mathematical properties of the scattering operator, as will be shown in Chapter 9. In particular, we will show that the properties of the scattering operator get somehow worsened also in this case (again similarly to the differential configuration). In the end, this means that the possibility to erase horizontal belts without erasing the targets inside them has some price in terms of resolution capabilities of the scattering operator. An important difference between the differential datum and the BKGR datum is that the first one is conceived as associated to a specific hardware, whereas BKGR is a procedure that can be applied on the usual common offset data. In particular, we can think of applying the background removal only within certain time intervals (which is impossible with a differential configuration), in order to erase the horizontal band while “saving” the targets embedded in them and, at the same time, keeping to a heuristic minimum the modifications of the scattering operator. An example of BKGR is shown in Figure 7.3, where the diffraction hyperbola relative to a small reflector is shown. The target is a square object that is built with a perfect electric conductor, sized 5 × 5 cm2 and buried at the depth of 1 m. The medium is a homogeneous soil with relative permittivity equal to 5 and electrical conductivity equal to 0.01 S/m. The data have been simulated with the GPRMAX code. The observation line is 2.5 m long and is at a height of 1 cm. The spatial step is 2.5 cm. The offset between source and observation point is zero. The source is a Ricker pulse with central frequency 500 MHz. In particular, in panel a, the diffraction hyperbola achieved after muting of the first 5 ns is represented; in panel b, the homologous quantity achieved from BKGR on all the traces is shown. In panel c the homologous quantity achieved from BKGR with mobile averaging on 9 traces is depicted; in panel d the homologous quantity achieved from BKGR performed on all the traces but only on the first 5 ns is shown. Figure 7.3 shows that the background removal can be done in several ways, each of which can have some pros and some cons. In particular, the background removal on all the traces (panel 2) erases the spurious interface generated by an abrupt muting but generates a spurious flat interface in correspondence to the top of the diffraction hyperbola. This is because the high level of the signal in the target point is able to change the level of the comprehensive average trace at that time instant. This can also be viewed as an effect of the limitedness of the observation line. In fact, if the BKGR is done on a longer and longer observation line, this effect is expected to be progressively weaker. This effect is usually easily recognized, because the lines generated by it are too straight to be ascribable to a real target. Notwithstanding, this effect might mask some weak target at the same time depth of the strong reflection. A BKGR with a moving average doesn’t show this drawback,  EXTRACTION OF THE SCATTERED FIELD DATA FROM THE GPR DATA  114  because the limitedness of the averaging line confines to a local effect this possible spreading. This is clear from panel c, where a moving BKGR on nine traces (corresponding to an averaging length of 20 cm) is shown. However, from panel c, it is also evident that the top of the diffraction hyperbola gets partially erased. This is becaues the top is the most flat part of the curve, so that the averaged traces are quite similar to each other and erase with the central one while performing the moving average BKGR. Finally, panel d shows the diffraction hyperbola achieved by a BKGR performed only on the first 5 ns of all the traces. In this case the result is very similar to that of panel a. However, unlike the simple “muting,” if we had had a target in the first 5 ns, in the case of Figure 7.3d the BKGR would not erase it. So, in the case at hand, the solution of panel d seems to be a good compromise between the contrasting exigencies to minimize the distortion of the data and to avoid the erasing of shallow targets.  (a) 0  (b)  × 10–8  0 1 t [sec]  t [sec]  1  × 10–8  2  2  3  3  4  4 0  0.25  0.5  0.75  1  1.25  0  0.25  x [m]  (c) 0  0.75  1  1.25  1  1.25  x [m]  (d)  × 10–8  0  × 10–8  1 t [sec]  1 t [sec]  0.5  2 3  2 3  4  4 0  0.25  0.5  0.75  1  1.25  0  x [m]  0.25  0.5  0.75  x [m]  Figure 7.3. Panel a: The diffraction hyperbola achieved after muting of the first 5 ns. Panel b: The same quantity achieved from BKGR on all the traces. Panel c: The same quantity achieved from BKGR with mobile averaging on 9 traces. Panel d: The same quantity achieved from BKGR performed on all the traces but only on the first 5 ns.  THE BACKGROUND REMOVAL  115  QUESTIONS 1. Is it necessarily well-advised to process data gathered with a stepped-frequency GPR system entirely in frequency domain? 2. Can the interface muting be performed in frequency domain? 3. Let us suppose that we have to perform a background removal on N traces, for any fixed N. Is a positive effect expected if the spatial step is made progressively narrower? 4. Let us suppose that we have to perform a background removal on N traces, for any fixed N. Is a positive effect expected if the spatial step is made progressively larger? 5. Does the interface muting provide a rigorous calculation of the scattered field? 6. In the case of a homogeneous soil, do the background removal and/or the differential configuration provide a quantity rigorously independent from the incident field?  8 THE BORN APPROXIMATION  8.1  THE CLASSICAL BORN APPROXIMATION  In Chapter 6, we have introduced the Born series of the scattering operator, even if in a specific case and not in its more general form. The basis for the construction of this Born series was given in Eq. (6.8) with regard to the case of nonmagnetic anomalies. The sequence provided in Eq. (6.8) can be written in a more general (i.e., for any dielectric contrast) and complete form as follows: E1 ðxs ,x, zÞ = Einc ðxs ,x,zÞ,  ðð  E2 ðxs , x, zÞ = Einc ðxs ,x,zÞ + ks2  Gi ðx,z,x0 ,z0 ÞE1 ðxs ,x0 ,z0 Þχ e ðx0 ,z0 Þ dx0 dz0 ,  D  ðð E3 ðxs , x, zÞ = Einc ðxs ,x,zÞ + ks2 …  ð8:1Þ  Gi ðx,z,x0 ,z0 ÞE2 ðxs ,x0 ,z0 Þχ e ðx0 ,z0 Þ dx0 dz0 ,  D  ðð  En ðxs , x, zÞ = Einc ðxs , x, zÞ + ks2  Gi ðx, z,x0 ,z0 ÞEn− 1 ðxs ,x0 ,z0 Þχ e ðx0 ,z0 Þ dx0 dz0 ,  z>0  D  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  116  THE CLASSICAL BORN APPROXIMATION  117  where D is the investigation domain and xs is the source point. If the Born sequence (8.1) converges, its limit point is the internal field by virtue of Eq. (4.44). Analogously to the particular case examined in chapter 6, the Born sequence for the internal field, as any sequence, can be put in the form of a series as follows: ðð 2 E = Einc + ks Gi Einc χ e dx0 dz0 ðð + ks4  D  Gi Einc χ e dx0 dz0  D  Gi Einc χ e dx00 dz00  D  ðð  0  Gi Einc χ e dx dz  + ks6  ðð  D  00  Gi Einc χ e dx dz D  ðð    + ks2n  0  ðð  0  Gi Einc χ e dx dz D  0  ðð  00  ðð  000  000  Gi Einc χ e dx dz +   D  00  Gi Einc χ e dx dz00    D  ðð Gi Einc χ e dx n dz n +  ,  z>0  D  ð8:2Þ Analogously to Eq. (6.9), in Eq. (8.2) all the functional dependences of the nested integrands have been dropped out in order to not over-prolong the expression. Being bi-univocally related to the Born sequence, the Born series for the internal field does not necessarily converge. Incidentally, some conditions for the convergence1 have been studied (D’Urso et al., 2007), but they are beyond the purposes of this text and will not be dealt with here. Substituting the Born series for the internal field into the external scattering equation [see Eq. (4.45)], we achieve the Born series for the scattered field, given by ðð ðð ðð Es = ks2 χ e Einc Ge dx0 dz0 + ks4 χ G dx0 dz0 G E χ dx00 dz00 + e i inc e  D  ðð  + ks2n + 2 D  D  χ e Ge dx0 dz0  ðð  e  D  Gi Einc χ e dx00 dz00    D  ðð Gi Einc χ e dx n + 1 dz n + 1 +  ,  z<0  D  ð8:3Þ Analogously to the Born series for the internal field, there is no general guarantee for the convergence of the Born series for the scattered field. In any case, the first term of this sequence provides the first-order Born Approximation (BA) for the scattered field, which is commonly just reported as the BA (Chew, 1995; Born and Wolf, 1999). Expanding the expression in order to make clear the functional dependences, under the BA the external scattering equation becomes ðð Es ðxs ,ωÞ = ks2 χ e ðx0 ,z0 ÞEinc ðx0 ,xs ,z0 ; ωÞGe ðx0 , x0 = xs + Δ, z0 ;ωÞ dx0 dz0, ðxs , xo Þ 2 Σ D  ð8:4Þ 1  The convergence is meant in the least square sense.  THE BORN APPROXIMATION  118  Equation (8.4) also accounts for a common offset configuration where the observation point and the source point are separated by a fixed offset Δ and the height of the data is a fixed parameter too. Under the BA, it is immediate that the scattering is approximated as a linear phenomenon, which poses the basis for faster and easier processing algorithms with respect to the actual nonlinear model, and of course a linear model is immune from the problem of the local minima. Moreover, as will be shown, BA allows a noticeable insight about the characteristics of the expected results, essentially based on the spatial filtering properties of the linear scattering operator. From a physical point of view, the BA amounts to neglect the mutual interactions between any two different buried targets or (which is mathematically the same) between any two different parts of the same target. The situation can be pictorially explained by means of Figure 8.1. In particular, let us regard A and B as two very small targets, so that we can assume that each of them, in the absence of the other one, would provide a scattered field given by Eq. (8.4), where the contrast is a function that describes each of the two targets in turn. In fact, if the target is very small, the integral term in Eq. (4.44) can be regarded as a negligible perturbation with respect to the incident field, because the contrast is a low norm function. However, if the two targets are present at the same time (so that the contrast is given by the sum of the contrasts relative to each of the two targets separately considered), they interact with each other, and consequently the comprehensive scattered field is not simply given by the sum of the scattered field that each of them would produce in absence of the other. This interaction is the physical genesis of the nonlinearity, because it makes the internal total field different from the internal incident field.  Tx  Rx Air Soil  A  B  Figure 8.1. Schematic for the physical reason of the nonlinearity of the scattering. The black arrows represent the direct contributions of the two small buried targets separately considered. The red arrows represent the contribution of the mutual interaction between A and B to the scattered field. For color detail, please see color plate section.  THE BORN APPROXIMATION IN THE PRESENCE OF MAGNETIC TARGETS  119  8.2 THE BORN APPROXIMATION IN THE PRESENCE OF MAGNETIC TARGETS From the complete internal scattering equations (5.69), we retrieve immediately that the BA in the more general case of both dielectric and magnetic targets requires a formally more restrictive condition with respect to the classical BA for only dielectric targets. In particular, with regard to the internal field, it is now required (Persico and Soldovieri, 2011) that we have E ðx, zÞ ≈Einc ðx, zÞ, r0 Eðx0 ,z0 Þ ≈rEinc ðx0 ,z0 Þ,  ðx0 ,z0 Þ 2 D, ðx0 ,z0 Þ 2 D  ð8:5Þ ð8:6Þ  where the symbols are in agreement with those adopted in the scattering equations provided in Chapters 4 and 5.2 Indeed, an intriguing theoretical question arises whether Eq. (8.6) is a direct consequence of Eq. (8.5) or is a really further independent condition [or whether (8.6) can be derived from (8.5) under some further wide hypotheses]. In particular, if the incident field is regarded as just a function, it is well known that the approximation (8.6) cannot be derived as a consequence of the approximation (8.5), because two quantities might be very close to each other (e.g., in the least square sense) and notwithstanding their derivatives might be very different from each other. However, the incident field is not a generic function, because it is a solution of the Maxwell’s equations, which represents a meaningful constraint. The question is open at the moment, to the best of our knowledge, because we have not found any proof that condition (8.6) can be derived directly from condition (8.5), nor have we found a proof of the opposite statement. So, we adopt “conservatively” both conditions. Substituting Eqs. (8.5) and (8.6) into the external scattering equation (5.68), we achieve the equation of the scattered field under BA for dielectric and magnetic targets: ðð Es ðxs ;ωÞ= ks2  ½Ge ðxs + Δ, x0 , z0 ; ωÞEinc ðxs ,x0 ,z0 ;ωÞχ e ðx0 ,z0 Þ  D  +  1 0 r Ge ðxs + Δ,x0 , z0 ;ωÞr0 Einc ðxs ,x0 ,z0 ;ωÞχ m1 ðx0 ,z0 Þ dx0 dz0 , xs , xo 2 Σ ks2 ð8:7Þ  where the height of the source and of the observation point have been supposed invariant χ m ðx0 ,z0 Þ has been labeled as χ m1(x0 ,z0 ). along the GPR scan and where the quantity 1 + χ m ðx0 ,z0 Þ 2  Let us stress that the erasing of the incident field discussed in Chapter 7 was referred to the incident field in the observation point (in air), whereas the incident field in Eqs. (8.1) and (8.2) is meant as the incident field in the investigation domain (underground).  120  THE BORN APPROXIMATION  Note that these two quantities have the same support3; that is, from a practical point of view, they approximately “express” two anomalies with the same size, position, and shape (but with different values). The scattering equation (8.7) is in frequency domain, and in particular the contrasts might depend on the frequency too. However, this dependence will be neglected. That said, under the BA the scattering problem is in any case linear and so any inversion algorithm based on the BA is not affected by local minima and is, in general, computationally less demanding with respect to a nonlinear approach. Of course, based on the reasoning presented in Chapter 6, the ill-posedness of the problem remains. As already said, physically the BA amounts to neglecting the mutual electromagnetic interactions among different buried targets and among the different parts of any buried target. In the case of magnetic and dielectric targets, this also amounts to neglecting the interaction between the magnetic contrasts and the dielectric contrasts, so that the scattered field under the BA is the sum of the scattered fields generated by the only dielectric part plus that generated by the only magnetic part of the buried targets.  8.3  WEAK AND NONWEAK SCATTERING OBJECTS  Theoretically, to neglect the mutual interactions between the buried targets is licit for weak scattering targets—that is, buried objects that make negligible the integral term on the right-hand side of Eq. (5.69). That term is the difference between the internal actual field and the internal incident field; that is, it is by definition the internal scattered field. The definition of weak scattering target is often accepted as an object that that modifies negligibly (conventionally ± π=8 at most) the phase of an electromagnetic wave propagating through it (Slaney et al., 1984). However, this is a definition essentially thought to be appropriate for free space cases. Actually, an inhomogeneous background can influence the degree of nonlinearity of the problem (Persico and Soldovieri, 2004). Therefore, here “weak scatterer” is defined as just an object for which the internal field, and (in case of magnetic targets) its first-order spatial derivatives can be approximated with those of the incident field. The “weakness,” in particular, is a feature not only related to the maximum level of the contrast, but also to the electrical size of the buried target (which implies a dependence on the frequency), its shape, and the nature of the of background medium (homogeneous or layered, lossless or lossy). It is important to emphasize that, independently from the validity of the BA in the current situation (with GPR field data, customarily BA is not valid), an aspect worth emphasizing is that the secondary sources that generate the scattered field under BA have the same support of the actual secondary sources, and this support is just the extension of the buried targets. In fact (see Chapter 4), the actual secondary source in case of dielectric 3 The support of a function is defined as the closure of the set of the points where a function assumes non-null values.  WEAK AND NONWEAK SCATTERING OBJECTS  121  targets are given by jωεs χ eE [see Eq. (4.20)], whereas the secondary source under the BA are provided by jωχ e εs Einc. Now, assuming that both the incident and the actual internal fields are supported throughout the entire investigation domain, it is clear that either under the exact model or under the BA the support of the secondary source is equal to the support of the dielectric contrast, which is just the extension of the buried targets. Therefore, it is licit to expect that in many cases the position, the size, and (under certain limits) the shape of the buried targets can be satisfyingly retrieved under BA, even in cases when the targets are not weak (Slaney et al. 1984; Idemen and Ackduman, 1990). This has also been widely shown experimentally (Meincke, 2001; Catapano et al., 2006; Persico and Sala, 2011). Let us also state that “satisfyingly” is a voluntarily generic term: It means that the achievable results are useful for some applications but does not mean that the geometrical reconstruction is “perfect” or very good (e.g., in the least square sense). In particular, the achievable reconstruction is affected by the filtering properties of the linear scattering operator, examined in the next chapter. In any case, in situations beyond the limits of the BA, we will not achieve a quantitative reconstruction of the electromagnetic characteristics of the buried object. Analogous statements can be straightforwardly worked out in the case of magnetic anomalies. At this point, we can propose a brief flashback on the question of the background medium, prompted in Chapter 7: Indeed, making a rough parallel between the Born series for the scattered field and the Taylor series for an ordinary function, we recognize that the background medium plays the role of the starting point of the series. The sense of the incident field, as well as the sense of the contrast function, actually depends on the chosen background medium. Consequently, to chose a background medium somehow “closer” to the physical situation is helpful in order to mitigate the nonlinearity of the problem. In particular, the common praxis for GPR data is to refer to a half-space geometry (or even to a homogeneous medium with the electromagnetic characteristics of the soil) because a “big box” model embedded in air would make quite more critical the intrinsic nonlinearity of the problem.  QUESTIONS 1. Consider a given weak scattering target embedded in a homogeneous soil. Let us embed this same target in a masonry composed of a material with the same characteristics of the previous soil. Is the scattering target “weak” in the same way? Namely, might the ratio between the norms of the internal incident field and the internal total field meaningfully change? Provide a qualitative answer considering the target under the radiation of the same sources placed in the same relative positions with respect to it in the two cases.  9 DIFFRACTION TOMOGRAPHY  9.1  INTRODUCTION TO DIFFRACTION TOMOGRAPHY  Diffraction Tomography is a topic that has been dealt with for a long time (Lesselier and Duchene, 1996; Meincke, 2001; Tabbra et al., 1988; Witten et al., 1996; Cui and Chew, 2002). In general terms, a DT relationship is an algebraic relationship between the spectrum of the data and the spectrum of the unknown function. There are several kinds of DT relationships in relationship with the measurement configuration (Persico et al., 2005; Persico, 2006), but here we will focus only on the common offset configuration. In general, a DT relationship requires more approximations than does the linearization provided by the BA, as will be shown in the following. In particular, two general hypotheses assumed for any DT relationship in common offset configuration are the following: 1. The soil or more in general the propagation medium is lossless. 2. The targets are not close to the sources in terms of wavelength.  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  122  DIFFRACTION TOMOGRAPHY FOR DIELECTRIC TARGETS  9.2  123  DIFFRACTION TOMOGRAPHY FOR DIELECTRIC TARGETS  In order to introduce the first DT relationship of this chapter, let us specify some further hypotheses, beyond BA and the assumptions 1 and 2 of the previous section. In particular, in this section we will assume the following: 1. 2. 3. 4. 5.  There is no magnetic target The observation line is at the air–soil interface. The observation line is infinitely long. The source is a filamentary electrical current. The datum is constituted by the scattered field in the observation point.  In this case, the linear external scattering equation [see Eq. (8.4)] is particularized into ðð Es ðx; ωÞ = ks2  Ge ðx,x0 ,0,z0 ;ωÞEinc ðx + Δ, x0 , 0, z0 ;ωÞχ e ðx0 ,z0 Þ dx0 dz0 ,  x2Σ  ð9:1Þ  D  where Δ is the fixed offset between the source and the observation point. After substituting the expressions of the external Green’s function given in Eq. (4.47) and the expression of the incident field given in Eq. (4.48) in Eq. (9,1), we obtain jωI0 μ20 μs ks2 Es ðx;ωÞ = 2π  +∞ ð +∞ ð +∞ ð ð +∞  − ∞ − ∞ − ∞ −∞  expð − jðkzs ðuÞ + kzs ðvÞÞz0 Þexpðjðu + vÞxÞ ðμ0 kzs ðuÞ + μs kz0 ðuÞÞðμ0 kzs ðvÞ + μs kz0 ðvÞÞ  × expð jvΔÞ expð − jðu + vÞx0 Þχ e ðx0 ,z0 Þ dx0 dz0 dudv,  x2Σ  ð9:2Þ  In Eq. (9.2), the integral on the investigation domain D has been replaced with an integral on the entire plane, because the dielectric contrast is a null function outside the investigation domain. Let us now write p = u + v ) u = p − v. The integrals can be rearranged as (Persico et al., 2005) jωI0 μ20 μs ks2 Es ðx;ωÞ = 2π  +∞ ð +∞ ð +∞ ð +∞ ð  −∞ −∞ −∞ −∞  expð − jðkzs ðp − vÞ + kzs ðvÞÞz0 Þexpð jpxÞ ðμ0 kzs ðp − vÞ + μs kz0 ðp − vÞÞðμ0 kzs ðvÞ + μs kz0 ðvÞÞ  × expð jvΔÞexpð − jpx0 Þχ e ðx0 ,z0 Þ dx0 dz0 dpdv,  x2Σ  ð9:3Þ  In the four nested integrals, we can recognize a Fourier transform of the contrast with respect to x0 (the conjugate variable being p) and an inverse Fourier transform with  DIFFRACTION TOMOGRAPHY  124  respect to the variable p (the conjugate variable being the observation point x). So, by Fourier transforming the data, from Eq. (9.3) we obtain +∞ ð  E^s ðp; ωÞ = jωI0 μ20 μs ks2  dz0 χ^e ðp,z0 Þ ×  −∞ +∞ ð  × −∞  expð −jðkzs ðp − vÞ + kzs ðvÞÞz0 Þ expð jvΔÞ dv, ðμ0 kzs ðp −vÞ + μs kz0 ðp − vÞÞðμ0 kzs ðvÞ + μs kz0 ðvÞÞ  x2Σ  ð9:4Þ  Now, the integral in dv can be solved under the stationary phase approximation, because we have assumed high values of z0 , that is, deep targets (see hypothesis 2 above). The rationale of the stationary phase method has already been introduced in Chapter 4 and thus will be not repeated now. However, in that chapter the twodimensional stationary phase approximation was dealt with. Here, instead, we need the one-dimensional stationary phase approximation, which is provided by (Felsen and Marcuvitz, 1994)  π pﬃﬃﬃﬃﬃ 2π exp j f ðx0 Þexp½jΩgðx0 Þ 4 rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ f ðxÞ exp½jΩgðxÞ dx≈ pﬃﬃﬃﬃ d 2 g X1 Ω ð x0 Þ dx2 X ð2  ð9:5Þ  where the symbols are homologous to those of Eq. (4.91). If the second derivative in the denominator is negative, the determination of the square root to be retained is sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ d 2 g  d2 g  ð x Þ = − j ðx0 Þ. In the case at hand, the phase function to consider is 0  2 2 dx dx  ψ ðvÞ = − kzs ðp− vÞ− kzs ðvÞ = −  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ks2 − ðp − vÞ2 − ks2 − v2  ð9:6Þ  Thus dψ p− v v =− + dv ksz ðp − vÞ ksz ðvÞ  ð9:7Þ  0 1 0 1 2 2 d2 ψ −1 ð p − v Þ 1 − v @ @ = + ksz ðp − vÞA + − ksz ðvÞA dv2 ðksz ðp − vÞÞ2 ksz ðp − vÞ ðksz ðvÞÞ2 ksz ðvÞ =−  ks2 ðksz ðp − vÞÞ  3  −  ks2 ðksz ðvÞÞ3  ð9:8Þ  DIFFRACTION TOMOGRAPHY FOR DIELECTRIC TARGETS  125  It easy to check that there is a unique first-order (see Section 4.6) stationary point at v = p=2, and in the stationary point we have d 2 ψ  − 2ks  p =    3 ) 2 p dv v = =2 ksz 2  sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ pﬃﬃﬃﬃﬃﬃﬃ d 2 ψ  2ks  p = − j   3 =2 2 p dv v = =2 ksz 2  ð9:9Þ  Substituting into Eq. (9.4), we obtain   E^s ðp;ωÞ = −     p π   3 jΔ exp j sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2 4 p     2 π kzs p p 2 + μs kz0 μ0 kzs 2 2  ωI0 μ20 μs ks exp  +∞ ð  × −∞      χ^e ðp,z0 Þ p 0 pﬃﬃﬃ exp − 2jkzs z dz0 0 2 z  ð9:10Þ  The integral term in Eq. (9.10) is once again a Fourier transform, so that eventually we obtain E^s ðp;ωÞ = f ðp; ωÞχ^^e1 ðηðp, ωÞ, ςðp, ωÞÞ  ð9:11Þ   p  π rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ  p3 ωI0 μ20 μs ks exp jΔ exp j 2 4 f ðp;ωÞ = −  π kzs p p2 2 + μs kz0 μ0 kzs 2 2  ð9:12Þ  where  χ e1 ðx0 ,z0 Þ =  χ e ðx0 ,z0 Þ pﬃﬃﬃ z0  ηðp, ωÞ = p ςðp, ωÞ = 2kzs  sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ p2 ω2 p2 4ω2 2 =2 = 2 ks2 − − = −p c2 2 2 c 2  ð9:13Þ  ð9:14Þ  p  The reader can check that hypotheses 1–5 listed at the beginning of this section and also hypotheses 1 and 2 of the previous section have all been used in the performed calculations. In particular, the last Fourier relationship and the application of the stationary phase method require the hypothesis of a lossless soil.  DIFFRACTION TOMOGRAPHY  126  Equation (9.11) also requires that kzs ðp=2Þ be a real quantity; otherwise the integral in Eq. (9.10) is not a Fourier transform but instead a Laplace transform (and this involves an exponential attenuation of the scattered waves). This restricts the admitted range of variability of p to the so-called “visible” interval Iv = (−2ks, 2ks). Physically, this means that the secondary sources, as any electromagnetic source, generate both a propagating field (related to the visible interval) and a reactive field (related to the values of p beyond the visible interval). The retrievable spectral set is provided by the image of Eq. (9.14) in the plane (η,ς), on condition that the spectral weighting function given in Eq. (9.12) is a relatively smooth function. In particular, the neighbors of the zeroes of the spectral weight should be excluded from the retrievable spectral set, because in those points the reconstruction of the spectrum of the contrast becomes unreliable. However, in order to introduce progressively the difficulties, let us neglect the effect of the spectral weight in a first moment. In this case, the mapping equation (9.14) is easily seen to be the parametric equations of a curve in the plane (η,ς). The corresponding Cartesian equation is easily retrieved as follows: ς = 2kzs  rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ η2 qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ = 4ks2 − η2 ) ς2 + η2 = 4ks2 = 2 ks2 − 2 2   η  ð9:15Þ  Equation (9.15) is the equation of a circumference centred in the origin and with ray 2ks. Moreover, it is immediate to check that we have the following correspondences, according to Eq. (9.14): p = − 2ks ! ðη, ςÞ = ð − 2ks ,0Þ, p = 0 ! ðη, ςÞ = ð0, 2ks Þ,  ð9:16Þ  p = 2ks ! ðη, ςÞ = ð2ks , 0Þ This means that, while p ranges from − 2ks to 2ks, the corresponding point in the plane (η,ς) describes in the clockwise direction a half-circumference in the half-plane ς ≥ 0, from the point (−2ks, 0) to the point (2ks, 0). Consequently, multifrequency data in a limited band ranging between some fmin and some fmax “cover” a half-annulus in the plane (η,ς). In Figure 9.1, the theoretically retrievable multifrequency spectral set is quantitatively depicted in four cases. Figure. 9.1 shows the fact that, even in the ideal case of a continuous amount of data gathered on an infinitely long observation line, the amount of retrievable information is limited and only a spatially filtered version of the object function is retrievable. As said, the spectral weight can provide a restriction of the ideal maximum spectral set of Figure 9.1 (and actually does). In order to get an insight on this effect, let us examine the behavior of the modulus of the spectral weight. In particular, in Figure 9.2 it is shown the modulus of the weighting function, normalized to its maximum, in four cases.  DIFFRACTION TOMOGRAPHY FOR DIELECTRIC TARGETS  127  (b) 80  40  60  30  ζ [m–1]  ζ [m–1]  (a)  40 20  20 10  0  0  –50 η  0  50  –40  –20  [m–1]  0 η  (c)  20  40  [m–1]  (d) 100 80  80  ζ [m–1]  ζ [m–1]  100 60 40  40 20  20 0  60  –100  –50  0 η [m–1]  50  100  0 –100  –50  0  50  100  η [m–1]  Figure 9.1. The theoretical retrievable spectral set in relationship with an infinitely long B-scan. Panel a: εs = 4ε0, μs = 4μ0, fmin = 200 MHz, fmax = 500 MHz. Panel b: εs = 7ε0, μs = μ0, fmin = 100 MHz, fmax = 400 MHz. Panel c: εs = 5ε0, μs = 2μ0, fmin = 200 MHz, fmax = 800 MHz. Panel d: εs = 15ε0, μs = 3μ0, fmin = 50 MHz, f = 350 MHz.  As can be seen, the behavior of the function is case-dependent, but some general features are easily identified. In particular, the function is even and vanishes at p = ± 2ks, as immediately understood from its expression (9.12). This means that the visible interval should not be considered equal to the entire interval (−2ks, 2ks), but rather an interval of the kind Iv = (−2ks + ε, 2ks − ε), where ε is a positive quantity frequency dependent and case dependent (in particular, noise-dependent). Moreover, as it can be appreciated from Figure 9.3, the shape of the modulus of the spectral weight normalised to its maximum value is somehow frequency invariant. Therefore, ε is expected roughly proportional to the frequency and the shape of the really retrievable spectral set is expected of the kind in Figure 9.4. Also note that the restriction is more severe if the soil shows magnetic properties, because this makes concave the graph (see Figure 9.2, and this feature has been confirmed by further not reported numerical results). Let us now consider the effect of the level of the spectral weight versus the frequency. From Eq. (9.12), it is easy to work out that we have an increasing of the pﬃﬃlevel ﬃ of the spectral weight versus the frequency, asymptotically proportional to f f for any fixed p. In particular, in Figure 9.5, the same spectral weights of Figure 9.3 are  DIFFRACTION TOMOGRAPHY  128  (b) 1  1  0.8  0.8  ∣f(p;ω)∣  ∣f(p;ω)∣  (a)  0.6 0.4  0.4 0.2  0.2 0  0.6  –50  0  0  50  –40  –20  p [m–1]  (c)  20  40  (d) 1  1  0.8  0.8  ∣f(p;ω)∣  ∣f(p;ω)∣  0 p [m–1]  0.6 0.4  0.4 0.2  0.2 0 –100  0.6  –50  0 p [m–1]  50  100  0  –50  0  50  p [m–1]  Figure 9.2. The normalized modulus of the spectral weighting function in four cases. Panel a: μs = 4μ0, εs = 4ε0, f = 500 MHz. Panel b: μs = μ0, εs = 7ε0, f = 400 MHz. Panel c: μs = 2μ0, εs = 5ε0, f = 800 MHz. Panel d: μs = 3μ0, εs = 15ε0, f = 350 MHz; in all the cases the variable p ranges from − 2ks to 2ks and the modulus of the spectral weight is normalized to its maximum.  shown. However, this time the four functions are normalized not with respect to their own maxima, but rather with respect to the maximum value over all of them, which is achieved at the maximum considered frequency. Physically, the result shown in Figure 9.5 means that a filamentary current, with a fixed (maximum or rms) value of the current flowing in it, radiates more power at higher frequencies. This should be accounted when considering very large band data (e.g., one decade or more) processed under a filamentary current model. In particular, in these cases a model based on a filamentary current might penalize too much the lower frequencies and should be somehow compensated. In conclusion, the retrievable spectral set is a limited set, even in the ideal case of an infinite observation line, and this is due to the ill-posedness of the problem. Due to its analytic properties, the spectrum of a square integrable function can be theoretically prolonged in a unique fashion all over the plane, starting from the retrievable spectral set. However, the prolonging of the Fourier transform is in turn an ill-posed problem. Indeed, the prolongation of the spectrum has been widely studied in one-dimensional cases, where some results in closed form have been achieved too  DIFFRACTION TOMOGRAPHY FOR DIELECTRIC TARGETS  (b) 1  1  0.8  0.8  ∣f(p;ω)∣  ∣f(p;ω)∣  (a)  129  0.6 0.4 0.2 0  0.6 0.4 0.2  –30 –20 –10  0  10  20  0  30  –60 –40 –20  20  40  60  (d)  (c) 1  1  0.8  0.8  ∣f(p;ω)∣  ∣f(p;ω)∣  0  p [m–1]  p [m–1]  0.6 0.4  0.4 0.2  0.2 0 –100  0.6  –50  0 p  50  100  0  –100  –50  [m–1]  0 p  50  100  [m–1]  Figure 9.3. The normalized modulus of the spectral weighting function in four cases. Panel a: f = 200 MHz. Panel b: f = 400 MHz. Panel c: f = 600 MHz. Panel d: f = 800 MHz; in all the cases εs = 4ε0, μs = 4μ0, p ranges from − 2ks to 2ks and the modulus of the spectral weight is normalized to its own maximum.  ζ [arbitrary units]  50 40 30 20 10 0  –50  –40  –30  –20  –10 0 10 η [arbitrary units]  20  30  40  50  Figure 9.4. Qualitative reduction of the spectral set due to the vanishing of the spectral weight at the two extremes of the visible interval. The unities are arbitrary, but the shape of the set is achieved supposing fmax = 2fmin.  DIFFRACTION TOMOGRAPHY  130  (b) 1  1  0.8  0.8  ∣f(p;ω)∣  ∣f(p;ω)∣  (a)  0.6 0.4 0.2 0  0.6 0.4 0.2  –30 –20 –10  0  10  20  0  30  –60 –40 –20  20  40  60  (d)  (c) 1  1  0.8  0.8  ∣f(p;ω)∣  ∣f(p;ω)∣  0  p [m–1]  p [m–1]  0.6 0.4  0.4 0.2  0.2 0 –100  0.6  –50  0 p  [m–1]  50  100  0  –100  –50  0 p  50  100  [m–1]  Figure 9.5. The normalized modulus of the spectral weighting function in four cases. Panel a: f = 200 MHz. Panel b: f = 400 MHz. Panel c: f = 600 MHz. Panel d: f = 800 MHz. In all the cases εs = 4ε0, μs = 4μ0, p ranges from − 2ks to 2ks and the modulus of the spectral weight is normalized to the highest value among the maximum levels of the four functions.  (Slepian and Pollack, 1961; Landau and Pollak, 1961; Landau and Pollak, 1962). Under the highlight provided by these studies, we can even say that the prolongation of the spectrum is the ill-posed problem “per antonomasia” and in general is not a suitable strategy to enhance the DT relationships.  9.3 DIFFRACTION TOMOGRAPHY FOR DIELECTRIC TARGETS SEEN UNDER A LIMITED VIEW ANGLE Among the five hypotheses assumed in Section 9.2, there was the infinite length of the observation line. This hypothesis allowed us to recast the problem as an algebraic relationship between spectra. However, in any practical case the observation line is limited. So, let us now consider a finite-length observation line, leaving unchanged the other hypotheses assumed in Sections 9.1 and 9.2. The finite length of the observation line corresponds to a limited-view angle range, smaller than ð − π=2, π=2Þ, which is the range of view angles available with an infinite observation line, as illustrated in Figure 9.6 with regard to a single point-like target. In Figure 9.6, the angles are referred to the  DIELECTRIC TARGETS SEEN UNDER A LIMITED VIEW ANGLE  131  –0.5  0  Observation line Σ  Air  z [m]  Soil  0.5 θmin θmax 1  *  Buried target D  1.5 –1  –0.8 –0.6 –0.4 –0.2  0 0.2 x [m]  0.4  0.6  0.8  1  Figure 9.6. Pictorial of the reduction of the view angle due to the limitedness of the observation line. In particular, θmin ! −π=2 and θmax ! π=2 if and only if the observation is infinitely long on both sides. The length units are arbitrary.  vertical line passing on the target and are counted clockwise. Therefore, they are negative if the observation point is on the left-hand side with respect to the target and positive when the observation point is on the right-hand side with respect to the target. In order to calculate the DT relationship in the case at hand, let us re-start from Eq. (9.1). However, in order to make it symmetrical, let us refer the scattered field not to the observation point, but to the intermediate point between the observation point x and source point x + Δ. This intermediate point is given by xm = x +  Δ 2  ð9:17Þ  Thus the observation and the source points can be expressed versus it as x = xm −  Δ 2  xs = x + Δ = xm +  ð9:18Þ Δ 2  ð9:19Þ  Under this change of variable, after substituting the expressions of the external Green’s function [Eq. (4.47)] and of the incident field [Eq. (4.48)] in Eq. (9.1), we obtain  DIFFRACTION TOMOGRAPHY  132  +∞ ð +∞ ð +∞ ð +∞ ð  jωI0 μ20 μs ks2 Es ðx; ωÞ = 2π  − ∞ −∞ − ∞ − ∞  expð − jðkzs ðuÞ + kzs ðvÞÞz0 Þ expðjðu + vÞxm Þ ðμ0 kzs ðuÞ + μs kz0 ðuÞÞðμ0 kzs ðvÞ + μs kz0 ðvÞÞ      Δ Δ exp − ju expð − jðu + vÞx0 Þχ e ðx0 ,z0 Þ dx0 dz0 dudv, × exp jv 2 2  x2Σ ð9:20Þ  The integrals can be reordered as jωI0 μ20 μs ks2 Es ðx; ωÞ = 2π  +∞ ð +∞ ð  0 0  0  χ e ðx ,z Þdx dz − ∞ −∞  0  +∞ ð  −∞    Δ exp − ju 2  expð − jðkzs ðuÞÞz0 Þ expðjuxm Þ expð − jux0 Þ du × ðμ0 kzs ðuÞ + μs kz0 ðuÞÞ 0  ×  0  expð − jkzs ðvÞz Þ expðjvxm Þexpð − jvx Þ dv, ðμ0 kzs ðvÞ + μs kz0 ðvÞÞ  +∞ ð  −∞    Δ exp jv 2  x2Σ  ð9:21Þ  After some straightforward manipulations, Eq. (9.21) can be still rewritten as Es ðx; ωÞ =  jωI0 μ20 μs ks2 2π  +∞ ð ð +∞  χ e ðx0 ,z0 Þ dx0 dz0 ×  −∞ −∞  12 20 +∞   ð 0 0 Δ exp ð − j ð k ð u Þ Þz Þ exp ð − ju ð x − x Þ Þ zs m duA + × 4@ cos u ðμ0 kzs ðuÞ + μs kz0 ðuÞÞ 2 −∞  0 +∞ 12 3   ð 0 0 Δ exp ð − j ð k ð u Þ Þz Þ exp ð − ju ð x − x Þ Þ zs m sin u +@ duA 5, 2 ðμ0 kzs ðuÞ + μs kz0 ðuÞÞ  x2Σ  −∞  ð9:22Þ Let us now write qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ r = ðxm − x0 Þ2 + z0 2 , 0  cos ðθ0 Þ =  z0 , r  sin ðθ0 Þ =  xm − x0 r  ð9:23Þ  DIELECTRIC TARGETS SEEN UNDER A LIMITED VIEW ANGLE  133  These positions express the vector of the relative position between the observation and the integration point in polar coordinates. Under these positions, the integral (9.22) is expressed as jωI0 μ20 μs ks2 Es ðx; ωÞ = 2π  +∞ ð ð +∞  χ e ðx0 ,z0 Þ dx0 dz0  −∞ − ∞  20 +∞ 12   ð 0 0 0 0 Δ exp ð − j ð k ð u Þ Þr cos ð θ Þ Þ exp ð −jur sin ð θ Þ Þ zs duA × 4@ cos u ðμ0 kzs ðuÞ + μs kz0 ðuÞÞ 2 −∞  0 +∞ 12 3   ð 0 0 0 0 Δ exp ð − j ð k ð u Þ Þr cos ð θ Þ Þexp ð −jur sin ð θ Þ Þ zs duA 5, x 2 Σ +@ sin u 2 ðμ0 kzs ðuÞ + μs kz0 ðuÞÞ −∞  ð9:24Þ where the dependence of r0 and θ0 from x0 , z0 , and xm is taken implicitly. Both the integrals in parentheses can be solved, for high values of r0 , making use of the stationary phase approximation. There is a unique first-order stationary point at u = ks sin(θ0 ), and the result is (Soldovieri et al., 2007) +∞ ð ð +∞ jωI0 μ20 μs ks2 Es ðx; ωÞ = χ e ðx0 ,z0 Þ dx0 dz0 2π −∞ −∞ 2  0  2πj expð − j2r0 ks Þ cos 3 ðθ0 Þks 6 2 ks Δ sin ðθ Þ × 4 cos  pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ2 2 μ0 ks cos ðθ0 Þ + μs k02 −ks2 sin 2 ðθ0 Þ z0   + sin 2   ks Δsin ðθ Þ  2 0  3  0  0  2πj expð − j2r ks Þ cos ðθ Þks 7 2 5 pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 0 0 2 2 2 0 μ0 ks cos ðθ Þ + μs k0 − ks sin ðθ Þ z 3  +∞ ð +∞ ð  =  − ωI0 μ20 μs ks3 −∞  expð − j2r 0 ks Þ cos 3 ðθ0 Þ 0 0 χ e ðx0 ,z0 Þ  2 dx dz , x 2 Σ pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 0 0 2 2 2 0 μ0 ks cos ðθ Þ + μs k0 −ks sin ðθ Þ z −∞  ð9:25Þ In Eq. (9.25), we have applied the phase stationary method with respect to r0 . Formally there is a dependence on r0 also in the residual phase term. In particular, the phase term was given by gðu,r0 Þ = − kzs ðuÞcos ðθ0 Þ −u sin ðθ0 Þ  ð9:26Þ  DIFFRACTION TOMOGRAPHY  134  This quantity formally depends also on r0 because r0 and θ0 are linked by Eqs. (9.23). We find comfortable, for a reason that will be clear in the following, to solve this question by generalizing the stationary phase formula (9.5) into  π pﬃﬃﬃﬃﬃ 2π exp j f ðx0 Þ exp½ jΩgðx0 ;ΩÞ 4 rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ f ðxÞ exp½jΩgðx; ΩÞ dx ≈ pﬃﬃﬃﬃ ∂2 g X1 Ω ðx0 ;ΩÞ ∂x2 Xð2  ð9:27Þ  which is not a correct operation in general. However, in the case at hand the application of (9.27) is licit, because the phase term of Eq. (9.26) does not vanish when r0 increases, which makes the rationale of the stationary phase method still valid, because it remains true that the exponential term exp(jr0 (−kzs(u) cos(θ0 ) − u sin(θ0 ))) in Eq. (9.24) is more and more oscillating when r0 increases. Equation (9.25) shows that, in the current observation point, the first contribution to the scattered field is given by a plane wave coming from the target to the observation point. The phase factor 2r0 ks expresses the round-trip of the wave from the source to the target and vice versa.1 At this point, let us consider (with regard to Figure 9.6) the case that the contrast is provided by a point like target. So, let us focus the attention on the following case: χ e ðx0 ,z0 Þ = χ 0 δðx0 − x0 Þδðz0 − z0 Þ  ð9:28Þ  Where, implicitly, z0 is supposed electrically large. Substituting Eq. (9.28) in Eq. (9.25), we achieve Es ðx;ωÞ = − ωI0 μ20 μs ks3 χ 0   expð − j2r0 ks Þ cos 3 ðθ 0 Þ pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ2 , μ0 ks cos ðθ0 Þ + μs k02 − ks2 sin 2 ðθ0 Þ z0  x2Σ  ð9:29Þ  where qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ðxm − x0 Þ2 + z20 , z0 cos ðθ0 Þ = , r xm − x0 sin ðθ0 Þ = r  r0 =  ð9:30Þ  Let us now consider the spectrum of the scattered field with respect to xm:  1 Actually, the physical optical path of the signal is from the source point to the target and from the target back to the observation point, but for long distances (in particular distances much longer than the offset between the antennas) it can be approximated by the round-trip from the source–receiver midpoint to the target.  DIELECTRIC TARGETS SEEN UNDER A LIMITED VIEW ANGLE  E^s ðp; ωÞ = −ωI0 μ20 μs ks3 χ 0  135  +∞ ð  expð − jðpx + 2r0 ks ÞÞcos 3 ðθ0 Þ  pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ2 dxm 2 2 2 − ∞ μ0 ks cos ðθ 0 Þ + μs k0 −ks sin ðθ0 Þ z0 +∞ ð  expð −jðpðxm −x0 Þ + 2r0 ks ÞÞ expð − jpx0 Þ cos 3 ðθ0 Þ dxm  pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ2 2 − k2 sin 2 ðθ Þ z k cos ð θ Þ + μ μ k s 0 0 0 −∞ 0 s s 0    +∞ ð exp − jz0 −p tg ðθ0 Þ + 2ks expð − jpx0 Þ cos 3 ðθ0 Þ cos ð θ Þ 0 = − ωI0 μ20 μs ks3 χ 0 dxm  pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ2 2 −k 2 sin 2 ðθ Þ z k μ k cos ð θ Þ + μ s 0 0 0 0 s −∞ s 0  =  − ωI0 μ20 μs ks3 χ 0  ð9:31Þ Let us solve the integral (9.31) with the stationary phase method with respect to z0. In doing this, we are again applying the generalized stationary formula (9.27). In particular, the phase term is now given by gðxm ,z0 Þ = − p tan ðθ0 Þ +  2ks xm − x0 2ks =p + cos ðθ0 Þ z0 z0  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ðxm − x0 Þ2 + z20  ð9:32Þ  whose first derivative with respect to the integration variable is ∂g p 2ks ðxm − x0 Þ qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ﬃ =− + ∂xm z0 z0 ðxm − x0 Þ2 + z20  ð9:33Þ  so that there is a unique first-order stationary point given by   pz0 xm0 − x0 2 p2 xmo = x0 + pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ) = 2 2 z0 4ks − p 4ks2 − p2  2 2 xm0 − x0 ðxm0 − x0 Þ2 + z20 rm0 p2 4ks2 ) +1= = = + 1 = z0 4ks2 − p2 z20 z20 4ks2 − p2  ð9:34Þ  Based on Eq. (9.34), in this stationary point xm0 we have pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 4ks2 −p2 z0 cos ðθm0 Þ = = , rm0 2ks pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ p , sin ðθm0 Þ = 1− cos 2 ðθm0 Þ = 2ks 2ks z0 rm0 = pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 4k 2 − p2  ð9:35Þ  DIFFRACTION TOMOGRAPHY  136  The second derivative of the phase term is given by ∂2 g =h ∂x2m  2ks z0 ðxm − x0 Þ2 + z20  i3=2  ð9:36Þ  and its value in the stationary point is equal to   3=2   2 2 3=2  2ks z0 4ks2 − p2 4ks − p ∂2 g  2ks z0 = = =    	  2 3=2 3=2 ∂xm xm = xm0 4ks2 z20 p2 z20 4ks2 z20 2 + z 4ks2 − p2 0  ð9:37Þ  Consequently, the final result is   pﬃﬃﬃﬃﬃ pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ   3=2   π − ωI0 μ20 μs ks3 χ 0 2π exp j expð − jpx0 Þ 4ks2 −p2 exp − jz0 4ks2 −p2 2ks z0 4 E^s ðp; ωÞ = sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ!2 2 p p2   2 2 3=4 p ﬃﬃﬃﬃ 8ks3 z0 μ0 ks2 − + μs k02 − 4ks −p z0 2 2  −ks ωI0 μ20 μs χ 0 =  sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ!  3=4   2 pﬃﬃﬃﬃﬃ 3=4 π p2 2 p 2π exp j expð −jpx0 Þ4 ks − exp −2jz0 ks2 − 4 4 4 sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ!2 p2 p2 pﬃﬃﬃﬃ 4 z0 μ0 ks2 − + μs k02 − 4 4 sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ!    3=4 2 π p2 2 p exp −2jz0 ks2 − j expð −jpx0 Þ ks − 4 4 4 sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ! p2 p2 2 pﬃﬃﬃﬃ z0 μ0 ks2 − + μs k02 − 4 4  pﬃﬃﬃ −ks ωI0 μ20 μs χ 0 π exp =      sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ    π p p 2 3 z0 πksz −ks ωI0 μ0 μs χ 0 exp j expð −jpx0 Þ exp − j2ksz 4 2 2 =      2 p pﬃﬃﬃﬃ 2 p 2 z0 μ0 ksz + μs ks0 2 2  ð9:38Þ At this point, let us note that if we particularize the result of Eq. (9.11) to the point-like target at hand, we obtain  DIELECTRIC TARGETS SEEN UNDER A LIMITED VIEW ANGLE   p  π p  ωI0 μ20 μs ks χ 0 exp jΔ exp j rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2 4 πksz3 E^s ðp;ωÞ = −  p p2 pﬃﬃﬃﬃ 2 z0 + μs kz0 μ0 kzs 2 2  p  × expð − jpx0 Þ exp − j2ksz z0 2  137  ð9:39Þ     which is the same as Eq. (9.38) except for the factor exp jΔ p2 (because the Fourier transform of the scattered field is computed with respect to the variable xm instead of the observation point x). However, the intermediate passages that have led us to Eq. (9.38) reveal a crucial point, expressed by Eqs. (9.35). In fact, Eqs. (9.35) show a noticeable one-to-one correspondence between the spectral variable and the spatial variable. In particular, the scattered field in the point xm0 provides the main contribution to the spectrum of the scattered field in the point p = 2ks sin(θm0). Therefore, we can say that any xm is the stationary point with regard to the related spectral point p = 2ks sin(θm). Now, when xm ranges the real axis from −∞ to +∞, p ranges the visible interval from −2ks to 2ks. However, if xm ranges from a finite xmin to a finite xmax, then p ranges through a subset of the visible interval xmin − x0 from 2ks sin(θmin) to 2ks sin(θmax), where sin ðθmin Þ = qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ and sin ðθmax Þ = ðxmin − x0 Þ2 + z20 xmax − x0 qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ﬃ are the sines of the view angles at the extreme points of the observation ðxmax −x0 Þ2 + z20 line, as illustrated in Figure 9.6. This means that, for a single point-like target, the visible interval with a limited view angle is restricted from Iv = (−2ks, 2ks) to Ivl = (2ks sin(θmin), 2ks sin(θmax)), where the extra subscript l stands for “limited” observation line. So, the visible interval is in general asymmetric and becomes theoretically symmetric if and only if the target point is centered with respect to observation line, in which case θmin = − θmax. The retrievable spectral set in the case of an observation line with finite extension is the spectral set corresponding to this reduced visible interval. In particular, the mapping between the point (p,ω) and the point (η,ς) is still given by Eq. (9.14) and the spectral weight is still given by Eq. (9.12), of course restricted to the available reduced visible interval. In general, we don’t have a single point-like target to focus but rather an entire investigation domain to reconstruct. Therefore, the achieved result means that the quality of the reconstruction is not constant throughout the investigation point within the investigation domain. In fact, as can be seen from Figure 9.6, the minimum and maximum view angles vary when ranging a point within the investigation domain. In particular, the retrievable spectral set reduces for deeper targets and gets particularly asymmetric for targets close to the lateral edges.2 In order to achieve a global-average characterization of the retrievable spectral set, one possibility is to refer it to the deepest central point of the investigation domain (Soldovieri et al., 2007). This is a worst-case evaluation with 2 This is actually related to the choice of an investigation domain of the same length and centered with respect to the observation line, which is the most customary and reasonable choice, as will be shown.  DIFFRACTION TOMOGRAPHY  138  –0.5  z [m]  –a 0  Air  Observation line Σ  a  Soil  0.5  θmin = –θmax  θmax  1 D  * z=z 1.5 –1  –0.8 –0.6 –0.4 –0.2  max  0.2 0 x [m]  0.4  0.6  0.8  1  Figure 9.7. Conventional choices for the evaluation of the global-average spectral set.  respect to the depth of the target, but does not consider the asymmetry of the spectral set for lateral targets. With this conventional choice, we have sin(θmin) = − sin(θmax), and therefore the visible interval becomes Ivl = (−2ks sin(θmax), 2ks sin(θmax)). Consequently, if the observation line at the air–soil interface is extended from x = − a to x = a and if the maximum investigated depth is zmax , then we have (see Figure 9.7) a sin ðθmax Þ = pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2 a + z2max  ð9:40Þ  At this point, we can represent the spectral sets relative to a limited observation line. Four (multifrequency) cases are quantitatively depicted in Figure 9.8. The four corner points in Figure 9.8 are P1 = (2ks min sin(θmax), 2ks min cos(θmax)), P2 = (−2ks min sin(θmax), 2ks min cos(θmax)), P3 = (−2ks max sin(θmax), 2ks max cos(θmax)), and P4 = (2ks max sin(θmax), 2ks max cos(θmax)). The points P1 and P2 are connected by an arch of circumference centered in the origin and with ray 2ks min, where the ks min is the minimum involved wavenumber in the soil; the points P3 and P4 are connected by an arch of circumference centered in the origin and with ray 2ks max, where ks max is the maximum involved wavenumber in the soil. The points P1 and P4, as well as the points P2 and P3, are connected by two straight line segments. The global-average spectral set is useful for a global estimation of the resolution capabilities of the linear scattering operator, but it cannot account for the variable  DIELECTRIC TARGETS SEEN UNDER A LIMITED VIEW ANGLE  (b) 120  120  100  100  80  80  60 20 0  P4  P3  40  P2 –100  ζ m–1  ζ m–1  (a)  139  –50  P3  40 20  P1 50  0  60  0  100  P4 P2  –100  –50  η m–1  50  100  η m–1  (c)  (d) 120  120  100  100  80 60 20 0  P4  P3  40  P2 –100  –50  ζ m–1  ζ m–1  P1 0  η m–1  P4  80 60 40  50  100  0  P1  P2  20  P1 0  P3  –100  –50  0  50  100  η m–1  Figure 9.8. The global-average retrievable spectral set under a limited view angle. In all cases a = 1 m and zmax = 1.5 m. Panel a: fmin = 200 MHz, fmax = 500 MHz, εrs = 9, μrs = 1. Panel b: fmin = 200 MHz, fmax = 500 MHz, εrs = 4, μrs = 1. Panel c: fmin = 300 MHz, fmax = 700 MHz, εrs = 4, μrs = 1. Panel d: fmin = 300 MHz, fmax = 700 MHz, εrs = 4, μrs = 4.  quality of the focusing for different points within the investigation domain. In particular, the reduction of maximum view angle versus the depth involves a loss of resolution versus the depth (Deming and Devaney, 1996), as will be shown. The spectral sets of Figure 9.8 express a fundamental characteristic of the reconstruction that we can achieve under a Born model, which is essentially expected low pass filtered with regard to the horizontal frequencies and bandpass filtered with respect to the vertical spatial frequencies. Practically, this means that the horizontal size of the targets is expected to be satisfyingly reconstructed unless the target is quite shorter than the dominant wavelength (we will be more precise in Section 9.5). Instead, with respect to the vertical direction, the reconstruction will essentially image the discontinuities along the depth, associated with “high” vertical spatial frequencies (Higgins, 1996). In other words, substantially we expect to retrieve (at most) the top and the bottom of the buried targets. Actually, in some cases the bottom is not imaged, due to the losses and/or to the strong reflection from the top. In some other cases, instead, when the target is vertically small, the reconstructions of the top and the bottom can superpose to each other, resulting in a unique “spot.” The vertical band-pass characteristics of the inverse scattering operator are the mathematical counterpart of the fact that the GPR signal is substantially composed by radar echoes from the buried targets, basically generated by discontinuities along the vertical direction.  DIFFRACTION TOMOGRAPHY  140  Another consequence of the “morphology” of the retrievable spectral set is that we cannot expect to retrieve the buried targets quantitatively but we can only retrieve their position, size, and (under some limits as said) shape. In particular, let us emphasize that the spectral set does not include the Cartesian origin of the plane (η,ς). Since the value of the spectrum of the contrast profile in the origin is equal the integral average value of the function, it is quite hard, under BA, to retrieve the mean value of the contrast, even if the target is a weak scattering object. In particular, the level of the reconstructed contrast is customarily quite lower than the level of the actual contrast. It is interesting to note that, formally, the “exploding” shape of the spectral set indicates that the amount of information retrievable from higher frequencies is somehow greater than that obtained from lower frequencies. In particular, after easy geometrical calculations, the area of the spectral is equal to As = 8θmax Δks ksm  ð9:41Þ  where Δks is the difference ks max − ks min and ksm is the medium wavenumber ðksmax + ksmian Þ=2. This means that, for example, the band 400–800 MHz formally provides more information than the band 50–450 MHz, even if the extension of the two bands is the same. The physical reason resides in the spatial diversity of the data, as will be shown later on in this chapter. However, this should not make us think that the lower frequencies are less important. In particular, as is well known, in order to investigate deeper layers in the soil, due to the losses (not accounted for in the DT relationships but always present in the field), we need low frequencies, as already discussed in Chapter 1. This warns about the fact that the optimality of the available (or needed) amount of information should not be meant in a merely quantitative way, but above all in a qualitatively way and in relationship with the specific case at hand.  9.4  THE EFFECTIVE MAXIMUM AND MINIMUM VIEW ANGLE  Up to now, we have implicitly assumed that the target is really “seen” from any observation point ranging along the observation line. This is a simplifying hypothesis adopted in order to introduce the calculations. However, in real cases, especially when the data are gathered along a long B-scan (e.g., 50 m long or more, which usually means hundreds or thousands central wavelengths in the soil), the GPR antennas will really perceive any buried target only within a subset of the entire observation line. We can account for this introducing the concept of the effective maximum (minimum) view angle, defined as the maximum (minimum) angle at which the GPR receiving antenna perceives some signal from the crossed buried target. The effective maximum (minimum) view angle θe max (θe min) is, in general, narrower than the geometrical maximum (minimum) view angle because of the geometrical spreading of the power, the losses, and the directivity of the antennas. The effective maximum view angle is difficult to be predicted in a theoretical way, but in general it can be heuristically evaluated from the data. For example, in Figure 9.9 a GPR scan is represented. The data have been gathered on the  THE EFFECTIVE MAXIMUM AND MINIMUM VIEW ANGLE  0  141  a  × 10–8  t  0.5  t [sec]  1  1.5  2  2.5  0  1  2  3 x [m]  4  5  6  Figure 9.9. Evalutation of the maximum effective view angle from a superficial target.  floor of a baroque building,3 and the visible anomalies are ascribable to superficial pipes under the floor. In this example, for the evidenced anomaly, we have a ≈ 1 m and the return time t corresponding to the top (neglecting the offset between the antennas) is about equal to 1 ns. From the shape of the diffraction curve, the propagation velocity has been estimated about equal to c ≈ 1.35 × 108 m/s, so that t ≈ 1 ns ) z = ct=2 ≈0:07 m. So, for this anomaly, we can estimate, applying Eq. (9.40) (with zmax = z), sin(θe max) ≈ 0.998. Clearly, superficial targets are seen under a large angle, but this changes for deeper targets. In particular, in Figure 9.10 a second example is proposed. The data have been gathered in an archaeological site,4 and the insulated anomaly is alleged to be ascribable to the basis of a column or to a piece of a column. Also in this case, we have a ≈ 1 m and the return time t corresponding to the top (neglecting the offset between the antennas) is equal to ~18 ns. From the shape of the diffraction curve, the propagation velocity has been estimated to be c ≈ 0.85 × 108 m/s, so that t ≈ 18 ns ) z = ct=2 ≈0:76 m: So, for this anomaly, we can estimate, applying Eq. (9.40) (with zmax = z), sin(θe max) ≈ 0.8. In general, the evaluation of the maximum (or equivalently the minimum) effective view angle depends on the single target, and so it should be averaged among more targets at the maximum depth of interest. The dealing of Section 9.3 should be referred in general to the effective view angle. Notwithstanding, the quantitative evaluations of Figure 9.8 are meaningful, because in those cases a relatively short observation line was considered, 3 The ex church of Saint Sebastian, nowadays headquarter of the Foundation Palmieri in Lecce, Italy (http:// www.fondazionepalmieri.it/). 4 Hierapolis, a Roman and Byzantine town in Turkey.  DIFFRACTION TOMOGRAPHY  142  0  10  a  20  0  10  t 20  30  Figure 9.10. Evalutation of the maximum effective view angle from a target less superficial with respect to that considered in Figure 9.9. The abscissas are in meters, and the times are in nanoseconds.  so that the geometrical maximum view angle was not larger than the effective maximum view angle. Let us also stress the fact that the introduction of the effective view angle shows that the problem of the asymmetry of the spectral set is not so dramatic in real cases: Actually, since the length of the B-scan usually is much longer than the central wavelength, in many cases the peripheral targets represent only a little share of the targets overflown by the GPR.  9.5  HORIZONTAL RESOLUTION  Let now calculate the available horizontal resolution. Actually, we cannot rigorously speak of the horizontal resolution as something separated by the vertical one, because the two quantities are correlated within the DT relationships. However, we are looking for an order of size, and so we will find an approximate relationship where the horizontal resolution is mainly related to the horizontal extent of the retrievable spectral set. The evaluation of the horizontal resolution proposed here refers (as is customarily done) to the capability to distinguish two “equally strong” scattering targets at the same depth. Of course, if the energy scattered by the two targets is different, one of them might mask the other one (Daniels, 2004). That said, the horizontal resolution can be defined as the minimum distance at which two electrically small scattering objects, of the same nature and buried at the same depth, can be distinguished from each other. In order to evaluate this distance, we can proceed approximating the spectral sets of Figure 9.8 with the best matching rectangle, as shown in Figure 9.11.  HORIZONTAL RESOLUTION  143  120 100 ζ m–1  80 60  P3  P4  P2  P1  40 20 0  –100  –50  0 η m–1  50  100  Figure 9.11. The spectral set of Figure 9.8 panel a and the rectangle to which it is assimilated.  The shape of the best matching rectangle depends on the current case, but it is evident from Figure 9.11 that a reasonable matching is achieved with the horizontal frequencies ranging between − 2ksc sin(θe max) and 2ksc sin(θe max) (where ksc = ks max + ks min =2 is the average wavenumber and θe max is the maximum effective view angle, assumed symmetrical) and with the vertical spatial frequencies ranging between 2ks min and 2ks max. Consequently, the corner points of the rectangle in Figure 9.11 are P1 = (2ksc sin(θe max), 2ks min), P2 = (−2ksc sin(θe max), 2ks min), P3 = (−2ksc sin(θe max), 2ks max), and P4 = (2ksc sin(θe max), 2ks max). In particular, the spectral set is approximately large 4ksc sin(θe max) along the η-axis and 2(ks max − ks min) along the ζ-axis. Now, let us consider a point-like target placed in the point (x0,z0), expressed by the contrast function χ e(x0 ,z0 ) = χ 0δ(x0 − x0)δ(z0 − z0), so that its spatial spectrum is given by χ^^e ðη, ςÞ = χ 0 expð − jηx0 Þ expð − jςz0 Þ. Neglecting the spectral weight, the reconstruction of such a target through DT is essentially the filtered version of the contrast achieved considering its spectrum only within the retrievable spectral set, in its turn approximated with the dashed rectangle in Figure 9.11. In this way, we will achieve a result in closed form. The reconstruction available for a point like target is also known as point spread function (Moghaddam and Chew, 1992). In the case at hand, it is given by χ er ðx0 ,z0 Þ =  χ0 4π 2  ðð  expðjðx0 − x0 ÞηÞexpðjðz0 − z0 ÞςÞ dηdς  R  2χ = 20 ksc sin ðθe max Þðks max − ks min Þexpðjðks max + ks min Þðz0 − z0 ÞÞ π × sincð2ksc sin ðθemax Þðx0 −x0 ÞÞsincððks max − ks min Þðz0 − z0 ÞÞ =  4χ 0 ksc sin ðθe max ÞBexpð2jksc ðz0 −z0 ÞÞ πc   2πB 0 ðz − z0 Þ × sincð2ksc sin ðθemax Þðx0 −x0 ÞÞsinc c  ð9:42Þ  DIFFRACTION TOMOGRAPHY  144  (a) 1 0.5 0 –0.5 –15  –10  –5  0  5  10  15  5  10  15  x  (b) 1 0.5 0 –0.5 –15  –10  –5  0 x  Figure 9.12. Panel a: The graph of two functions sinc(x − π) and sinc(x + π), for which the distance between the maxima is equal to the extent of the main lobe. Panel b: The graph of the sum sinc(x − π) + sinc(x + π). The axes are in arbitrary units.  where B is the frequency band and R indicates the rectangle in Figure 9.11. The size of the main lobe of this sinc-like function along the horizontal direction is π=ksc sinðθemax Þ = λsc =2 sin ðθemax Þ. It is found reasonable that two targets will be reliably distinguishable if their distance is equal to this value, which guarantees that the main lobes of the two reconstructions do not overlap to each other. So we have HR ≈  λsc 2 sin ðθe max Þ  ð9:43Þ  In Figure 9.12, two equal sinc functions shifted of the main lobe with respect to each other are represented; this makes clear the rationale of the choice of Eq. (9.43). Equation (9.43) derives from several assumptions and approximations. So, it is no surprise that different expressions of the horizontal resolution can be found pﬃﬃﬃ in the literature. In particular, the literature often reports the value λs =2 (or λs = 2) where account λs is defined as the central wavelength. This evaluation, however, does notp ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ for the loss of resolution versus the depth. Jol (2009) reports the value HR = dλs =2, where d the depth. This accounts for the loss of resolution versus the depth but drives to an infinitesimal resolution for very shallow targets. Another reported value  VERTICAL RESOLUTION  145  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ (Sheriff, 1980) is HR = ðd + λs =4Þ2 − d2 , which reduces to the previous estimation for d > > λs and becomes HR ≈λs =4 for shallow targets. Equation (9.43) accounts for the loss of resolution versus the depth by means of sin(θe max). In particular, it accounts for the fact that the available resolution depends on the size of the portion of the observation line under which the buried target is “seen” by the GPR antennas. In fact [see Eq. (9.40)], sin(θemax) accounts both for the depth of the target and the wideness of the effective observation line. This means, for example, that if for some reason (e.g., the presence of superficial obstacles) the buried targets can be crossed over only along a short B-scan, then the horizontal resolution is expected to degrade. This implicitly also means that the available resolution is to be evaluated after the processing. Actually, the resolution is evaluated sometime on the basis of the raw data and sometimes it is thought that it is a mere hardware attribute of the antennas. Actually, the focusing capabilities of the processing [sometimes referred to as synthetic aperture radar SAR effect (Daniels, 2004)] influence the achievable resolution meaningfully, even if their effectiveness depends on the current case (in particular on the amount of losses). Equation (9.43) can be also applied on low-loss soils, by means of a “perturbative” approach (Franceschetti, 1997), where the wavelength is evaluated on the basis of the real part of the wavenumber. However, for a more refined evaluation, it should be also accounted the fact that, in most cases [even if some exceptions are reported (Daniels, 2004; Jol, 2009)] the losses attenuate the higher frequencies versus the depth more strongly than the lower frequencies. Therefore, in Eq. (9.43), λsc should be meant as the central received frequency from the range of depth of interest, which is in most cases greater or equal to the central radiated wavelength. So, we can generalize Eq. (9.43) by introducing an effective central received wavelength in the soil λsec and writing HR ≈  λsec 2 sin ðθemax Þ  ð9:44Þ  Likewise θemax, also λsec is not easily predictable, but can be evaluated from the GPR data by windowing suitably (i.e., without introducing strong discontinuities) the range of depths of interest and considering the spectrum of the windowed data, as done (for example) in Sala and Linford (2010). So, in general the losses degrade the horizontal resolution, because they make λsec increase and θemax decrease.  9.6  VERTICAL RESOLUTION  Likewise the horizontal resolution, also the vertical resolution can be approximately estimated from the retrievable spectral set. The vertical resolution can be defined as the maximum distance between two electrically small and vertically piled targets distinguishable from each other. This time, however, beyond the same assumptions assumed in the previous section, we have to account for two further elements:  DIFFRACTION TOMOGRAPHY  146  1. The upper target can partially mask the lower one, even if the two targets are of the same nature. So, two piled targets with the same electromagnetic characteristics do not, in general, provide echoes of the same level. Therefore, we will make the further assumption that the two targets are relatively weak targets, so that the masking effect of the upper one on the lower one is negligible. 2. The phase term exp(j(ks max + ks min)(z0 − z0)) = exp(2jksc(z0 − z0)) in Eq. (9.42), deriving from the fact that the spectral set is band-pass along the vertical spatial frequency axis, can influence the reconstruction. In particular, in the case of two small piled objects, the two relative phase terms can sum in a constructive or destructive way, depending on the electrical distance between the source and the targets at the central frequency. That said, an order of magnitude for the vertical resolution can be formally calculated in the same way followed for the horizontal resolution—that is, from the wideness of the vertical main lobe of the point spread function. Consequently, based on Eq. (9.42), the vertical resolution in lossless cases is given by VR =  c c = B ðfmax − fmin Þ  ð9:45Þ  As said, the band of a GPR antenna is often of the same order of the central frequency. So a rougher evaluation can be derived from Eq. (9.45) as follows: VR =  c c ≈ = λsc B fc  ð9:46Þ  It is sometime reported that the vertical resolution is equal to one half of the central wavelength in the soil instead of just the wavelength in the soil. Of course, the two quantities are of the same order, and so this difference is not a big trouble. At any rate, Eq. (9.46) is coherent with the fact that, under the geometrical approximations performed on the retrievable spectral set and under the hypothesis of large band (in particular with the maximum frequency much larger than the minimum one) the retrievable spectral set is essentially twice larger along the direction of the horizontal spatial frequencies than it is along the direction of the vertical spatial frequencies. This makes the theoretical horizontal resolution for shallow targets equal to one half of the corresponding vertical resolution. In lossy cases, likewise in the case of the horizontal resolution, we can introduce the effective band, the effective central frequency, and the effective central wavelength. Thus, a rough extension of Eqs. (9.45) and (9.46) can be VR =  c c ≈ = λsce Be fce  ð9:47Þ  As said, the higher frequencies attenuates more than the lower ones versus the depth, so that the effective band is customarily narrower than the radiated band. This means that in real cases some degradation of the vertical resolution versus the depth is expected, even if in an ideal lossless soil the vertical resolution is constant versus the depth.  SPATIAL STEP  9.7  147  SPATIAL STEP  DT also provides an approximated but powerful tool to calculate the spatial step needed for taking GPR measurements correctly. In particular, based on the previous dealing, the scattered field should be sampled in a way that allows the correct evaluation of its spectrum within the effective visible interval Iv = (2ks sin(θemin), 2ks sin(θemax)). Of course, the effective visible interval is a function of the target position. So, in order to choose the spatial step needed for the data in a “conservative” way, the best choice is to estimate the visible interval in relationship to the shallowest part of the investigation domain, because this will provide the narrowest step. Let us outline that this is the opposite criterion with respect to that adopted for the evaluation of the resolution. At this point, we should identify from the data a maximum view angle for the shallowest targets in the investigation domain and, from this, the visible interval for the evaluation of the needed spatial step. Actually, in most cases the investigation domain starts just from the air–soil interface, and in this case the maximum (minimum) view angle is equal to θemax ≈ π=2ðθemin ≈ − π=2Þ. The visible interval is large 4ks sin(θemax). Based on the Nyquist criterion, the required spatial step ssf at a single frequency is therefore given by ssf =  π π λs = = 2ks sin ðθemax Þ 2ð2π=λs Þsin ðθemax Þ 4sin ðθemax Þ  ð9:48Þ  where λs is the wavelength in the soil. Of course, the GPR scans are multifrequency data, and so the step (9.48) should be meant conservatively with respect to the minimum involved wavelength. Thus, in the usual multifrequency case we have s=  λsmin 4 sin ðθemax Þ  ð9:49Þ  If the investigation domain starts quite close to the air–soil interface, of course Eq. (9.49) reduces to s = λsmin =4. Indeed, this is the most common case, so that the criterion s = λsmin =4 (sometime relaxed to s = λsc =4, i.e. referred to the central wavelength instead of the minimum one) is probably the most reported one (Daniels, 2004; Jol, 2009). However, by virtue of the loss of resolution versus the depth, if the targets looked for are deep enough, the spatial step can be theoretically reliably relaxed according to Eq. (9.49). This can have a practical relevance in some special cases—for example, in cases where the data have to be gathered in a discrete (noncontinuous) mode (Persico et al., 2010). Finally, it is also worth noting that, in some cases, the targets looked for might be very large with respect to the wavelength—for example, in the case of the investigation of geological stratifications. In these cases the horizontal spatial band of spectrum of the contrast is possibly quite narrow, and useful results can be achieved even with a spatial step larger than that given in Eq. (9.49). Equation (9.49) involves some redundancy in the gathered data, because the step is conservatively optimised with respect to the highest involved frequency. This redundancy cannot be avoided, because it is unpractical to think of modifying the spatial step versus the frequency (it is just impossible with a pulsed system and it would be uselessly time-consuming with a stepped frequency system). However, if needed  DIFFRACTION TOMOGRAPHY  148  for computational reasons, some decimation of the data might be done before processing them. As a rule of thumb, it is not wrong to gather data with a spatial step narrower than (9.49), due to the losses and to the parametric uncertainties about the characteristics of the soil, and also in order to average some noise. However, it is pointless to gather data with a spatial step one order of magnitude smaller than that of Eq. (9.49). In Section 15.2 the reader will find some exercises on spatial step and horizontal resolution. Please note that they are also based on the 2D migration exposed in Chapter 10 and on the SVD theory exposed in Chapter 14.  9.8  FREQUENCY STEP  Let us now examine the problem of the needed frequency step. Let us specify that what we are looking for is the needed frequency step in order to process correctly GPR data in the frequency domain, which refers to data gathered in either the time domain or the frequency domain. Instead, the result worked out in Chapter 3 was referred to the frequency step needed in order to gather the data correctly with a stepped frequency system. The two frequency steps can be different because, from the raw data, we might see that the targets of interest are confined within a subset of the entire initially probed depth range, so that we might be interested in focusing only the targets enclosed in a specific depth range smaller than the entire “gathered” depth range. That said, let us note that, within the DT relationship, a single frequency corresponds to an arch of circle within the retrievable spectral set. The spectral set is therefore somehow sampled by these arches of circle. This involves the fact that the vertical spatial frequency sampling is not independent from the horizontal frequency sampling, due to the nonlinear relationship (9.14). So, to simplify the problem, in a first moment we will neglect the curvature of the arches of circle linked to each frequency, and we will approximate them as horizontal segments. In this way, we can identify a linear relationship between the vertical spatial frequency step and the frequency step. In particular, under this approximation, the vertical spatial frequency sampling step is related to the (temporal) frequency step by the following proportionality relationship: pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 4π εsr μsr 2π Δς = 2Δks = 2 Δf = Δf c0 c  ð9:50Þ  where c is the propagation velocity of the wave in the soil and c0 is the propagation velocity of the waves in free space, εsr and μsr are the relative dielectric permittivity and magnetic permeability of the soil. In order to establish whether the sampling of the spatial frequencies is correct, we resort again to the Nyquist criterion. This time the role of the “band”, is played by the vertical extent of the investigation domain, because of the formal similarity between the direct and the inverse Fourier transforms. So, if we label as b the vertical extent of this domain (see Figure 4.1), we have that the Nyquist criterion requires  TIME STEP  149  Δς ≤  2π b  ð9:51Þ  Substituting Eq. (9.51) into Eq. (9.50), we obtain the condition pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ Δς 2 εsr μsr 1 c0 = Δf ≤ ) Δf ≤ pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2π b c0 2b εsr μsr  ð9:52Þ  Equation (9.52) reduces to Eq. (3.12) if b = D; that is, if the processed depth range coincides with the entire “gathered” depth. However, if we focus on only a subset of the maximum investigated (nonambiguous) depth, then b < D and Eq. (9.52) is a condition relaxed with respect to Eq. (3.12), which can be computationally important. It is important to emphasize, however, that in our model (see Figure 4.1) we suppose apriori that the targets are present only within the investigation domain. In particular, we assume that there is no target shallower than it and no target deeper than it. This assumption is quite strong, and in many cases a simple glance to the raw data is sufficient to prove that it is unacceptable. In these cases, in order to focus a precise range of depth, one should preventively mute the signal in the time domain before and after the depth range of interest. This operation is an anti-aliasing spatial prefiltering. At this point, let us now consider the curvature of the spectral arches of circle corresponding to each time frequency within the retrievable spectral set. In particular, we can observe that the calculated vertical spatial frequency sampling is based on the distance along the ς-axis of two spectral circles corresponding to two different frequencies. This is to say that we have founded our calculations on Δς for η = 0. For any η 6¼ 0, the vertical frequency sampling between two circles, from Eqs. (9.14), is given by ΔςðηÞ =  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 4ðks + Δks Þ2 − η2 − 4ks2 −η2  ð9:53Þ  However, the minimum versus η of the function (9.53) is achieved for η = 0, and therefore condition (9.52) is conservative. Similar to the spatial step, the frequency step is to be meant as an order of magnitude. A good rule of thumb is to choose a frequency step for data processing slightly but not much (namely one order of magnitude or more) smaller than that given in Eq. (9.52), in order to mitigate some possible effect of the losses, of the model approximations, and of the parametric uncertainties. In Section 15.3 the reader can find some exercises on frequency step and vertical resolution. Please note that they are also based on the 2D migration exposed in Chapter 10 and on the SVD theory exposed in Chapter 14.  9.9  TIME STEP  As said, GPR data can be processed either in the frequency domain or in the time domain. So, for completeness, now we provide the time step needed in order to process the data in the time domain. The reasoning is dual to the case of processing  DIFFRACTION TOMOGRAPHY  150  in frequency domain, and also in this case the time step needed for the processing is not necessarily equal to that needed in order to gather data correctly by means of a pulsed system [see Eq. 3.39)]. In particular, we might be interested in the result relative to a subset of the entire band of the data, because (for example) we have recognized that there are some strong interferences on some frequencies). In this case, after filtering the data [thus restricting the spectrum to a band of interest (let us call it Bint) narrower than the band B of the signal initially gathered] and applying the Nyquist criterion, we have that the time step needed for a processing in the time domain is given by Δt =  1 Bint  ð9:54Þ  It is obvious that condition (9.54) is relaxed with respect to condition (3.39). Actually, in the GPR common praxis the time step is rarely a real problem, because the allowed number of time samples for a given time bottom scale is in general so high to guarantee the absence of any meaningful aliasing without particular computational problems (see also Section 3.4, question 2 in Chapter 3, and answer 2 in Appendix G, Section on Chapter 3).  9.10 THE EFFECT OF A NON-NULL HEIGHT OF THE OBSERVATION LINE Let us now consider the case of an observation line at height h 6¼ 0 with respect to the soil.5 This removes hypothesis 2 in Section 9.2. We retain in a first moment hypotheses 1, 3, 4, and 5. In particular, we consider first the ideal case of an infinite observation line, then we will pass to the case of a limited observation line. So, we can start from the relationship ðð Es ðx; ωÞ = ks2  Ge ðx,x0 , h,z0 ; ωÞEinc ðx + Δ, x0 ,h,z0 ;ωÞχ e ðx0 ,z0 Þ dx0 dz0 ,  x2Σ  ð9:55Þ  D  Substituting in Eq. (9.55) the expressions of the external Green’s function and of the incident field given in Eqs. (4.47)–(4.48), we have jωI0 μ20 μs ks2 Es ðx; ωÞ = 2π  +∞ ð +∞ ð +∞ ð +∞ ð  −∞ − ∞ − ∞ − ∞  expð − jðkzs ðuÞ + kzs ðvÞÞz0 Þ expðjðu + vÞxÞ ðμ0 kzs ðuÞ + μs kz0 ðuÞÞðμ0 kzs ðvÞ + μs kz0 ðvÞÞ  × expð jv; ΔÞexpð −jðu + vÞx0 Þexpðjhðkz0 ðuÞ + kz0 ðvÞÞÞχ e ðx0 ,z0 Þ dx0 dz0 dudv,  x2Σ  ð9:56Þ  5 Let us remind ourselves that, by virtue of the Cartesian reference assumed (see Figure 4.1), h is to be taken as negative.  THE EFFECT OF A NON-NULL HEIGHT OF THE OBSERVATION LINE  151  Equation (9.56) is the same as Eq. (9.2) but for the term exp(jh(kz0(u) + kz0(v))). This term is identically unitary for h = 0 and is almost unitary when the height h of the antennas is small in terms of the minimum involved wavelength in air. Now, we will instead assume the opposite hypothesis—that is, that h is large with respect to the maximum involved wavelength. In this case, putting p = u + v ) u = p − v as previously done with regard to Eq. (9.2), we can develop the calculations as follows (Persico, 2006): jωI0 μ20 μs ks2 Es ðx;ωÞ = 2π  +∞ ð +∞ ð +∞ ð ð +∞  − ∞ − ∞ −∞ −∞  expð −jðkzs ðp− vÞ + kzs ðvÞÞz0 Þexpð jpxÞ ðμ0 kzs ðp −vÞ + μs kz0 ðp −vÞÞðμ0 kzs ðvÞ + μs kz0 ðvÞÞ  × expðjhðkz0 ðp− vÞ + kz0 ðvÞÞÞexpð jvΔÞ expð − jpx0 Þχ e ðx0 ,z0 Þ dx0 dz0 dpdv,  x2Σ  ð9:57Þ Rearranging the integrals in the same way followed for the calculation carried out in the case h = 0, we obtain E^s ðp; ωÞ = jωI0 μ20 μs ks2  +∞ ð  dz0 χ^e ðp,z0 Þ  −∞ +∞ ð  × −∞  expð − jðkzs ðp− vÞ + kzs ðvÞÞz0 Þ expðjhðkz0 ðp −vÞ + kz0 ðvÞÞÞ expð jvΔÞ dv, ðμ0 kzs ðp− vÞ + μs kz0 ðp− vÞÞðμ0 kzs ðvÞ + μs kz0 ðvÞÞ  x2Σ  ð9:58Þ Equation (9.58) is similar to Eq. (9.4), with the only difference constituted by the presence of the term exp(jh(kz0(p − v) + kz0(v))). Now, in order to analyze the effect of this term, we distinguish two cases: The first one is the case |h| < < z0 , and the second one is |h| > > z0 . Let us now focus on the case |h| < < z0 . In this case the term exp(jh(kz0(p − v) + kz0(v))) can be regarded as slowly varying with respect to the term exp(jz0 (kz0(p − v) + kz0(v))). So, we can apply the same stationary phase method applied in the case h = 0, and the result is  p E^s ðp; ωÞ = f ðp;ωÞ exp j2hkz0 χ^^e1 ðηðp, ωÞ, ςðp, ωÞÞ 2  ð9:59Þ  where f(p;ω) is given in Eq. (9.12) and χ^^e1 ðηðp, ωÞ, ςðp,ωÞÞ is given in Eq. (9.13). Thus, the achieved result is just a modification of the spectral weight times the factor expðj2hkz0 ðp=2ÞÞ. Now, while p ranges in the interval Ivh = (−2k0, 2k0) (the suffix h refers to the “non-null height”), the quantity expðj2hkz0 ðp=2ÞÞ is just a phase term that does not affect the modulus of the spectral weight. However, beyond this range, the exponent has a negative real part that attenuates meaningfully the spectral weight. An example is given in Figure 9.13. In particular, Figure 9.13 shows the comparison between the normalized modulus of the spectral weight at the air–soil interface [calculated according to Eq. (9.12)] and at a height equal to one-fifth of the minimum  DIFFRACTION TOMOGRAPHY  152  (a) 1 0.8 0.6 0.4 0.2 0  –60  –40  –20  0  20  40  60  20  40  60  η m–1  (b) 1 0.8 0.6 0.4 0.2 0  –60  –40  –20  0 η m–1  Figure 9.13. Comparison between the spectral weight at the soil and at the wavelength in air. In both panels, we have εsr = 4, μsr = 2, and f = 600 MHz. Panel a: h = 0. Panel b: h = 0.1 m. In the example at hand 2ks = 71.13 m− 1 and 2ko = 25.15 m−1  wavelength in air [calculated accordingly to Eq. (9.59)]. This shows that, even for a relatively small electrical height of the observation line, the ideal visible interval reduces rapidly from Iv = (−2ks, 2ks) up to Ivh = (−2k0, 2k0). We can give a physical interpretation of this fact by reminding that the main contribution to the spectrum of the data at the air–soil interface, for any value of p within the visible interval Iv, is given by a plane wave coming from the direction 2ks sin(θ). However, as is well known, if this plane wave impinges from the underground beyond the critic angle θc, the wave refracted in the air attenuates exponentially versus the height. Due to Snell’s law, the critic angle is pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ the angle at which sin ðθc Þ = 1= εsr μsr (Franceschetti, 1997), where εsr and μsr are the relative permittivity and the relative magnetic permeability of the soil. Consequently, the visible interval for a high observation line might also be rewritten as Ivh = (−2ks sin(θc), 2ks sin(θc)). This means that, physically, the effect of the height of the observation line is that of limiting the maximum and minimum view angle, even in the case of an ideal infinite observation line. From Figure 9.13, we also appreciate the fact that the maxima of the spectral weight for h = 0 are close to the extremes of Ivh. Actually, this is related to the radiation pattern of a filamentary current on the soil, which tends (for high relative permittivity of permeability of the soil) to show its maxima at the critic angles (Engheta et al., 1982). Consequently to the reduction of the visible interval, the retrievable spectral set restricts too, as depicted in Figure 9.14. Let us now pass to the case where |h| > > z0  THE EFFECT OF A NON-NULL HEIGHT OF THE OBSERVATION LINE  153  (a) 70 60  ζ m–1  50 40 30 20 10 0  –60  –40  –20  0 η  20  40  60  20  40  60  m–1  (b) 70 60  ζ m–1  50 40 30 20 10 0  –60  –40  –20  0 η m–1  Figure 9.14. Comparison between the spectral set at the soil (panel a) and for a high observation line (panel b). εsr = 4, μsr = 2, fmin = 200 MHz, fmax = 600 MHz. In panel a, the view angle has been made to range from θmin = −π=2 + π=20 to θmax = π=2 −π=20, in order to provide a pictorial effect of the vanishing of the spectral weight toward the extremes of the visible interval (see Figure 9.4).  8 z0 2 D. In this case, when applying the stationary phase method to the integral in dv, we will regard exp( jh(kz0(p − v) + kz0(v))) as the oscillating term, whereas the term exp(−j (kzs(p − v) + kzs(v))z0 ) is included among the “smooth” ones. Please note that this time we can remove the hypothesis that the targets are necessarily deep in terms of wavelength, because the oscillations of the terms exp(jh(kz0(p − v) + kz0(v))) are sufficient to enable us to apply the stationary phase method. Incidentally, in the case of an electrically large height of the data, the removing of the hypothesis of deep targets is also physically reasonable, because in this case it is hard to think of detecting electrically deep targets. That said, under these new assumption, there is again a unique first-order stationary point at v = p=2, and the result is E^s ðp; ωÞ = fh ðp; ωÞχ^^e ðηðpÞ, ςðpÞÞ  ð9:60Þ  DIFFRACTION TOMOGRAPHY  154  where  p  p  π  p3 jωI0 μ20 μs ks2 exp jΔ exp j2hkz0 exp j rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2 2 4 π kz0 fh ðp; ωÞ = p p2 pﬃﬃﬃ 2 + μs kz0 ko h μ0 kzs 2 2  ð9:61Þ  where the subscript h stands for “high measurement line.” Let us explicitly note that in (9.60) we have the spectrum of the contrast function, and not the spectrum of the contrast normalized to the square root of the depth. This because the stationary pﬃﬃﬃ phase is applied with respect to the propagation in air, and so the variable factor 1= z0 has been replaced pﬃﬃﬃ by the constant factor 1= h. Apart from the formal differences between Eq. (9.11) and Eq. (9.60), the essential physical difference is the again the presence of the factor expðj2hkz0 ðp=2ÞÞ in the spectral weighting function. Thus, the same considerations just exposed can be repeated. An example is given in Figure 9.15. In particular, Figure 9.15 shows the comparison between the normalized modulus of the spectral weight at the air–soil interface [calculated according to Eq. (9.12)] and at a height equal to the wavelength in air [calculated accordingly to Eq. (9.61)]. The visible interval and the retrievable spectral set are restricted further on in the case of a limited line, and these reductions can be described again resorting to the effective maximum and minimum view angle. However, the effective view angle should not be based on the maximum abscissa at which we see the last “tail” of the diffraction curve. In fact, due to Snell’s law, this leads to an apparent maximum view angle larger than the effective one, which should be calculated at the air–soil interface. Basically, this is the same physical phenomenon that makes a target embedded under a shallow layer of water appear larger than it is to our eye. The phenomenon can be accounted for by means of the quantities x1(xmax) and x1(xmin) related to xmax and xmin as described in Chapter 2 (see Section 2.3.4). In particular, the maximum effective view angle should be evaluated as x1 ðxmax Þ sin ðθemax Þ = qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ½x1 ðxmax Þ2 + d2  ð9:62Þ  where d is the depth of the target. A geometrical scheme is provided in Figure 9.16. A similar formula holds for the minimum view angle too. Of course, the case dealt with represents a limit situation, where the observation line and the interface are far from each other with respect to the minimum involved wavelength. In general, intermediate situations are possible, so that at the lower frequencies some meaningful “tail” beyond Ivh are still present. In these cases, we have some formal difficulty in describing an intermediate spectral set, because the hypotheses exploited for retrieving the spectral sets do not hold any longer. At any rate, what is physically important is “the trend,” which shows how the height of the observation line  THE EFFECT OF A NON-NULL HEIGHT OF THE OBSERVATION LINE  155  (a) 1 0.8 0.6 0.4 0.2 0  –60  –40  –20  0  20  40  60  20  40  60  η m–1  (b) 1 0.8 0.6 0.4 0.2 0  –60  –40  –20  0 η m–1  Figure 9.15. Comparison between the spectral weight at the soil and at height equal to the wavelength in air. In both panels, we have εsr = 4, μsr = 2, and f = 600 MHz. Panel a: h = 0. Panel b: h = 0.5 m. In the example at hand 2ks = 71.13 m−1 and 2k0 = 25.15 m−1.  is paid with a loss of information extractable from the data (Persico, 2006). When possible, therefore, the best choice is to gather contact data. However, there are applications where the data are necessarily contactless (e.g., asphalt monitoring or airborne GPR surveys). The horizontal and vertical resolutions, as well as the spatial step, are straightforwardly derived from the shape of the spectral set. In particular, with regard to the horizontal resolution, we have HRh =  λsec 2 sin ðθemax Þ  ð9:63Þ  which is formally identical to Eq. (9.44) but substantially different because of the reduced θe max. In particular, we have now the physical constraint θ emax ≤ θc. The same holds for the needed spatial step. Instead, the vertical resolution and the frequency step keep substantially unchanged with respect to the case with data at the air–soil interface, because the view angle does not enter the calculations in this case. In Section 15.6 the reader will find some exercises on the effects of the height of the observation line. Please note that they are also based on the 2D migration exposed in Chapter 10 and on the SVD theory exposed in Chapter 14.  DIFFRACTION TOMOGRAPHY  156  –0.5 xmax  Observation line Σ h x1(xmax)  Air 0  Soil θmax  z [m]  d 0.5  *  Buried target 1  1.5 –1  –0.8  –0.6  –0.4  –0.2  0  0.2  0.4  0.6  0.8  1  x [m]  Figure 9.16. Pictorial for the effective maximum view angle for a high observation line. The depth of the target is exaggerated for representation exigencies. The units are arbitrary.  9.11 THE EFFECT OF THE RADIATION CHARACTERISTICS OF THE ANTENNAS The effect of the radiation characteristics of the antennas can be accounted for by considering the scattering equation with the incident field given by Eq. (4.84) and the external Green’s function given by Eq. (4.115). We will consider first the case with antennas at the air–soil interface, with an infinite observation line and with no magnetic target. The passages are fully analogous to those exposed in Section 9.2. Thus, we won’t repeat them and will provide directly the DT relationship, which in this case is given by E^s ðp; ωÞ = fa ðp; ωÞχ^^e1 ðηðpÞ, ςðpÞÞ  ð9:64Þ  where χ e1(x0 ,z0 ) is the contrast normalized to the square root of the depth as given in Eq. (9.13), and the spectral weight (the suffix stands for “antennas”) is given by  p  π  p p p rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2  p3ﬃ − jmμ0 μs λ0 exp jΔ exp j E^Tx E^Rx kz0 2 4 2 2 2 π kzs ð9:65Þ fa ðp;ωÞ =  p p2 2 + μs kz0 2π 3 IR ς0 μ0 kzs 2 2  THE EFFECT OF THE RADIATION CHARACTERISTICS OF THE ANTENNAS  157  With respect to the relationship (9.12), we can see that the retrievable spectral set is the same in principle, because the arguments of the Fourier transforms are the same, and also the set where the spectral variables range are the same. The difference is, one more time, in the weighting spectral function, which depends among other things on the radiation characteristics of the antennas. Now, for practical reasons, the GPR antennas are never electrically large; and this, in general, makes their radiation pattern “smooth” (Daniels, 2004). This also implicitly explains the fact that, in most cases, the GPR data processing is done without having a precise quantification of the radiation characteristics of the antennas. Let us also stress the fact that the measure of these characteristics is not a trivial task, and in particular buried antennas would be required (Meincke and Hansen, 2004). Finally, in principle the characteristics of the antennas are sitedependent too. It is worth outlining that, beyond the fact that a very directive GPR antenna pattern is usually unrealistic, it is not desirable either. In fact, in this limit case, based on the dealing shown in Sections 4.4–4.8, we have that the plane wave spectra of the antennas [and thus the spectral weighting function (9.65)] becomes very peaked near the value p = 0. This means that we have a restriction of the effective retrievable spectral set near the line p = 0. The effect is therefore, again, a reduction of the value of the effective maximum view angle; and the higher the directivity, the stronger the reduction. Physically, this means that an extremely directive source eliminates the possibility to see the targets from a wide view angle. In fact, in the limit for high directivity, the transmitting antenna emits (and the receiving antenna receives) only TEM broadside plane waves. It is sometimes erroneously thought that very directive antennas radiate just a “thin ray” in front of them. However, the narrowness of the radiation pattern is in angular terms, and not in terms of linear distance, and let us also remind ourselves that the directivity is in turn a limit concept that is defined only in the far-field zone of the antenna, which in turn depends on the size of the antenna too (Collin, 1985; Franceschetti, 1997). It is clear that, in the limit case of only TEM broadside waves, it would be useless to move the source, because the incident field would remain the same (Soldovieri et al., 2005b). This limit case shows again that the quality of the image improves if the antennas “see” the targets from several viewpoints. Of course, the data processing is a key point with regard to this. In fact, in any fixed position, a couple of not-much-directive antennas illuminate and gather the echoes coming from many directions, and these contributions are superposed on each other. However, when the radiation and reception is performed in several positions and at several frequencies for each position, a suitable data processing is able to distinguish the origin of each contribution. The passage to a finite observation line is analogous to those exposed with regard to the case of a filamentary current, and so it will be not repeated. Because the antenna pattern is expected (at least in air) to be quite roundish and not varying so much among the practical antennas, the spatial and frequency steps, as well as the horizontal and vertical resolutions, are expected to be of the same order as those provided in Sections 9.5–9.8. As a last observation, we can note that the spectral weight is composed of (a) a part dependent on the current source and receiver (i.e., the product E^Tx ðp=2ÞE^Rx ðp=2Þ) and (b) a part independent of it, given by  DIFFRACTION TOMOGRAPHY  158   p  π  p rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2  p3ﬃ − jmμ0 μs λ0 exp jΔ exp j kz0 2 4 2 f1 ðp;ωÞ = π kzs  p p2 2 + μs kz0 2π 3 IR ς0 μ0 kzs 2 2  ð9:66Þ  The modulus of f1(p;ω) is shown in Figure 9.17. Figure 9.17 shows that, independently from the exploited antennas, the visible interval vanishes at the extreme points ± 2ks. There are also two further roots in the points ± 2k0, corresponding to the critic angle, but these can be counteracted by singularities of the plane wave spectrum of the source and receiver, as seen in Eq. (9.12).  9.12 DT RELATIONSHIP IN THE PRESENCE OF MAGNETIC TARGETS At this point, let us consider the possibility of magnetic targets. To deal with this case, we come back to the case of a filamentary current as source and for the scattered field as datum; moreover, we will consider the case of data gathered at the air–soil interface and will limit our discussion to the ideal case of an infinite observation line. Thus, the starting equation is the complete linear scattering equation (8.7), with the incident field given by Eq. (4.48) and the external electrical Green’s function given by Eq. (4.47). The substitutions of these quantities, together with the calculation of the gradients under the sign of integral, provide jωI0 μ20 μs ks2 Es ðx; ωÞ = 2π  +∞ ð +∞ ð +∞ ð +∞ ð  −∞ − ∞ − ∞ −∞  expð − jðkzs ðuÞ + kzs ðvÞÞz0 Þexpðjðu + vÞxÞ ðμ0 kzs ðuÞ + μs kz0 ðuÞÞðμ0 kzs ðvÞ + μs kz0 ðvÞÞ  × expð jvΔÞ expð − jðu + vÞx0 Þχ e ðx0 ,z0 Þ dx0 dz0 dudv jωI0 μ20 μs − 2π  +∞ ð +∞ ð +∞ ð +∞ ð  −∞ −∞ − ∞ − ∞  expð −jðkzs ðuÞ + kzs ðvÞÞz0 Þexpðjðu + vÞxÞ ðμ0 kzs ðuÞ + μs kz0 ðuÞÞðμ0 kzs ðvÞ + μs kz0 ðvÞÞ  × expð jvΔÞ expð − jðu + vÞx0 Þχ m1 ðx0 ,z0 Þðuv + kzs ðuÞkzs ðvÞÞ dx0 dz0 dudv,  with χ m1 =  χ m ðx0 ,z0 Þ as in Section 8.2. 1 + χ m ðx0 ,z0 Þ  x2Σ ð9:67Þ  (a) 1 0.8 0.6 0.4 0.2 0  –60 –40 –20  0  η  m–1  20  40  60  (b) 1 0.8 0.6 0.4 0.2 0  –40  –20  0 η  20  40  m–1  (c) 1 0.8 0.6 0.4 0.2 0  –60  –40  –20  0  20  40  60  η m–1  (d) 1 0.8 0.6 0.4 0.2 0  –100  –50  0 η  50  100  m–1  Figure 9.17. The factor of the spectral weight source and receiver independent at the air–soil interface. Panel a: f = 600 MHz, εrs = 4μrs = 2. Panel b: f = 400 MHz, εrs = 4μrs = 2. Panel c: f = 400 MHz, εrs = 4μrs = 4. Panel d: f = 800 MHz, εrs = 4μrs = 4.  DIFFRACTION TOMOGRAPHY  160  From Eq. (9.67), we can develop calculations fully analogous to those shown before. The details are left as an exercise. The final result is E^s ðp;ωÞ = f ðp; ωÞχ^^e1 ðηðpÞ, ςðpÞÞ − f ðp;ωÞχ^^m11 ðηðpÞ, ςðpÞÞ  ð9:68Þ  where χ m1 ðx0 ,z0 Þ  χ m1 ðx0 ,z0 Þ pﬃﬃﬃ z0  ð9:69Þ  and f(p;ω) is the electrical spectral weight as provided in Eq. (9.12). Equation (9.68) states the theoretical impossibility, within the DT approximations, to distinguish the dielectric or the magnetic nature of the buried targets. In fact, the retrieved quantity is the difference of the spectra of the two object functions, electric and magnetic, and “unfortunately” the spectra are calculated in the same points of the plane (η,ς) and with the same spectral weights, so that there is no way to distinguish the two contributions from each other unless some further off-line information is achievable.  9.13  DT RELATIONSHIP FOR A DIFFERENTIAL CONFIGURATION  Let us now deal with the DT relationship for differential configuration. The following hypotheses are assumed: The source is a filamentary current, the observation line is at the air–soil interface and is limited, and no magnetic target is present. The presence of small losses is accounted for perturbatively. Let us remind that in the differential configuration the datum is the difference of the scattered field values gathered in two points at a fixed offset and symmetrical with respect to the source. Thus, the datum is given by ΔE ðx, ωÞ = Es ðx + Δ, ωÞ − Es ðx − Δ, ωÞ  ð9:70Þ  where Δ is the offset between the central receiver and any of the two transmitters (see Section 7.3). By Fourier transforming along the x-axis Eq. (9.70), we achieve, after the same straigthforward passages (Persico and Soldovieri, 2006). E^s ðp;ωÞ = fd ðp; ωÞχ^^e1 ðηðpÞ, ςðpÞÞ  ð9:71Þ  where   π sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ   3      j 4 p p p exp jΔ − exp − jΔ fd ðp;ωÞ =     2 π kzs 2 2 2 p p μ0 kzs + μs kz0 2 2   π sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ   jωI0 μ20 μs ks exp j    3 4 Δp p = 2j sin ð9:72Þ     2 π kzs 2 2 p p + μs kz0 μ0 kzs 2 2 jωI0 μ20 μs ks exp  DT RELATIONSHIP FOR A DIFFERENTIAL CONFIGURATION  161  Equations (9.71)–(9.72) are different from Eqs. (9.11)–(9.12) only for the spectral weighting function; however, the difference is meaningful because the purely phase term expðjΔp=2Þ has now been replaced by 2j sin ðΔp=2Þ = 2jsin ðΔη=2Þ, which involves an amplitude weighting of the spatial frequencies within the spectral retrievable set. In particular, the retrievable spectral set is reduced, because this term erases the spatial frequencies corresponding to the zeroes of this sine function, given by η0 =  2nπ Δ  ð9:73Þ  where n is any integer. In particular, this erases a vertical belt about the zero horizontal frequency. The offset Δ affects the wideness of the belt to be erased. The erased spectral belt is actually case-dependent (in particular, noise-dependent), because it is the belt within which we “can’t trust” the diffraction tomography result. To provide a graphical representation, let us now assume that the reconstruction is not reliable in the belt corresponding to the −20 dB level of the sine function with respect to the maximum, and let us focus around η = 0. The wideness of the erased belt is provided by the equation       sin ηΔ  = 0:1 ) ηΔ ’ ± 0:1 ) η ’ ± 0:2  2  2 Δ  ð9:74Þ  If the data are noisier, the erasing band enlarges; and if the data are cleaner, the belt restricts; but it is, in any case, inversely proportional to the offset. The wideness EB of the erased belt is given the distance between the two solutions of Eq. (9.74), and so it is given by EB =  0:4 Δ  ð9:75Þ  Physically, this means that, when the two source points are too close to each other, the two subtracted values of the scattered field are substantially the same, because (whatever the buried targets) the field does not have “enough space” to vary meaningfully. Therefore, for short offsets, the scattering operator under differential configuration will some way tend to an identically null operator. Moreover, the fact that the zero horizontal spatial frequency is erased modifies the properties of the inverse scattering operator, making the retrievable reconstruction no longer horizontally low-pass and vertically band-pass, but rather band-pass along both the horizontal and the vertical directions. As a consequence, we will tend to reconstruct essentially the edges of the target, both along the abscissa and along the depth. This is physically easily explained. In fact, let us think of a long horizontal target; in this case, apart from a brief path over the leftand right-hand edges, when the system of antennas flies over this target, the scenario becomes symmetrical (see Figure 9.18), and therefore the gathered signal is null over most of the crossed target. In the end, this is a drawback coherent with the main purpose  DIFFRACTION TOMOGRAPHY  162  Rx Air Soil  Tx Δ  Rx Δ  Target  Figure 9.18. Pictorial of a prospecting in differential configuration on a long target (x and z are in arbitrary units). If the edges are far enough, the buried scenario is symmetric and the datum vanishes.  of the differential configuration—that is, to erase the contribution of the air–soil interface and of any further quasi-horizontal layers. In particular, these interfaces can be assimilated to long quasi-horizontal targets, and we can expect that, if they are filtered out by the differential configuration, then also long horizontal target will be filtered out. The choice of the offset Δ is therefore crucial, because it influences the class of the retrievable or at least detectable targets. In particular, this choice should be done, as far as possible, also related to the size of the targets looked for. In particular, a rough quantification of the class of targets specifically erased by the differential configuration can be identified by considering the Fourier transform of a centered rectangular homogeneous target large L. The vertical size and the depth of the center are at a first approximation unessential, but let us label them as vs and zc. The spectrum of such a dielectric contrast6 is given by   ςvs ηL ^ ^ χ e = χ o Lhexpð − jςzc Þsinc sinc 2 2  ð9:76Þ  The main lobe of the sinc function along the horizontal frequencies is large 2π=L; and so, if we desire a “good” reconstruction of a target large L, we should make this main lobe at least larger than the erased belt EB. This means that, due to Eq. (9.75), we should have at least 0:4 2π 0:2L ≤ ,Δ≥ = 0:064L Δ L π  ð9:77Þ  6 Actually we should consider the spectrum of the target normalized to the square root of the depth; but for a qualitative evaluation we can neglect this, especially if we consider a vertically thin target.  DT RELATIONSHIP IN THE PRESENCE OF BACKGROUND REMOVAL  163  On the other hand, to increase the offset indeterminately is not a good idea. In fact, apart some possible degradation of the signal-to-noise ratio, we have to consider the problem of the periodicity of the sine function. In particular, the zeroes of the sine are at a 2π=Δ distance from each other; and this means that, in order to avoid that further erasing belts enter the retrievable spectral set, we should also guarantee the condition 2π 0:2 6:08 3:04 0:48λsmin = − = ≥ 2ksmax sin ðθemax Þ , Δ ≤ Δ Δ Δ ksmax sin ðθemax Þ sin ðθemax Þ  ð9:78Þ  It is not an easy task to establish a priori an optimal choice for Δ, but Eqs. (9.77) and (9.78) provide two relevant trade-offs. Let us also note that the two conditions (9.77) and (9.78) are incompatible with each other if L > 0:48λsmin =0:064 sin ðθemax Þ = 7:5λsmin = sin ðθemax Þ. The coefficient 7.5 becomes larger if the criterion for the choice of the erase band is relaxed (e.g. −30 dB instead of −20 dB). However, the general sense of Eq. (9.78) is that the targets horizontally large in terms of wavelength will be poorly reconstructed under a differential configuration, especially if buried at a shallow depth. Four examples are shown in Figures 9.19 and 9.20. In particular, in Figure 9.19 the erasing effect is shown at several values of the offset, and the resulting spectral sets are shown in Figure 9.20.  9.14 DT RELATIONSHIP IN THE PRESENCE OF BACKGROUND REMOVAL Let us now consider the DT in the presence of background removal (BKGR). The hypotheses adopted are the same of the previous section. The BKGR is a procedure widely known and exploited (Conyers, 2004), and it is also widely known that the BKGR constitutes a spatial filtering. A quantitative evaluation of the spatial filtering effects of the BKGR has been provided, in recent years, in Persico and Soldovieri (2008) and in Persico and Soldovieri (2010). So, let us consider relationship (7.11), that provides the datum under background removal in frequency domain. The Fourier transform of Eq. (7.11) with respect to the abscissa provides "  # N X 1 expð − jpnsÞ E^b ðp, ωÞ = E^s ðp, ωÞ 1 − 2N + 1 n = − N  ð9:79Þ  By following the same formal passages shown in Chapter 3 [see Eq. (3.18)], Eq. (9.79) can be still rewritten as  DIFFRACTION TOMOGRAPHY  164  (a)  ζ [m–1]  80 60 40 20 0  –50  0  50  η [m–1]  (b)  ζ [m–1]  80 60 40 20 0  –50  0  50  η [m–1]  (c)  ζ [m–1]  80 60 40 20 0  –50  0  50  η [m–1]  (d)  ζ [m–1]  80 60 40 20 0  –50  0  50  η [m–1]  Figure 9.19. Red dashed lines: the modulus of the erasing function (emphasized by a factor 5 for graphic reasons). Blue dot lines: the erasing belts deriving from the erasing function. Solid black line: the spectral set without the differential effect. The parameters are: fmin = 200 MHz, fmax = 600 MHz, εsr = 4, μsr = 2. Panel a: Δ = 3.83 cm. Panel b: Δ = 7.65 cm. Panel c: Δ = 10.21 cm. Panel d: Δ = 15.31 cm. The erased belt is calculated according to Eq. (9.75). For color detail, please see color plate section.  80  80  60  60  ζ [m–1]  ζ [m–1]  DT RELATIONSHIP IN THE PRESENCE OF BACKGROUND REMOVAL  40 20 0  40 20  –50  0  0  50  –50  –1  50  η [m ]  80  80  60  60  ζ [m–1]  ζ [m–1]  0 –1  η [m ]  40 20 0  165  40 20  –50  0  50  0  –50  η [m–1]  0  50  η [m–1]  Figure 9.20. The resulting retrievable spectral sets in relationship to Figure 9.19.  2  3  ps sin ð 2N + 1 Þ 1 6 ps 2 7 E^b ðp, ωÞ = f1 ðpÞE^s ðp, ωÞ = 41 − 5E^s ðp,ωÞ 2N + 1 sin 2  ð9:80Þ  Substituting E^s ðp,ωÞ from Eq. (9.11), we have E^b ðp, ωÞ = f ðp, ωÞf1 ðpÞχ^^e1 ðηðpÞ,ςðpÞÞ  ð9:81Þ  where the transformation of coordinates is given by Eq. (9.14), the spectral weight f(p,ω) is given in Eq. (9.12), and the further spectral weight f1(p) is specified in Eq. (9.80) and is the complement to 1 of a normalized Dirchlet sine function. With respect to Eq. (9.11), Eq. (9.80) just shows the extra-spectral weight f1(p). The dealing reveals noticeable similarities to that relative to a differential configuration, where the substantial effect of the displacement of source and receivers is to provide a spectral extra-weight. We might even say that the differential configuration is an hardware way to implement a simple kind of background removal. The extra-weight f1(p) is quantitatively represented in four cases in Figure 9.21. The effect of the weighting function on the retrievable spectral set is in some aspect analogous to that illustrated in Figures 9.19 and 9.20 with regard to a differential configuration. In particular, similar to the case of a differential configuration, the extra-weight is periodical and has a root at p = η = 0. So, also the background removal necessarily involves a filtering of the lowest horizontal spatial frequencies, with periodical erasing belts of the same thickness in the plane (η,ς). The wideness of the main lobe of the Dirichlet sine at hand is given by  DIFFRACTION TOMOGRAPHY  166  4π ð2N + 1Þs  ð9:82Þ  and the function is periodic with period P=  2π s  ð9:83Þ  Consequently, in order to guarantee that there is only the central “erasing belt” within the retrievable spectral set, we have to guarantee that 2π 2π 4πN Nλslmin − = ≥ 2kslmax sin ðθeslmax Þ , s ≤ ð2N + 1Þ sin ðθeslmax Þ s ð2N + 1Þs ð2N + 1Þs  ð9:84Þ  Also in this case, we have to minimize the thickness of the central horizontal belt. However, this time we have at our disposal two parameters to handle, namely the number of averaged traces and the spatial step s of the data.7 Actually, the product (2N + 1)s in Eq. (9.82) has the physical meaning of the “averaged distance” along the B-scan, starting at a distance s=2 before the first averaged trace and ending at a distance s=2 after the last one. The importance of having two parameters at our disposal is that we can reduce the thickness of the central erasing belt without “pulling in” further erasing belts within the spectral retrievable domain. To do this, we have to increase the number of averaged traces without enlarging the spatial step. On the other hand, it is also wrong to choose a spatial step too narrow. In this way, in fact, the background removal makes the scattering operator tend toward a null operator unless the number of averaged traces is correspondingly increased. In other words, if the averaged traces are too close to each other, their average value is substantially the same as the central trace, and so the difference between the two quantities vanishes. The averaged length should also account for the kind of targets looked for. In particular, we can define a critical length equal to L = ð2N + 1Þs  ð9:85Þ  The critical length represents the maximum horizontal size that a target should have in order not to be strongly filtered out by the background removal. The proof is straightforward on the basis of the same reasoning of the previous section. With regard to the choice of an optimal N, due to Eq. (9.82), we have that the maximum amount of information is achieved when all the gathered traces are averaged, because this choice makes the critical length substantially as long as the entire B-scan. Practically, some further issues should be accounted for. One of them is the smoothness of the possible layering—that is, the flatness of the interface layers. Another issue is the possibility that a strong scattering object modifies the retrieved average value of the traces at a fixed time depth. Both these phenomena are not accounted for within a BA 7 The offset between the antennas, unlike the differential configuration, represents at a first approximation just a phase term.  DT RELATIONSHIP IN THE PRESENCE OF BACKGROUND REMOVAL  167  (a) 1.5 1 0.5 0 –50  0  50  p [m–1]  (b) 1.5 1 0.5 0 –50  0  50  p [m–1]  (c) 1.5 1 0.5 0 –50  0 p [m  50 –1]  (d) 1.5 1 0.5 0 –50  0  50  p [m–1]  Figure 9.21. The masking function f1(p) under background removal. Panel a: N = 5, s = 10 cm. Panel b: N = 5, s = 20 cm. Panel c: N = 10 , s = 20 cm. Panel d: N = 10, s = 10 cm.  DIFFRACTION TOMOGRAPHY  168  model funded on a couple of homogeneous half-spaces. It is also important to emphasize the fact that, usually, commercial codes do not account for the performed background removal when performing the migration (dealt with in the next chapter) of the data, which instead should theoretically be done. All these factors can make a moving average BKGR preferable. The evaluation of the best choice, in many cases, can be only heuristic—that is, performed on the basis of the results achieved from several applied BKGRs. To sum up, it has been shown that the BKGR, as any spatial filtering, has some drawbacks. In particular, it unavoidably involves some filtering effect on the targets of interest too. In many cases the background removal is needed, and this drawback is just a price to be paid. However, sometimes the targets are deep enough and the scenario is quite “clean.” In these cases, it is not well-advised to apply the BKGR. In Section 15.8 the reader can find some exercises on the effects of the background removal. Please note that they are also based on the 2D migration exposed in Chapter 10 and on the SVD theory exposed in Chapter 14.  QUESTIONS 1. 2. 3. 4. 5. 6. 7. 8. 9. 10. 11. 12.  On which parameters does the visible interval depend? Do the spatial and frequency steps affect the retrievable spectral set? Do the time step and the time bottom scale influence the spectral retrievable set? Does a narrowing of the spatial (frequency) step essentially improve the available horizontal (vertical) resolution in any case? Does the resolution essentially improve if the observation line becomes longer? And is this improvement progressive? Does a more directive couple of antennas improve the horizontal resolution? Does a more directive couple of antennas influence the vertical resolution? Could the frequency step needed for data processing be relaxed with respect to that needed for gathering the data with a stepped frequency system? Can the time step needed for data processing be relaxed with respect to that needed in order to properly gather the data with a pulsed system? Can an enlargement of the available band improve the reconstruction? Might it also cause problems? Does a background removal on an increased number of traces increase the theoretical amount of information indefinitely? Does an increased amount of information improve the achieved image?  10 TWO-DIMENSIONAL MIGRATION ALGORITHMS  10.1  MIGRATION IN THE FREQUENCY DOMAIN  In this section we will focus on data in the frequency domain, and in the next one we will focus on data in the time domain. In both cases, we will limit ourselves to the case of common offset data gathered at the air–soil interface, as well as to the case of only dielectric soils and dielectric targets. Let us start from Eq. (9.11), reported here for sake of easy readability; E^s ðp;ωÞ = f ðp; ωÞχ^^e1 ðηðp, ωÞ, ςðp, ωÞÞ  ð10:1Þ  where (let us remind ourselves)  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  169  TWO-DIMENSIONAL MIGRATION ALGORITHMS  170      p π   3 ω2 I0 μ20 μs exp jΔ exp j sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2 4 p π kzs f ðp; ωÞ = −     2 2 p p c μ0 kzs + μs kz0 2 2     2 3=4 pﬃﬃﬃ p π ω p2 ω2 π I0 μ20 μs exp jΔ exp j − 2 4 c2 4 =− sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ !2 ω2 p2 ω2 p2 c μ0 − + μs − 2 c 4 c20 4 χ e ðx0 ,z0 Þ pﬃﬃﬃ z0 ﬃ s ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ r    2  2 sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ p2 2 p ω p 4ω ηðp, ωÞ = p, ςðp, ωÞ = 2kzs = 2 ks2 − − − p2 = =2 c2 2 2 c 2 χ e1 ðx0 ,z0 Þ =  ð10:2Þ  ð10:3Þ ð10:4Þ  The transformation (10.1) is algebraically inverted as χ^^e1 ðηðp, ωÞ,ςðp, ωÞÞ = gðp, ωÞE^s ðp;ωÞ  ð10:5Þ  where 8 > > > > > > <  sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ!2    ω2 p2 ω2 p2 p π c μ0 − − exp − j Δ + + μ s 2 4 c2 4 c20 4 1 = − ,  2  gðp,ωÞ = f ðp; ωÞ 3=4 2 > p ﬃﬃﬃ ω p > 2 > ω 2 I0 μ0 μ s π 2 − > > c 4 > : 0 ðp, ωÞ 2 =Ω  ðp,ωÞ 2 Ω  ð10:6Þ where Ω is meant as the visible 2D multifrequency set, that ranges in the interval [ωmin, ωhmax] along the ω-axis and ranges in the interval ½ − 2ks sin ðθemax Þ, i ω ω 2ks sin ðθemax Þ = − 2 sin ðθemax Þ, 2 sin ðθemax Þ along the p-axis at any fixed ω. c c Ω is of course a trapezium in the plane (p,ω). At this point, we can solve for the spectrum of the object function inverting relationship (10.4) between the coordinatives, thereby obtaining a relationship of the form χ^^e1 ðη, ςÞ = gðpðη, ςÞ, ωðη, ςÞÞE^s ðpðη, ςÞ, ωðη, ςÞÞ  ð10:7Þ  Equation (10.7) is a nonambiguous relationship because the correspondence (10.4) between the point (p,ω) (with p belonging to the visible interval) and the  MIGRATION IN THE FREQUENCY DOMAIN  171  point (η,ς) is bi-univocal.1 Finally, the inverse Fourier transform of Eq. (10.7) in the spatial domain provides the solution of the problem, given by 1 χ e1 ðx ,z Þ = 2 4π 0 0  +∞ ð +∞ ð  gðpðη,ςÞ,ωðη,ςÞÞE^s ðpðη, ςÞ, ωðη, ςÞÞ expðjηx0 Þexpðjςz0 Þ dηdς  −∞ −∞  ð10:8Þ Equation (10.8) can be explicated inverting Eq. (10.4), thereby obtaining2 pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ c η2 + ς2 pðη, ςÞ = η, ωðη, ςÞ = 2  ð10:9Þ  which provides 1 χ e1 ðx ,z Þ = 2 4π 0 0  +∞ ð +∞ ð  c g1 ðη,ςÞE^s η,  −∞ −∞  pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ! η2 + ς2 expðjηx0 Þexpðjςz0 Þ dηdς 2  ð10:10Þ  with pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ! c η2 + ς2 g1 ðη,ςÞ = g η, 2 8 sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ﬃ!!2  2     > > c η π > > 2 2 > η μ ς + μ −1 + ς exp −j Δ + p ﬃﬃ ﬃ > 0 s < c0 2 4 2 2 pﬃﬃﬃ , = − 2   > cI0 μ0 μs π 3=2 > 2 2 > η +ς ς > > > : 0, ðη,ςÞ 2 = Ω1  ðη,ςÞ 2 Ω1  ð10:11Þ where Ω1 is the image in the plane (η,ς) of the set Ω through the transformation (10.4), which is just the retrievable spectral set. Equation (10.10) constitutes a migration formula in frequency domain. It essentially consists in an interpolation of the spectrum of the data multiplied times a known function and then back Fourier transformed in the spatial domain. Equation (10.10) has the drawback that it requires some interpolation of the spectrum of the data, but has the computational advantage that it is a two-dimensional 1  Let us stress that this depends on the fact that we are considering the multibistatic (common offset) configuration. For example, if the source and the receiver can be moved independently from each other, this does not happen (Soldovieri et al., 2005a). 2 We maintain the formal difference between p and η, even if they are numerically the same value, because the two quantities are semantically different: The first one is the conjugate variable of the measurement abscissa, and the second one is the conjugate variable of the abscissa in the investigation domain.  TWO-DIMENSIONAL MIGRATION ALGORITHMS  172  inverse Fourier transform and therefore can be implemented by means of computationally effective IFFT algorithms. Alternatively, we can substitute the following in Eq. (10.10): c pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ η2 + ς2 = ω ) ς = 2  rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 4ω2 2 − η ) dς = c2  4ωdω sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 4ω2 2 −η c2 c2  ð10:12Þ  thereby obtaining 1 χ e1 ðx ,z Þ = 2 2 c π 0 0  +∞ ð +∞ ð  −∞ −∞  rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ! 4ω2 2 0 g2 ðη, ωÞE^s ðη, ωÞ expðjηx Þ exp j − η z dηdω ð10:13Þ c2 0  where g2 ðη,ωÞ  0 sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ1 4ω2 2 A 4ωg1 @η, −η c2 sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ = 4ω2 2 −η c2 c2 ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 8 0 0v 00 12 1112 u sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ >    u 2 > 2 > 4ω 4ω η π > B Bu CC 2 2 @@ c A > A t > + + μ μ −η + η −2 exp − j Δ @ @ A A 0 s > > c0 2 4 pﬃﬃﬃ c2 c2 < = − 32 2pﬃﬃﬃ   2 5=4 > > 4ω2 2 > cI0 μ0 μs π > > ω −η > 2 > c > : 0, ðη,ωÞ 2 =Ω  ðη, ωÞ 2 Ω,  ð10:14Þ where Ω is the same set defined after Eq. (10.6), this time formally represented in the plane (η,ω) instead of (p,ω) Equation (10.13) is an alternative form of the migration in the frequency domain, where no interpolation of the data is required but, on the other hand, the achieved integral is not an inverse Fourier transform and thus cannot be calculated by means of a fast IFFT algorithm. Equations (10.10) and (10.13) express the so-called Stolt’s migration or f − k (or ω − k) migration (Stolt, 1978). The name derives from the fact that the integration can be performed either making use of the variable ω or of the variable ς, labeled elsewhere as k.3 Actually, we can also adopt a more simple migration formula that does not include the factor g2(η,ω).  We have preferred the symbol ς in order to avoid a possible confusion between the vertical spatial frequencies of the spectrum of the object function and the wavenumber.  3  MIGRATION IN THE FREQUENCY DOMAIN  F χ e1 ðx0 ,z0 Þ = 2 2 c π  +∞ ð +∞ ð  −∞ −∞  173  rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ! 4ω2 2 0 − η z dηdω E^s ðη, ωÞexpð jηx0 Þexp j c2  ð10:15Þ  where F is a unitary but not dimensionless factor, included just in order to preserve the dimensional coherence of the equation (the factor g2(η,ω), in fact, was not dimensionless). In particular, the integration ranges on the entire 2D plane relying on the fact that the integrand E^s ðη, ωÞ attenuates outside the multifrequency visible spectrum. Equation (10.13) is obviously mathematically more rigorous than Eq. (10.15.) However, Eq. (10.15) is somehow more robust against uncertainties on the sources and the receiver and against the singular behavior of the spectral weight g2(η,ω) for η ! ± 2ks.4 It is also much more similar to the classical migration formulas derived from the seismic (Stolt, 1978). Assuming the model of Eq. (10.15) for the integration in dηdω, the integration in dηdς can be performed according to the substitution rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 4ω2 2 c η2 + ς2 cς dς c dς = ς ) ω = ) dω = pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ = sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ − η 2 2 c2 2 2 η +ς η2 2 1+ 2 ς  ð10:16Þ  And consequently (Stolt, 1978; Oden et al., 2007) Eq. (10.15) can be also written as  F χ e1 ðx0 ,z0 Þ = 2cπ 2  +∞ ð +∞ ð E^s  −∞ −∞  pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ! η2 + ς 2 η, 2 sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ expð jηx0 Þ expð jςz0 Þ dηdς 2 η 1+ 2 ς c  ð10:17Þ  The two formulas (10.15) and (10.17) show the same trade-offs as the formally more rigorous formulas (10.10) and (10.13), namely one of them (10.17) is an inverse Fourier transform but requires some interpolation of the data and the other one (10.15) does not require any interpolation but is not an inverse Fourier transform. There is also a third possible form for the migration integral, that can be worked out expressing the integral (10.10) in polar coordinatives in the plane (η,ς). In particular, let us put η = k cos ðΦÞ,  4  ς = k sin ðΦÞ  ð10:18Þ  Theoretically, this diverging behavior is counteracted by the fact that the spectrum of the scattered field should be a null quantity at the edge of the visible interval, but the parametric uncertainties in general affect this equilibrium.  TWO-DIMENSIONAL MIGRATION ALGORITHMS  174  Substituting into Eq. (10.10), we have   ðπ +∞ ð 1 ck χ e1 ðx ,z Þ = 2 dϕ kg1 ðk cos ðϕÞ, k sin ðϕÞÞE^s k cos ðϕÞ, 4π 2 0 0  0  0  × expðjk cos ðϕÞx0 Þexpðjk sin ðϕÞz0 Þ dk  ð10:19Þ  and, after the further change of variable θ = ϕ−  π 2  ð10:20Þ  we obtain π  1 χ e1 ðx0 ,z0 Þ = 2 4π  ð=2  +∞ ð  dθ −π=    ck ^ kg1 ð − k sin ðθÞ, k cos ðθÞÞEs − k sin ðθÞ, 2  0  2  × expð − jk sin ðθÞx0 Þ expðjk cos ðθÞz0 Þ dk  ð10:21Þ  Equation (10.21) requires an interpolation of the data and is not a double inverse Fourier transform. Therefore, it is not commonly exploited. However, it can be instructive because it shows directly the essential role of the view angle and of the band. In particular, in Eq. (10.21), θ is easily recognized to be just the view angle, whereas k is easily recognized to be the wavenumber. This also allows us to express explicitly (instead of implicitly by means of the essential support of g1) the extremes of integration—that is, to express a regularized migration integral formula. In particular, supposing that the maximum view angle is symmetric, Eq. (10.21) can be rewritten as 1 χ e1 ðx ,z Þ = 2 4π 0 0  θemax ð  2kð smax  dθ − θemax    ck ^ kg1 ð − k sin ðθÞ, k cos ðθÞÞE s − k sin ðθÞ, 2  2ksmin  × expð − jk sin ðθÞx0 Þexpð jk cos ðθÞz0 Þ dk  ð10:22Þ  Of course, it is possible to provide a “polar” migration formula also neglecting the spectral weight, within a nonrigorous but somehow more robust formulation. This can be derived e.g., from Eq. (10.17) after some straightforward manipulations, so to obtain F χ e1 ðx ,z Þ = 2cπ 2 0 0  2kð smax  θ emax ð  cos ðθÞdθ − θemax    c k E^s − k sin ðθÞ, k 2  2ksmin  × expð − jk sin ðθÞx0 Þ expð jk cos ðθÞz0 Þ dk  ð10:23Þ  MIGRATION IN THE TIME DOMAIN  10.2  175  MIGRATION IN THE TIME DOMAIN  Raffaele Persico and Raffaele Solimene In GPR prospecting, it is often found comfortable to migrate the data in the time domain. The formula for the migration in the time domain can be worked out starting from Eq. (10.13) and observing that, by definition,  E^s ðη, ωÞ =  +∞ ð +∞ ð  Es ðx, t Þ expð − jηxÞexpð − jωt Þ dxdt  ð10:24Þ  −∞ 0  where the extremes of the integral account for the fact that the signal starts at the time instant t = 0. Substituting Eq. (10.24) into Eq. (10.13), we obtain  1 χ e1 ðx0 ,z0 Þ = 2 2 c π  +∞ ð  +∞ ð  +∞ ð  dtEs ðx, t Þ  dx −∞  0  +∞ ð  +∞ ð  2 +∞ ð expð − jωt Þ4 g2 ðη, ωÞ  −∞  −∞  0 vﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 1 3 u 2 u4ω × expð − jηðx −x0 ÞÞ exp@jt 2 − η2 z0 A dη5dω c 1 = 2 2 c π  dx −∞  g3 ðx − x0 ,z0 ,t ÞEs ðx, t Þ dt  ð10:25Þ  0  Equation (10.25) expresses the most general form of the migration in the time domain, also called Kirchhoff’s migration, where the convolutional weight in the time domain is given by  g3 ðx − x0 ,z0 ,tÞ =  +∞ ð  −∞  2 +∞ sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ! 3 ð 4ω2 2 0 expð − jωt Þ4 g2 ðη,ωÞ × expð −jηðx − x0 ÞÞ exp j −η z dη5dω c2 −∞  ð10:26Þ The integral (10.26) cannot be solved in a closed form, but can be effectively calculated because, for any fixed z0 , it is the double Fourier transform of the quantity g2 ðη, ωÞ  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ  2 2 0 calculated in the points x − x0 and t. However, as said in the previous exp j 4ω c2 − η z section, the spectral weighting is often neglected, following seismic models. In the case at hand, this provides the following expression for the migration in the time domain:  TWO-DIMENSIONAL MIGRATION ALGORITHMS  176  F χ e1 ðx0 ,z0 Þ = 2 2 cπ  +∞ ð  +∞ ð  dtEs ðx, t Þ  dx −∞  +∞ ð  0  #  −∞  2 +∞ 0 vﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 1 ð u 2 u4ω 4 @ expð − jωt Þ exp jt 2 −η2 z0 A c −∞  × expð − jηðx − x0 ÞÞdη dω  ð10:27Þ  where again F is meant as unitary but not dimensionless. Under the approximated model of Eq. (10.27), the double integral in square brackets can be calculated in a closed form. To show this, let us preliminarily write rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ! 4ω2 2 0 +∞ ð exp j c2 − η z ð +∞ rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ expð − jηðx − x0 ÞÞexpð − jωt Þ dηdω ð10:28Þ g4 ðx − x0 , z0 , t Þ = 4ω2 2 −∞ −∞ −η j c2 The integral in dη in Eq. (10.27) is proportional to the Hankel function of zeroth order and of second kind (Harrington, 1961). Physically, this means that by neglecting the spectral weight we essentially neglect the interface and assimilate the air–soil space to a homogeneous medium entirely composed of “soil.” It is immediate that the integral (10.28) can be rewritten as F ∂ χ e1 ðx ,z Þ = 2 2 0 c π ∂z 0 0  +∞ ð  +∞ ð  dx −∞  g4 ðx −x0 , z0 , t ÞEs ðx, t Þ dt  ð10:29Þ  0  At this point, the integral expansion of Eq. (10.28) can be also rewritten as follows (Heidary, 2003):  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2ω +∞ ðx − x0 Þ2 + z0 2 + y2 ð +∞ ð exp j c qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ g4 ðx − x0 ,z0 , t Þ = expð − jωt Þ dydω 0 Þ2 + z0 2 + y2 x − x ð −∞ −∞ +∞ ð  +∞ ð  expð − jωt Þ dω  =2 −∞  0   qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2ω exp j ðx − x0 Þ2 + z0 2 + y2 c qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ dy ðx − x0 Þ2 + z0 2 + y2  ð10:30Þ  The passages that work out Eq. (10.30) from Eq. (10.28) are shown in Appendix A. So, substituting Eq. (10.30) into Eq. (10.29), we obtain  MIGRATION IN THE TIME DOMAIN  χ e1 ðx0 ,z0 Þ =  =  2F ∂ c2 π 2 ∂z0  +∞ ð  +∞ ð  dx −∞    2  +∞ ð  6 dtEs ðx,t Þ6 4  +∞ ð  expð − jωt Þ −∞  0  177  0  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 3 2ω exp j ðx − x0 Þ2 + z0 2 + y2 7 c qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ dy7 5dω ðx − x0 Þ2 + z0 2 + y2  ð10:31Þ At this point, let us write τ=   2 qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ τc 2 ðx − x0 Þ2 + z0 2 + y2 ) y2 = − kr − r0 k 2 sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ﬃ sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ  2 τc c 4kr − r0 k2 2 )y= − kr − r0 k = τ2 − c2 2 2 2 c  c τdτ ) dy = sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2 4kr − r0 k2 τ2 − c2  ð10:32Þ  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ where of course kr − r k = ðx − x0 Þ2 + z0 2 . Substituting in Eq. (10.31), we have, with straightforward manipulations, the following: 0  χ e1 ðx0 ,z0 Þ =  2  2F ∂ = 2 2 0 c π ∂z  F ∂ = 2 2 0 c π ∂z  =  2F ∂ c2 π ∂z0  2F ∂ = 2 c π ∂z0  +∞ ð  +∞ ð  dx −∞  0  +∞ ð  +∞ ð  dx −∞  0  +∞ ð  +∞ ð  −∞  0  +∞ ð  +∞ ð  0  +∞ ð  +∞ ð dτ sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ expðjωðτ −t ÞÞ dω dtEs ðx,t Þ 4kr− r0 k2 −∞ 2kr −r0 k τ2 − c c2 +∞ ð  δðτ −t Þdτ sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 4kr −r0 k2 2kr−r0 k 2− τ c c2 +∞ ð  dtEs ðx, t Þ  dx −∞  +∞ 6 +∞ 7 ð ð 6 7 expð jωτÞ cτ 1 6 7dω ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ﬃ s dtEs ðx, t Þ6 expð −jωt Þ × dτ cτ 7 2 0 2 4 5 4kr−r k −∞ 2kr −r0 k 2− 2 τ c 2 c  dtEs ðx, t Þ  dx  3  δðuÞdu sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 0 2 2 4kr−r k 2kr−r0 k − ð u + t Þ − t c c2  ð10:33Þ  TWO-DIMENSIONAL MIGRATION ALGORITHMS  178  At this point, we have  +∞ ð  δðuÞ du sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 4kr− r0 k2 2kr −r0 k ðt + uÞ2 − −t c c2 8 > > 0 > > > > < =  if  2kr −r0 k −t > 0 c  1 sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ > > > > 4kr− r0 k2 > > : t2 − c2  if    2kr −r0 k H t− c δðuÞ du 2kr− r0 k sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ = sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ −t < 0 ) 0 2 4kr− r k 4kr−r0 k2 c 2kr − r0 k t2 − ðt + uÞ2 − −t c 2 c c2 +∞ ð  ð10:34Þ where H is the Heaviside’s function, equal to 1 if its argument is greater than 0 and equal to 0 if its argument is negative. Substituting Eq. (10.34) into Eq. (10.33), we achieve  χ e1 ðx0 ,z0 Þ =  2F ∂ c2 π ∂z0  2F ∂ = 2 c π ∂z0  +∞ ð  +∞ ð  dx    2kr − r0 k H t− c ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ dtEs ðx,t Þ v u u 2 4kr −r0 k2 tt − c2  −∞  0  +∞ ð  +∞ ð  Es ðx, t Þ vﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ dt u u 4kr − r0 k2 2kr− r0 k t 2 t − c c2  dx −∞  ð10:35Þ  Equation (10.35) expresses the migration in time domain, or Kirchhoff’s migration, in a way similar to the classical seismic formulation as given in (Schneider, 1978). In particular, having neglected the spectral weight g2(η,ω) the convolutional weight ﬃ  .qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 0 0 2 g3(x − x0 , z0 , t) has been calculated as H t − 2kr c− r k t2 − 4kr c−2r k . Performing the derivative ∂=∂z0 under the sign of integral (and accounting for the fact that ∂kr −r0 k=∂z0 = z0 =kr − r0 k = cos ðθÞ is just the cosine of the view angle), we obtain another expression for the Kirchhoff’s migration formula:  MIGRATION IN THE TIME DOMAIN  +∞ ð  +∞ ð  Es ðx, tÞ sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ dt 4kr −r0 k2 −∞ 2kr− r0 k 2− t c c2   2kr − r0 k +∞ +∞ Es x, u + ð ð c 2F ∂ ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ dx s = 2 du 2 c π ∂z0 0 2kr− r k 4kr − r0 k2 −∞ 0 − u+ c c2     2kr − r0 k 2kr − r0 k +∞ +∞ +∞ +∞ Es x, t + ð ð ð Es x, u + ð c c 2F ∂ 2F ∂ 1 sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ dx = 2   du = c2 π ∂z0 dx pﬃt sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ  ﬃ dt 0 0 c π ∂z0 4 r −r 4 r− r k k k k −∞ −∞ 0 0 u u+ t+ c c   0 2kr− r k +∞ +∞ Es x, t + ð ð c 2F 1 ∂ dx pﬃ 0 sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ = 2  ﬃ dt cπ t ∂z 4kr −r0 k −∞ 0 t+ c   0  1 ∂ 2kr− r0 k 2kr − r0 k E x, t + s +∞ +∞ B C Es x, t + ð ð c C c 4F 1 B∂t C dt  s ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ﬃ dxcos ðθÞ pﬃ B ð10:36Þ − = 3   3 C   0 cπ tB 0 2A @ 4 k r− r k 4 r− r k k −∞ 0 t+ t+ c c  χ e1 ðx0 ,z0 Þ =  2F ∂ c2 π ∂z0  179  dx  sometimes (indeed more often in seismic than in GPR applications) it is used a far-field approximation of Eq. (10.36) that retains only the first term in the parentheses, which decays more slowly than the other one versus the distance kr − r0 k. Making use of Heaviside’s function, this approximated far-field formula can be written as   ∂ 2kr −r0 k Es x,t + +∞ +∞ ð ð c 4F 1 ∂t 0 0 ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ s χ e1 ðx ,z Þ = 3 dx cos ðθÞ pﬃ  ﬃ dt 0 cπ t 4 k r−r k −∞ 0 t+ c   ∂ 2kr −r0 k x,t + E s +∞ +∞ ð ð c 4F H ðt Þ ∂t pﬃ sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ = 3 dx cos ðθÞ  ﬃ dt 0 cπ t 4 k r−r k −∞ −∞ t+ c  =  4F c3 π  dx cos ðθÞ −∞    ∂ 2kr −r0 k Es ðx, t = τÞ τ− ∂t c sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ  ﬃ dτ 2kr −r0 k 2kr−r0 k τ− τ+ c c  +∞ ð H  +∞ ð  −∞  ð10:37Þ  TWO-DIMENSIONAL MIGRATION ALGORITHMS  180  0  −  At this point, let us note that the integrand is null up to the time instant τ = 2kr−c r k whereas, qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 0 + 0 afterward, we have that the piece with τ − 2kr−c r k is singular at τ = 2kr−c r k , whereas the ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ﬃ q 0 piece with τ + 2kr−c r k is instead quite flat because of the far field hypothesis. So, there is an error vanishing versus kr − r0 k if we introduce the further approximation rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2kr − r0 k 2kr − r0 k ≈ τ+ τ+  c c   τ=  rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 4kr − r0 k 2 kr − r0 k pﬃﬃﬃ = = c c 2kr −r0 k  ð10:38Þ  c  Under this approximation, we have   2kr− r0 k H τ − c 2F cos ðθÞ ∂ qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ dx pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ Es ðx, t = τÞ dτ χ e1 ðx0 ,z0 Þ = 2:5 0 0 c π ∂t kr − r k τ − 2kr c− r k −∞ −∞ +∞ ð  +∞ ð  ð10:39Þ  H ðt Þ The integral in dτ is the convolution product between the two functions pﬃ and t ∂ Es ðx, t Þ, calculated in the point t = 2kr − r0 k=c. This convolution is equal to the so-called ∂t “half-derivative” of the electric field (see Appendix B), so that Eq. (10.37) can be also written with a more compact notation as (Gazdag and Squazzero, 1984) 2F χ e1 ðx ,z Þ = 2:5 c π 0 0  +∞ ð  −∞    cos ðθÞ ∂0:5 2kr − r0 k dx pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 0:5 Es x,t = c kr − r0 k ∂ t  ð10:40Þ  In order to compare the obtained formulas (both in frequency and in time domain) with the “classical” formulas available in the literature, a brief aside is still needed. In particular, in the classical migration algorithms derived from the seismic processing (Schneider, 1978), the unknown looked for is not the contrast but the scattered field in the time domain in the buried investigated points (Es(x0 ,z0 ,0)) starting from the scattered field in the observation line in air (Es(x0 ,0,t)). This involves the fixing of a conventional zero time at the instant when the buried point begins its re-scattering of the energy impinging on it. Of course, the buried targets are not illuminated at the same instant, because of the finite velocity of propagation of the incident field radiated by the primary sources, and this is “amortized” by considering waves that “start” from the buried points within the investigation domain at the same instant but propagate at one-half the actual propagation velocity of the electromagnetic waves in the soil. Such a formulation is not rigorous in the framework of Maxwell’s equations, because the propagation velocity is univocally determined by the same Maxwell’s equations. So, we have recast (as often is done in the literature on inverse problems) the problem in terms of contrast functions. In particular, the contrast does not represent the “temporal  MIGRATION IN THE TIME DOMAIN  181  origin” of the scattered field, but rather its “causal origin.” That said, the interested reader can compare the retrieved migration formulas in frequency domain with Eqs. (51) and (52) in (Stolt, 1978) and the retrieved migration formulas in time domain with Eq. (12) in Schneider (1978): He/she will see that, if the spectral weight is neglected, then the integrals are the same. The Stolt’s and the Kirchhoff’s migrations are equivalent in theory, but the Kirchhoff’s formulation allows us to impose more immediately some regularization. In particular, when performing the numerical integration of the data along the x-axis,we can limit the integration interval on the basis of the wideness of the visible diffraction curves. This implicitly means to choose the extension of the spectral retrievable set in relationship to the maximum effective view angle. Several commercial codes for GPR data processing allow us to choose the number of traces to be taken into account when performing the Kirchhoff’s migration (but usually not when performing the Stolt’s migration), which is equivalent to limiting the extremes for the integration in dx.  QUESTIONS 1. Do 2D migration algorithms account for all the aspects of the 2D electromagnetic scattering? 2. Are 2D migration algorithms directly derived by the Born approximation? 3. Is the air–soil interface accounted for in migration algorithms? 4. Can the radiation pattern of the antennas be partially (roughly) accounted for within a commercial migration code for migration, even if not explicitly enclosed in the available menus? 5. Is it always true that to account for the spectral weight improves the result? 6. Suppose we perform a GPR prospecting crossing a buried empty crypt. The crypt is at the depth of 1 m, and its cross section is about 2 m long and 3 m deep. The soil shows a relative permittivity equal to 9, no magnetic properties are present, and the losses are negligible. The B-scan is centered on the crypt and is 9 m long. The central frequency of the antennas is 500 MHz. What apparent size would show the room after being focused by means of a standard migration algorithm accounting for the propagation velocity of the surrounding soil? Suppose now that the room is filled with fresh water and that the water is so pure (low concentrations of salts) that it allows the penetration of the GPR signal until the bottom and then back until the antennas. What apparent size would provide the standard migration algorithm in this case?  11 THREE-DIMENSIONAL SCATTERING EQUATIONS Lorenzo Lo Monte, Raffaele Persico, and Raffaele Solimene  11.1 SCATTERING IN THREE DIMENSIONS: REDEFINITION OF THE MAIN SYMBOLS So far, the discussion has been focused on 2D inverse scattering. This is the most common model in GPR data processing. However, recent advances in distributed GPR, coherent GPR, HF GPR, and RF tomography led to an extension of classical 2D work in a more proper 3D scenario. The basic principles hold the same, but the formulas become more complicated. To avoid confusion, we will differentiate between 2D and 3D geometries by renaming our previous variables with different symbols. In this chapter: • E is a 3D complex vector representing the electric field; similarly, Einc will be the incident field and Es will be the scattered field. • rs = xsix + ysiy + zsiz is the source point. Since we are dealing with 3D space, the source must also have an orientation vector, which is the direction of the effective length of the transmitting antenna; this vector is labeled ^a (see Figure 11.1).  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  182  SCATTERING IN THREE DIMENSIONS: REDEFINITION OF THE MAIN SYMBOLS  iz  Tx â  183  rs  iy  ix  Rx  r0  b̂  ε0, μ0 εs, μ0  Σ D r  aly  Anom  Figure 11.1. Geometry of the problem.  • r0 = x0ix + y0iy + z0iz is the receiver point. Since we are dealing with 3D space, the receiver must also have an orientation vector, which is the direction of the effective length of the receiving antenna; this vector is labeled as ^b (see Figure 11.1). • r = xix + yiy + ziz is a generic point within the investigation domain, beneath the air–soil interface. Capitalized, bold, and underlined quantities describe dyadics, which are represented by 3 × 3 matrices as described in Tai, (1991). Bold variables represent vectors, and circumflexed vectors are real-valued with unitary norm, generally representing directions. Within the proposed 3D discussion, we will not consider the case of magnetic anomalies, nor will we consider the case of magnetic soils. In general, a set of n = 1, …, N field measurements are collected: A distinct nth measurement is obtained by varying one of the following: 1. 2. 3. 4. 5.  transmitter position rs transmitter direction ^a (unit norm) receiver position r0 receiver direction ^b (unit norm) angular frequency ω = 2πf  Targets reside only within a volumetric region D named investigation domain. The electric field E [V/m], the magnetic field H [A/m], the electric current density J [A/m2], and  THREE-DIMENSIONAL SCATTERING EQUATIONS  184  the magnetic current density M [V/m2] are all expressed in phasor form using the exp (jωt) convention (Lo Monte et al., 2010). Please note that in Figure 11.1 the z-axis is oriented versus the air, unlike the convention followed for the 2D dealing (see Figure 4.1).  11.2  THE SCATTERING EQUATIONS IN 3D  Due to the linearity of Maxwell’s equations, we can state that the 2D scalar scattering equations (4.44) and (4.45) evolve into a more general formulation given by ððð Eðr,rs Þ = Einc ðr,rs Þ + ks2  χ e ðr0 ÞGi ðr,r0 ÞEðr0, rs Þ dr0 ,  r 2 D,rs 2 Σ  ð11:1Þ  r 0 , rs 2 Σ  ð11:2Þ  D  ððð Es ðr0 ,rs Þ = ks2  χ e ðr0 ÞGe ðr0 , r0 ÞEðr0, rs Þ dr0,  D  where, D is the investigation domain embedded in the soil and Σ is the observation domain in air, as depicted in Figure 11.1. The product between the dyadic Green’s functions and the field is implemented as the usual product between a 3 × 3 matrix times a column vector with three elements. The result is a column vector of three elements that are the components of the vector result along the axes x, y, and z. So, to specify the 3D scattering equations (11.1) and (11.2) means to find the expressions of Green’s functions and (for a given and characterized source) of the incident field.  11.3  THREE-DIMENSIONAL GREEN’S FUNCTIONS  Due to the increased complexity of the 3D dealing, it is useful to generalize the definition of Green’s function. First of all, let us remind that the Green’s function is the response to a spatially impulsive source as has been shown in 2D. In 3D, any Green’s function is dyadic and thus can be expressed by means of a general matrix scheme of the following kind: 0  1 Gxx Gxy Gxz G = @ Gyx Gyy Gyz A Gzx Gzy Gzz  ð11:3Þ  Each element of the matrix is a function of the source point, the observation point, and the frequency. The dyadic nature of Green’s function corresponds to the fact that the source and the resulting electric field in general are not parallel to each other, unlike in the scalar 2D case. It is easily recognized that the generic element of the matrix Ghk (h, k = x, y, z) represents the component along ih of the response to a spatially impulsive source directed along ik.  THE INCIDENT FIELD  185  It may be useful to warn the reader about the fact that in Eqs. (11.1) and (11.2) the Green’s functions have dimensions of m−1, whereas in the scalar 2D equations (4.44) and (4.45) the Green’s functions were dimensionless. Of course, this results from the fact that in the 3D case the scattering equations are based on volume integrals instead of surface integrals. Let us also remind that the internal Green’s function represents the impulsive response of the system with both source and observation points embedded in the soil, whereas the external Green’s function is the impulsive response of the system with source point embedded in the soil and observation point in air (see Chapter 4). This can be better specified by using the subscripts “a” (which stands for “air”) and “s” (which stands for “soil”) as follows: Gss ðr,r0 Þ = Gi ðr,r0 Þ  ðz,z0 < 0Þ,  Gsa ðr,r0 Þ = Ge ðr,r0 Þ  ðz > 0, z0 < 0Þ  ð11:4Þ  It is useful to consider also the two additional quantities Gaa ðr,r0 Þ = internal Green's function in air Gas ðr,r0 Þ = external air−soil Green's function  ðz, z0 > 0Þ, ðz < 0, z0 > 0Þ  ð11:5Þ  In particular, the dual quantities of Eq. (11.5) represent the Green’s function of a formally “mirrored” inverse scattering problem with virtual targets embedded in air and a virtual GPR moving underground. Moreover, it is also useful to consider the degenerated case where the two involved half-spaces have the same electromagnetic characteristics, so that one is actually considering the targets and the GPR embedded in a homogeneous space. In this inverse problem, we cannot distinguish any longer an internal and an external Green’s function, but there is just a unique Green’s function of the medium. Thus, from now on we will label Ga ðr,r0 Þ = Green's function of a homogeneous space made up of air, Gs ðr,r0 Þ = Green's function of a homogeneous space made up of soil  ð11:6Þ  Later on in this chapter, we will see that the half-space Green’s functions (11.4)–(11.5) can be expressed versus the homogeneous Green’s functions of Eq. (11.6). Actually, this happens also in 2D, even if we didn’t need to specify the homogeneous Green’s function in that case.  11.4  THE INCIDENT FIELD  For the three-dimensional case, we will assume a spatially impulsive source directed along the unitary vector ^a, which means that the primary source is described as  THREE-DIMENSIONAL SCATTERING EQUATIONS  186  Jðr0 Þ = I0 lδðr0 − rs Þ^a  ð11:7Þ  where I0 is the current flowing into the dipole and l is its length. Please note that, unlike Chapter 4, we will now make use of the common synthetic notation for the delta function with respect to vector variables, so that, by definition, we mean δðr0 − rs Þ ≡ δðx0 − xs Þδðy0 −ys Þδðz0 − zs Þ  ð11:8Þ  In order to calculate the incident field due to an impulsive primary source, we can start from Eq. (11.2). In particular, based on Eq. (4.20), on Eq. (11.4), and on the definition of the dielectric contrast [see Eq. (4.1)], we can rewrite Eq. (11.2) as Es ðr0 ,rs Þ =  ks2 jω  ððð  Ge ðr0 ,r0 Þjωχ e ðr0 ÞEðr0 ,rs Þ dr0  D  =  ks2 jωε0 εsr  ks2 = jωε0 εsr  ððð  Gsa ðr0 ,r0 ÞjωΔεðr0 ÞEðr0 ,rs Þ dr0  D  ððð  Gsa ðr0 ,r0 ÞJeq ðr0 Þ dr0 = − jωμ0  D  ððð  Gsa ðr0 ,r0 ÞJeq ðr0 Þ dr0 ,  r0 , rs 2 Σ  D  ð11:9Þ At this point, let us note that Maxwell’s equations are the same for both equivalent (secondary) and actual (primary) sources. Consequently, Eq. (11.9) also provides the electric field evaluated in air due to a generic current distribution embedded in the soil, which can be rewritten as ððð Eðr0 Þ = − jωμ0 Gsa ðr0 ,r0 ÞJðr0 Þdr0 , r0 in air, r0 2 D embedded in the soil D  ð11:10Þ For the sake of symmetry, the electric field in the soil due to a generic current distribution embedded in air is given by ððð Gas ðr0 ,r0 ÞJðr0 Þdr0 , r0 in the soil, r0 2 D embedded in air Eðr0 Þ = − jωμ0 D  ð11:11Þ In the special case of the spatially impulsive source given by Eq. (11.7), Eq. (11.11) provides the incident field relative to an impulsive source, that is therefore achieved substituting Eq. (11.7) into Eq. (11.11). The result is Einc ðrÞ = − jμ0 ωI0 lGas ðr,rs Þ^a,  z<0  ð11:12Þ  HOMOGENEOUS 3D GREEN’S FUNCTIONS  187  A similar relationship holds also in 2D, and the reader can retrieve it as an exercise starting from Eq. (4.48). Equation (11.12) provides the incident field to be put into the scattering equation. By a similar derivation, the incident field in air is provided by Einc ðrÞ = − jμ0 ωI0 lGaa ðr,rs Þ^a,  z>0  ð11:13Þ  Often, in 3D cases, rather than the vector incident field, it is important to consider the component along the effective length of the receiving antenna of this incident field. In this text, we will suppose that the receiving antenna is a Hertzian dipole as the transmitting one. Moreover, the derivation will be simplified in the fact that we will not consider the effective length ^ This means that the formal expression of the of the receiving dipole but just its direction b. recorded incident field datum in the observation point (i.e., the direct coupling between the antennas) is given by Einc ðr0 Þ = −jωμ0 I0 l^bGaa ^a,  z>0  ð11:14Þ  In Eq. (11.14) we have used the scalar symbol Einc to indicate the projection of the vector ^ In terms of vector–matrix product, the product in Einc along the unitary vector b. Eq. (11.14) is to be meant as a raw vector (1 × 3) times a matrix (3 × 3) times a column vector (3 × 1). The result is clearly a scalar quantity. The provided dealing shows that, in order to specify the scattering equations, we just need to find Green’s functions Gas , Gsa and Gss , and in order to specify the incident field everywhere (which means to retrieve the theoretical expression of the direct coupling between the antennas) we have to find Gaa . Let us emphasize that this is because we have chosen to model both the transmitting and receiving antennas as two ideal dipole-like ones. If more complicated antennas are considered, the problem of the behavior of the currents on the antennas has to be considered too. In 2D we have seen that this can be done by means of the plane wave spectra (or equivalently the effective lengths) of the antennas, but in the 3D discussion we will avoid this complication, limiting to the case of Hertzian dipoles both in transmission and in reception.  11.5  HOMOGENEOUS 3D GREEN’S FUNCTIONS  As said, the calculation of the half-space Green’s functions requires the preliminary calculation of the Green’s function of a homogeneous space. So, in this section the expressions of the homogeneous Green’s functions Ga and Gs are retrieved. Of course, the calculations are the same in the two cases, with just the wavenumbers being different. So, let us focus on the homogeneous Green’s function in air Ga . In the same way followed for a half-space geometry, the dyadic Green’s function under study Ga ðr,r0 Þ relates the electric field E(r) to the electric current density J(r0 ) that generated it (either real or equivalent) in free space via the integral relationship: ððð EðrÞ = − jωμ0 Ga ðr,r0 ÞJðr0 Þ dr0 ð11:15Þ D  188  THREE-DIMENSIONAL SCATTERING EQUATIONS  Manipulating the Maxwell’s equations as done in Chapter 4 [see, in particular, Section 4.2 and Eq. (4.23)], we have that free space E(r) is a solution of the vector equation: r × r × EðrÞ− k02 EðrÞ = − jωμ0 JðrÞ  ð11:16Þ  Substituting Eq. (11.15) into Eq. (11.16), deriving under the integral, and accounting for the fact that the achieved equality holds for any current density (in particular for spatially impulsive currents) we obtain the following differential equation for Green’s function1: r × r × Ga ðr,r0 Þ − k02 Ga ðr,r0 Þ = Iδðr − r0 Þ  ð11:17Þ  where I is the 3 × 3 identity matrix, whose elements are equal to 1 along the diagonal and zero elsewhere. The curl operator on a matrix is meant to be performed on the columns; that is, r × r × Gðr,r0 Þ is a 3 × 3 matrix where each column is given by the curl of the curl of the homologous column of Gðr,r0 Þ. The spatial derivations are meant with regard to r. To find the Green’s function Ga ðr,r0 Þ, we can use the vector potential theory, in a way formally similar to that followed in Chapter 5 with regard to the magnetic anomalies. Actually, the vector potential theory is fundamental in electromagnetism; a more complete description of this theory can be found in Chew (1995), Balanis (1989), Van Bladel (2007), Jackson (1998), and Tai (1994). Here we can start from the Maxwell’s equations given in Eq. (4.5). Since no magnetic source (neither magnetic anomaly) is involved, Eq. (4.5) can be rewritten as follows: r × E = − jωμ0 H, r × H = jωε0 E + J, rε0 E = ρ,  ð11:18Þ  rμ0 H = 0 The fourth Maxwell’s equation r  μ0H = 0 implies that μ0H (and thus H, being μ0 a constant quantity) is solenoidal; therefore, it can be represented as the curl of another vector function, called “potential vector” (let us recall the vector identity r × r A = 0). Hence, we can assume that μ0 H = r × AðrÞ  ð11:19Þ  where A(r) is the vector potential. Consequently, the first Maxwell’s equations in (11.18) becomes r × E = − jωr × AðrÞ , r × ðE + jωAðrÞÞ = 0  1  ð11:20Þ  Actually Eq. (11.17) is a general condition that regards Green’s function in any geometry, not only in free space.  HOMOGENEOUS 3D GREEN’S FUNCTIONS  189  As is well known (Franceschetti, 1997), Eq. (11.20) ensures the presence of a scalar potential function ϕ(r) such as E = − jωAðrÞ − rϕðrÞ  ð11:21Þ  Substituting Eq. (11.21) in the second of the Maxwell’s equations (11.18), we obtain r × r × AðrÞ = ω2 ε0 μ0 AðrÞ − jωε0 μ0 rϕðrÞ + μ0 JðrÞ = k02 AðrÞ − jωε0 μ0 rϕðrÞ + μ0 JðrÞ  ð11:22Þ  Similar to what is done in Chapter 4 (see Eqs. (4.23) and(4.24), at this point we exploit ! ! ! the definition of the Laplacian vector, namely r2 v = r r v − r × r × v. Applied in Eq. (11.22), this leads to r2 AðrÞ + k02 AðrÞ = rðrA + jωε0 μ0 ϕðrÞÞ − μ0 JðrÞ  ð11:23Þ  In the same way shown in Chapter 4 with regard to the Fitzgerald vector, also in this case we have that neither the potential vector nor the scalar potential function are univocally determined, and thus also in this case we can exploit this indeterminateness in order to impose the gauge of Lorentz, which means to choose a priori the couple of potential functions that satisfies the condition rA + jωε0 μ0 ϕðrÞ = 0  ð11:24Þ  which reduces Eq. (11.23) to a Helmholtz equation as follows: r2 AðrÞ + k02 AðrÞ = − μ0 JðrÞ  ð11:25Þ  Moreover, considering the divergence of Eq. (11.21) and substituting in the third Maxwell’s equation (11.18), we obtain rE = − jωrAðrÞ− rrϕðrÞ =  ρ ρ , r2 ϕðrÞ + jωrAðrÞ = − ε0 ε0  ð11:26Þ  In Eq. (11.26) we have accounted for the fact that the scalar Laplacian operator is defined as the divergence of the gradient. Substituting Eq. (11.24) in Eq. (11.26), we obtain r2 ϕðrÞ + k02 ϕðrÞ = −  ρðrÞ ε0  ð11:27Þ  So, under the gauge of Lorentz, also the scalar potential is the solution of a Helmholtz equation. The calculation steps for solving Eqs. (11.25) and (11.27) are reported in Appendix C. The solution is given by  THREE-DIMENSIONAL SCATTERING EQUATIONS  190  ððð A ðr Þ = μ 0 D  ϕðrÞ =  1 ε0  ððð D  expð − jk0 kr − r0 kÞ 0 Jðr Þ dr0 4π kr − r0 k  ð11:28Þ  expð − jk0 kr − r0 kÞ 0 ρðr Þ dr0 4π kr − r0 k  ð11:29Þ  Substituting (11.28) and (11.29) into (11.21), the electric field is given by 0 1 ððð ððð 0 expð −jk0 kr − r0 kÞ 0 1 exp − jk r − r ð Þ k k 0 Jðr Þ dr0 − r@ ρðr0 Þ dr0 A EðrÞ = − jωμ0 ε0 4π kr − r0 k 4π kr − r0 k D  D  ð11:30Þ Making use of the continuity equation rJ + jωρ = 0 , ρðrÞ = −  rJðrÞ jω  ð11:31Þ  we have ððð EðrÞ = − jωμ0 D  0 1 ððð 0 expð − jk0 kr− r0 kÞ 0 1 exp − jk r− r ð Þ k 0 0k Jðr Þ dr0 + r Jðr0 Þ dr0 A r@ jωε0 4π kr −r0 k 4π kr−r0 k D  ð11:32Þ The gradient symbol in the second integral in Eq. (11.32) is primed because the derivations refer to the variable r0 . Performing the integration of the second term by parts, we achieve ððð EðrÞ = − jωμ0 D  0 1  ððð  0 ð Þ expð − jk0 kr −r0 kÞ 0 1 exp −jk k r− r k 0 0 0 0 0 r@ r Jðr Þ dr A Jðr Þ dr + 4π kr− r0 k 4π kr−r0 k jωε0 D  ð11:33Þ Now, it is easy to see that r0  expð − jk0 kr − r0 kÞ expð − jk0 kr − r0 kÞ = −r 4π kr− r0 k 4π kr − r0 k  ð11:34Þ  so that we have ððð EðrÞ = − jωμ0 D  0 1 ððð 0 expð − jk0 kr− r0 kÞ 0 1 exp − jk r−r ð Þ k k 0 rr@ Jðr Þ dr0 + Jðr0 Þ dr0 A jωε0 4π kr −r0 k 4π kr−r0 k D  ð11:35Þ  HOMOGENEOUS 3D GREEN’S FUNCTIONS  191  Equation (11.35) allows us to express the dyadic Green’s function. In fact, it can be compacted in the form ððð EðrÞ = −jωμ0  Ga ðr,r0 ÞJðr0 Þ dr0  ð11:36Þ  D  on condition that   1 expð − jk0 kr − r0 kÞ Ga ðr,r Þ = I + 2 rr 4π kr − r0 k k0 0    ð11:37Þ  where I is the identity matrix 3 × 3. Developing the spatial derivations in Eq. (11.37), the explicit expression of the terms of the free space dyadic Green’s function, according to Eq. (11.3), are given by " # expð − jk0 kr − r0 kÞ 3ðx − x0 Þ2 3ðx− x0 Þ2 k0 ðx − x0 Þ2 k02 + 1 k0 k02 Gaxx = +j − −j +j 4πk02 kr − r0 k4 kr − r0 k3 kr −r0 k2 kr − r0 k kr − r0 k5 ð11:38Þ " # expð − jk0 kr− r0 kÞ 3ðx − x0 Þðy − y0 Þ 3ðx− x0 Þðy − y0 Þk0 ðx − x0 Þðy− y0 Þk02 Gaxy = +j − 4πk02 kr − r0 k4 kr − r0 k3 kr− r0 k5 ð11:39Þ " # expð − jk0 kr − r0 kÞ 3ðx − x0 Þðz − z0 Þ 3ðx− x0 Þðz − z0 Þk0 ðx − x0 Þðz − z0 Þk02 Gaxz = +j − 4πk02 kr− r0 k4 kr − r0 k3 kr − r0 k5 ð11:40Þ Gayx = Gaxy  ð11:41Þ  " # expð − jk0 kr − r0 kÞ 3ðy − y0 Þ2 3ðy− y0 Þ2 k0 ðy − y0 Þ2 k02 + 1 k0 k02 Gayy = +j − −j +j 4πk02 kr − r0 k4 kr − r0 k3 kr −r0 k2 kr − r0 k kr − r0 k5 ð11:42Þ " # expð − jk0 kr − r0 kÞ 3ðy − y0 Þðz − z0 Þ 3ðy− y0 Þðz − z0 Þk0 ðy − y0 Þðz − z0 Þk02 +j − Gayz = 4πk02 kr− r0 k4 kr − r0 k3 kr − r0 k5 ð11:43Þ Gazx = Gaxz  ð11:44Þ  Gazy = Gayz  ð11:45Þ  THREE-DIMENSIONAL SCATTERING EQUATIONS  192  " # expð − jk0 kr− r0 kÞ 3ðz − z0 Þ2 3ðz − z0 Þ2 k0 ðz− z0 Þ2 k02 + 1 k0 k02 Gazz = +j − −j +j 4πk02 kr − r0 k4 kr − r0 k3 kr −r0 k2 kr − r0 k kr − r0 k5 ð11:46Þ  11.6 THE PLANE WAVE SPECTRUM OF A 3D HOMOGENEOUS GREEN’S FUCNTION We have seen that the three columns of Green’s function represent three electric fields, and more precisely they are, apart from an unessential factor, the fields (calculated in the point r = (x,y,z)) generated by an impulsive source (located in the point r0 = (x0 ,y0 ,z0 )) oriented along the x-, y-, and z-axis, respectively. Therefore, each of the columns can be expressed by means of its plane wave spectrum according to the calculations shown in Chapter 4 (see Section 4.4), and consequently also the overall dyadic Green’s function can be expanded as an integral sum of plane waves. In particular, choosing the plane z = z0 as reference, analogously to Eq. (4.60), we can define the plane wave spectrum of Green’s function as2 ^^ G a ðu, v, r'Þ =  +∞ ð ð +∞  Ga ðx, y, z ! z0 , x0 , y0 , z0 Þexpð − juxÞ expð − jvyÞ dxdy  ð11:47Þ  −∞ −∞  However, the integral (11.47) is not immediate, because of the singular behavior of Green’s function for r = r0 . So, specific passages are required as illustrated in the following. In particular, let us start from the three-dimensional spatial Fourier transform of Eq. (11.17), calculated in three independent variables u, v, w. So, we retrieve the equality +∞ ð +∞ ð +∞ ð     r × r × Ga ðr,r0 Þ− k02 Ga ðr,r0 Þ expð − jðux + vy + wzÞÞ dxdydz  −∞ −∞ −∞ +∞ ð +∞ ð +∞ ð  =  ð11:48Þ ðIδðr − r0 ÞÞexpð − jðux + vy + wzÞÞ dxdydz  −∞ −∞ −∞  ^^ Let us label as k the symbolic vector uix + viy + wiz, and let us label as G^a ðk,r0 Þ the threedimensional transform of Ga ðr,r0 Þ. It is straightforward to recognize that the nabla vector translates into jk in the transformed domain and that the formal vector product (which indicates the curl vector in the spatial domain) translates into an “authentic” vector product in the transformed domain. Consequently, we have ^^ ^^ − k × k × G^a ðk,r0 Þ − k02 G^a ðk,r0 Þ = Iexpð − jkr0 Þ  ð11:49Þ  2 The reason why, unlike the 2D case, have considered z tending to z0 instead of z = z0 will be clear in the following.  THE PLANE WAVE SPECTRUM OF A 3D HOMOGENEOUS GREEN’S FUCNTION  193  where the double vector product is applied on the columns of the dyadic Green’s function and where the dot stands for scalar product.3 Due to the general vector identity v1 × v2 × v3 = v1 ðv2 v3 Þ− v3 ðv1 v2 Þ we can rewrite Eq. (11.49) as   ^^ ^^ ^^ 0 ^ − k kGa ðk,r Þ + kkk2 G^a ðk,r0 Þ − k02 G^a ðk,r0 Þ    ^ ^^ ^ 0 ^ = − k kGa ðk,r Þ + kkk2 − k02 G^a ðk,r0 Þ = Iexpð − jkr0 Þ  ð11:50Þ  ð11:51Þ  ^^ where the scalar product kG^a ðk,r0 Þ is meant with respect to the columns of the dyadic Green’s function (so that the result is a vector) and the dyadic product v1v2 [that is meant applied to the first term in Eq. (11.51)] is meant in terms of components as 0 1 0 1 v1x v2x v1x v2y v1x v2z v1x v1 v2 = @ v1y Að v2x v2y v2z Þ = @ v1y v2x v1y v2y v1y v2z A ð11:52Þ v1z v2x v1z v2y v1z v2z v1z Let us now calculate the scalar product of Eq. (11.51) times k:         ^^ ^^ ^^ ^^ − kkk2 kG^a ðk,r0 Þ + kkk2 kG^a ðk,r0 Þ − k02 kG^a ðk,r0 Þ = − k02 kG^a ðk,r0 Þ ^^ ðkIÞexpð − jkr0 Þ = ðkIÞ expð − jkr0 Þ ) kG^a ðk,r0 Þ = − k02  ð11:53Þ  Substituting in Eq. (11.53) into Eq. (11.51), we obtain ^^ kðkIÞexpð − jkr0 Þ ^ + kkk2 G^a ðk,r0 Þ − k02 G^^a ðk,r0 Þ 2 k0 ^ kkexpð − jkr0 Þ  2 2 ^ G^a ðk,r0 Þ = Iexpð − jkr0 Þ + k − k k k 0 k02  2  ^^ Ik0 − kk expð − jkr0 Þ 0 ^   ) Ga ðk,r Þ = k02 kkk2 − k02  =  3  ð11:54Þ  It is meant as a non-Hermitian scalar product: If v1 = v1xix + v1yiy + v1ziz and v2 = v2xix + v2yiy + v2ziz are two vectors, either real or complex, the non-Hermitian scalar product is defined as v1  v2 = v1xv2x + v1yv2y + v1zv2z, whereas the Hermitian scalar product is defined as v1 ∘v2 = v1x v∗2x + v1y v∗2y + v1z v∗2z , where “∗” stands for conjugation. Clearly, the two scalar products are the same thing for real vectors, but not for complex vectors.  THREE-DIMENSIONAL SCATTERING EQUATIONS  194  Consequently, inverting the Fourier transform, we can write 0  Ga ðr,r Þ =  +∞ ð +∞ ð +∞ ð  Ik2 − kk 0  0  e jkðr − r Þ dudvdw 2 2 2 ð2π Þ k kkk − k0 −∞ −∞ −∞ 0 1  3  1 = 2 4π  +∞ ð  +∞ ð  du −∞  −∞  0 +∞ 1 ð dv @ 1 Ik02 − kk 0   e jkðr− r Þ dwA k02 2π u2 + v2 + w2 − k02 −∞  1 1 k02 − u2 uv uw B +∞ @ uv k02 − v2 vw A C +∞ +∞ B C ð ð ð 2 2 C 1 dv B 1 − w uw vw k 0 jkðr − r Þ 0  B C  e dw = 2 du B C 2 2 2 2 2 4π k0 B2π u + v + w − k0 C −∞ −∞ @ −∞ A 0  0  ð11:55Þ  Equation (11.55) shows that the argument of the integral in dw does not tend to a null matrix for high values of w, because we have 0  0 2 2 11 0 1 0 0 0 k0 − u uv uw 1  @ uv k02 − v2 vw AA = @ 0 0 0 A = − iz iz lim @ 2 2 w! ±∞ u + v + w2 − k02 0 0 −1 uw vw k02 − w2 ð11:56Þ Subtracting and adding again the limit value (11.56) to the integrand in Eq. (11.55), we obtain 0  Ga ðr,r Þ =  =  +∞ ð +∞ ð +∞ ð  Ik02 −kk 0   e jkðr − r Þ dudvdw 3 2 2 2 ð2π Þ k kkk −k0 −∞ −∞ −∞ 0 1  1 4π 2  +∞ ð  +∞ ð  du −∞  1 − 2 4π  −∞  2 dv 6 1 4 k02 2π  +∞ ð  +∞ ð  du −∞  −∞  +∞ ð  0  2 B Ik0 − kk  @ kkk2 − k02 −∞  1  3  0 C 7 + iz iz Ae jkðr − r Þ dw5  2 +∞ 3 ð dv 4 1 0 iz iz e −jkðr − r Þ dw5 k02 2π −∞  3  1 2 2 2 Ik − kk + i i k −k k k z z 0 C jkðr − r0 Þ 1 dv 6 1 7 1 B 0   = 2 du dw5 − 2 iz iz δðr −r0 Þ 4 @ Ae 2 4π 2 k02 2π k0 kkk −k0 −∞ −∞ −∞ +∞ ð  +∞ ð  2  +∞ ð  0  ð11:57Þ This passage has allowed us to integrate separately the piece not integrable in classical terms (in fact it has been integrated in distributional terms). So, now the integrand in  THE PLANE WAVE SPECTRUM OF A 3D HOMOGENEOUS GREEN’S FUCNTION  195  Eq. (11.57) vanishes for w ! ±∞, and so it is licit to solve it by resorting to the theory of the residuals, in the same way followed for the (scalar) spectral integral in Appendix A. So, in the case at hand we obtain Ga ðr,r0 Þ =  j 8π 2 k02 +∞ ð +∞ ð  × −∞ −∞  −   expðjuðx − x0 ÞÞ expðjvðy − y0 ÞÞ expðjkz1 jz − z0 jÞ  2 Ik0 − k0 k0 dudv kz10  1 iz iz δðr − r0 Þ k02  ð11:58Þ  where, analogously to the notation followed in Chapter 4 [see Eq. (4.57)], we have kz10 ðu,vÞ =  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ k02 − u2 − v2  ð11:59Þ  where the imaginary part is meant as non-negative and where ( k0 =  uix + viy + kz10 ðu,vÞiz ,  z − z0 > 0,  uix + viy −kz10 ðu, vÞiz ,  z − z0 < 0  ð11:60Þ  From a mathematical point of view, the different sign of the z-component of the wavevector descends from the fact that |z − z0 | is equal either to z − z0 or to z0 − z, and so the integral path for the application of the theory of the residuals has to enclose either pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ the pole at w = k02 − u2 − v2 or the pole at w = − k02 − u2 − v2 (where the square root is meant with a nonnegative imaginary part). From a physical point of view, the different sign of the z component of the wavevector is due to the fact that the field propagates in any case away from the sources. In the integral in Eq. (11.58) we easily identify an inverse double Fourier transform, so that we have  j expðjkz1 jz− z0 jÞ  2 Ik0 −k0 k0 2 2k0 kz1 1 − 2 iz iz 4π =  +∞ ð +∞ ð  δðr − r0 Þexpðjuðx − x0 ÞÞexpðjvðy − y0 ÞÞ dxdy  −∞ −∞ 0   iz iz δðz− z0 Þ jexpðjkz1 jz − z jÞ  2 Ik0 − k0 k0 − 2 4π 2 2k0 kz1 +∞ ð ð +∞  = −∞ −∞  Ga ðr,r0 Þexpð − juðx − x0 ÞÞ expð −jvðy− y0 ÞÞ dxdy  ð11:61Þ  THREE-DIMENSIONAL SCATTERING EQUATIONS  196  Comparing Eq. (11.61) with Eq. (11.47), we retrieve the expression of plane wave spectrum of Green’s function in air, which is given by  ^^  G a u, v,r'jz!z0 =   j  2 Ik − k0 k0 expð − jðux0 + vy0 ÞÞ 2k02 kz10 0  0 2 2 8 k0 − u > > > B > > > j expð − jux0 Þexpð − jvy0 Þ B > B − uv > > B > > 2k02 k1z0 @ > > > < − uk1z0 = > 0 > > > k02 − u2 > > > 0 0 > j expð − jux Þexpð − jvy Þ B > B − uv > > > @ > 2k02 k1z0 > : uk1z0  − uv k02 − v2  − uk1z0  1  C C − vk1z0 C C, A  − vk1z0 u2 + v2 1 − uv uk1z0 C k02 − v2 vk1z0 C A,  z − z0 > 0,  ð11:62Þ  z − z0 < 0  vk1z0 u2 + v2  Due to the impulse present in Eq. (11.61), the plane wave spectrum of Eq. (11.62) is bi-univocally related to Green’s function for any z 6¼ z0 but not for z = z0 . The following calculation steps are of course the same for any homogeneous medium, on the condition that we make use of the wavenumber of that medium. Therefore, we can express the plane wave spectrum of a homogeneous Green’s function Gs ðr, r'Þ relative to an ideal world “made up of soil” as follows:  ^ G^s u,v,r'jz!z0 =  j 2ks2 kz1s     Iks2 − ks ks expð − jðux0 + vy0 ÞÞ  0 2 2 8 ks − u > > > B > 0 0 > jexpð − jux Þ expð −jvy Þ B > > B − uv > > @ 2ks2 k1zs > > > > > < − uk1zs = 0 2 2 > > ks − u > > > > 0 0 B > jexp ð − jux Þ exp ð −jvy Þ > B > > B − uv > 2k > @ 2k 1zs > s > : uk1zs  − uv  − uk1zs  1  C C ks2 − v2 − vk1zs C, A − vk1zs u2 + v2 1 − uv uk1zs C C ks2 − v2 vk1zs C, A  z− z0 > 0, ð11:63Þ  z − z0 < 0  vk1zs u2 + v2  where kz1s ðu,vÞ = with nonnegative imaginary part.  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ks2 − u2 − v2  ð11:64Þ  HALF-SPACE GREEN’S FUNCTIONS  11.7  197  HALF-SPACE GREEN’S FUNCTIONS  The calculation of the homogeneous Green’s functions is a preliminary step for the calculation of the half-space Green’s functions. Indeed, since the homogeneous Green’s function can be (and has been) expressed by mean of an integral superposition of plane waves, the half-space Green’s function is achieved by considering the homogeneous Green’s function as an incident “triple” of fields, wherein each plane wave component is reflected and refracted at the air–soil interface. The integral sum of the transmitted waves will provide the external Green’s function, whereas the integral sum of the reflected waves, plus the incident (homogeneous) Green’s function itself, will provide the internal Green’s function. However, the Fresnel coefficients, i.e. the reflection and transmission coefficient of the plane waves at the interface depend on the polarization of the incident field too (Franceschetti, 1997). Consequently, we will distinguish the TE component and the TM component in the homogeneous Green’s function, and each component will be reflected and transmitted according to its own Fresnel coefficients. So, the first step is to calculate the matrix decomposition of the plane wave spectrum of the homogeneous Green’s functions such as ^ ^^ ^^ G^a ðu, vÞ = GaTE ðu, vÞ + GaTM ðu, vÞ, ^ ^ ^ G^s ðu, vÞ = G^sTE ðu, vÞ + G^sTM ðu, vÞ  ð11:65Þ  The decomposition of a plane wave impinging at the air soil interface along its TE and TM components is derived in Appendix D. Applying this decomposition to the columns of the homogeneous Green’s function in air we achieve 0  1 k02 v2 − k02 uv 0 B u2 + v2 u2 + v2 C C expð − jux0 Þexpð − jvy0 Þ B ^^ B 2 C 2 2 GaTE ðu, v, z, r'Þ = j B C − k uv k u 0 B 0 C 2k02 kz10 0 @ u2 + v2 u2 + v2 A 0 0 0  80 2 2 u kz10 > > >B 2 2 > > u B +v > > B > > B uvk2 > > z10 B > > B > > > @ u2 + v2 > > expð − jux0 Þ expð − jvy0 Þ < − ukz10 0 ^ ^ × 0 2 2 GaTM ðu,v, z ! z ,r'Þ = j u kz10 > 2k02 kz10 > > > B u2 + v2 > > B > > B > > B uvk2 > > z10 B > > B 2 2 > > u +v @ > > : ukz10  8z  1 2 uvkz10 − ukz10 C u2 + v2 C C 2 C, v2 kz10 C − vk z10 C u2 + v2 A  − vkz10 u2 + v2 1 2 uvkz10 ukz10 C u2 + v2 C C 2 C, v2 kz10 vkz10 C C 2 2 u +v A vkz10  ð11:66Þ  z− z0 > 0,  z− z0 < 0  u2 + v2  ð11:67Þ  THREE-DIMENSIONAL SCATTERING EQUATIONS  198  The reflection and transmission TE and TM coefficients are retrieved in Appendix E. Applying in particular Eqs. (E.18) and (E.20) to the columns of the TE components of Green’s function and applying Eqs. (E.32) and (E.34) to the columns of the TM component of Green’s function, we have 2 0 2 2 1 k0 v − k02 uv 0 6 B u2 + v2 u2 + v2 C B C 0 0 6 exp ð − j ð ux + vy Þ Þ C 6 B 2 ^ 6TTE B − k0 uv k02 u2 C G^as = j 2 6 B C 2k0 kz10 4 @ u2 + v2 u2 + v2 0 A 0  0  2 u2 kz10 B 2 2 u +v  2 uvkz10 u2 + v2  0  1  0  3  ukz10 C 0 17 B C 7 0 0 0 B C kz10 7 2 2 2 C+ @ A 7 T 0 0 0 + TTM B uvk v k TM B C 7 z10 z10 2 2 7 B 2 2 2 2 vkz10 C kz1s uk vk u + v z10 z10 @u + v u + v A 5 0 0 0 2 0 2 2 1 k0 v − k02 uv 0 6 B u2 + v2 u2 + v2 C B C expð − jðux0 + vy0 ÞÞ 6 6 B 2 C 2 2 T =j B C 6 − k uv k u TE 2 0 0 6 B C 2k0 kz10 4 @ u2 + v2 u2 + v2 0 A 0 0 0 0 2 2 13 2 u kz10 uvkz10 ukz10 B u2 + v2 u2 + v2 C7 C7 B B C7 2 2 B uvk2 C7 z10 v kz10 C7 B vkz10 + TTM B 2 2 2 2 C7 Bu + v u + v C7 B C7 2 2 2 B uk 2 C7 @ z10 vkz10 kz10 ðu + v Þ A5 kz1s kz1s kz1a 0 2 2 1 2 k0 v − k02 uv 0 B u2 + v2 u2 + v2 C 6 B C expð − jðux0 + vy0 ÞÞ 6 C 6 2kz10 B 2 2 2 =j B C 6 − k uv k u 2 0 0 B C 6 k + k 2k0 kz10 4 z10 z1s @ u2 + v2 u2 + v2 0 A 0  2 u2 kz10 B u2 + v2  0 2 uvkz10 u2 + v2  0  0 13  ukz10 C7 B C7 B C7 2 2 2 B C7 2kz1s ε0 B uvkz10 v kz10 C7 vkz10 + B u2 + v2 u2 + v2 C7 C7 kz1s + kz10 εs B B C7 2 2 2 B uk 2 C7 @ z10 vkz10 kz10 ðu + v Þ A5 kz1s kz1s kz1s  ð11:68Þ  HALF-SPACE GREEN’S FUNCTIONS  199  After summing the matrixes, the final result is expð − jðux0 + vy0 ÞÞ ^ G^as = j k 2 ðu2 + v2 Þ 0  0  k02 v2 ε0 u2 kz1s kz10 + B kz10 + kz1s kz1s ε0 + kz10 εs B B B − k02 uv ε0 uvkz1s kz10 B × Bk + k + k ε + k ε z1s 0 z10 s B z10 z1s B B 2 2 ε0 ukz10 ðu + v Þ @ ðkz1s ε0 + kz10 εs Þ  − k02 uv ε0 uvkz1s kz10 + kz10 + kz1s kz1s ε0 + kz10 εs k02 u2 ε0 v2 kz1s kz10 + kz10 + kz1s kz1s ε0 + kz10 εs ε0 vkz10 ðu2 + v2 Þ ðkz1s ε0 + kz10 εs Þ  1 ε0 ukz1s ðu2 + v2 Þ ðkz1s ε0 + kz10 εs Þ C C C 2 2 C ε0 vkz1s ðu + v Þ C ðkz1s ε0 + kz10 εs Þ C C C 2 2 2 C ε0 ð u + v Þ A kz1s ε0 + kz10 εs ð11:69Þ  Equation (11.69) accounts for the fact that the source point is in air and the observation point is buried, so that we have z − z0 < 0. For brevity of notation, let us label as Mas1 ðu, vÞ the matrix in the large parentheses in Eq. (11.69). The air–soil Green’s function is given by the inverse Fourier transform of Eq. (11.69) as follows: 0  Gas ðr,r Þ =  j 4π 2 k02  +∞ ð +∞ ð  −∞ −∞  expðjðuðx − x0 Þ + vðy − y0 Þ − kz10 z0 − kz1s zÞÞ Mas1 ðu, vÞ dudv ðu2 + v2 Þ ð11:70Þ  For conventional reasons, it is more comfortable to express the quantity (11.70) as 0  Gas ðr,r Þ =  j 4π 2 k02  +∞ ð +∞ ð  −∞ −∞  expðjð − uðx − x0 Þ− vðy− y0 Þ − kz10 z0 − kz1s zÞÞ Mas ðu,vÞ dudv ðu2 + v2 Þ ð11:71Þ  with 0  k02 v2 ε0 u2 kz1s kz10 + B kz10 + kz1s kz1s ε0 + kz10 εs B B B − k02 uv ε0 uvkz1s kz10 B Mas = B k + k + k ε + k ε z1s 0 z10 s B z10 z1s B B 2 2 − ε0 ukz10 ðu + v Þ @ ðkz1s ε0 + kz10 εs Þ  −k02 uv ε0 uvkz1s kz10 + kz10 + kz1s kz1s ε0 + kz10 εs k02 u2 ε0 v2 kz1s kz10 + kz10 + kz1s kz1s ε0 + kz10 εs − ε0 vkz10 ðu2 + v2 Þ ðkz1s ε0 + kz10 εs Þ  1 − ε0 ukz1s ðu2 + v2 Þ ðkz1s ε0 + kz10 εs Þ C C C − ε0 vkz1s ðu2 + v2 Þ C C ðkz1s ε0 + kz10 εs Þ C C C C 2 2 2 ε0 ðu + v Þ A kz1s ε0 + kz10 εs ð11:72Þ  THREE-DIMENSIONAL SCATTERING EQUATIONS  200  It is easy to check that the expressions (11.70) and (11.71) are equivalent, so from now on we will refer to (11.71). Substituting Eq. (11.71) into Eq. (11.11), we retrieve the incident field in the soil due 0 1 ax to a dipole oriented according to some direction ^a ≡@ ay A, which is the first “piece” to az be put in the scattering equation (11.1): μ ωI0 l Einc ðrÞ = 0 2 2 4π k0  +∞ ð +∞ ð  −∞ −∞  0 1 ax expðjð −uðx −x0 Þ − vðy − y0 Þ − kz10 z0 − kz1s zÞÞ @ ay A dudv ð u, v Þ M as ðu2 + v2 Þ az  0 +∞ +∞ 10 1 ð ð ax μ0 ωI0 l @ expðjð − uðx − x0 Þ − vðy −y0 Þ −kz10 z0 −kz1s zÞÞ A@ ay A = 2 2 ð u,v Þ dudv M as ðu2 + v2 Þ 4π k0 a −∞ −∞  z  ð11:73Þ The Green’s function Gsa ðr,r0 Þ, with buried source and observation point in air, is derived in the same way, accounting for the fact that now the field propagates toward the positive side of the z-axis (z < z0 ) and the Fresnel coefficients from the soil to the air have to be accounted for (see Appendix E). The result is ^ G^sa = j  expð − jðux0 + vy0 ÞÞ ks2 ðu2 + v2 Þ  0  ks2 v2 εs u2 kz1s kz10 B kz10 + kz1s + kz1s ε0 + kz10 εs B B B − ks2 uv εs uvkz1s kz10 B × Bk + k + k ε + k ε z1s 0 z10 s B z10 z1s B B 2 2 εs ukz1s ðu + v Þ @ − ðkz1s ε0 + kz10 εs Þ  − ks2 uv εs uvkz1s kz10 + kz10 + kz1s kz1s ε0 + kz10 εs ks2 u2 εs v2 kz1s kz10 + kz10 + kz1s kz1s ε0 + kz10 εs −  εs vkz1s ðu2 + v2 Þ ðkz1s ε0 + kz10 εs Þ  1 εs ukz10 ðu2 + v2 Þ ðkz1s ε0 + kz10 εs Þ C C C εs vkz10 ðu2 + v2 Þ C C − ðkz1s ε0 + kz10 εs Þ C C C C 2 2 2 εs ðu + v Þ A kz1s ε0 + kz10 εs −  ð11:74Þ Equation (11.74) expresses the plane wave spectrum of the external Green’s function. Similarly to the position introduced with regard to Eq. (11.72), from now on we will label as Msa ðu, vÞ the matrix in large parentheses in Eq. (11.74). This allows us to express the external 3D Green’s function in a compact way as follows: 0  0  Ge ðr,r Þ = Gsa ðr,r Þ =  j 4π 2 ks2  +∞ ð +∞ ð  −∞ −∞  expðjðuðx −x0 Þ + vðy − y0 Þ−kz1s z0 − kz10 zÞÞ Msa ðu,vÞ dudv ðu2 + v2 Þ  ð11:75Þ  HALF-SPACE GREEN’S FUNCTIONS  201  Finally, let us now retrieve the internal Green’s function Gi ðr,r0 Þ. From the discussion carried out in this chapter, it is by now clear that this function represents the set of the answers to an impulsive buried source, observed in any buried point. So, the internal Green’s function is provided by the sum of the Green’s function of a homogeneous soil (given by Gs ðr,r0 Þ) plus the contribution back-reflected in the soil from the soil-air interface. So, let us start with the decomposition of Gs ðr,r0 Þ into its TE and TM components: 0  1 ks2 v2 − ks2 uv 0 B u2 + v2 u2 + v2 C C expð − jux0 Þexpð − jvy0 Þ B ^^ B 2 C 2 2 GsTE ðu, v, z, r'Þ = j B C − k uv k u 2 s s B C 2ks kz1s @ u2 + v2 u2 + v2 0 A 0 0 0  80 2 2 u kz1s > > > > B u2 + v2 > B > > B > > B > > 2 B > > > B uvkz1s > B > > B u2 + v2 > > > @ > > > < 0 0 −ukz1s expð −jux Þ expð −jvy Þ 0 ^ × 0 G^sTM ðu,v, z ! z ,r'Þ = j 2 2 > 2ks kz1s > u2 kz1s > > >B 2 2 > > Bu + v > >B > > B > > B uvk 2 > > z1s B > > > u2 + v2 >B B > > @ > > : ukz1s  8z  1 2 uvkz1s −ukz1s C u 2 + v2 C C C 2 2 C, v kz1s C −vk z1s C u 2 + v2 C A −vkz1s u2 + v2 1 2 uvkz1s uk z1s C u2 + v2 C C C 2 C, v2 kz1s vkz1s C C 2 2 u +v C A 2 2 vkz1s u + v  ð11:76Þ  z−z0 > 0,  z−z0 < 0  ð11:77Þ  which can be more compactly written as 0 ^ G^sTM ðu, v, z ! z , r'Þ = j  0 B B B ×B B B @  expð − jux0 Þ expð − jvy0 Þ 2ks2 kz1s  2 u2 kz1s 2 u + v2  2 uvkz1s 2 u + v2  2 uvkz1s u2 + v2  2 v2 kz1s u2 + v2  − u sgnðz− z0 Þkz1s − v sgnðz− z0 Þkz1s  1 − sgnðz − z0 Þukz1s C C C C 0 − sgnðz −z Þvkz1s C C A u2 + v2  ð11:78Þ  THREE-DIMENSIONAL SCATTERING EQUATIONS  202  where sgn stands for the sign function, equal to 1 if its argument is positive and equal to −1 if its argument is negative. At this point, based on the calculations presented in Appendix E [see, in particular, Eqs. (E.18), (E.19), (E.32), and (E.33)], and reminding ourselves that the soil–air reflection coefficients are the opposite of the air–soil ones (see again Appendix E), we obtain the plane wave spectrum of the “reflected Green’s function”, given by 2  ^ G^rss  1 ks2 v2 − ks2 uv 0 6 B u2 + v2 u2 + v2 C B C expð − jðux0 + vy0 ÞÞ 6 6 B 2 C 2 2 =j − R B C 6 −k uv k u TE 2 s s B 6 C 2ks kz1s 4 @ u2 + v2 u2 + v2 0 A 0 0 0 0  2 u2 kz1s B 2 2 Bu + v B 2 − RTM B B uvkz1s B 2 2 @u + v 0  0  1 2 uvkz1s 0 − u sgnðz − z Þkz1s C u2 + v2 C C 2 2 C v kz1s 0 − v sgnðz− z Þkz1s C C 2 2 u +v A 0 0  0  13 0 0 0 A5 0 0 0 + RTM @ −u sgnðz − z0 Þkz1s − vsgnðz − z0 Þkz1s − ðu2 + v2 Þ 2  1 ks2 v2 − ks2 uv 0 B u2 + v2 u2 + v2 C 6 B C expð − jðux0 + vy0 ÞÞ 6 6 B C =j 6 − RTE B − ks2 uv ks2 u2 C 2 2 B C 6 2ks kz1s 0 4 @ u2 + v2 u2 + v2 A 0 0 0 0 B B B − RTM B B B @  0  2 u2 kz1s u2 + v2  2 uvkz1s u2 + v2  2 uvkz1s u2 + v2  2 v2 kz1s u2 + v2  u sgnðz − z0 Þkz1s v sgnðz −z0 Þkz1s  13 0  − u sgnðz −z Þkz1s C7 C7 C7 C7 7 0 − v sgnðz − z Þkz1s C C7 A5 ðu2 + v2 Þ  Substituting the reflection coefficient as retrieved in Appendix E, we obtain  ð11:79Þ  HALF-SPACE GREEN’S FUNCTIONS  203  expð −jðux0 + vy0 ÞÞ ^ G^rss = − j 2k2 k s z1s  0  2 u2 kz1s ðkz1s ε0 −kz10 εs Þ ks2 v2 ðkz10 −kz1s Þ + B 2 2 B ðu + v Þðkz10 + kz1s Þ ðu2 + v2 Þðkz1s ε0 + kz10 εs Þ B B 2 B − k2 uvðkz10 −kz1s Þ uvkz1s ðkz1s ε0 −kz10 εs Þ s B + ×B 2 2 B ðu + v Þðkz10 + kz1s Þ ðu2 + v2 Þðkz1s ε0 + kz10 εs Þ B B B usgnðz−z0 Þkz1s ðkz1s ε0 −kz10 εs Þ @ ðkz1s ε0 + kz10 εs Þ  2 uvkz1s ðkz1s ε0 − kz10 εs Þ −ks2 uvðkz10 − kz1s Þ + ðu2 + v2 Þðkz10 + kz1s Þ ðu2 + v2 Þðkz1s ε0 + kz10 εs Þ 2 v2 kz1s ðkz1s ε0 −kz10 εs Þ ks2 u2 ðkz10 −kz1s Þ + ðu2 + v2 Þðkz10 + kz1s Þ ðu2 + v2 Þðkz1s ε0 + kz10 εs Þ  v sgnðz−z0 Þkz1s ðkz1s ε0 −kz10 εs Þ ðkz1s ε0 + kz10 εs Þ  1 −u sgnðz −z0 Þkz1s ðkz1s ε0 −kz10 εs Þ C ðkz1s ε0 + kz10 εs Þ C C C 0 −v sgnðz−z Þkz1s ðkz1s ε0 −kz10 εs Þ C C C ðkz1s ε0 + kz10 εs Þ C C C 2 2 C ðu + v Þðkz1s ε0 −kz10 εs Þ A ðkz1s ε0 + kz10 εs Þ  ð11:80Þ Let us now label as Mrss the matrix in large parentheses. In this way, the contribution to the half-space Green’s function coming from the reflection at the soil-air interface can be compactly written as +∞ ð +∞ ð  j  Grss ðr,r0 Þ =  4π 2 ks2  −∞ −∞  expðjðuðx − x0 Þ + vðy − y0 Þ − kz1s ðz + z0 ÞÞÞ Mrss ðu,vÞ dudv kz1s ð11:81Þ  Let us remind, at this point, after Eq. (11.37), that we can express compactly the Green’s function of a homogeneous soil4 as    1 expð − jks kr −r0 kÞ Gs ðr,r0 Þ = I + 2 rr ks 4π kr − r0 k  ð11:82Þ  Equation (11.82) provides the direct contribution to the Green’s function in a half space, with both a buried source and observation point. Eventually the internal Green’s function of the problem is given by Gi ðr,r0 Þ = Gss ðr,r0 Þ = Grss ðr,r0 Þ + Gs ðr,r0 Þ j 4π 2 ks2  +∞ ð +∞ ð  −∞ −∞  expðjðuðx − x0 Þ + vðy − y0 Þ − kz1s ðz + z0 ÞÞÞ Mrss ðu,vÞ dudv kz1s  0  10 1 0 1 exp − jk r − r ð Þ k k s A + @I + 2 rrA@ ks 4π kr − r0 k  ð11:83Þ  4 Actually Eq. (11.37) refers to the free space, but the extension to the case of any homogeneous space is straightforward.  204  THREE-DIMENSIONAL SCATTERING EQUATIONS  At this point, the scattering equations have been fully specified. In fact, they are given by Eqs. (11.1) and (11.2), with the incident field specified in Eq. (11.73), the external Green’s function specified in Eq. (11.75), and the internal Green’s function specified in Eq. (11.83). The same procedure can be followed in order to calculate also the Green’s function Gaa ðr,r0 Þ, relative to the case of a half-space with both the source and observation points in air. However, this quantity does not enter the scattering equations, and we leave it as a possible exercise. The quantity Gaa ðr,r0 Þ is theoretically relevant if one wants to retrieve the scattered field data by subtraction of the incident field data from the total field data [see Eq. (11.13)]. However, as already emphasized in Chapter 7, this is not a robust procedure with experimental GPR data.  QUESTIONS 1. Is the 3D inverse scattering problem ill-posed? How could we prove this? 2. In the 2D case dealt with in Chapters 4 and 5, we have that the electric field is parallel to the direction of the source. Is it the same in 3D? 3. What is the main difference between the gauge of Lorentz applied in the calculations in Chapter 5 and that applied in Chapter 10? 4. In the 2D case we did not distinguish a reflection coefficient for TE polarization and another one for TM polarization. Why? 5. Is the GPR datum gathered under a 3D model a vector quantity for each observation point?  12 THREE-DIMENSIONAL DIFFRACTION TOMOGRAPHY  12.1  BORN APPROXIMATION AND DT IN 3D  The (first-order) Born approximation (BA) in 3D can be introduced in the same way as done in 2D, namely approximating the internal field with the incident one. The underlying physical rationale is the same as in 2D, and therefore it will be not repeated. With the symbols introduced in Chapter 11, and with reference to Figure 11.1, this means that, under BA, the scattering equations reduce to Eðr,rs Þ = Einc ðr,rs Þ, ððð Es ðr0 ,rs Þ = ks2  r 2 D, rs 2 Σ  χ e ðr0 ÞGe ðr0 ,r0 ÞEinc ðr0 ,rs Þ dr0 ,  ð12:1Þ r0 , r s 2 Σ  ð12:2Þ  D  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  205  THREE-DIMENSIONAL DIFFRACTION TOMOGRAPHY  206  Parallel B-scans z Air  x T  h y  Soil  Figure 12.1. Geometrical scheme of the common offset C-scan. For color detail, please see color plate section.  The linear scattering equation (12.2) is a vector relationship. However, the GPR datum is in any case a scalar quantity, because it is essentially the tension value gathered by the receiving antenna. The correct relationship between the field and retrieved tension should account for the effective length of the receiving antenna, as illustrated in Chapter 4. However, as said in Chapter 11, we will approximate the received datum as the projection of the field in the observation point along the direction of the receiving dipole. Moreover, we will refer to the customary GPR prospecting performed in common offset (Daniels, 2004), so that we will assume that the transmitting and receiving antennas are two dipoles parallel to each other and also parallel to the air–soil interface. Therefore, with reference to Figure 12.1, it is comfortable to assume that a reference system such as the transmitting and receiving dipoles are directed either along the x-axis either along the y-axis. Let us focus on the case when the two dipoles are directed along the x-axis, are separated by a fixed offset Δ, and move sequentially along several lines parallel to the y-axis separated from each other by a fixed interline distance (transect) T and at a fixed height h (possibly and hopefully equal to zero, due to the considerations exposed in Chapter 9). This configuration is commonly called a C-scan (Daniels, 2004). Thus, resorting to Eqs. (11.4) and (11.11), the scalar scattered field datum under BA can be written as ððð Esx ðr0 ,rs Þ =  − jks2 μ0 ωI0 l  χ e ðr0 Þix Gsa ðr0 ,r0 ÞGas ðr0 ,rs Þix dr0 ,  r 0 , rs 2 Σ  ð12:3Þ  D  Substituting the expressions of Gas ðr,rs Þ and Gsa ðr0 ,r0 Þ from Eqs. (11.71) and (11.75), we obtain  BORN APPROXIMATION AND DT IN 3D  − jμ0 ωI0 l Esx ðr,rs Þ = 16π 4 k02  +∞ ð +∞ ð +∞ ð  dx0 dy0 dz0 χ e ðx0 ,y0 ,z0 Þ  −∞ −∞ −∞  +∞ ð +∞ ð  ×  207  +∞ ð +∞ ð  du1 dv1 −∞ −∞  du2 dv2 −∞ −∞  ðix Msa ðu1 ,v1 ÞMas ðu2 ,v2 Þix Þ  2 2  2 2  u1 + v1 u2 + v2  × expðjðu1 ðx − x0 Þ + v1 ðy − y0 Þ − u2 ðx0 − xs Þ− v2 ðy0 − ys Þ − ðzkz10 ðu1 ,v1 Þ + zs kz10 ðu2 ,v2 ÞÞ− ðkz1s ðu1 ,v1 Þ + kz1s ðu2 ,v2 ÞÞz0 ÞÞ,  r, rs 2 Σ  ð12:4Þ  Due to the considered configuration, we have ys = y + Δ, ð12:5Þ  xs = x, z = zs = h Consequently the scalar scattered field datum is given by − jμ0 ωI0 l Esx ðx, y;ω, h, ΔÞ = 16π 4 k02  +∞ ð +∞ ð +∞ ð  −∞ −∞ −∞  +∞ ð ð +∞  ×  dx0 dy0 dz0 χ e ðx0 ,y0 ,z0 Þ  +∞ ð +∞ ð  du1 dv1 −∞ −∞  du2 dv2 −∞ −∞  ðix Msa ðu1 ,v1 ÞMas ðu2 ,v2 Þix Þ  2 2  2 2  u1 + v1 u2 + v2  × expð − jððu1 + u2 Þx0 + ðv1 + v2 Þy0 ÞÞexpðjððu1 + u2 Þx + ðv1 + v2 ÞyÞÞ expð − jz0 ððkz1s ðu1 ,v1 Þ + kz1s ðu2 ,v2 ÞÞÞÞ × expðjv2 ΔÞexpð − jhðkz10 ðu1 ,v1 Þ + kz10 ðu2 ,v2 ÞÞÞ,  r, rs 2 Σ  ð12:6Þ  In the 3D case, we will focus only on the case with data gathered at the air–soil interface (h = 0). That said, let us pose u1 + u2 = p v1 + v2 = q Thus, Eq. (12.6) is rewritten as  ð12:7Þ  THREE-DIMENSIONAL DIFFRACTION TOMOGRAPHY  208  − jμ0 ωI0 l Esx ðx, y; ω,0,ΔÞ = 16π 4 k02  +∞ ð +∞ ð +∞ ð  −∞ −∞ −∞  +∞ ð +∞ ð  ×  dx0 dy0 dz0 χ e ðx0 ,y0 ,z0 Þ  +∞ ð +∞ ð  dpdq −∞ −∞  ðix Msa ðp − u2 , q− v2 ÞMas ðu2 ,v2 Þix Þ  du2 dv2   2 2  2 ð Þ + ð q − v Þ u2 + v22 p − u 2 2 −∞ −∞  × expð − jðpx0 + qy0 ÞÞ expðjðpx + qyÞÞ expð − jz0 ððkz1s ðp − u2 , q − v2 Þ + kz1s ðu2 ,v2 ÞÞÞÞ expðjv2 ΔÞ,  r, rs 2 Σ  ð12:8Þ  In Eq. (12.8) we can recognize a double direct Fourier transform with respect to the contrast and a double inverse Fourier transform with respect to the data. Thus, from Eq. (12.8) we obtain − jμ0 ωI0 l E^^sx ðp,q;ω,0,ΔÞ = 4π 2 k 2 0  +∞ ð  ^e ðp, q,z0 Þ dz0 χ^  −∞  +∞ ð ð +∞  ×  ðix Msa ðp − u2 , q − v2 ÞMas ðu2 ,v2 Þix Þ    2 2  2 ð Þ + ð q − v Þ u2 + v22 p− u 2 2 −∞ −∞  × expð − jz0 ððkz1s ðp − u2 ,q − v2 Þ + kz1s ðu2 ,v2 ÞÞÞÞexpðjv2 ΔÞ du2 dv2 ,  r, rs 2 Σ  ð12:9Þ  The double integral in du2dv2 is solved under the stationary phase approximation for high values of z0 , which amounts to assume targets that are not too shallow, analogously to the 2D case. There is a unique first-order stationary point at p u2 = , 2  v2 =  q 2  ð12:10Þ  Thus, under the above approximations we have E^^sx ðp, q;ω,0,ΔÞ =  +∞ ð  W ðp, q; ω,0,ΔÞ −∞   p q χ^^e ðp, q,z0 Þ 0 exp − j2z k , dz0 z1s z0 2 2  where the spectral weight W(p,q;ω,0,Δ) is given by  ð12:11Þ  BORN APPROXIMATION AND DT IN 3D  W ðp, q;ω,0,ΔÞ  =  μ0 ωI0 l πk02  4ks2 − p2 − q2  209         p q p q p ix Msa , Mas , ix exp −j Δ 2 2 2 2 2 qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ   2 ðp2 + q2 Þ 4ks2 − p2 4ks2 − q2  3=2       3=2 p     μ0 ωI0 lexp − j Δ 4ks2 − p2 − q2 3 X 2 p q p q qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ = Msa1n , Masn1 ,    2 2 2 2 2 4ks2 − p2 4ks2 − q2 n = 1 πk02 ðp2 + q2 Þ   p 20 12 3 8μ0 εsr ωI0 lexp − j Δ kz1s 2 2 2 2 k q ε p k k 0 z1s z10 4@ 0 A qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ + =    2 k + k k ε + k ε 2 2 2 2 2 2 2 z10 z1s z1s 0 z10 s πk0 ðp + q Þ 4ks − p 4ks − q 0  12 0 12 3 2 2 2 k pq ε pqk k ε pk ð p + q Þ 0 z1s z10 A 0 z10 A5 +@ 0 − +@ kz10 + kz1s kz1s ε0 + kz10 εs 2ðkz1s ε0 + kz10 εs Þ  ð12:12Þ  The second member of Eq. (12.11) represents the Fourier transform of the auxiliary quantity χ e1 ðx0 ,y0 ,z0 Þ =  χ e ðx0 ,y0 ,z0 Þ z0  ð12:13Þ  calculated in the point ηðp, qÞ = p, ξðp, qÞ = q, sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2 2 pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ p q ω2 ςðp, qÞ = 2 ks2 − − = 4ks2 − p2 − q2 = 4 2 − p2 − q2 4 4 c  ð12:14Þ  In the end, the DT relationship in 3D is given by ^ E^^sx ðp,q;ω,0,ΔÞ = W ðp, q;ω,0,ΔÞχ^^e1 ðηðp, qÞ, ξðp, qÞ, ςðp, qÞÞ  ð12:15Þ  with the spectral weight given by Eq. (12.12) and the coordinative transformation given by Eq. (12.14). As can be seen, Eq. (12.15) is a conceptually straightforward extension of the DT relationship in 2D, expressed by Eq. (9.11).  210  THREE-DIMENSIONAL DIFFRACTION TOMOGRAPHY  12.2 IDEAL AND LIMITED-VIEW-ANGLE 3D RETRIEVABLE SPECTRAL SETS Based on the coordinative transformation given in Eq. (12.14), relationship (12.15) provides a Fourier relationship between the spectrum of the data and that of the contrast normalized to the depth if and only if the soil is lossless and the couple (p,q) verifies the inequality p2 + q2 ≤ 4ks2 . This means that the 2D ideal (i.e., relative to an infinite observation line) visible interval in 3D becomes the ideal visible circle, centered in the origin and with ray equal to 2ks in the plane (p,q). It is characterized by the inequality Cv = ðp, qÞ : p2 + q2 ≤ 4ks2  ð12:16Þ  This ideal circle corresponds to the case of an infinite observation plane with effective view angle ranging from − π=2 to π=2 along any horizontal direction. At any fixed frequency, from Eq. (12.14) we recognize that the visible circle is transformed in a curved surface in the space (η,ξ,ς), whose equation is given by η2 + ξ2 + ς2 = 4ks2  ð12:17Þ  Equation (12.17) is the equation of a sphere centered in the origin and with ray 2ks in the space (η,ξ,ς). It is easy to recognize, in particular, that the visible circle Cv corresponds to the half-sphere of Eq. (12.17) enclosed in the half-space ς ≥ 0. At variance of the frequency, the spectral retrievable set in 3D is given by the points (η,ξ,ς) enclosed between the two half spheres centered in the origin with minimum ray 2ks min and maximum ray 2ks max, respectively. This means that the retrievable spectral set is limited. In particular, we have that the 3D retrievable spectral set is given by the solid of revolution of the homologous 2D set around the ς-axis. It is important to outline that the spectral weight tends to zero all over the bound of the visible circle, so that the “actual” retrievable spectral set is never equal to the ideal one, in the sense that it would not be equal to the ideal set even if the measurement plane surface were unlimited, analogously to what happened in 2D (see Section 9.2). With regard to the case of a limited view angle, the equivalent in 3D of Section 9.3 should be developed. The procedure is conceptually straightforward but of course quite long. In particular, the maximum view angle (meant at the moment in a merely geometrical sense) obviously depends on the shape of the bound of the observation surface and in general is not the same along any horizontal direction. In the (common) case that the area of interest is large with respect to the square of the central wavelength in the soil, and on condition that the shape of this area is not extremely elongated, it makes a sense to introduce the concept of an effective maximum view angle, which can be averagely estimated from the data in the same way shown in the 2D case. Rigorously, the maximum view angle is in general a quantity depending on the particular horizontal direction, and in particular it is in general not the same along the x-axis or along the y-axis. Physically, this is because the radiation patterns of the antennas are in  IDEAL AND LIMITED-VIEW-ANGLE 3D RETRIEVABLE SPECTRAL SETS  211  general not symmetrical around the z-axis. In particular, in the considered case (a Hertzian dipole as source and a mere “projector” as receiver) this can be recognized from the fact that in Eq. (12.12) the spectral weight is not a function of p2 + q2, nor do we have W(p,q) = W (q,p). If a particularly refined analysis is required or desired, we might estimate from the data the maximum effective view θe max y along the y-axis (i.e., the axis along which the B-scans develops) and the effective maximum view angle θe max x along the x-axis (theoretically, this can be retrieved joining the traces of the different B-scans at the same value of y). In this case, the visible set can be approximated by the canonical ellipsis with axes 4ks sin(θe max y) and 4ks sin(θe max x) in the plane (p,q). The fact that the visible effective set in general is not circular drives to the consideration that (rigorously) the retrievable spectral set is not rotationally symmetric around the axis ς. This means, on one side, that the optimal spatial step along y and along x, namely the spatial step between the traces along any B-scan and the transect between any two adjacent B-scans, are not rigorously equal to each other, and this also means that the resolution achievable along x is rigorously not the same as that expected along y or along any other horizontal direction. However, θe max x and θe max y are expected of the same order, and since we look for an order of magnitude with regard to both the spatial step to adopt and the resolution that we can hope to achieve, we will refer just to a θe max that will be assumed equal along any horizontal direction. Operatively, it is more simple to evaluate θe max from the B-scans, gathered along the y-axis in the considered case. Under this assumption, the effective visible set accounting for the finite view angle is circular, and its equation is Cve = ðp, qÞ : p2 + q2 ≤ 4ks2 sin 2 ðθemax Þ  ð12:18Þ  Inequality (12.18) describes the circle centered in the origin and with ray equal to 2ks sin(θe max). If the frequency is between fmin and fmax, we will achieve the spectral set as the intersection (in the half-space ς > 0) of volume enclosed between the two spheres centered in the origin with ray 2ks min and 2ks max and the cone of angular aperture θe max. Mathematically, the spectral set S is described as follows: S = S1 \ S2 \ S3 \ S4  ð12:19Þ  where S1 = ðη, ξ, ςÞ : ς ≥ 0, 2 S2 = ðη, ξ, ςÞ : η2 + ξ2 + ς2 ≥ 4ksmin , 2 , S3 = ðη, ξ, ςÞ : η2 + ξ2 + ς2 ≤ 4ksmax  S4 = ðη, ξ, ςÞ : η2 + ξ2 ≤ ς2  ð12:20Þ  sin ðθemax Þ cos 2 ðθemax Þ 2  A quantitative representation of the retrievable spectral set is given in Figure 12.2.  THREE-DIMENSIONAL DIFFRACTION TOMOGRAPHY  212  Obliquous view from the top side  Lateral view 60  60 40  40  ζ  ζ 20  20  0 50 η  0 –50  –50  0 –60  50  0 ξ  –40  Obliquous view from the bottom side  –20  0 η  20  40  –50 605 00  Plan view from the top side 60 40  60  20 40 ζ  0  20  ξ  –20  0 –50  50 0  –50 0 η  0 50  50  ξ  –40 –50  0 η  50  –60  Figure 12.2. Quantitative representation of the effective 3D retrievable spectral set. Involved parameters: fmin = 200 MHz, fmax = 600 MHz, εsr = 4, and θe max = 0.8481 radians (sin(θe max) = 0.75).  12.3  SPATIAL STEP AND TRANSECT  The spatial step and the transect or, in other terms, the spatial needed steps along the direction of the movement of the antennas and along the horizontal direction orthogonal to this are driven by the Nyquist criterion. Therefore, the spatial step both along the x- and y-axis has to be not larger than 2π times the inverse of the diameter of the visible circle, both along the x-axis and along the y-axis. This step is the maximum one allowed in order to guarantee an aliasing-free reconstruction of the effective visible circle. Of course, we are mainly interested in mutlifrequency prospecting and so, conservatively, the bound will be referred to the maximum involved frequency. Consequently, in the end we have λsmin , = 2π 4 sin ðθemax Þ 4 sin ðθemax Þ λsmin 2π 2π λsmin transect = T = = = 2π 2ð2ksmax sin ðθemax ÞÞ 4 sin ðθemax Þ 4 sin ðθemax Þ λsmin spatial step = s =  2π = 2ð2ksmax sin ðθemax ÞÞ  2π  ð12:21Þ  Analogously to the 2D case, the needed spatial step (and also the needed transect) can be relaxed if the targets of interest are not very shallow.  HORIZONTAL RESOLUTION  213  With regard to the spatial step, the 3D result confirms the 2D result [see Eq. (9.49)]. Instead, the evaluation of the needed transect makes sense only within a 3D model. From a practical point of view, in most cases it is not a problem to guarantee the Nyquist rate with regard to the spatial step along the B-scan, because the step guaranteed by the odometer is in most cases automatically narrower than the Nyquist rate. Instead, to guarantee the Nyquist rate with regard to the transect is in most cases unpractical, at least with a classical (single antenna) GPR system. To mitigate this problem, in many cases a grid of measurements along two orthogonal C-scans, along both the x-axis and the y-axis (Conyers, 2004), is taken. In this way, the combination (i.e., the multiplication, pixel by pixel, after some suitable interpolation) of the two images achieved from the two C-scans mitigates the “necessarily too large” transect. On the other hand, it is also to be outlined that, in most cases, even if the transect is larger than that theoretically required, the user can achieve meaningful and above all useful results (the published case histories are endless because indeed a transect larger than the Nyquist rate is the praxis). This happens for two reasons: 1. Based on the DT equation (12.15), the spectrum of the field within the visible circle is proportional to the spectrum of the object function. The effective visible circle is approximately the maximum possible extension of the spatial spectrum of the field at a given frequency. However, the actual extension of the spectrum of the field might be even narrower, which relaxes the anti-aliasing requirements. This can happen if the targets of interest are larger than the Nyquist rate. In other words, we really need the Nyquist rate only if we have to achieve the maximum available resolution, which fortunately does not occur in all the case histories. 2. The effective visible spectrum depends also on the depth of the targets of interest, because of the sine of the maximum effective view angle, which customarily decreases versus the depth, as said. Thus, the Nyquist rate is “fully” needed only if the targets of interest are small and shallow. In particular, for deeper targets the achievable performances get unavoidably degraded but, on the other hand, also the sampling requirements get consequently relaxed.  12.4  HORIZONTAL RESOLUTION  Raffaele Persico and Raffaele Solimene In order to estimate the horizontal (and then the vertical) resolution, we will follow the same steps already implemented in the 2D case (see Section 9.5). In particular, neglecting the effect of the spectral weighting function, we will approximate the reconstruction of a point-like target—that is, the point spread function, with the inverse Fourier transform of the spectrum of the object function restricted to the retrievable spectral set.  THREE-DIMENSIONAL DIFFRACTION TOMOGRAPHY  214  Still, in order to achieve a closed-form solution, we will approximate the retrievable spectral set as a cylinder. The basis of the cylinder is the visible circle at the central frequency—that is, the circle with equation 2 sin 2 ðθemax Þ η2 + ξ2 = 4ksc  ð12:22Þ  The height of the cylinder ranges between 2ks min and 2ks max along the ς-axis. In Figure 12.3, the approximated cylindrical spectral set is quantitatively represented, in comparison with the actual spectral set. The involved parameters are the same as in Figure 12.2. Let us refer to this volume as Cyl. This cylinder is the solid of revolution around the ς-axis of the dashed rectangle that approximates the spectral set in 2D (see Figure 9.11). At this point, neglecting also the unessential normalization of the contrast to the depth [see Eq. (12.13)], let us consider a point-like target described as χ e ðx0 ,y0 ,z0 Þ = χ 0 δðx0 − x0 Þδðy0 − y0 Þδðz0 − z0 Þ  ð12:23Þ  Its point spread function is given by χ er ðx0 ,y0 ,z0 Þ =  χ0 8π 3  ððð  expðjðx0 − x0 ÞηÞexpðjðy0 − y0 ÞξÞ expðjðz0 −z0 ÞςÞ dηdξdς ð12:24Þ  Cyl  It is convenient to solve in polar coordinatives the double integral, so we write η = ρ cos ðφÞ, ξ = ρ sin ðφÞ, x0 − x0 = ρ1 cos ðφ1 Þ, y0 − y0 = ρ1 sin ðφ1 Þ  ð12:25Þ  60 40 ζ 20 0  50 η  0  –50  –20 –60 –40  0  20  40  60  ξ  Figure 12.3. Actual and approximated (cylindrical) spectral retrievable set.  HORIZONTAL RESOLUTION  215  where ρ= ρ1 =  φ=  pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ η2 + ξ2 , qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ðx0 − x0 Þ2 + ðy0 − y0 Þ2 , 8 0 1 > > ξ > > > arcsin@pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃA > > 2 > η + ξ2 > <  if η ≥ 0,  0 1 > > > > ξ > > > π − arcsin@pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃA if η < 0 > > : η2 + ξ2 0 1 8 > 0 > y − y0 > B C > > qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃA if x0 − x0 ≥ 0, > > arcsin@ 2 2 > < ðx0 − x0 Þ + ðy0 − y0 Þ 0 1 φ1 = > > > y 0 − y0 > B C > > π − arcsin@qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃA if x0 − x0 < 0 > > 2 2 : 0 0 ðx − x0 Þ + ðy − y0 Þ  ð12:26Þ  Thus, Eq. (12.24) can be rewritten as  χ χ er ðx ,y ,z Þ = 03 8π 0  0 0  2kð s max  2ksc sin ððθemax Þ  0  expðjðz − z0 ÞςÞ dς 2ks min  χ = 03 8π  2kð s max  0  ρdρ expðjρρ1 cos ðφ− φ1 ÞÞ dφ = 0  0  2ksc sin ððθemax Þ  2ðπ  expðjðz − z0 ÞςÞ dς  ρdρ expðjρρ1 cos ðφÞÞ dφ = 0  2ks min  =  2π ð  0  χ0 ðks max − ks min Þ expðj2ksc ðz0 − z0 ÞÞ sin cððks max − ks min Þðz0 − z0 ÞÞ × 8π 3 2ksc sin ððθe max Þ  2ðπ  ρ dρ expðjρρ1 cos ðφÞÞ dφ  × 0  ð12:27Þ  0  In particular, in Eq. (12.27) we have exploited the periodicity of the argument of the third integral, which makes the result independent of φ1.  THREE-DIMENSIONAL DIFFRACTION TOMOGRAPHY  216  Based on the calculation steps developed in Appendix F, we can solve the integral (12.27) in terms of the Bessel’s function of first kind and order one (Abramowitz and Stegun, 1972) as follows: χ er ðx0 ,y0 ,z0 Þ 2 4χ 0 ðks max − ks min Þexpðj2ksc ðz0 − z0 ÞÞksc sin 2 ðθe max Þ 2 π  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ J1 2ksc sin ðθe max Þ ðx0 − x0 Þ2 + ðy0 − y0 Þ 0 qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ × sin cððks max − ks min Þðz − z0 ÞÞ 2ksc sin ðθe max Þ ðx0 − x0 Þ2 + ðy0 − y0 Þ  =  ð12:28Þ In Figure 12.4, the function J1 ðxÞ=x is represented versus x: It is an even function somehow similar to a sinc function. In particular, the first zeroes of the function are at x = 3.84. Thus, the extension of the main lobe of the function is provided by the following equation: qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ðx0 − x0 Þ2 + ðy0 − y0 Þ2 qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ = 2 × 3:84 ) ðx0 − x0 Þ2 + ðy0 − y0 Þ2 =  2ksc sin ðθemax Þ  3:84 3:84 λsc = ksc sin ðθe max Þ π 2 sin ðθe max Þ  ð12:29Þ  Similarly to the 2D case, this distance also provides the horizontal resolution, which therefore is given by  0.5  J1(x)/x  0.4 0.3 0.2 0.1 0 –0.1  –10  –5  0 x  5  Figure 12.4. Graph of J1 ðx Þ=x.  10  VERTICAL RESOLUTION, FREQUENCY AND TIME STEPS  HR =  3:84 λsc λsc ≈1:22 2 sin ðθe max Þ π 2 sin ðθ e max Þ  217  ð12:30Þ  Since what we can retrieve is (only) an order of magnitude, Eq. (12.30) essentially confirms the 2D result of Eq. (9.44), namely the fact that best retrievable horizontal resolution is expected of the order of one-half of the internal wavelength for shallow targets and is expected to degrade progressively versus the depth.  12.5  VERTICAL RESOLUTION, FREQUENCY AND TIME STEPS  The calculation of the vertical resolution is fully analogous to the 2D case. This stems from the fact that, in the calculation of the point spread function, the integral in dς is decoupled from the integrals along the other spectral variables and is exactly the same in 2D and 3D [see Eqs. (9.42) and (12.28)]. Consequently, the vertical achievable resolution can be quantified by means of Eqs. (9.45) and (9.46), here repeated for a more comfortable reading: Lossless case c c ≈ = λsc B fc  ð12:31Þ  c c ≈ = λsce Be fce  ð12:32Þ  VR = Lossy case (perturbative approach) VR =  With regard to the needed frequency step, the calculations are straightforwardly derived from the 2D dealing of Section 9.8, with the only difference that condition (9.53) is replaced by its equivalent in 3D Δςðη, ξÞ =  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 4ðks + Δks Þ2 − η2 − ξ2 − 4ks2 − η2 − ξ2  ð12:33Þ  whose minimum versus η and ξ is achieved at (η,ξ) = (0,0). Thus, also in this case we will not repeat the passages, referring the reader to Section 9.8. Here, we will just repeat the result, which is [see Eq. (9.52)] Δf =  c0 pﬃﬃﬃﬃﬃﬃ 2b εsr  ð12:34Þ  where b is the vertical extent of the investigation domain and εsr is the relative permittivity of the soil (we are not considering the case of magnetic soils in this chapter).  218  THREE-DIMENSIONAL DIFFRACTION TOMOGRAPHY  Let us also remind that this is the frequency step for processing the data, which is possibly different from the frequency step needed to gather the data in the frequency domain, for which the reader is referred to Chapter 3. Finally, with regard to the time step, the dealing remains the same as in Section 9.9, and also in this case there is no difference with respect to the 2D case. In particular, the time step needed for gathering the data is given in any case by Eq. (3.39), and the time step needed to process the data in the time domain after filtering them for any reason (in particular, for some possible narrow band interferences) is given by Eq. (9.54).  QUESTIONS 1. Does the ideal (with infinite observation line) 2D visible interval at fixed frequency translate into a square range in the analogous 3D case? 2. Is the 3D retrievable spectral set the rotation volume of the 2D spectral set around its symmetry axis? 3. Is the horizontal resolution in 3D better than that available in 2D, because of the more accurate model? 4. Is the Nyquist criterion an indispensable requirement with regard to the spatial step of the data along both the x and y horizontal directions?  13 THREE-DIMENSIONAL MIGRATION ALGORITHMS  13.1  3D MIGRATION FORMULAS IN THE FREQUENCY DOMAIN  In this section we will provide 3D migration formulas for the case developed in the previous chapter, namely data gathered at the air–soil interface in common offset on a nonmagnetic soil and without magnetic targets. The source is assimilated to a Hertzian dipole, and the received signal is approximated as the projection of the field along the direction of the receiving dipole in the observation point. The migration in 3D is based on the inversion of Eq. (12.15), which (omitting the dependence of the spectral weight on the height of the measurement line and on the offset) is formally written as ^ χ^^e1 ðη, ξ, ςÞ =  1 E^^SX ðpðη, ξ,ςÞ,qðη, ξ, ςÞ;ωðη, ξ, ςÞÞ ð13:1Þ W ðpðη, ξ, ςÞ, qðη, ξ, ςÞ;ωðη, ξ,ςÞÞ  Where the spatial spectral weight W is provided by Eq. (12.12) and where the inversion is defined only for (η,ξ,ς) belonging to the spectral retrievable set, which automatically provides also a regularization of the result. The formal expression of the coordinative  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  219  THREE-DIMENSIONAL MIGRATION ALGORITHMS  220  transformation from a volume in the space (η,ξ,ς) to a volume in the space (p,q,ω) is achieved by inverting Eq. (12.14), which provides p = η, q = ξ, qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ c ω= η2 + ξ2 + ς2 2  ð13:2Þ  where c is the propagation velocity of the electromagnetic waves in the soil. Thus Eq. (13.1) can be more simply rewritten as ^ χ^^e1 ðη, ξ, ςÞ =   qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 1 c ^ η2 + ξ 2 + ς 2 qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ E^sx η,ξ; c 2 η2 + ξ2 + ς2 W η, ξ; 2   ð13:3Þ  The object function is provided by the 3D inverse Fourier transform of Eq. (13.1): ððð  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 1 1 ^^ η, ξ; c η2 + ξ2 + ς2 χ e1 ðx0 ,y0 ,z0 Þ = 3   E qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ sx 8π c 2 Sp − set W η, ξ, η 2 + ξ 2 + ς2 2 × expðjðηx0 + ξy0 + ςz0 ÞÞ dηdξdς  ð13:4Þ  where the integration is performed over the retrievable spectral set. Equation (13.4) requires an interpolation of the spectrum of the data, but it is a three-dimensional inverse Fourier transform and thus can be implemented by means of fast IFFT algorithms. Alternatively, the integration can be performed in the variables η, ξ, and ω, by means of the substitution vﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ u 2 qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ u4ω c 4ωdω η2 + ξ2 + ς2 = ω ) ς = t 2 −η2 − ξ2 ) dς = sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ c 2 ð13:5Þ 4ω2 2 2 −η −ξ 2 c In this way, we can rewrite Eq. (13.4) as χ e1 ðx0 ,y0 ,z0 Þ =  1 4π 3  ððð  ωE^^sx ðη, ξ;ωÞ sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 4ω2 2 2 Sp − set1 W ðη,ξ; ωÞ −η −ξ c2  sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ !! 4ω2 2 2 0 −η −ξ z × exp j ηx + ξy + dηdξdω c2 0  0  ð13:6Þ  3D MIGRATION FORMULAS IN THE FREQUENCY DOMAIN  221  Equation (13.6) does not require any interpolation of the spectrum of the data, but it is not an inverse Fourier transform, and so the integral cannot be calculated by means of fast IFFT algorithms. In Eq. (13.6) the integration domain has been labeled as the Sp_set1 because it is the spectral retrievable set in the space (η,ξ,ω) straightforwardly specified from the spectral retrievable set Sp_set in the space (η,ξ,ς), which coincides with the set S characterised by Eqs. (12.19) and (12.20). We can achieve an integral expression where the extremes of the integration are explicated, by passing to polar coordinatives. In particular, we can substitute in Eq. (13.4) η = ρ cos ðφÞ sin ðθ1 Þ, ξ = ρ sin ðφÞ sin ðθ1 Þ,  ð13:7Þ  ς = ρ cos ðθ1 Þ where the symbol θ1 has been adopted in order not to confuse the integration variable with the maximum effective view angle. Substituting into Eq. (13.4) and putting in the integral also the Jacobian of the transformation ρ2 sin(θ1), we obtain 2π ð 1 0 0 0 χ e1 ðx ,y ,z Þ = 3 dφ 8π 0  π  ð2  2kð s max  sin ðθ1 Þdθ1 π 2  − θe max  ρ2 dρ 2ks min    c ^ ^ E sx ρ cos ðφÞ sin ðθ1 Þ, ρ sin ðφÞ sin ðθ1 Þ, ρ 2  ×  c W ρ cos ðφÞ sin ðθ1 Þ,ρ sin ðφÞsin ðθ1 Þ, ρ 2 × expðjðρ cos ðφÞ sin ðθ1 Þx0 + ρ sin ðφÞ sin ðθ1 Þy0 + ρ cos ðθ1 Þz0 ÞÞ  ð13:8Þ  Equation (13.8) requires some interpolation of the data and is not an inverse Fourier transform, so it is computationally less convenient with respect to the previous expressions. However, it allows us to write in a closed form the extremes of the integrals and allows us to appreciate more immediately the effect (and the relevance) of the maximum view angle. Equations (13.4), (13.6), and (13.8), are three alternative expressions for the f–k migration in 3D. Similarly to the 2D case, a simplified but robust expression of the migration can be achieved by neglecting the effect of the spectral weight W and extending the spectral integral to the entire space (η,ξ,ς), or alternatively the entire space (η,ξ,ω), relying on the fact that the spectrum of the data automatically vanishes outside the visible circle. In particular, assimilating to a unitary (but not dimensionless) factor F the 2ω rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ in Eq. (13.6), we can write: quantity 4ω2 2 2 −η −ξ W ðη, ξ; ωÞ c2  THREE-DIMENSIONAL MIGRATION ALGORITHMS  222  F χ e1 ðx ,y ,z Þ≈ 3 8π 0  0 0  +∞ ð +∞ ð +∞ ð  E^^sx ðη, ξ; ωÞ exp j ηx0 + ξy0 +  − ∞ −∞ −∞  sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ !! 4ω2 2 2 0 dηdξdω −η −ξ z c2 ð13:9Þ  or alternatively in the space (η,ξ,ς)  χ e1 ðx0 ,y0 ,z0 Þ ≈  cF 16π 2  +∞ ð +∞ ð +∞ ð ςE^^sx    −∞ −∞ −∞  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ c η2 + ξ2 + ς2 η, ξ; 2 pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ expðjðηx0 + ξy0 + ςz0 ÞÞ dηdξdς η 2 + ξ2 + ς2 ð13:10Þ  The expressions (13.9) and (13.10) correspond to classical expressions of the f–k migration in 3D [see, e.g., Eqs. (67a) and (67b) in Stolt (1978), under the same clarifications provided in Chapter 10 with regard to the 2D case].  13.2  3D MIGRATION FORMULAS IN THE TIME DOMAIN  In order to express the migration formulas versus the data in space and time domain, we can start from Eq. (13.6). In particular, it is comfortable to define 8 > > <  ω sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ , 4ω2 2 2 gðη,ξ,ωÞ = 4π 3 W ðη,ξ;ωÞ −η −ξ > c2 > : 0,  ðη, ξ, ωÞ 2 Sp− set1 ð13:11Þ ðη, ξ, ωÞ 2 = Sp− set1  So that Eq. (13.6) can be more compactly rewritten as 0  0 0  +∞ ð +∞ ð +∞ ð  χ e1 ðx ,y ,z Þ =  gðη, ξ,ωÞE^^sx ðη, ξ;ωÞ ×  −∞ −∞ −∞  sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ !! 4ω2 2 2 0 × exp j ηx0 + ξy0 + −η −ξ z dηdξdω c2  ð13:12Þ  Now, the spectrum E^^sx ðη, ξ;ωÞ is expressed versus the data in space and time domain as  E^^sx ðη, ξ; ωÞ =  +∞ ð +∞ ð +∞ ð  Esx ðx, y, t Þ expð − jðηx + ξyÞÞ expð − jωt Þ dxdydt −∞ −∞ −∞  ð13:13Þ  3D MIGRATION FORMULAS IN THE TIME DOMAIN  223  Substituting Eq. (13.13) into Eq. (13.12), we obtain 0  +∞ ð +∞ ð ð +∞  0 0  χ e1 ðx ,y ,z Þ = −∞ −∞ −∞  sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ !! 4ω2 2 2 0 gðη, ξ, ωÞ exp j ηx + ξy + −η −ξ z × c2 0  0  +∞ ð +∞ ð ð +∞  Esx ðx,y,t Þexpð − jðηx + ξyÞÞ expð − jωt Þ dxdydtdηdξdω =  × −∞ −∞ −∞ +∞ ð +∞ ð +∞ ð  =  g1 ðx− x0 , y −y0 , z0 , t ÞEsx ðx,y,t Þ dxdydt  ð13:14Þ  −∞ −∞ −∞  where the function g1(x − x0 , y − y0 , z0 , t) is defined as 0  0  +∞ ð +∞ ð +∞ ð  0  g1 ðx − x , y − y , z , t Þ =  " gðη, ξ, ωÞ − j ωt + ηðx − x0 Þ + ξðy − y0 Þ +  −∞ −∞ −∞  sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ! # 4ω2 2 2 − z0 −η −ξ dηdξdω c2  ð13:15Þ  In general, the integral (13.15) cannot be solved in a closed form; thus, in general, integral (13.14) cannot be solved in closed form either. However, if we assume that the function g(η,ξ,ω) is unitary, then we can close the integrals. In fact, in this case we can approximate χ e1 ðx0 ,y0 ,z0 Þ =  +∞ ð +∞ ð ð +∞  g2 ðx− x0 , y − y0 , z0 , t ÞEsx ðx,y,t Þ dxdydt  ð13:16Þ  −∞ −∞ −∞  with g2 ðx − x0 , y − y0 , z0 ,t Þ = F  +∞ ð  expð − jωt Þ dω −∞ +∞ ð ð +∞  × −∞ −∞  2  vﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ! 3 u 2 u4ω exp4 − j ηðx − x0 Þ + ξðy − y0 Þ − t 2 − η2 − ξ2 z0 5 dηdξ c ð13:17Þ  where F is a unitary but not dimensionless factor. Equation (13.17) can also be put in the form  THREE-DIMENSIONAL MIGRATION ALGORITHMS  224  ∂ g2 ðx −x , y − y , z , t Þ = F 0 ∂z 0  0  0  +∞ ð  expð − jωt Þ dω × −∞  sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ !# 4ω2 2 2 0 exp − j η ð x − x Þ + ξ ð y − y Þ− − η −ξ z +∞ +∞ ð ð c2 sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ × dηdξ 4ω2 2 2 −∞ −∞ −j −η −ξ c2 "  0  0  ð13:18Þ At this point, let us remind that in the 3D case the axis z0 is directed upward—this is, in the air half-space—we have that z0 in Eq. (13.18) is a negative quantity, and so the function can again be rewritten as ∂ g2 ðx −x , y − y , z , t Þ = jF 0 ∂z 0  0  0  +∞ ð  expð − jωt Þ dω × −∞  sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ # 4ω2 2 2 0 0 0 +∞ ð +∞ ð exp − jηðx − x Þ − jξðy− y Þ − j c2 − η − ξ jz j sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ dηdξ × 4ω2 2 2 −∞ −∞ −η −ξ c2 "  ð13:19Þ At this point, the integral in Eq. (13.19) can be solved in dηdξ by using the calculations shown in Appendix A. In particular, based on Eq. (A.19) we have sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ # 4ω2 2 2 0 +∞ ð +∞ ð exp −jηðx − x Þ − jξðy − y Þ − j c2 − η − ξ jz j sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ dηdξ 2 4ω −∞ −∞ − η2 − ξ2 c2  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2ω 2jπ exp j ðx − x0 Þ2 + ðy − y0 Þ2 + z0 2 c qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ = ðx − x0 Þ2 + ðy − y0 Þ2 + z0 2 "  0  0  Substituting Eq. (13.20) into Eq. (13.19), we obtain  ð13:20Þ  3D MIGRATION FORMULAS IN THE TIME DOMAIN  g2 ðx − x0 , y − y0 , z0 ,t Þ = − 2πF  ∂ ∂z0  225    qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2 exp − jω t − ðx − x0 Þ2 + ðy − y0 Þ2 + z0 2 c qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ dω ðx − x0 Þ2 + ðy − y0 Þ2 + z0 2  +∞ ð  −∞   qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2 δ t− ðx − x0 Þ2 + ðy − y0 Þ2 + z0 2 c ∂ 2 qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ = − 4π F 0 ∂z ðx − x0 Þ2 + ðy − y0 Þ2 + z0 2  ð13:21Þ  Substituting Eq. (13.21) into Eq. (13.16), eventually we obtain  χ e1 ðx0 ,y0 ,z0 Þ = − 4π 2 F  ∂ ∂z0  +∞ ð +∞ ð +∞ ð δ  −∞ −∞ −∞  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2 t− ðx − x0 Þ2 + ðy− y0 Þ2 + z0 2 c qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ Esx ðx,y,t Þ dxdydt ðx − x0 Þ2 + ðy − y0 Þ2 + z0 2   qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2 +∞ ðx− x0 Þ2 + ðy − y0 Þ2 + z0 2 ð +∞ ð Esx x, y, t = c ∂ 2 qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ = −4π F 0 dxdy ∂z 0 Þ2 + ðy −y0 Þ2 + z0 2 x− x ð −∞ −∞  ð13:22Þ  Apart from an unessential factor, Eq. (13.22) is the classical 3D migration formula in the time domain, as reported (for example) in Schneider (1978, page 53). Performing the derivative under the sign of integral, we can still write  χ e1 ðx0 ,y0 ,z0 Þ≈ − 4π 2 F  ∂ ∂z0  +∞ ð +∞ ð Esx  −∞ −∞  +∞ ð +∞ ð  = − 4π 2 F −∞ −∞  2r x, y, t = c r   dxdy  0    B 2z0 ∂  B E ð x, y, t Þ  @cr 2 ∂t sx    1 2r z Esx x, y, t = c C C dxdy ð13:23Þ − A 3 r 2r 0  t=  c  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ where r = ðx −x0 Þ2 + ðy − y0 Þ2 + z0 2 is the distance between the source point (x,y,0) and the investigation point (x0 ,y0 ,z0 ). The quantity z0 =r is easily recognized to be just the view angle for the current source and investigation points, so that Eq. (13.23) can be also rewritten as  THREE-DIMENSIONAL MIGRATION ALGORITHMS  226  χ e1 ðx0 ,y0 ,z0 Þ = 4π 2 F  +∞ ð +∞ ð  −∞ −∞ +∞ ð +∞ ð  −4π 2 F −∞ −∞   2 cos ðθÞ ∂Esx ðx, y, t Þ    cr ∂t  cos ðθÞEsx  dxdy t=  2r x, y, t = c  r2  2r r    dxdy  ð13:24Þ  The signa are linked to the fact that z0 < 0 whereas we mean θ as the (acute) view angle, so that cos(θ) = −z0 /r. Some commercial code, such as e.g., the GPRSLICE, allow to perform 3D migrations. The reader will find an example in Section 15.9.  13.3 3D VERSUS 2D MIGRATION FORMULAS IN THE TIME DOMAIN We think it might be of interest, at this point, to expose the physical reason why in the formulas of the 2D migration in the time domain [Eqs. (10.35) and (10.36)] the datum is integrated versus the time, whereas in the homologous 3D formulas [Eqs. (13.22) and (13.23)] the integration along the time disappears.1 The reason is illustrated by means of Figure 13.1. In particular, in a 2D geometry (panel A), we have depicted a 2D source constituted by a filamentary current at the air–soil interface and a point-like 2D target, parallel to each other and both indefinitely long along one of the axes. For the sake of clarity, the air–soil interface has been made fully transparent in Figure 13.1. Moreover, the observation point along the axis orthogonal to the axis of invariance is evidenced too. Let us now assume that the source is a filamentary current and radiates an electromagnetic pulse in a nondispersive soil. This means that the filament is crossed by a temporally impulsive electrical current. This situation can be also viewed as the contemporary radiation of an infinite series of (3D) electromagnetic pulses emanated by a series of adjacent elementary Hertzian dipoles: The single pieces of the blue dashed line in Figure 13.1 can be interpreted as representative of this series. Let us now concentrate on the cross section of the target at x = 0 according to the Cartesian system in Figure 13.1. The incident field in this point will be not temporally impulsive, because the waves radiated by all the equivalent Hertzian dipoles that compose the 2D source propagate at the same finite velocity. So, the elementary Hertzian dipole d1 (see Figure 13.1, panel A) at x = 0 will be the first one to illuminate the cross section at x = 0 of the target at hand, at the instant time rst =c (where rst is the minimum distance between the source and the cross section of the target at x = 0 and where c is the propagation velocity in the soil). Immediately afterward, at the time rst =c + dt, the cross section will be illuminated by the two “adjacent” equivalent Hertzian dipoles d2a and d2b, placed at x = dx and x = − dx along the filamentary source, respectively. Then, at the time 1 In particular, this also means that the 2D formula is not merely given by the 3D formula with one less spatial integration.  3D VERSUS 2D MIGRATION FORMULAS IN THE TIME DOMAIN  (a)  227  Panel A : 2D Z Observation point d3b d2b  X d1 d2a d3a Target  Y  Source  (b)  Panel B : 3D Z Observation point  Source  X Target  d1  Y  Figure 13.1. Pictorial of a 2D (panel A) and a 3D (panel B) geometry with an impulsive point-like source and a point-like target. For color detail, please see color plate section.  rst =c + 2dt the cross section at hand is illuminated by the two dipoles d3a and d3b, placed at x = 2dx and x = −2dx along the filamentary source, and so on. The subsequent contributions are progressively weaker because of the geometrical spreading and because of the possible losses in the propagation medium, so the field incident in the cross section of the target at x = 0 vanishes versus the time. However, theoretically its duration time ranges from the time instant rst =c up to +∞ The same reasoning also holds with regard to the field scattered from the 2D target and so, in the end, the scattered field received in the observation point ranges in time from the instant ðrst + rto Þ=c [where rto is the distance between the cross section of the target at x = 0 and the observation point (that also is placed at x = 0)] up to the time +∞. If we neglect the offset between the source and observation points along the y-axis (as implicitly done when putting equal to 1 the spectral weight), then we have that the scattered field is a vanishing quantity theoretically observed from the time instant 2r=c (where r = rst = rto) up to the time  228  THREE-DIMENSIONAL MIGRATION ALGORITHMS  instant +∞. In the end, we can say that a trace of the actual three-dimensionality of the “world” inexorably remains also within a 2D model. Instead, within a 3D model (Figure 13.1, panel B), if we assume a point-like impulsive source (i.e., a Hertzian dipole crossed by a temporally impulsive current) and a point-like target, then we will measure an impulsive scattered field in the observation point.  QUESTIONS 1. Are the 2D migration formulas obtained from the 3D ones with the suppression of one of the integrals? 2. Could 3D migration formulas be obtained also if the transmitting and receiving antennas were orthogonal to each other? 3. Suppose we have at our disposal an ideal array of dipole antennas. The dipoles are at a λsmin =4 distance from each other and are orthogonal to the direction of the B-scans. Does this make the gathering of orthogonal B-scans useless, in principle? 4. Is there some way to gather in a unique going-through all the information gathered with two orthogonal sets of B-scans?  14 THE SINGULAR VALUE DECOMPOSITION  14.1  THE METHOD OF MOMENTS  Let us start from the 2D scattering equation under the Born approximation without considering magnetic contrasts. The data are gathered in common offset configuration and the height of the data is possibly greater than zero. So, the starting point is Eq. (9.55), repeated here for readability. ðð Es ðx; ωÞ = ks2  Ge ðx,x0 , h,z0 ; ωÞEinc ðx + Δ, x0 ,h, z0 ;ωÞχ e ðx0 ,z0 Þ dx0 dz0 ,  x2Σ  ð14:1Þ  D  where the involved symbols have been already explained in Chapter 9. Equation (14.1) can be discretized by means of the method of moments (MoM). MoM is a well-known subject, so its description will be very brief. Let us just state that the kind of MoM used here is based on point matching in both spatial and frequency domains. Thus, we will expand the contrast in a finite set of basis functions φk(x0 ,z0 ) k = 1, …, K, assuming that K is high enough to allow a good representation of the targets of interest. That said, the contrast is expressed as Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  229  THE SINGULAR VALUE DECOMPOSITION  230  χ e ðx0 ,z0 Þ ﬃ  K X  αk φk ðx0 ,z0 Þ  ð14:2Þ  k=1  Under the assumption (14.2), to retrieve the contrast means to retrieve its expansion coefficients α1, … αK. Substituting Eq. (14.2) in Eq. (14.1) and particularizing it to a finite set of points x1, …, xM and ω1, …, ωN, we have a finite number of linear equations as follows: Es ðx1 ;ω1 Þ =  ðð K X 2 αk ks1 Ge ðx1 ,x0 , h,z0 ;ω1 ÞEinc ðx1 + Δ, x0 ,h,z0 ;ω1 Þφk ðx0 ,z0 Þ dx0 dz0 , k=1  Es ðx2 ;ω1 Þ =  K X  D  ðð  2 αk ks1  k=1  Ge ðx2 ,x0 , h,z0 ;ω1 ÞEinc ðx2 + Δ,x0 , h, z0 ;ω1 Þφk ðx0 ,z0 Þ dx0 dz0 ,  D  …  ðð K X 2 αk ks1 Ge ðxM ,x0 ,h,z0 ;ω1 ÞEinc ðxM + Δ, x0 , h, z0 ;ω1 Þφk ðx0 ,z0 Þ dx0 dz0 , Es ðxM ;ω1 Þ = k=1  Es ðx1 ;ω2 Þ =  K X  2 αk ks2  k=1  Es ðx2 ;ω2 Þ =  D  ðð  Ge ðx1 ,x0 , h,z0 ;ω2 ÞEinc ðx1 + Δ,x0 , h, z0 ;ω2 Þφk ðx0 ,z0 Þ dx0 dz0 ,  D  K X  ðð  2 αk ks2  k=1  Ge ðx2 ,x0 , h,z0 ;ω2 ÞEinc ðx2 + Δ,x0 , h, z0 ;ω2 Þφk ðx0 ,z0 Þ dx0 dz0 ,  D  …  ðð K X 2 αk ksN Ge ðxM ,x0 , h,z0 ;ωN ÞEinc ðxM + Δ, x0 ,h,z0 ;ωM Þφk ðx0 ,z0 Þ dx0 dz0 Es ðxM ;ωN Þ = k=1  D  ð14:3Þ Equation (14.3) can be resumed in a general way as Aα = d  ð14:4Þ  where d is the column vector of the data d1, …, dNd = Es(x1,ω1), …, Es(xM,ωN), Nd = NM is the number of data, and α = α1, …, αK is the column vector of the unknown expansion coefficients of the contrast. The size of the matrix A is (Nd,K) = (NM,K); that is, it has as many rows as the data and as many columns as the unknowns. The matrix A is given by the piling of the submatrixes relative to all the exploited frequencies. For each frequency ωn, the relative submatrix S is characterized as  REMINDERS ABOUT EIGENVALUES AND EIGENVECTORS  ðð 2 Sði, jÞ = ksn  Ge ðxi ,x0 , h,z0 ;ωn ÞEinc ðxi + Δ, x0 , h,z0 ;ωn Þφj ðx0 ,z0 Þ dx0 dz0  231  ð14:5Þ  D  Of course, the wavenumber has been indexed after the frequency. Three-dimensional problems can be discretized in a similar way: In this case, the data column is achieved by reordering after a unique index the values of the field in the points (xi,yj) and at the frequency ωk, whereas the unknown is expanded in this case along a three-dimensional basis as follows: χ e ðx0 ,y0 ,z0 Þ ﬃ  K X  αk φk ðx0 ,y0 ,z0 Þ  ð14:6Þ  k=1  Formally, the number of unknowns is still given by K and the number of data is still equal Nd = NM, where N is the number of observation points and M is the number of frequencies. Of course, however, K and N are expected quite larger in a three-dimensional problem than in a two-dimensional one, which makes three-dimensional inversions computationally more demanding than two-dimensional ones.  14.2  REMINDERS ABOUT EIGENVALUES AND EIGENVECTORS  The SVD of a rectangular matrix will be introduced in this chapter as an extension of the basic theory of the eigenvalues and eigenvectors of a square matrix. So, preliminarily, some reminders about the eigenvalues and eigenvectors are provided in relationship to matrix inversions. In particular, the basic theory of the linear transformations between two complex vector spaces, equipped with the usual scalar Hermitian (see footnote 2 in Section 11.6) product for complex vectors, is taken for granted. Of course, also the basic concepts about eigenvalues and eigenvectors are taken for granted. That said, let us consider a square [let’s say sized (N,N)] maximum rank matrix M, and let λ1, …, λN be its eigenvalues ordered after a decreasing modulus. Possibly, some of the eigenvalues can be equal to each other; that is, the case of multiple eigenvalues is enclosed too. Let be m1,…, mN be the unitary norm eigenvectors corresponding to the eigenvalues. The set m1,…, mN constitutes (either “naturally” for different eigenvalues or by construction thanks to the Gram–Schmidt procedure) an orthonormal basis for C N. Consequently, we have hmh ,mk i = δh, k  ð14:7Þ  where the symbol hmh ,mk i stands for the Hermitian scalar product in [CK] and δh,k is the Kronecker’s delta function, equal to 1 if h = k and 0 if h 6¼ k. Let us now write U = ðm1 , …, mn Þ  ð14:8Þ  THE SINGULAR VALUE DECOMPOSITION  232  The matrix U is a unitary1 matrix, sized (N,N), whose columns are the eigenvectors. Equation (14.7) implies that U+U =I  ð14:9Þ  where U + is the adjoint (i.e., the transposed and conjugate) of U and I is the identity matrix, sized (N,N). This shows that a unitary matrix is invertible and its inverse coincides with its adjoint, which is in turn a unitary matrix.2 Now, from the definition of eigenvalues and eigenvectors, we have M m1 = λ1 m1 M m2 = λ2 m2 …  ð14:10Þ  M mN = λN mN which in matrix terms can be expressed as M U = U Λ ) M = U Λ U − 1 = U ΛU +  ð14:11Þ  where Λ is a diagonal square matrix [also sized (N,N)] whose non-null elements are the eigenvalues. At this point, let us consider a generic algebraic system with a square maximum rank matrix: Mx=y  ð14:12Þ  Since the matrix has by hypothesis maximum rank, we can formally express the unique exact solution of the system as x = M − 1y  ð14:13Þ  However, this solution might be unstable if the condition number—that is, the modulus of the ratio between the first (largest level) and the last (smaller level) eigenvalues—is much larger than 1. We can understand this by exploiting the eigenvalue decomposition (14.11), as follows: M x = y ) U Λ U + x = y ) x = U Λ−1U + y  1  ð14:14Þ  A matrix is said to be unitary when its columns are orthogonal to each other and have unitary norm. This also means that the property of being unitary can be indifferently defined with regard to the rows or to the columns of the matrix. 2  REMINDERS ABOUT EIGENVALUES AND EIGENVECTORS  233  where Λ − 1 is the inverse of Λ and is a diagonal matrix whose elements along the diagonal are the inverse of the eigenvalues. In terms of eigenvalues and eigenvectors, the solution shown in Eq. (14.14) is written as x=  N X 1  λ n=1 n  h y,mn imn  ð14:15Þ  This makes clear that Eq. (14.14) expresses the solution after a change of basis, and the adopted basis is just constituted by the eigenvectors. This also suggests a possible regularization scheme. In fact, the terms that can generate instability are those relative to the smallest eigenvalues. In particular, inserting in Eq. (14.15) the data affected by any kind of equivalent noise3 Eq. (14.15) evolves into x=  N X 1  λ n=1 n  h y0 + noise, mn imn =  N X 1  λ n=1 n  h y0 ,mn imn +  N X 1  λ n=1 n  hnoise,mn imn  ð14:16Þ  where y0 is the vector of the ideal (noise-free) data. The stability can be guaranteed by arresting the sum to some, N1 ≤ N, thus eliminating the contribution related to the smallest eigenvalues: x≈  N1 X 1  λ n=1 n  h y,mn imn  ð14:17Þ  Of course, the choice of N1 is dictated by a trade-off between accuracy and robustness of the solution, and so it should account for the level of the involved uncertainties affecting the data. In a matrix form, the regularized solution can be expressed by x = U ΛR−1 U + y  ð14:18Þ  where ΛR− 1 is the regularized inverse of Λ; that is, it is a diagonal matrix where the elements on the diagonal are equal to 8 <1, −1 ΛR ði,iÞ = λi : 0,  i ≤ N1 ,  ð14:19Þ  i > N1  3 This includes any source of uncertainty for the data, as for example the model error and the interferences, further than the “actual” thermal noise generated by the receiver.  234  THE SINGULAR VALUE DECOMPOSITION  At this point, we can extend the discussion also to the case of a square matrix that does not show the maximum rank. In fact, this can be seen in a sense as the limit case for a very ill-conditioned matrix. Indeed, while very low eigenvalues lead to a progressively more instable solution, if we loosely admit the concept of null eigenvalues,4 they lead to an indeterminate (which somehow means completely instable) solution. In this case, in order to have any solution, the regularization is mandatory, and the inversion formulas are still provided by Eqs.(14.17) and (14.18), taking for granted that the choice of N1 cuts out the “naturally null” eigenvalues plus possibly the smallest non-null ones. The eigenvectors relative to null eigenvalues are just the eigenvectors belonging to the null space of the linear transformations. Of course, the regularized solution is not an exact solution, in the case of both a maximum rank matrix and a nonmaximum rank matrix.  14.3  THE SINGULAR VALUE DECOMPOSITION  In GPR problems, after linearizing the scattering equations, the algebraic system is in general rectangular; that is, the number of equations in general is not equal to the number of unknowns. In particular, in most cases, GPR systems work with an odometer, as said, and this means that usually we don’t choose apriori the number of gathered data. Of course, we might resample the data so to have as many data as unknowns, but in general this is not a convenient operation, because an increased number of data can help in amortizing the noise. Thus, in general we have to deal with the problem of solving rectangular linear algebraic systems in a regularized way, which requires an extension of the eigenvalue theory; this extension is the singular value decomposition (Bertero and Boccacci, 1998). In these conditions, we are not guaranteed that an exact solution even exists, and we will look for a least square solution. So, with reference to Eq. (14.4), we are now looking for a vector α such as the quantity F ðαÞ = kA α − dk2  ð14:20Þ  is minimum. Such a quantity is achieved by identifying the vector α such as the residual A α− d is orthogonal to all the elements of the range of the linear transformation identified by the matrix A. In fact, in this case, for any chosen α1 belonging to the space of the unknowns CK, we have hA α − d,A α1 i = 0 ) α1+ A + A α −α1+ A + d = 0  8α1 2 C K  Such an α makes minimum F(α). In fact, given any α1 2 CK, we have  4  We mean them just as the null elements of the main diagonal of the matrix Λ.  ð14:21Þ  THE SINGULAR VALUE DECOMPOSITION  235  F ðα1 Þ = kA α1 − dk2 = kA α1 − A α + A α −dk2 = kAðα1 − αÞ + A α −dk2 = hAðα1 − αÞ + A α − d, Aðα1 − αÞ + Aα − di = kAðα1 − αÞk2 + hA α −d, Aðα1 − αÞi + hAðα1 − αÞ, A α− di + kAα − dk2 = kAðα1 − αÞk2 + kA α− dk2 ≥ kA α − dk2 = F ðαÞ  ð14:22Þ  because A ðα1 − αÞ is an element of the range of the linear transformation, and so it is by definition orthogonal to A α − d: Moreover, condition (14.21) can be verified only if A + A α − A + d is a null vector, because α1 is an arbitrary vector. This means that α has to be an exact solution of the algebraic system A+ A α = A+ d  ð14:23Þ  Let us note that A + A is a square matrix sized (K,K), and this makes it possible to resort to the eigenvalue theory for the solution of the system (14.23). In a first moment, let now suppose that A + A is invertible (it is easy to test that this happens if and only if A has maximum rank). In this case, there exists a unique least square solution of the problem, expressed by −1  α = ð A + AÞ A + d  ð14:24Þ  −1  The matrix ðA + AÞ A + is customarily called the pseudo-inverse of A: However, since the underlying physical problem is ill-posed, the stability of the solution has to be guaranteed in the case where we look either for an exact solution or for a least square solution. In particular, the matrix A + A is in general ill-conditioned, and its eigenvalues can show a meaningful dynamic range. Thus, a regularization is needed. In order to perform it, let us start noting that the eigenvalues of the matrix A + A are real and nonnegative quantities. This can be shown by calculating the square norm of the A mi , given by the scalar product of the vector times itself: hAmi ,A mi i = mi+ A + A mi = λi mi+ mi = λi = kA mi k2 ≥ 0  ð14:25Þ  Consequently, we can order the eigenvalues of A + A in a decreasing series of nonnegative numbers, which we will call σ 21 , σ 22 , …,σ 2K . The nonnegative square roots of these eigenvalues σ1, σ 2, …, σ k will be taken as the singular values of the matrix A.5 At this point, let us consider the quantities ni =  1 A mi σi  ð14:26Þ  5 This choice is conventional: For example, the singular values might be chosen negative on condition to reverse the corresponding singular vector.  THE SINGULAR VALUE DECOMPOSITION  236  By definition, we have Ami = σ i ni  ð14:27Þ  A + ðσ i ni Þ = σ i A + ni = A + A mi = σ 2i mi ) A + ni = σ i mi  ð14:28Þ  Moreover, we have  which is the dual of Eq. (14.27). Moreover, from Eqs. (14.27) and (14.28), we have AA + ni = Aðσ i mi Þ = σ i Ami = σ 2i ni  ð14:29Þ  This shows that the matrix A A + has the same eigenvalues as A + A, and the vectors ni are the eigenvectors of A A + . Let us specify that AA + is a square matrix sized (Nd,Nd). Thus, the size of this matrix is different from the size of A + A. However, having the same (non null) eigenvalues, the two matrixes have the same rank. Therefore, in order to be guaranteed that A + A achieves its maximum rank, as supposed up to now, at the moment we will suppose that Nd ≥ K; that is, we will suppose that the data are more than the unknowns. So, when saying that the two matrixes have the same eigenvalues, we mean more precisely that they have the same K non-null eigenvalues, whereas A A + will have Nd − K extra null eigenvalues. It can be also seen that the K eigenvectors ni result automatically orthonormal to each other. In fact,     σi 1  1 σ2  ni ,nj = Ami ,A mj = mj+ A + Ami = i mi ,mj = δi, j = δi, j σiσj σi σj σiσj σj  ð14:30Þ  The interested reader can easily verify that also A A + is a Hermitian matrix. The vectors mi are by definition the singular vectors in the space of the unknowns, whereas the vectors ni are by definition the singular vectors in the space of the data. The singular value decomposition (SVD) of the matrix A is eventually the triple {mi,σ i,ni}i = 1, …, K. As shown, its evaluation can be recast as the calculation of the eigenvalues and eigenvectors of suitable auxiliary square matrixes. At this point, we can provide a matrix factorization based on SVD. In fact, from Eq. (14.28), we have 0  1 σ 1 0 0.:0 B 0 σ 2 0::0 C C ) A+ V = U Σ A + ðn1 ,n2 ,…, nK Þ = ðm1 ,m2 ,…, mK ÞB @… A 0 0…σ K  ð14:31Þ  where V is the matrix of the singular vectors in the space of the data, U is the matrix of the singular vectors in the space of the unknowns, and Σ is the diagonal matrix of the singular values.  THE SINGULAR VALUE DECOMPOSITION  237  Consequently, being V a unitary matrix, we have A+ = U Σ V +  ð14:32Þ  On the other hand, based on the classical eigenvalue theory resumed in the previous section, the square matrix A + A can be factorized as A + A = U Σ2 U +  ð14:33Þ  where Σ2 is a diagonal matrix where Σ2 ði, iÞ = σ 2i . Therefore, the inverse of A + A can be factorized [see Eq. (14.14)] as ðA + AÞ  −1  = U Σ −2 U +  ð14:34Þ  where Σ −2 is a diagonal matrix where Σ −2 ði, iÞ = 1=σ 2i . Substituting Eqs. (14.32) and (14.34) in Eq. (14.24), we can express the least square solution as α = U Σ − 2U + U Σ V + d = U Σ − 1V + d  ð14:35Þ  where Σ −1 is a diagonal matrix where Σ −1 ði, iÞ = 1=σ i . The least square solution (14.35) can be equivalently expressed as α=  K X 1 i=1  σi  hd,ni imi  ð14:36Þ  Equation (14.36) makes it clear that the SVD is based on a double change of basis, both in the space of the unknowns and in the space of the data. The ill-conditioning is expressed by the high ratio between the first (maximum) and the last (minimum) singular value. As shown in the previous section with regard to the exact solution of a square algebraic system, also the least square solution can be regularized by thresholding the singular values,6 so that, choosing N1 < K, we have a regularized solution that can be expressed as α≈  N1 X 1 i=1  σi  hd,ni imi  ð14:37Þ  Similarly to the case of square matrixes, at this point we can remove the hypothesis of maximum rank matrix. In particular, we can account for this situation by choosing 6 Also other kinds of regularizations are possible, where the contributions of the smallest singular values are progressively dumped instead of being abruptly thresholded, but we will not deal with them.  238  THE SINGULAR VALUE DECOMPOSITION  N1 such that the null singular values are cut out, further than possibly the smallest non-null ones. Finally, under the viewpoint of a regularized reconstruction, even the hypothesis that the system is overdetermined can be removed. In fact, when performing a regularization of the kind (14.37), the actual number of unknowns looked for is in the end N1. However, please note that this does not mean that we can a priori impose the problem looking formally for N1 unknowns: actually, the problem has to be discretized suitably, in order to guarantee that the singular vectors do not (meaningfully) depend on the discretization itself. In other words, the singular vectors have to approximate quantities independent of the discretization, which are the singular functions of the scattering operator (Bertero and Boccacci, 1998). In other words, the question is not only how many unknowns we should look for, but also what kind of unknowns we should look for. The optimal choice for the unknowns is, as shown, the coefficients of the object function along the singular functions, because this allows us to separate the “invertible” part form the “noninvertible” part of the linear relationship at hand. However, the singular functions are not known in a closed form, and so the initial (trial) representation of the object function has to be refined enough in order to represent them adequately. In Section 15.4, the reader will find some exercises on the number of trial unknowns. In conclusion, the SVD is a way to solve the problem in a regularized way and it is calculable from two correlated eigenvalue–eigenvector problems. This fact also provides the formal way for the calculation of the SVD. However, the formal “classical” calculation of the eigenvalues (performed by means of the roots of the characteristic polynomial of the matrix) and of the relative eigenvectors is practicable only for small matrixes. In inverse scattering problems applied to GPR data, the matrix might have thousands of rows and columns. This makes it necessary to make use of suitable numerical algorithms for the evaluation of the SVD. Numerical algorithms for SVD are the object of a specific research field (Golub and van Loan, 1996), underlying all the computational available SVD routines.  14.4 THE STUDY OF THE INVERSE SCATTERING RELATIONSHIP BY MEANS OF THE SVD The singular value decomposition provides not only a method for the solution of the problem but also a possible method for the analysis the problem. In particular, even if numerically, the SVD can help us to understand the characteristics of the scattering operator. In particular, the class of retrievable object functions is characterized by the span of the singular functions relative to the the singular values smaller than or at most equal to the chosen threshold. This means that the regularization influences the class of retrievable targets and that there is a trade-off between the details that we can retrieve (related to the dimension of the space where the solution is looked for) and the robustness of the solution (provided by the ratio between the smallest and the maximum retained singular value). The two exigencies are contrasting to each other, and the choice of the threshold  THE STUDY OF THE INVERSE SCATTERING RELATIONSHIP BY MEANS OF THE SVD  239  is a compromise between them. The optimal choice of the threshold (i.e., the level of the regularization) is in general a nontrivial problem. Some solutions have been proposed (Bertero and Boccacci, 1998), but they refer to linear problems where the data are affected by white noise. Actually, in GPR prospecting we are not guaranteed that the data are affected (only) by white noise and in general we don’t have at our disposal an objective measure of the level of the noise [i.e., we don’t know the signal-to-noise ratio (SNR), because customarily we cannot switch on the receiver of a GPR system without switching on its transmitter too]. Of course, it is even more improbable to have at our disposal a measure of the statistics of the noise. Moreover, the regularization should account not only for the “real” noise (i.e., the noise produced in the electronics of the receiving system) but also for several further kinds of disturbances, provided (for example) by the clutter (i.e., the impossibility to insert in a deterministic inversion model the roughness of the surface), the model error (i.e., the fact that we are modeling a 3D vector nonlinear world by means of a linear, possibly even 2D and scalar, model), and possible interferences by other electromagnetic sources (in particular, radio and TV transmissions and mobile phones). Thus, the comprehensive “equivalent noise” is in general “colored” and has an unknown level, and it is rigorously even correlated to the signal itself (because of the model error). Finally, it is also worth emphasizing that the noise superposed to the signal depends on our exigencies, because it also depends on the depth range that we need to investigate: Of course the signal reflected by deepest targets is usually weaker and thus noisier than that reflected by the shallowest targets. In these conditions, it is practically impossible to predict an optimal level for the regularization. On the other hand, the SVD allows us to easily retrieve the reconstruction at several levels of regularization, so that a heuristic choice of the best one is possible based on the experience of the human operator. Incidentally, this also means that the personal experience regarding the kind of problem at hand is essential: Physics– mathematics cannot automatically provide the best solution and, in particular, the best interpretation. At any rate, whatever the adopted regularization method, the SVD can help in understanding the class of retrievable profiles and thus can provide an important insight about the possibilities of our reconstruction strategy. For example, in order to know whether the spatial step or the frequency step is sufficiently narrow, we can compare the curves7 of the singular values (some exercises are proposed in the next chapter); in particular, a comparative analysis between singular values and singular functions can back up, correct, or possibly deny the conclusions retrieved from DT. In particular, let us stress that the SVD analysis accounts for the linear scattering operator “as it is,” without the further assumption of a lossless media and of electrically deep targets. A quantity possibly useful for comprehension purposes is given by the spectral content (SPEC) of the singular functions’ (in the space of the unknowns) upper threshold. In particular, if N1 is the number of singular functions upper threshold, and un(x,z) 7 The curve of the singular values is a common but not rigorous term (because the singular values are a sequence) often used in literature. It is generically meant as a smooth curve that interpolates the singular values.  THE SINGULAR VALUE DECOMPOSITION  240  [un(x,y,z) if we adopt a 3D model] is the nth singular function in the space of the unknowns, the spectral content is defined as (Persico et al., 2005, Persico, 2006, Persico and Soldovieri, 2010)  SPEC =  N1  X  u^^n ðη,ζ Þ  within a 2D approach  N =1 N1   X  ^^  SPEC = u^n ðη, ξ, ζÞ  ð14:38Þ within a 3D approach  N =1  that is, the spectral content is the sum of the moduli of the spectra of the singular functions in the space of the unknowns. The spectral set is a tool that can provide an insight about the spatial frequencies retrievable in realistic cases. In particular, we can hope to retrieve correctly only the spectral components of the object function where the spectral content is meaningful. Please note that the support of the spectral content does not provide the spatial frequencies surely retrievable, but its information is to be meant in negative, in the sense that it shows the spatial frequencies surely not retrievable. Notwithstanding, it can be an immediate (even if incomplete) way to visualize the filtering properties of the operator in a framework that overcomes the constraints imposed by DT. Another quantity worth considering is the spatial content (SPAC) of the singular functions in the space of the unknowns, defined as  SPAC =  N1 X  jun ðx,zÞj  within a 2D approach,  N =1  SPAC =  N1 X  jun ðx, y, zÞj  ð14:39Þ within a 3D approach  N =1  where the symbol have the same meaning as in Eq. (14.38). To show the usefulness of the spatial content, let us start from the fact that it is intuitive (and can be easily shown numerically) that the singular functions relative to lower and lower singular values have their support (meant under some energetic criterion) centered on progressively deeper buried levels. This just means that, due to the progressive attenuation of the GPR signal (due both to the geometrical spreading and above all to the losses), the deeper layers of the soil provide a weaker “echoes” and are progressively more difficult to be retrieved. This fact is not accounted for by the spectral content. The spatial content can help in understanding whether the applied regularization is excessive. In particular, given a target at depth d, we cannot retrieve it if the support of the spatial content is not extended at least up to the depth d. In Section 15.5 the reader will find some exercises on the spectral and the spatial content. Finally, he/she will find some 2D reconstructions based on numerical  THE STUDY OF THE INVERSE SCATTERING RELATIONSHIP BY MEANS OF THE SVD  241  regularized SVD throughout Chapter 15, along with some examples of 3D reconstructions based on numerical regularized SVD in Section 15.10.  QUESTIONS Does the SVD provide a model more refined than that provided by a migration? Does a more refined model necessarily provide a better result? Is the computational burden only a CPU time problem? Does a nontruncated SVD ideally provide the exact solution of a linear problem? Can we control the investigated depth range changing the available regularization parameters making use of a migration algorithm? 6. Can we control the investigated depth range changing the available regularization parameters making use of an SVD algorithm? 1. 2. 3. 4. 5.  15 NUMERICAL AND EXPERIMENTAL EXAMPLES  15.1 EXAMPLES WITH REGARD TO THE MEASURE OF THE PROPAGATION VELOCITY In this section, some examples of measure of propagation velocity based on the diffraction curves are shown. In order to introduce the examples, let us preliminarily emphasize that, of course, the real GPR pulses cannot have a zero duration, because the band of the system (in particular the band of the antennas) is never infinite. Therefore, the diffraction curves introduced in Chapter 2 are didactic abstractions. In the real word, the diffraction curves have some “thickness,” and this constitutes an unavoidable source of uncertainty, both with regard to the propagation velocity of the waves and with regard to the depth of the buried targets.  15.1.1 Common Offset Interfacial Data with Null Offset on a Homogeneous Soil The first example is about the method of the diffraction hyperbolae in common offset configuration and is implemented with simulated data. The simulation has been implemented with the GPRMAX code (Giannopulos, 2003), based on the method of Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  242  EXAMPLES WITH REGARD TO THE MEASURE OF THE PROPAGATION VELOCITY  243  the finite differences in time domain FDTD (Kunz and Luebbers, 1993). The simulated “ground truth” is given in Figure 15.1. The target is a metallic (perfect electric conductor) cylindrical pipe with ray equal to 1 cm. The depth of the center is 50 cm, whereas the abscissa of the center is 1.3 m after the starting position of the B-scan. The soil shows a relative dielectric permittivity equal to 5, a relative magnetic permeability equal to 1, and an electric conductivity equal to 0.01 S/m. A B-scan that is 2.5 m long is considered, with spatial step of 2.5 cm. The source is a Ricker pulse with nominal central frequency of 500 MHz. The offset between source and observation point is equal to zero. The data are represented in Figure 15.2, after zero timing and interface muting. Let us now evaluate the propagation velocity from the data. Didactically, let us first do this in a “manual” fashion—that is, by means of a simple homemade code. The procedure has consisted in the following steps: 1. A vector of data has been identified by choosing N points (x1,t1), …, (xn,tn), where for every position xn (corresponding to a radar trace) the relative return time tn has been chosen as the time corresponding to the maximum modulus of the radar trace (after zero timing and interface muting). The couple corresponding to the minimum return time has been assumed as the couple (x0,t0) in relationship with Eq. (2.2). 2. A heuristic regularization has been applied to the data, retaining only those traces for which the value of the maximum along the trace was not smaller than 0.1 times the value of the global maximum level, which is achieved at the point (x0,t0). 3. A vector of trial values for the propagation velocity has been set. In particular, we have spanned the range [c1,c2] = [0.33 × 108 m/s, 3 × 108 m/s], with a step of 267,000 m/s, corresponding to 1/1000 of the investigated range. The initial trial value corresponds to the propagation velocity of the electromagnetic waves 0 0.2  Depth [m]  0.4 Metallic pipes (ray = 1 cm) 0.6 0.8 1 1.2 0  0.5  1 1.5 Abscissa along the scan [m]  2  Figure 15.1. Geometry of the simulated scenario.  2.5  NUMERICAL AND EXPERIMENTAL EXAMPLES  244  0  × 10–8  0.5  Time [sec]  1 1.5 2 2.5 3 0  0.5  1  1.5  2  2.5  Abscissa [m]  Figure 15.2. The data relative to the ground truth of Figure 15.1.  in fresh water, whereas the final value corresponds to the value of the propagation velocity in free space. 4. For each trial value ctrial of the propagation velocity, a vector of model data has been calculated according to Eq. (2.2) as rﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ c t 2 trial 0 ðxn − x0 Þ2 − tmodn = ctrial 2 2  ð15:1Þ  5. A cost function has identified as the least square difference between the retained data and corresponding model data. Thus, the cost function is given by f ðctrial Þ =  N qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ X ðtn − tmodn Þ2  ð15:2Þ  n=1  6. The result has been achieved as the values of ctrial that makes minimum the cost function. In Figure 15.3 the graph of the cost function is provided, with a zoom about its (unique) minimum. As it can be seen, the minimum is reached at the value ctrial = 1.33 × 108 m/s. Let us remind that the data had been simulated imposing a relative dielectric permittivity equal to 5, a conductivity of 0.01 S/m and no magnetic property to the soil. This means that we can neglect the conductivity pfor ﬃﬃﬃ the evaluation of the velocity, so that the actual propagation velocity is c = c0 = 5 = 1:34 × 108 m=s: Therefore, the propagation velocity has been estimated with an excellent precision.  EXAMPLES WITH REGARD TO THE MEASURE OF THE PROPAGATION VELOCITY  ×10–7  ×10–9 12  Cost function [sec]  2 1.8 1.6 Cost function [sec]  245  1.4 1.2  10 8 6 4 2 0  1  1.24 1.26 1.28 1.3 1.32 1.34 1.36 1.38 1.4 1.42  ×108  Trial value of c [m/s]  0.8 0.6 0.4 0.2 0  0.5  1  2 1.5 Trial value of c [m/s]  2.5  3 ×108  Figure 15.3. The cost function for a numerical evaluation of the propagation velocity.  As said, the proposed exercise is didactic: In the real practice, such a procedure would be time-consuming, because each of the data points tn should be identified “almost manually” (in particular, the maximum value within the “hyperbola thickness” in general is not the same as the maximum value along the trace). However, there are commercial code can calculate the propagation velocity from the shape of the diffraction hyperbolas in a more automatic and faster fashion. This is theoretically less refined than the least square minimization just shown, but it is essentially the same in conceptual terms and in terms of available precision in the field. In particular, we have imported the data of the presented exercise in Reflexw (Sandmeier, 2003). The evaluation in this case is graphical, achieved by superposing a hyperbola relative to a trial value of the propagation velocity to the apex of the diffraction curve. In Figure 15.4, a screen of this code is shown, where five trial hyperbolas are superposed to the diffraction hyperbola of the data. The trial values for the propagation velocity range from 1.16 × 108 m/s (corresponding to the narrower hyperbola) to 1.56 × 108 m/s. (corresponding to the larger hyperbola) with a step of 0.1 × 108 m/s. The central hyperbola clearly provides the best matching between model and data. It corresponds to the value 1.36 × 108 m/s, in good agreement with the actual propagation velocity.  15.1.2 Common Offset Interfacial Data on a Wall, Neglecting the Offset Between the Antennas Let us now show an example with experimental data. The data are those gathered in the situation depicted in Figure 2.1, where a metallic road is placed and then removed from one side of the wall. Let us emphasize that even if this time the scenario is not constituted  246  NUMERICAL AND EXPERIMENTAL EXAMPLES  Figure 15.4. Evaluation of the propagation velocity performed graphically in Reflexw.  by a homogeneous half-space, the propagation from the antennas to the target and vice versa occurs in the wall, so that the diffraction hyperbola is substantially the same that one would achieve in a soil made up of the same material constituting the wall (that is concrete). The data were gathered with a Ris Hi-mode system, equipped with antennas at nominal central frequency of 2000 MHz. The scan was performed in continuous mode, downward along a vertical B-scan. The metallic road was placed in horizontal position behind the wall, in order to maximize the reflected signal from it (Conyers, 2004). The results are provided in Figure 15.5. Of course, a real case presents a much more confused scenario. In particular, on purpose we didn’t choose a controlled test site, and we just gathered the data on the wall of a dismissed hovel: The several anomalies visible in the wall are probably internal reinforcement metallic bars. However, the “extra” diffraction hyperbola due to the marker (represented by the circle) is clearly identified, even if its left-hand half-branch is masked by some other internal target. In the case at hand the thickness of the wall was directly measurable (see Figure 2.1), and so we know that this thickness is 40 cm. Now, since the top of the hyperbola occurs at 5.3 ns, this provides a propagation velocity of 1.5 × 108 m/s, which is a value plausible for a concrete, even if slightly smaller than the average expected values, presented in tables (for example) in Conyers (2004), Daniels (2004), and Jol (2009). For comparison, also the shape of the diffraction hyperbola has been exploited. We have made use for this of the Reflexw code, and the result was 1.40 × 108 m/s. This case requires the watchfulness to match only the right-hand side of the hyperbola, because its right-hand side is not visible. Actually, there is a sort of branch of hyperbola also on the left side of the bar, but it is a feature visible also in absence of the bar, and so it is not due to the bar but to something else (even if we don’t  EXAMPLES WITH REGARD TO THE MEASURE OF THE PROPAGATION VELOCITY  247  Figure 15.5. The experimental example relative to the photographs shown in Figure 2.1. Left-hand image: The signal achieved without the auxiliary target. Right hand image: The signal achieved with the auxiliary target.  know what). It is not simple to determine the better estimation, because the wall is not perfectly homogeneous. So, we might choose the average value 1.45 × 108 m/s. The discrepancy between the two retrieved values and the central value is 3.45%.  15.1.3 Interfacial Common Offset Data on a Homogeneous Soil: The Effect on the Offset Between the Antennas Let us now present a simulation depicting the effect of the offset. In particular, we propose a simulation with realistic parameters, where the source is a Ricker pulse at central frequency equal to 2 GHz and the offset between source and observation point is 5 cm. We have considered a small metallic target at the depth of 5 cm. The soil shows a relative dielectric permittivity εsr = 5 and an electric conductivity σ = 0.01 S/m. The soil does not show magnetic properties. The spatial step is 1.25 cm. In Figure 15.6 several diffraction curves achieved with a null offset are represented, superposed to the data, whereas in Figure 15.7 several diffraction curves achieved considering the actual offset are superposed to the data. The data have been simulated by means of GPRMAX. In both cases, the solid lines range from the trial values εsr = 1 (top curve) to the trial value εsr = 7 (lowest line), and in both cases the best matching with the data is heuristically achieved for the diffraction curve relative to εsr = 3.5 (dotted line). This means that we retrieve the propagation velocity with an error of about 19.5%. The result is less good than that achieved in the previous simulations. This is due to some near-field effects and possibly also due to some numerical problem resulting from the closeness of the target to the  NUMERICAL AND EXPERIMENTAL EXAMPLES  248  0  ×10–9  0.5 1 1.5  t [sec]  2 2.5 3 3.5 4 4.5 5 0.9  1  1.1  1.2  1.3  1.4  1.5  1.6  x [m]  Figure 15.6. Diffraction curves neglecting the offset. Solid lines from top to bottom: Curves relative to trial relative permittivities ranging from 1 to 7. Dotted line: Heuristic best matching curve relative to the trial value 3.5.  0  ×10–9  0.5 1 1.5  t [sec]  2 2.5 3 3.5 4 4.5 5 0.9  1  1.1  1.2  1.3  1.4  1.5  1.6  x [m]  Figure 15.7. Diffraction curves considering the offset. Solid lines from top to bottom: Curves relative to trial relative permittivities ranging from 1 to 7. Dotted line: Heuristic best matching curve relative to the trial value 3.5.  EXAMPLES WITH REGARD TO THE MEASURE OF THE PROPAGATION VELOCITY  249  interface. However, to consider a deeper target would have made obvious the result, unless we had simulated an improbably large offset. The relevant result is that the offset does not have too much effect on the result.  15.1.4 Noninterfacial Common Offset Data with a Null Offset Between the Antennas Let us now show some results relative to the effect of the height of the observation line: In particular, we have considered a small metallic target at the depth of 0.5 m and an observation line at the height of 0.5 m above the air–soil interface. The soil has the same characteristics of the previous exercise. The source is a Ricker pulse with central frequency 500 MHz and the spatial step of the data is 5 cm. In Figure 15.8 the effect of the refraction at the interface is neglected, whereas in Figure 15.9 it is accounted for. The set of diffraction curves are analogous to that considered in the previous exercise. Figures 15.8 and 15.9 allow some observations: First of all, we see that the height of the observation line has a consistent weight, and to neglect it can lead to meaningful errors. However, it is also important to stress that, at variance of the trial propagation velocity, the diffraction curves considering the height are “closer” to each other than in the case of data gathered at the air–soil interface. In other terms, if one calculated the cost function [i.e., the homologous of Eq. (15.2)]  ×10–8  1  1.1  t [sec]  1.2  1.3  1.4  1.5  1.6  0  0.5  1  1.5  2  2.5  x [m]  Figure 15.8. Diffraction curves neglecting the height of the observation line. Solid lines from top to bottom: Curves relative to trial relative permittivities ranging from 1 to 7. Dotted line: Heuristic best matching curve relative to the trial value 1.8.  NUMERICAL AND EXPERIMENTAL EXAMPLES  250  ×10–8  1  1.1  t [sec]  1.2  1.3  1.4  1.5  1.6  0  0.5  1  1.5  2  2.5  x [m]  Figure 15.9. Diffraction curves considering the height of the observation line. Solid lines from top to bottom: Curves relative to trial relative permittivities ranging from 1 to 7. Dotted line: Heuristic best matching curve relative to the trial value 3.5.  in the case of data gathered at some distance from the air–soil interface, he/she would see a much flatter behavior regarding the minimum with respect to the case of interfacial data, which makes it more difficult to perform a reliable measurement. The physical reason has been exposed in Section 2.3.4.  15.1.5  Common Midpoint Data  Let us now show an example with common midpoint data. In particular, let us in a first moment erase the effect of the air–soil interface. The data are obtained with GPRMAX, and the reference scenario is the same as in the example of the common (null) offset relative to Figures 15.1 and 15.2. The data start over the target and extend along the same observation line of the previous example, with the same spatial step. We have kept also the same Cartesian reference system of the previous example, for comparison. The result is the half-hyperbola shown in Figure 15.10. This time, the evaluation of the propagation velocity is achieved from the slant of the tail of the diffraction hyperbola. In Figure 15.10 we have represented the same diffraction curve in both panels, for sake of graphical clarity. However, in the lower panel we have gridded the image and have superposed the tangent to the farthest (from the vertex) visible point of the hyperbola.  EXAMPLES WITH REGARD TO THE MEASURE OF THE PROPAGATION VELOCITY  0  251  ×10–8  Time [sec]  0.5 1 1.5 2 2.5 3 1.4  1.6  1.8  2  2.2  2.4  2  2.2  2.4  Abscissa [m] 0  ×10–8  Time [sec]  0.5 1 1.5 2 2.5 3 1.4  1.6  1.8 Abscissa [m]  Figure 15.10. The diffraction curve retrieved from common midpoint data. The curve is the same in both the upper and the lower panels, where a grid and the tangent line in the “tail” point have been superposed.  The extreme points of the dashed line in Figure 15.10 are (x, t) = (1.25 m, 3 ns) on the left-hand side and (x, t) = (2.5 m, 21 ns) on the right-hand side. So, the slant of the line is given by s=  ð21− 3Þ × 10 − 9 s = 14:4 × 10 − 9 s=m ð2:5 − 1:25Þ m  ð15:3Þ  On the basis of Eq. (2.3), the propagation velocity can be estimated as c=  2 = 1:39 × 108 m=s s  ð15:4Þ  Let us remind ourselves that the actual value for this example was 1.34 × 108 m/s, so the percentage error is 3.7%. At this point, let us reconsider the complete data—that is, the data of the same CMP without erasing the interface contribution and the direct coupling. The amplitude of the signal received from all the points has been made at the same level, thereby mitigating the effect of the natural high dynamic range, due to the fact that the antennas get progressively farther from each other. This is equivalent to radiating some more power when the antennas gets farther apart. The result is shown in Figure 15.11: The difference  NUMERICAL AND EXPERIMENTAL EXAMPLES  252  0  x 10–8  1 2 3  0  1.4  1.6  1.8  2  2.2  2.4  1.4  1.6  1.8  2  2.2  2.4  x 10–8  1 2 3  Figure 15.11. Measure of the propagation velocity from complete CMP data.  between the direct signal in air and that in the soil is evident, and it is also evident that direct signal received through the soil provides a line almost parallel to the tangent to the diffraction hyperbola (far from the vertex) relative to the buried target. We have then zoomed apart (this is not shown here) the image in Figure 15.11 and have seen that the line relative to the path in air passes for the two points (1.3 m, 2 ns) and (1.6 m, 4 ns), whereas the second line passes for the two points (1.5 m, 6 ns) and (1.9 m,12 ns). This allows us to retrieve the slants of the two lines, from which the two (definitely satisfying) values c0 = 3 × 108 m/s and c = 1.33 × 108 m/s are worked out.  15.2 EXERCISES ON SPATIAL STEP AND HORIZONTAL RESOLUTION In this section, we propose some examples about the needed spatial step and the correlated achievable horizontal resolution. To construct a first example, let us consider a 2D investigation domain D sized 2 × 2 m2, starting from the depth of 0.5 m. The relative permittivity of the soil is equal to εsr = 5, and the electric conductivity is equal to 10−3 S/m. The frequency band ranges from 200 to 710 MHz and the frequency step is 15 MHz. The investigation domain has been discretized by means of 51 complex Fourier harmonics along the horizontal direction and 45 step functions along the depth. The observation line Σ is at the air–soil interface and has the same length as the investigation domain. The offset between the source and the observation point is equal to zero. In Figure 15.12 the reference geometry for this simulation is shown, whereas in Figure 15.13 the singular values of the discretized linear scattering operator are shown at variance of the spatial step, having fixed the frequency step at 15 MHz.  EXERCISES ON SPATIAL STEP AND HORIZONTAL RESOLUTION  253  Σ  0  θesmax –0.5  Depth [m]  –1 –1.5 –2 D –2.5 –3 –1.5  –1  –0.5  0  0.5  1  1.5  Abscissa [m]  Figure 15.12. Maximum view angle on the top of the investigation domain. Due to the limited size of D, it is approximated with the maximum geometrical view angle.  0 –10  dB  –20 –30  –40 –50 –60  50  100  150  200  250 300 Index N  350  400  450  500  550  Figure 15.13. Singular values at variance of the spatial step: crosses (lower curve): s = 40 cm; dots: s = 20 cm; dots and dashes: s = 10 cm; solid line: s = 5 cm; dashes (almost indistinguishable from the solid line): s = 2.5 cm.  254  NUMERICAL AND EXPERIMENTAL EXAMPLES  In particular, the spatial step is progressively halved starting from 40 cm to 20 cm, to 10 cm, to 5 cm, and to 2.5 cm. From Figure 15.13, it is clearly seen that the curve of the singular values grows meaningfully up to the spatial step of 5 cm. However, passing from 5 to 2.5 cm the curve keeps substantially unchanged. This means that the quantity of information is saturated; that is, adding more measurement points doesn’t add a meaningful quantity of information. It is implicit that the validity of this reasoning is also related to the dynamic range of the singular values taken into consideration. In other words, one has to establish the level up to which the singular values are meaningful. As widely stressed in Chapter 14, from a practical point of view, it is difficult to establish how many singular values should be accounted for in a nonheuristic way. On the basis of the specific practical experiences of this author, however, the heuristically optimal choice in most cases lies within the range between −20 and −40 dB. Consequently, the interval considered in Figure 15.13 (which extends up to −60 dB) can be practically viewed as a conservative range. Let us now compare this result with those achieved under DT in Chapter 9. In particular, let us first note that, in the case at hand, the minimum involved wavelength in the soil (neglecting the pﬃﬃﬃﬃﬃﬃ losses) is equal to λsmin = c0 =fmax εsr = 18:9 cm. Moreover, in the case at hand we are considering a relatively small investigation domain, and therefore we can approximate the effective maximum view angle with the geometrical maximum view angle. The sine of the maximum view angle with respect to the shallowest part of the investipﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ gation domain (shown in Figure 15.12) is equal to sin ðθesmax Þ = 1= 12 + 0:52 = 0:89. Therefore, the optimal spatial step under the DT approximation in the case at hand [see Eq. (9.49)] is equal to s = λsmin =4 sin ðθesmax Þ = 5:3 cm. This means that, according to DT, a spatial step meaningfully smaller than 5 cm is redundant, whereas a step meaningfully larger is inadequate and causes a loss of information. So, the behavior of the singular values is in noticeable agreement with the predictions achieved under a DT model. Let us now show some reconstruction examples. The spatial step of the data is 5 cm and the model is built up as just previously described. The data have been achieved from FDTD simulations performed with GPRMAX, and the central frequency of the exploited Ricker pulse was heuristically chosen at 320 MHz, so that the −6 dB band of the data was extended from about 200 to 710 MHz. In the six reconstructions shown in Figure 15.14, we propose the case of two circular, electrically small (ray = 1 cm) metallic targets buried at the depth of 55 cm (meant as the depth of the centers), progressively shifted toward each other from 35 to 10 cm (meant as the distance of the two centers). The reconstruction has been achieved from an inversion of the linear scattering operator performed by means of a singular value decomposition regularized with a threshold at −20 dB on the singular values. As can be seen, the two targets are well distinguished from each other if their reciprocal distance is equal to or larger than 20 cm. Instead, if their distance is equal to 15 cm, then their reconstructed images touch each other and they are hardly distinguishable. Finally, if their distance is equal to or smaller than 10 cm, they are definitely fused into a unique target. In the case at hand, the DT resolution is of the order of 16.6 cm [see Eq. (9.43)], in noticeable agreement with the achieved results.  EXERCISES ON SPATIAL STEP AND HORIZONTAL RESOLUTION  0.5  0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  25 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  Figure 15.14. Reconstruction by  35 CM  255  0  1  15 CM  2.5 –1 0.5  inversion of two circular targets at  1  1  the same depth (55 cm) progressively closer to each other. The title  1.5  1.5  of each panel refers to the dis-  2  2  tance between the centers of the two targets. The axes are in meters.  2.5 –1  0  1  2.5 –1  30 CM  0  1  20 CM  0  11  10 CM  0  1  In order to show the worsening of the horizontal resolution versus the depth, we have repeated the example shifting the two targets 1 m below, at the depth of 155 cm. The sine of the maximum view angle for these two targets is restricted to 0.51, which leads to a DT resolution of about 29 cm [see Eq. (9.43)]. Figure 15.15 is the analogous of Figure 15.14 for these deeper targets, and it shows results in good agreement with the DT previsions. In particular, the two spots are hardly distinguished at 30 cm and collapse into a unique spot for smaller values of the spacing between them. The data exploited in Figures 15.14 and 15.15 are noiseless. In order to show the robustness versus the noise, in Figures 15.16 and 15.17 the same cases of Figures 15.15 and 15.16 are proposed, with the only difference being the addition of a white Gaussian noise to the data. The signal-to-noise ratio, referring to the total field data, is 60 dB. The comparison between Figure 15.14 and Figure 15.16 and between Figure 15.15 and Figure 15.17 shows that the inversion is quite robust against noise.  NUMERICAL AND EXPERIMENTAL EXAMPLES  256  0.5  35 CM  0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  25 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  15 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1  0  1  2.5 –1  30 CM  0  1  20 CM  0  1  10 CM  0  1  Figure 15.15. Reconstruction by inversion of two circular targets at the same depth (155 cm) progressively closer to each other. The title of each panel refers to the distance between the centers of the two targets. The axes are in meters.  At this point, let us investigate the dependence of the resolution on the degree of regularization. In particular, in Figures 15.18 and 15.19 the same noisy data of Figures 15.16 and 15.17 are inverted, thresholding the singular values at −40 dB instead of −20 dB. Figures 15.18 and 15.19 show clearly the trade-off between resolution and robustness. In particular, in the case of the shallower targets, we can say that the lower threshold allows a marginal improvement of the resolution. However, in the case of the deeper targets, the lower threshold makes the reconstruction much poorer. It is interesting to stress that this happens at a parity of signal-to-noise ratio, because the echoes from the deeper targets are weaker than those from analogous targets at a shallower depth. Indeed, the signal-to-noise ratio is an integral parameter referring to the entire recorded time range (either real or synthetic). During this time, however, the instantaneous signal power gets progressively lower whereas the instantaneous noise power remains of the same  EXERCISES ON SPATIAL STEP AND HORIZONTAL RESOLUTION  0.5  35 CM  0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  25 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  15 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1  0  1  2.5 –1  257  30 CM  0  1  20 CM  0  1  10 CM  0  1  Figure 15.16. Reconstruction by inversion of two circular targets at the same depth (55 cm) progressively closer to each other. The title of each panel refers to the distance between the centers of the two targets. The axes are in meters. The data are noisy with SNR = 60 dB, evaluated on the total field.  order. This is sometimes loosely but explicatively expressed saying that the signalto-noise ratio gets worse versus the depth of the targets. This confirms the prevision (see Section 14.4) that in most cases the optimal threshold should be chosen heuristically on the basis of the results achieved with several threshold levels or more in general under several regularization degrees. At the same time, these examples also show that, in any case, the resolution improvements possibly achievable from a weaker regularization are expected to be marginal with respect to the DT predictions. In Figures 15.20 and 15.21 the same noisy data of the previous examples have been migrated in the time domain. The migration has been performed with the commercial  NUMERICAL AND EXPERIMENTAL EXAMPLES  258  0.5  35 CM  0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  25 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  15 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1  0  1  2.5 –1  30 CM  0  1  20 CM  0  1  10 CM  0  1  Figure 15.17. Reconstruction by inversion of two circular targets at the same depth (155 cm) progressively closer to each other. The title of each panel refers to the distance between the centers of the two targets. The axes are in meters. The data are noisy with SNR = 60 dB, evaluated on the total field.  code Reflexw (Sandmeier, 2003). More precisely, after importing the raw noisy data in Reflexw, a data-driven processing has been performed as follows: 1. The zero time has been moved of 2.75 ns. 2. A background removal up to 4 ns on all the traces has been performed in order to erase the residual air–soil interface. 3. The data have been filtered by means of a Butterworth filter in order to clean some noise. The chosen cutoff frequencies for the filters have been set at 200 and 710 MHz, respectively, in order to make the migration-based processing homologous to the inversion.  EXERCISES ON SPATIAL STEP AND HORIZONTAL RESOLUTION  0.5  35 CM  0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  25 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  15 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1  0  1  2.5 –1  259  30 CM  0  1  20 CM  0  1  10 CM  0  1  Figure 15.18. Reconstruction by inversion of two circular targets at the same depth (55 cm) progressively closer to each other. The title of each panel refers to the distance between the centers of the two targets. The axes are in meters. The data are noisy with SNR = 60 dB, evaluated on the total field. The SVD is thresholded at −40 dB.  4. A gain versus the depth has been applied in order to make more visible the targets. The value of the gain has been set at 5 dB/ns up to a maximum gain equal to 40 dB. 5. Kirchhoff migration on 25 traces has been applied, on the basis of the wideness of the diffraction hyperbolas. 6. After exporting the migrated data in MATLAB, time–depth conversion has been achieved from the propagation velocity retrieved from the diffraction hyperbolas, and the same spatial window shown for the inversion results has been adopted. The results of Figures 15.20 and 15.21 basically drive to the same considerations of the inversion results. Namely, the resolution is of the same order as that foreseen within  NUMERICAL AND EXPERIMENTAL EXAMPLES  260  0.5  35 CM  0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  25 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  15 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1  0  1  2.5 –1  30 CM  0  1  20 CM  0  1  10 CM  0  1  Figure 15.19. Reconstruction by inversion of two circular targets at the same depth (155 cm) progressively closer to each other. The title of each panel refers to the distance between the centers of the two targets. The axes are in meters. The data are noisy with SNR = 60 dB, evaluated on the total field. The SVD is thresholded at −40 dB.  DT, and it degrades versus the depth. The artifact due to the crossing point between the diffraction hyperbolas is evident both within the inversion-based and migration-based result. Before ending this section, we found it interesting to show a case where the effective maximum view angle is different from the geometrical maximum view angle. This example has been achieved by just adopting a time bottom scale of 30 ns in the simulated data (in the previous examples the bottom scale was 40 ns in all cases). We have simulated two targets at the depth of 1.95 m, with the same measurement parameter of the other examples shown in this section. Now, with reference to panel A in Figure 15.22, since the observation line is 2 m long, if we calculate the maximum view angle geometrically with respect to the initial or the final point of the scan and  EXERCISES ON SPATIAL STEP AND HORIZONTAL RESOLUTION  0.5  35 CM  0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  25 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  15 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1  0  1  2.5 –1  261  30 CM  0  1  20 CM  0  1  10 CM  0  1  Figure 15.20. Reconstruction by Kirchhoff migration of two circular targets at the same depth (55 cm) progressively closer to each other. The title of each panel refers to the distance between the centers of the two targets. The axes are in meters. The data are noisy with SNR = 60 dB, evaluated on the total field.  with respect to the midpoint between the targets, it is easy to recognizepthat the sine ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ﬃ of the geometrical maximum view angle is equal to sin ðθemax Þ = 1= 1 + 1:952 = 0:456 ðθemax = 27:13 degreesÞ. In this case, the hypotenuse of the triangle ABC is long pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ﬃ 1 + 1:952 = 2:191 m (see Figure 15.22, panel A) and, according to Eq. (9.43), the expected horizontal resolution should be of the order of 32 cm. However, the longest time up to which we are now recording the signal is 30 ns, and therefore the maximum hypotenuse that we have to consider for the triangle ABC restricts to (see Figure 15.22, pﬃﬃﬃﬃﬃﬃ panel B) AC = 0:5c0 × 30 × 10 − 9 s:= εsr = 2:0125 m. Consequently, the segment BC, that represents the maximum abscissa under which we still see some tail of the diffraction pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ hyperbola restricts from 1 m to AB = 2:01252 − 1:952 m = 0:498 m, and coherently  NUMERICAL AND EXPERIMENTAL EXAMPLES  262  0.5  35 CM  0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  25 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  15 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1  0  1  2.5 –1  30 CM  0  1  20 CM  0  1  10 CM  0  1  Figure 15.21. Reconstruction by Kirchhoff migration of two circular targets at the same depth (155 cm) progressively closer to each other. The title of each panel refers to the distance between the centers of the two targets. The axes are in meters. The data are noisy with SNR = 60 dB, evaluated on the total field.  the sine of the effective view angle restricts to sin ðθemax Þ = ðBC=AC Þð0:4977= 2:0125Þ = 0:247 ðθemax = 14:32 degreesÞ. Accordingly, based on Eq. (9.43) the expected horizontal resolution degrades to about 58 cm. In Figures 15.23 and 15.24 the reconstruction of two circular small (ray = 1 cm) metallic targets at the same depth (1.95 m) is shown. The distance between the two targets is labeled on each subfigure. We have considered distances larger than in the previous figures, because of the foreseen loss of resolution. The reconstructions in Figure 15.23 are achieved from a linear inversion performed by SVD and regularized by truncation of the singular values with threshold at −20 dB. The reconstructions of Figure 15.24 are achieved from the same migration-based processing adopted in Figures 15.20 and 15.21. The synthetic data are affected by a Gaussian white noise with SNR = 60 dB,  PANEL A 2m  B 0.498 m  θema = 1 x 4.32°  2.1 91  1.95 m  θm = ax 27. 13°  1.95 m  C  m  C  A  2.0 125  1m  m  B  PANEL B 2m  A  Figure 15.22. Quantitative pictorial of the restriction of the effective maximum view angle due to the reduction of the time bottom scale from 40 ns to 30 ns.  0.5  1  1.5  1.5  2  2  0.5  0  1  60 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1  by inversion of two circular tar-  0.5  1  2.5 –1  Figure 15.23. Reconstruction  80 CM  0.5  0  1  40 CM  2.5 –1 0.5  1  1  the  1.5  1.5  centers. The axes are in meters. SNR = 60 dB with respect to  2  2  gets at the same depth (195 cm). The panels are labeled after the  distance  between  the total field. The SVD is thresholded at −20 dB.  2.5 –1  0  1  2.5 –1  70 CM  0  1  50 CM  0  1  30 CM  0  1  NUMERICAL AND EXPERIMENTAL EXAMPLES  264  0.5  80 CM  0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  60 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  40 CM  2.5 –1 0.5  70 CM  0  1  50 CM  0  1  30 CM  Figure 15.24. Reconstruction by Kirchhoff migration of two circular targets at the same depth (195 cm) progressively  1  1  closer to each other. The title  1.5  1.5  of each panel refers to the distance between the centers of  2  2  2.5 –1  0  1  2.5 –1  the two targets. The axes are  0  1  in meters. The data are noisy with SNR = 60 dB, evaluated on the total field.  evaluated with respect to the total field. From both Figures 15.23 and 15.24, we can appreciate the loss of resolution due to the restriction of the effective maximum view angle, which appears completely fused into each other if their distance is 30 cm and appears fully detached from each other only if their distance is 60 cm or more. As a corollary, this exercise also shows that the chosen time bottom scale should be longer than the expected (if any) time depth of the targets of interests, because we need the whole tails of the diffraction hyperbolas in order to focus at best the buried objects.  15.3 EXERCISES ON FREQUENCY STEP AND VERTICAL RESOLUTION Some exercises on the frequency step and on the vertical resolution can be proposed on the basis of the same examples proposed in the previous section. In particular, let us remind ourselves that we have made use of a matrix calculated in the frequency  EXERCISES ON FREQUENCY STEP AND VERTICAL RESOLUTION  265  0  –10  dB  –20  –30  –40  –50  –60  50  100  150  200  250 300 Index N  350  400  450  500  550  Figure 15.25. Behavior of the singular values at variance of the frequency step. Crosses (lower curve): Δf = 127.5 MHz. Dots: Δf = 63.75 MHz. Dashes: Δf = 30 MHz. Solid (upper curve): Δf = 15 MHz.  band 200–710 MHz, sampled with a frequency step equal to 15 MHz. Moreover, the investigation domain ranges along the depth from 0.5 to 2.5 m. This means that, according with the DT model [Eq. (9.52)], the frequency step should be not larger than pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ Δf = c0 =2b εsr μsr = 33:54 MHz. Thus, the first question is whether or not the chosen frequency step of 15 MHz was redundant. In order to answer this question, in Figure 15.25 we show the behavior of the singular values while progressively enlarging the frequency step from 15 to 30, 63.75, and 127.5 MHz.1 The other parameters are unchanged with respect to the simulations of the previous section, and in particular the spatial step is 5 cm. From Figure 15.25, we see that the suitable frequency step is actually dependent on the level of the allowed regularization. In particular, if the singular values are to be thresholded at −20 dB, then a frequency step of 15 MHz is redundant and the DT bound of 30 MHz is adequate. However, if the data are particularly “good” and allows us to make use of a weaker regularization, then it can be useful to reduce the frequency step with respect to the DT previsions. The evaluation of this possibility is case-dependent but, as said, to the best of our experience it is quite hard that the GPR data allow to achieve a good reconstruction with a regularization threshold lower than −40 dB. In order to test the effect of these considerations versus the quality of the reconstruction and in particular versus the vertical resolution, we now propose some examples with two 1  This means to consider 5, 9, 18, and 35 frequencies equally spaced in the band 200–710 MHz, respectively.  NUMERICAL AND EXPERIMENTAL EXAMPLES  266  circular and electrically small (ray = 1 cm) metallic targets superposed to each other at the same abscissa but at different depths. The data are noisy with white Gaussian noise, and the signal-to-noise ratio with respect to the total field is equal to SNR = 60 dB. The soil parameters are the same as the previous examples, as well as the number and dislocation of data. The frequency step is 15 MHz. In Figure 15.26, some inversion results are shown: The upper target is buried at 55 cm and the distance between the upper and the lower target is labeled on each panel. The SVD is thresholded at −20 dB. In Figure 15.27, the analogous results for two deeper targets of the same kind are shown; this time the upper target is at the depth of 155 cm. Also for Figure 15.27 the SVD is thresholded at −20 dB. The comparison between Figures 15.26 and 15.27 shows that the evaluation  0.5  35 CM  0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  25 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1  0  1  2.5 –1  15 CM 0.5  1  1  1.5  1.5  2  2 0  0  1  20 CM  0  1  10 CM  0.5  2.5 –1  30 CM  1  2.5 –1  0  1  Figure 15.26. Reconstruction by inversion of two circular superposed targets (the upper one buried at 55 cm) progressively closer to each other. The title of each panel refers to the distance between the centers of the two targets. The axes are in meters. The data are noisy with SNR = 60 dB, evaluated on the total field. The SVD is thresholded at −20 dB.  EXERCISES ON FREQUENCY STEP AND VERTICAL RESOLUTION  267  of the vertical resolution is more “tricky” than that of the horizontal resolution. In particular, in the proposed examples it is clear that the upper target partially masks the lower one, whose image appears faded. Then, as said in Chapter 9 (see Section 9.6) there is an interference term between the two targets that depends on the position of the targets and of the source. In particular, this can cause some anomalies such as, with reference to Figure 15.26, an artifact in the middle between the two targets when these are at the distance of 35 cm or, with reference to Figure 15.27, the fact that the two targets seem better distinguishable from each other when their distance is 30 cm instead of 35 cm. The DT vertical resolution in the case at hand is of the order of 26 cm according to Eq. (9.45). The rougher equation (9.46) yields to 29 cm. In the case at hand, the dispersion  0.5  35 CM  0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  25 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  15 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1  0  1  2.5 –1  30 CM  0  1  20 CM  0  1  10 CM  0  1  Figure 15.27. Reconstruction by inversion of two circular superposed targets (the upper one buried at 155 cm) progressively closer to each other. The title of each panel refers to the distance between the centers of the two targets. The axes are in meters. The data are noisy with SNR = 60 dB, evaluated on the total field. The SVD is thresholded at −20 dB.  NUMERICAL AND EXPERIMENTAL EXAMPLES  268  of the soil is not meaningful and we do not appreciate a different band between the signal coming from a target at 55 cm and a target at 155 cm. As we can see, the achieved results are in good agreement with the DT previsions, and in particular we distinguish the two targets from each other if their distance is equal to 25 cm or larger. Moreover, in the case at hand, unlike the case of the horizontal resolution, we don’t see any meaningful loss of resolution versus the depth, and actually the vertical resolution seems even better for the deeper targets of Figure 15.27 than for the shallower targets of Figure 15.26. In order to show the dependence of the resolution on the regularization, in Figures 15.28 and 15.29 we show the results achieved thresholding the SVD at −40 dB instead of −20 dB, in the same cases of Figure 15.26 and 15.27, respectively.  0.5  35 CM  0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  25 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  15 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1  0  1  2.5 –1  30 CM  0  1  20 CM  0  1  10 CM  0  1  Figure 15.28. Reconstruction by inversion of two circular superposed targets (the upper one buried at 55 cm) progressively closer to each other. The title of each panel refers to the distance between the centers of the two targets. The axes are in meters. The data are noisy with SNR = 60 dB, evaluated on the total field. The SVD is thresholded at −40 dB.  EXERCISES ON FREQUENCY STEP AND VERTICAL RESOLUTION  0.5  35 CM  0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  25 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  15 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1  0  1  2.5 –1  269  30 CM  0  1  20 CM  0  1  10 CM  0  1  Figure 15.29. Reconstruction by inversion of two circular superposed targets (the upper one buried at 155 cm) progressively closer to each other. The title of each panel refers to the distance between the centers of the two targets. The axes are in meters. The data are noisy with SNR = 60 dB, evaluated on the total field. The SVD is thresholded at −40 dB.  Figures 15.28 and 15.29 make us appreciate that, in the case at hand, no meaningful improvement is achieved from a weaker regularization. This results is at least partially due to the masking of the deeper target of behalf of the shallower one. In particular, the results of Figures 15.28 and 15.29 indirectly show that a frequency step of 30 MHz would have been “sufficient” for the inversion at hand. In particular, when thresholding at −20 dB, the number of upper threshold singular values are substantially the same for Δf = 30 MHz and Δf = 15 MHz (see Figure 15.25). This shows in turn that the DT-based previsions about the needed frequency step [see Eq. (9.52)] provide a reasonable order of magnitude. In Figures 15.30 and 15.31 the data of Figures 15.28 and 15.29 are focused by a migration-based algorithm. The details of the processing are the same of those described  NUMERICAL AND EXPERIMENTAL EXAMPLES  270  0.5  35 CM  0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  25 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1 0.5  0  1  15 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1  0  1  2.5 –1  30 CM  0  1  20 CM  0  1  10 CM  0  1  Figure 15.30. Reconstruction by Kirchhoff migration of two circular superposed targets (the upper one buried at 55 cm) progressively closer to each other. The title of each panel refers to the distance between the centers of the two targets. The axes are in meters. The data are noisy with SNR = 60 dB, evaluated on the total field.  for Figures 15.20 and 15.21. From Figures 15.30 and 15.31 we see that the migrationbased algorithm provides some more “tails” starting from the focused targets but, on the other hand, the capability of distinguishing the two targets seems even better than those provided by the inversion algorithm. To sum up, the vertical resolution is intrinsically a concept definable in a way less rigorous than the horizontal resolution, because the class of retrievable targets is characterized (in terms of spatial frequencies) by a low-pass behavior along the abscissa and a band-pass behavior along the depth. In particular, there is an irresolvable ambiguity specifically linked to this fact, and there is a question about whether two superposed spots should refer to two distinct targets or to the top and the bottom of a unique structure; this  EXERCISES ON THE NUMBER OF TRIAL UNKNOWNS  0.5  circular  superposed  0.5 1  1.5  1.5  2  2  0.5  by Kirchhoff migration of two  35 CM  1  2.5 –1  Figure 15.31. Reconstruction  271  0  1  25 CM  2.5 –1 0.5  1  1  1.5  1.5  2  2  2.5 –1  0  1  15 CM  targets  0.5 1  1  1.5  1.5  2  2  refers to the distance between the centers of the two targets. The axes are in meters. The data are noisy with SNR = 60 dB, evaluated on the total field.  2.5 –1  0  0.5  1  0  1  20 CM  2.5 –1  (the upper one buried at 155 cm) progressively closer to each other. The title of each panel  30 CM  0  1  10 CM  2.5 –1  0  1  is actually deduced (when possible) from the context of the case history at hand and not really from the involved physics–mathematics.  15.4  EXERCISES ON THE NUMBER OF TRIAL UNKNOWNS  In the two previous sections, we have shown examples on the achievable resolution and (related to this) on the needed spatial and frequency steps, which means examples on the number of data to be gathered. Clearly, in order to discretize the problem for a numerical inversion, we also need some criterion to choose the number and kind of unknowns formally looked for. We say formally looked for because, within a regularized SVD-based approach, the kind of unknowns really looked for are the expansion coefficients of the object function along the singular functions in the space of the  NUMERICAL AND EXPERIMENTAL EXAMPLES  272  unknowns (see Chapter 14). On the other hand, we don’t know the singular functions in a closed form, and so we cannot choose them “directly” to represent the object function. Consequently, we have to adopt a trial basis through which we can represent in an approximate but adequate way the singular functions of the linear scattering operator. In particular, the basis expansion should not be too coarse because otherwise it would spuriously limit or alter the capabilities of the linear scattering operator with respect to the class of theoretically retrievable targets and should not be uselessly refined because, beyond a certain limit, this would increase the computational burden without improving the resolution. The kinds of adoptable trial bases functions are infinite, of course, but whatever the choice, a quantification of a convenient number of coefficients that are worth looking for can be based on DT, as will be shown in a while. In particular, in this chapter we will make use of bilateral Fourier harmonics along the horizontal direction and step functions along the depth. This specifically means that, indexing the basis functions after two indexes (namely m, ranging from 1 and 2 M + 1, for the horizontal variability, and n, ranging from 1 to N, for the vertical variability) the generic basis function is expressed as φm, n ðx, zÞ = φhm ðxÞφvn ðzÞ  ð15:5Þ  with the horizontal expansion given by π  x ϕhm ðxÞ = exp j ðm − M − 1Þx Π a a  ð15:6Þ  and the vertical expansion given by   Nz− 0:5nb ϕvn ðzÞ = Π b   ð15:7Þ  In Eqs. (15.6) and (15.7), a and b are the horizontal and vertical size of the investigation domain, respectively, according to Figure 4.1, and the Π step function is defined as usual as Πðw Þ =  8 <1  if jwj ≤ 12  :0  if jwj > 12  ð15:8Þ  Under this choice, the comprehensive number of unknowns formally looked for is given by N(2M + 1) and the problem at hand is just to address a convenient choice of N and M. With regard to the horizontal variability, following the same reasoning exposed with reference to Figure 9.11, we can approximate the horizontal extent (HE) of the retrievable spectral set as HE = 4ksc sin ðθe max Þ  ð15:9Þ  EXERCISES ON THE NUMBER OF TRIAL UNKNOWNS  273  where ksc is the central wavenumber in the soil and the spectral set is symmetric with respect to the ς-axis; that is, it extends along the η-axis from − 2ksc sin(θe max) to 2ksc sin(θe max). Therefore, it is reasonable to choose M such that the maximum-order   π  πM x , Fourier harmonic, given by ϕhð2M + 1Þ ðxÞ = exp j ð2M + 1 − M − 1Þx = exp j a a has the same spatial period as exp( jHEx) = exp ( j2ksc sin(θe max) x), which yields the equation Mπ 4π 4a = 2ksc sin ðθe max Þ = sin ðθe max Þ , M = sin ðθe max Þ a λsc λsc  ð15:10Þ  In general, the result of Eq. (15.10) is not an integer number, and therefore now M should 4a be meant as the first integer number equal to or greater than sin ðθe max Þ. λsc Equation (15.10) shows that the number of horizontal harmonics also depends on the sine of the effective maximum view angle, which means that we might progressively relax the number of Fourier harmonics at deeper levels. This is coherent with the loss of resolution versus the depth, of course. At any rate, we will not do that in this book, and we will conservatively evaluate sin(θe max) with respect to the central point at the top of the investigation domain, according to Figure 15.12. Clearly, some redundancy is accepted in this way. In the cases considered throughout this chapter (frequency band ranging from 200 and 710 MHz, εsr = 5, a = 2 m), this evaluation yields M = 25. With regard to the number of vertical steps, we propose an evaluation slightly looser, because the DT spectral set is intrinsically matched with complex Fourier harmonic functions. At any rate, again approximating the spectral set with a rectangle as shown in Figure 9.11, the vertical extent (VE) of the spectral set is given by VE = 2ks max − 2ks max =  pﬃﬃﬃﬃﬃﬃ pﬃﬃﬃﬃﬃﬃ 4π εsr 4π εsr B ð fmax − fmin Þ = c0 c0  ð15:11Þ  and it seems reasonable to guarantee that the length of the vertical step function is equal to one-half of the period of the spatial harmonic function exp ( jVEz). This yields pﬃﬃﬃﬃﬃﬃ 4bB εsr b 1 2π c0 = = pﬃﬃﬃﬃﬃﬃ , N = N 2 VE 4 εsr B c0  ð15:12Þ  pﬃﬃﬃﬃﬃﬃ Again, N is to be meant as the first integer number equal to or greater than 4bB εsr =c0 . In the cases dealt with before in this chapter (b = 2 m, B = 510 MHz, εsr = 5), this drives to N = 31. In all the inversion results shown in this chapter, we have had M = 25 and N = 45, for a comprehensive number of trial unknowns equal to (2 × 25 + 1) × 45 = 2295, which is therefore a reasonable (even if redundant) number of trial unknowns. In Figure 15.32, the behavior of the singular values for three choices of the trial unknowns are shown. Figure 15.32 confirms that the proposed evaluation is slightly redundant but reasonable.  NUMERICAL AND EXPERIMENTAL EXAMPLES  274  0  –10  dB  –20  –30  –40  –50  –60  50  100  150  200  250  300  350  400  450  500  550  600  Index N  Figure 15.32. Singular values looking for 31 horizontal Fourier harmonics and 31 vertical step functions (dotted line), 51 horizontal Fourier harmonics and 45 vertical step functions (dashed line), and 63 horizontal Fourier harmonics and 63 vertical step functions (solid line).  In particular, up to a threshold of −20 dB, the three curves of singular values are substantially superposed, and beyond a threshold of −40 dB we should make twice larger the number of unknowns in order to increase the number of upper threshold of about 20%. However, in previous examples we have also seen that the use of a lower regularization threshold can improve the result only if the data are sufficiently clean, which in turn is related also to the depth of the targets of interest. To give a final rule of thumb, in the choice of the number of trial unknowns, some redundancy with respect to a DT-based evaluation is in general well-advised, both because the DT calculations are derived under several approximations and assumptions and because a larger number of basis functions will provide a better approximation of the actual singular function of the linear scattering operator. However, it is pointless (further than computationally burdening and potentially even harmful) to increase of an order of magnitude the number of trial unknowns with respect to a DT evaluation.  15.5  EXERCISES ON SPECTRAL AND SPATIAL CONTENTS  In Chapter 14 (Section 14.4) we have defined the spectral content and the spatial content of the upper threshold singular functions. In this section, we show a few examples about the possibilities that these quantities offer in order to characterize (in a nonrigorous but effective way) the class of the retrievable targets. In particular, this implicitly  EXERCISES ON SPECTRAL AND SPATIAL CONTENTS  275  completes the numerical analysis of the previous sections, where the nonredundancy of the data has been related to some saturation of the behavior of the singular values. Indeed, the saturation of the behavior of the singular values is not a sufficient condition in order to show that the class of retrievable profiles is saturated too. In fact, the class of the retrievable profiles is the span of the singular function upper threshold; and even if the number of singular values higher than a fixed threshold is saturated, theoretically this does not mean that the retrievable targets are definitively (namely, in a way not modifiable through the gathering of further data) characterized. In particular, the span of the upper threshold singular functions might hypothetically still change when increasing the number of data. The spectral and the spatial content of the singular function are qualitative but immediate instruments to show that indeed not only the number but also the class of retrievable targets tends to become stabilized when the data sampling, either in space or in frequency (or in time), is slightly more intense than the DT values. In Figure 15.33 we show the spectral content [as defined in Eq. (14.38)] of the singular function relative to the singular values depicted in Figure 15.25. In particular, Figure 15.33 shows the spatial frequencies that we have some hope to retrieve making use of 5, 9, 18, and 35 time frequencies, respectively. The line describes the bound of the retrievable spectral set according to DT (see Chapter 9). The DT set has been calculated neglecting the conductivity and accounting from the maximum view (geometrical) angle, evaluated with respect to the central upper point of the investigation domain, as shown in Figure 15.12. Figure 15.33 makes us appreciate that there is a noticeable agreement between the DT spectral set and maximum achievable support of the spectral content Frequency step 15 MHz  Frequency step 30 MHz 80  60  ζ [m]–1  ζ [m]–1  80 40 20 0  60 40 20  –50  0 η [m]–1  0  50  80  60  60  ζ [m]–1  ζ [m]–1  80  20 0  0 η [m]–1  50  Frequency step 126.5 MHz  Frequency step 63.75 MHz  40  –50  40 20  –50  0 η [m]–1  50  0  –50  0 η [m]–1  50  Figure 15.33. The spectral content of the upper threshold singular functions (threshold = −20 dB) at variance of the frequency step. The frequency step is after the title of each panel.  NUMERICAL AND EXPERIMENTAL EXAMPLES  276  of the singular functions. However, when the frequency step is too large, this maximum achievable support is not completely filled. To make narrower the frequency step is equivalent to fill progressively better the available spectral set. In this regard, in Figure 15.33 it is evident that we can even distinguish the contributions of each involved frequency that is associated with a well-localized “spectral arch.” Some effect of the frequency step on the reconstruction can be appreciated from Figure 15.34. The examples of Figure 15.34 represent a variation on the theme of the first case presented in Figure 15.27. In particular, the first (upper left-hand side) panel is the same in the two cases. Then, in Figure 15.34, the frequency step has been progressively enlarged in the subsequent panels to 30, 63.75, and 126.5 MHz. From Figure 15.34, we can appreciate that the main effect of the spectral holes is the introduction of false targets, the majority of which are actually related to aliasing effects  0.5  Δf =15 MHz (35 frequencies)  0.5  1 z [m]  z [m]  1  1.5  2  2.5 –1  Δf = 30 MHz (18 frequencies)  1.5  2  –0.5  0  0.5  2.5 –1  1  –0.5  x [m] 0.5  Δf = 63.75 MHz (9 frequencies)  0.5  z [m]  z [m]  0.5  1  Δf = 126.5 MHz (5 frequencies)  1  1  1.5  1.5  2  2  2.5 –1  0 x [m]  –0.5  0 x [m]  0.5  1  2.5 –1  –0.5  0  0.5  1  x [m]  Figure 15.34. Reconstruction of two superposed small circular (ray = 1 cm) metallic targets at distance 35 cm from each other at variance of the frequency step within the comprehensive frequency band 200–710 MHz. The title of each panel indicates the frequency step. SVD threshold = −20 dB.  EXERCISES ON SPECTRAL AND SPATIAL CONTENTS  277  that replicate (in a distorted way) the actual targets. We can also appreciate that it is not wrong to take data with some (nonexcessive, i.e., not an order of magnitude) redundancy with respect to the DT previsions [which in the case at hand would suggest a frequency step of 33 MHz according to Eq. (9.45)]: The expected improvement is marginal but clearly visible from the comparison of the two upper panels in Figure 15.34. Finally, Figures 15.33 and 15.34 also show that the class of the retrievable targets can be different even at a parity (or almost at a parity) of singular value behavior. In particular, from the two upper panels of Figure 15.33 we appreciate that, even if the upper threshold singular values are almost the same (281 making use of 35 frequencies and 275 making use of 18 frequencies, according to Figure 15.25), actually the span of the upper threshold singular function is not the same, and that with 35 frequencies allows a better coverage of the lower central part of the theoretically available spectral set. Let us pass to an example regarding the spatial content of the singular functions. To do that, now we propose an example with higher losses in the soil than those considered up to now. In particular, let us consider a soil with electrical conductivity σ = 0.05 S/m (the value considered before was σ = 0.01 S/m). The other parameters keep unchanged with respect to the previous case relative to Figure 15.33. In Figure 15.35 we show the spatial content, defined in Eq. (14.39), normalized to its maximum value, at variance of the regularization threshold for the singular values. The gray tones make us appreciate that the bottom of the investigation domains is much clearer than the top if the threshold is fixed at −10 or at −20 dB. In other words, the span of the singular functions upper threshold in these two cases does not portray adequately the bottom of the investigation  1 0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1  z [m]  1 1.5 2 2.5  –1  –0.5  0  0.5  Threshold at –20 dB  0.5  1.5 2 2.5  1  –1  –0.5  x [m]  1.5 2  –1  –0.5  0 x [m]  0.5  1  1 0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1  0.5  1  Threshold at –40 dB  0.5  1 0.9 0.8  1  0.7  z [m]  z [m]  1  2.5  0 x [m]  Threshold at –30 dB  0.5  1 0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1  1 z [m]  Threshold at –10 dB  0.5  0.6  1.5  0.5 0.4  2 2.5  0.3 0.2  –1  –0.5  0  0.5  1  x [m]  Figure 15.35. Normalized spatial content at variance of the threshold: σ = 0.05 S/m.  NUMERICAL AND EXPERIMENTAL EXAMPLES  278  domain. This is made still more evident if we threshold the normalized spatial content at 0.1—that is, at one order of size with respect to its maximum value. We mean this quantity as a function whose value is 1 in the points where the normalized spatial content is equal to or greater than 0.1 and 0 elsewhere. The relative image is shown in Figure 15.36, and we can appreciate that with threshold equal to −20 dB (or even more −10 dB), the bottom of the investigation domain is not adequately “covered.” To show the effect of the lack of spatial coverage, let us propose the reconstruction of two metallic circular targets at the depth of 2.4 m (with reference to their centers: the ray is 1 cm). The distance between the two targets is 80 cm. The data are achieved, as before, by means of a two-dimensional FDTD simulation performed with GPRMAX, and a white Gaussian noise has been superposed to the data so that we have SNR = 60 dB with respect to the total field data. From Figure 15.37, we can appreciate that in this case we cannot regularize at −20 dB (or even more at −10 dB) the singular values if we want to see these two targets; we need more singular functions in order to image the bottom of the investigation domain. In particular, from Figure 15.37 we also appreciate that the threshold at −30 dB is certainly the best one among the four presented trial values. In fact, it allows the imaging of the two targets without artifacts, which instead appears when the threshold is further on decreased to −40 dB, in which cases the same image of the two targets is distorted. In other words, Figure 15.37 documents, in the case at hand, the progressive passage from an overregularization (threshold at −10 and −20 dB) to a reasonable regularization (−30 dB) to an underregularization (−40 dB). In previous cases  Threshold at –10 dB  0.8  z [m]  1  0.6  1.5  0.4  2 2.5  –1  0  0.5  1  0.8 0.6  1.5  0.4  2 2.5  0  –1  0.2  –0.5  x [m]  0.8  0.4  2  0.2  –0.5  0  1  0  0.5  x [m]  1  0  1 0.8  1 z [m]  z [m]  0.6  1.5  –1  0.5  Threshold at –40 dB  0.5  1  1  2.5  0 x [m]  Threshold at –30 dB  0.5  1  1  0.2  –0.5  Threshold at –20 dB  0.5  1  z [m]  0.5  0.6  1.5 0.4  2 2.5  –1  0.2  –0.5  0  0.5  1  0  x [m]  Figure 15.36. The normalized spatial contents of Figure 15.35 thresholded at one-tenth of their maximum value: σ = 0.05 S/m.  EXERCISES ON SPECTRAL AND SPATIAL CONTENTS  0.5  Threshold = –10 dB  0.5  1.5  2  0.5  –0.5  0 x [m]  0.5  2.5 –1  1  Threshold = –30 dB  0.5  –0.5  0 x [m]  0.5  1  Threshold = –40 dB  1 z [m]  z [m]  1.5  2  1  1.5  1.5  2  2  2.5 –1  Threshold = –20 dB  1 z [m]  z [m]  1  2.5 –1  279  –0.5  0 x [m]  0.5  1  2.5 –1  –0.5  0 x [m]  0.5  1  Figure 15.37. Reconstruction of two metallic targets (ray = 1 cm) at the depth of 2.5 cm at variance of the regularization threshold. The distance between the two targets is 80 cm.  (see Figures 15.16–15.19), we have seen that, at parity of signal-to-noise ratio, the best threshold might be lower or higher than that exploited here. This confirms that the signalto-noise ratio is not a sufficient parameter to establish any optimal degree of regularization, because it depends on the losses and on the position of the targets of interest too. Before closing this section, we find it interesting also to show the data relative to the reconstruction of Figure 15.37. In particular, in Figure 15.38 the noisy data after zero timing and muting of the interface are shown, as they appear (upper panel) and after a filtering in the band 200–710 MHz (that is, the band of the source and the band exploited for the inversion) in the lower panel. From Figure 15.38, we can appreciate that the two targets are well-visible from the data. In other words, the data speak and tell us up to what depth we can reasonably try to focus the targets (even if under some progressive degradation of the resolution).  NUMERICAL AND EXPERIMENTAL EXAMPLES  280  0  Data without filtering  × 10–8  t [sec]  1 2 3 4 –1  0  –0.8  –0.6  –0.4  –0.2  0 x [m]  0.2  0.4  0.6  0.8  1  0.2  0.4  0.6  0.8  1  Filtered data  × 10–8  t [sec]  1 2 3 4 –1  –0.8  –0.6  –0.4  –0.2  0 x [m]  Figure 15.38. The noisy data (SNR = 60 dB, calculated on the total field data) exploited for the reconstructions of Figure 15.37, after zero timing and interface muting. Upper panel: The data as they appear. Lower panel: The data after filtering in the band of the source.  15.6 EXERCISES ON THE EFFECT OF THE HEIGHT OF THE OBSERVATION LINE In the previous sections the data were at the air–soil interface. In this section we show some examples regarding the effect of the height of the observation domain. In particular, here we consider a soil with relative dielectric permittivity εrs = 5 and electric conductivity σ = 0.01 S/m. The investigation domain is sized 1.5 × 1.5 m2 and ranges in depth from 1 cm to 151 cm. This investigation domain is discretized with 31 Fourier harmonic functions along the horizontal direction and 31 step functions along the depth. The frequency band ranges from 200 to 600 MHz with frequency step 25 MHz. The spatial step of the data is 2.5 cm, within a multimonostatic configuration where the offset between source and observation point is equal to zero. The observation line is 1.5 m long and is superposed to the investigation domain. Figure 15.39 shows the behavior of the singular values for h = 0 cm, h = 10 cm, h = 20 cm, h = 30 cm, h = 40 cm, and h = 50 cm. The figure shows that, as expected, the curve of the singular values becomes lower and lower when increasing the height of the observation line. Actually, in its initial part, the curve for h = 0 cm is lower than some among the other ones; this is due to some  EXERCISES ON THE EFFECT OF THE HEIGHT OF THE OBSERVATION LINE  281  0  –10  dB  –20  –30  –40  –50  –60  50  100  150  200  250  Index N  Figure 15.39. Singular value behavior at variance of the height h of the observation line. Solid line (upper curve): h = 0 cm. Dashed line: h = 10 cm. Dashes and dots: h = 20 cm. Dots: h = 30 cm. Asterisks: h = 40 cm. Crosses (lower curve): h = 50 cm.  redundancy of the data (Persico, 2006). However, by adopting a reasonable level of regularization (let’s say with threshold chosen within the range between −15 and −40 dB), the behavior of the singular values tells us that the height of the observation line makes the retrievable amount of information decrease. In order to show the relationship between this loss of information and the class of retrievable targets, let us remind that the height of the observation line is related to a decrease in the effective maximum view angle, as shown in Section 9.10. The progressive reduction of the maximum view angle while increasing the height of the observation line is shown in Figure 15.40. In Figure 15.40 the minimum depth of the investigation domain (dmin) has been voluntarily exaggerated with respect to the data of the example of Figure 15.39 (where dmin = 1 cm and the investigation domain is sized 1.5 × 1.5 m2). However, this is only for a graphical evidence: Indeed, for any fixed height and extent of the observation line, the maximum view angle is dictated by Snell’s law on the refraction, and therefore the maximum view angle does not vanish while decreasing dmin. Instead, of course the maximum view angle vanishes for h ! + ∞, because we are considering an observation line of finite length. In particular, we have found numerically the effective maximum view angles solving Eq. (2.16) for the refraction point at the air–soil interface. According to Figure 15.40, the reference buried point is the upper central point of the investigation domain, so that, with reference to the symbols in Eqs. (2.16) ﬃﬃﬃ (2.17), in the case at  pand pﬃﬃﬃﬃﬃﬃ hand we have x = 1.5 m, x0 = 0 m, c = c0 = εsr = 3 × 108 = 5 m=s ≈1:342 × 108 m=s, ct01 =2 = dmin = 0:01 m. After solving for the refraction point x1, the maximum effective  NUMERICAL AND EXPERIMENTAL EXAMPLES  282  Observation line Σ Air Soil  θ3 dmin  h3 h2 h1 = 0 θ2 θ1  Investigation domain D  Figure 15.40. Pictorial of the reduction of the maximum view angle when increasing the height of the observation line. For color detail, please see color plate section.  TABLE 15.1 Numerical Results at Variance of the Height h h (m)  θe max (degrees)  HRh (cm)  0.0 0.1 0.2 0.3 0.4 0.5  89.24 34.6 32.8 31 28.37 25.24  16.8 29.5 31 32.6 35.3 39.3   .pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2 x21 + dmin angle is given by θe max = arcsin x1 and the expected horizontal resolution, according to. Eqs. (9.62) and (9.63), is given by HRh = λsc =2 sin ðθe max Þ = pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2 2x1 . In the case at hand, the central frequency is equal to fc = 400 MHz, λsc x21 + dmin and therefore the central internal wavelength is equal to λsc = c=fc = 33:54 cm. The numerical results at variance of the height h are presented in Table 15.1. In Figure 15.41, we show the spectral content of the singular functions at variance of the height, with reference to a threshold equal to −20 dB. Together with the spectral content, we show the DT retrievable spectral set, accounting for the maximum view angle at variance of the height as shown in Table 15.1. As can be seen, the agreement between the DT contour of the retrievable set (red lines) and the edges of the support of the spectral content is very good for h ≥ 20 cm. At h = 10 cm this matching is still good, even if the spectral content extends slightly beyond the lateral bounds. This discrepancy is probably due to near-field effects, which as said are not accounted in DT. Instead, for h = 0 cm the support of the spectral content is substantially smaller than the DT bounds. This is because the spectral weight of the DT algebraic relationship is equal to zero at the extremes of the visible interval, as already outlined in Section 9.2.  EXERCISES ON THE EFFECT OF THE HEIGHT OF THE OBSERVATION LINE  h = 10 cm  60  60  40  40  ζ [m–1]  ζ [m–1]  h = 0 cm  20 0  0  –50  20 0  50  –50  60  60  40  40  20 0  –50  0  50  –50  40  40  ζ [m–1]  ζ [m–1]  60  20  0 η  50  [m–1  ]  0  50  h = 50 cm  60  –50  50  20  h = 40 cm  0  0 h = 30 cm  ζ [m–1]  ζ [m–1]  h = 20 cm  0  283  20 0  –50  50  0 –1  η [m ]  Figure 15.41. Spectral content of the singular functions (threshold of the singular value at −20 dB), together with the DT bound of the spectral retrievable set (red lines) at variance of the height h of the observation line. For color detail, please see color plate section.  Figure 15.41 shows that the degradation of the reconstruction expected for higher observation lines is mainly related to a decreasing of the maximum effective view angle, which essentially (see Chapter 9) makes us expect a degradation of the horizontal resolution, as explicitly calculated in Table 15.1 according to Eqs. (9.62) and (9.63). In order to show this on a reconstruction, we have simulated the data relative to two small circular metallic targets with GPRMAX. The centers are at the depth of 3 cm and the rays are 2 cm. Thus, the targets are superficial and the horizontal resolution limits in Table 15.1 can be tested (otherwise a further degradation due to the depth of the buried targets should be accounted for). The data are noisy with SNR = 60 dB with respect to the total field. The reconstruction is regularized by thresholding the singular values at −20 dB. The distance between the centers of the two targets is 30 cm. Since the targets are quite shallow,  NUMERICAL AND EXPERIMENTAL EXAMPLES  284  h = 10 cm  h = 0 cm  0.5 z [m]  z [m]  0.5 1 1.5  –0.5  0  1 1.5  0.5  –0.5  h = 20 cm  z [m]  z [m]  0.5  1  –0.5  0  1 1.5  0.5  –0.5  0.5  0.5  0.5 z [m]  z [m]  0  h = 50 cm  h = 40 cm  1 1.5  0.5  h = 30 cm  0.5  1.5  0  –0.5  0 x [m]  0.5  1 1.5  –0.5  0 x [m]  0.5  Figure 15.42. Reconstruction of two small and shallow circular metallic targets at variance of the height h of the observation line.  the relative diffraction curves were partially embedded in the echo of the airsoil interface. Therefore, background removal has been applied on the data. From Figure 15.42, we see the progressive degradation of the horizontal resolution. In particular, the two targets are welldistinguished for h = ≤ 20 cm, are hardly distinguished for h = 30, 40 cm (and a meaningful artifact centered below the two targets appears too), and are substantially fused together for h = 50 cm (at this height the artifacts are still more relevant). These results are in good agreement with the DT horizontal resolution previsions of Table 15.1.  15.7 EXERCISES ON THE EFFECT OF THE EXTENT OF THE INVESTIGATION DOMAIN Up to now, we have discussed two linear focusing methods, one essentially based on the migration and one essentially based on the linear inversion. The expected characteristics of the reconstruction in terms of retrievable spatial harmonic components  EXERCISES ON THE EFFECT OF THE EXTENT OF THE INVESTIGATION DOMAIN  285  are not much different, because in both cases the physical “point” driving the resolution is the filtering behavior of the linear scattering operator. These are more explicitly foreseeable under a DT model but they are essentially confirmed by the numerical SVD of the linear operator, even if this one accounts for losses, near-field effects and truncation of the observation line without introducing further approximations. The trade-off usually reported between migration and inversion is that the first one is a faster but mathematically less refined focusing method with respect to the second one. This is true, but there is an important corollary that customarily is not stated: The stronger computational burden required for an inversion compels us to restrict the investigation domain that (depending on the single case and on the available computational power) is usually extended up to a few central wavelengths within an inversion approach, whereas it can be extended up to hundreds of wavelengths within a migration-based approach. Now, in common GPR practices, a B-scan is often quite long in terms of wavelength (hundreds or even thousands). Therefore, in such a case, it is not possible to apply an inversion approach to the whole set of data. What has been done, up to now, is to join side by side several inversion results (Pettinelli et al., 2009; Persico, Soldovieri, and Utsi, 2010), according to the scheme of Figure 15.43, where the B-scan line has been divided into several observation lines Σ and the underlying portion of soil of interest has been divided into several corresponding investigation domains D. As depicted in Figure 15.43, it is well-advised that, for each subportion of the B-scan, the subobservation line is of the same length of the underlying sub-investigation domain and is perfectly superposed to it. This is because, for each inversion, the adopted model (see Section 4.1) assumes that the targets are present only within the current investigation domain. This is not true in the real world, and therefore an observation line quite longer than the underlying investigation domain would enhance the effects of targets external to the investigation domain on the achieved image. However, even choosing observation lines superposed to the investigation domains, the targets within each investigation domain can influence the reconstruction in adjacent investigation domains, and the targets in the adjacent investigation domains can in turn affect the reconstruction in the current investigation domain. The possible situations are pictorially shown in Figure 15.44. In particular, with reference to Figure 15.44, a target T1 is expected to be optimally reconstructed, because it is centered with respect to the sub-observation line superposed to it, so that it is seen under a presumably adequate maximum effective view angle. Air  ΣN–1  ΣN  ΣN+1  DN–1  DN  DN+1  Soil  Figure 15.43. Subdivision of a long B-scan into several observation and investigation domains.  NUMERICAL AND EXPERIMENTAL EXAMPLES  286  Air  ΣN  ΣN–1  T2 Soil  T1 DN–1  DN  ΣN+1  T3 DN+1  Figure 15.44. Pictorial of the possible situations: with respect to the current investigation and investigation domains Dn and Σn, the targets might be centered as T1, peripheral as T2 or external as T3.  Instead a target like T2 is seen under an asymmetric maximum view angle, because the sub-observation line is not centered on it. This makes us expect that the reconstruction of T2 will be somehow poorer than that of T1. Moreover, the external target T3 is certainly “seen” by the GPR system when it reaches the right-hand bound of the subobservation line ΣN, and therefore it is a potential source of artifacts within the investigation domain DN. For the same reason, T2 is a potential source artifact within the investigation domain DN − 1 and T3 is a peripheral target within the investigation domain DN+1, so that its reconstruction is subject to the effects of an asymmetric effective maximum view angle. At this point, it is clear that the presence of possibly many peripheral targets and the production of artifacts due to close external targets are the two sides of the same coin and are a consequence of the fact that we have partitioned the original whole observation line and the underlying whole investigation domain of interest. Figure 15.44 comprises also apparently more complicated cases. For example, a target that crosses the lateral bound between two investigation domains can be seen as a couple of adjacent targets, one of which is peripheral and another one external to the current investigation domain. Similarly, a long target that crosses the whole investigation domain on both sides can be seen as five adjacent targets: two external (one on the righthand side and another one on the left-hand side), two internal but peripheral (one on the right-hand side and another one on the left-hand side), and one internal and centered. In order to show some effects of the subdivision, we propose an example constructed as follows: The relative dielectric permittivity of the soil is equal to εrs = 5, and its electric conductivity is equal to σ = 0.001 S/m. The offset between source and observation point is equal to zero, the spatial step of the data is 2.5 cm, and a B-scan 4.5 m long is considered. With these parameters, we have 181 observation points all together. For the inversion results, the B-scan at hand has been divided into three adjacent observation domains, each of which is 1.5 m long. In this way, we have 61 measurement points for each investigation domain, and the last point of the first (second) observation domain is also “re-exploited” as the first point of the second (third) observation domain. For each observation domain, the corresponding investigation domain starts from the interface and ends at the depth of 1.5 m. The investigation domain has been discretized by means  EXERCISES ON THE EFFECT OF THE EXTENT OF THE INVESTIGATION DOMAIN  287  0  z [m]  0.5  1  1.5  0  0.5  1  1.5  2  2.5  3  3.5  4  4.5  x [m]  Figure 15.45. Reconstruction of three centered cavities at the depth of 1 m. 0  z [m]  0.5  1  1.5  0  0.5  1  1.5  2  2.5  3  3.5  4  4.5  x [m]  Figure 15.46. Reconstruction of three cavities of Figure 15.45 shifted 55 cm toward the righthand side.  of 31 bilateral Fourier harmonic functions along the horizontal direction and 31 step functions along the depth. The inversion has been performed in the frequency domain, and the exploited band for the inversion has been 200–600 MHz sampled with frequency step 25 MHz. The SVD has been regularized by thresholding the singular values at −20 dB with respect to the first (maximum) one. The data have been simulated with GPRMAX, making use of a Ricker source with central frequency at 300 MHz. We have checked that the band at −3 dB of such a source is about equal to the interval 200–600 MHz. In Figure 15.45 we show the reconstruction of three centered square cavities, each of which is 30 × 30 cm2, with the depth of the top at 1 m, and in Figure 15.46 we show the reconstruction that we achieve if the cavities are shifted 55 cm toward the right-hand side. It is evident that the reconstruction in Figure 15.46 is worse than that in Figure 15.45, because the targets are peripheral. In particular the three spots relative to the reconstructions appear as spuriously “pulled” toward the centers of the investigation domains. This example shows that, if possible, the subdivision of the investigation domain should account of the most relevant targets in order to make them, if possible, centered.  NUMERICAL AND EXPERIMENTAL EXAMPLES  288  0  z [m]  0.5 1 1.5  –0.5  0.5  1.5  2.5 x [m]  3.5  4.5  Figure 15.47. Reconstruction of three cavities of Figure 15.46 achieved after a zero padding that makes the targets centered.  This can be achieved in some cases with a shift of the subdivision, which in turn can require some zero padding of the B-scan at its beginning and/or at its end. Incidentally, some zero padding is customarily needed in any case if we want to invert the entire gathered B-scan. In fact, the length of the physically gathered observation line in general is not an integer multiple of the chosen length of the subportion selected for the inversions. In particular, with some zero padding on the same data of Figure 15.46, we have performed the same inversion on four investigation domains instead of three, and we have achieved the result of Figure 15.47. In Figure 15.47 the vertical solid lines indicate the start and end point of the real B-scan. As can be seen, in Figure 15.47 the same targets of Figure 15.46 are made centered with respect to the subportions of the observation line exploited for each inversion, and this improves the reconstruction. In particular, some limited view angle effect is perceived only with regard to the third cavity on the right-hand side, because this cavity is placed close to the end of the gathered observation line. In other words, it is a “really peripheral” target and therefore the lack of a symmetric and adequate maximum view angle is an intrinsic (physical) unavoidable phenomenon in this case. For completeness, in Figure 15.48 the result of a migration-based processing is shown too. In particular, the data have been imported in Reflexw and have been migrated in the time domain (Schneider, 1978). The exploited propagation velocity has been that corresponding to the real part of the complex permittivity, which is licit because the soil is low-lossy. The number of traces considered for the migration has been 181—that is, the total and not a subset, because the diffraction curves visible from the data appeared as large as the comprehensive length of the B-scan. From Figure 15.48 we can see some residual effect of the diffraction curves and the image appears somehow noisier than that in Figure 15.47. Moreover, as in Figure 15.47, also in Figure 15.48 we appreciate some limited view angle effect only with regard to the cavity on the right-hand side (which appears slightly pulled toward the left-hand side). We find also interesting to present some examples about the problem of artful anomalies due to targets external to the observation domain. In the previous example this problem was formally present too, but not meaningful because the three targets were scattering objects of the same shape, size, and nature. Instead, let us now consider a situation where both strong and weak scattering targets are present. In particular, let us consider,  EXERCISES ON THE EFFECT OF THE EXTENT OF THE INVESTIGATION DOMAIN  289  0  z [m]  0.5  1  1.5  0  0.5  1  1.5  2  2.5  3  3.5  4  4.5  x [m]  Figure 15.48. Reconstruction of three cavities of Figure 15.47 achieved from Kirchhoff migration.  at a parity of measurement and scenario parameters, three new targets with the same geometry (namely size, position, and orientation) as that of the targets above. However, now the left-hand side target is a perfect electric conductor, the central target is a weak scattering object with relative permittivity equal to 6 and with the same conductivity of the surrounding soil, and the right-hand target is a void. This time we show first of all the data (Figure 15.49) after zero timing and muting of the interface contribution. This is done because we are considering a scenario with weak and strong scattering targets put together. In particular, it is natural that a strong scattering object can partially or even totally cover the visibility of a weaker scattering targets, and therefore we want to show preliminarily that the weak target is visible in the raw data and therefore it should be visible also after a correct focusing processing. The data of Figure 15.49 make us appreciate that, even if it is meaningfully weaker than the other two, the diffraction curve of the weak target—that is, the central one among the three diffraction curves—is clearly visible. In Figure 15.50 the result with the investigation domain sequence of Figure 15.46 is shown. As can be seen, the central weak scattering target has been substantially erased, because it is completely masked by the false target produced by the tail of the diffraction curve of the perfect electric conductor within the central investigation domain. In Figure 15.51, instead the result of a Kirchhoff migration similar to that of Figure 15.48 is shown. Indeed, the image of Figure 15.51 has been enhanced by means of some gain variable versus the depth and some saturation, which is a common “trick” to enhance the achieved image. However, the shape of the retrieved target and the comparison with the data provide a trustful result. Incidentally, we have tried similar and also further or alternative manipulations also on the image of Figure 15.50, but we didn’t achieve any reliable image of the central target. Let us now show the reconstruction of the same underground scenario according to the sequence of four investigation domains considered in Figure 15.47. The result is shown in Figure 15.52, and the image of the central target has been slightly enhanced by means of some darkening of the image. Alternatively, one might normalize each of the achieved adjacent reconstructions to its own maximum level. In this way, the image of Figure 15.53 is achieved.  NUMERICAL AND EXPERIMENTAL EXAMPLES  290  Figure 15.49. GPR data with three targets. From left to right: A perfect electric conductor, a weak scattering target, and a void.  0  z [m]  0.5  1  1.5  0  0.5  1  1.5  2  2.5  3  3.5  4  4.5  x [m]  Figure 15.50. The reconstruction of three targets. From left to right: A perfect electric conductor, a weak scattering target, and a cavity.  EXERCISES ON THE EFFECT OF THE EXTENT OF THE INVESTIGATION DOMAIN  291  0  z [m]  0.5  1  1.5  0  0.5  1  1.5  2  2.5  3  3.5  4  4.5  x [m]  Figure 15.51. The migration result achieved for three targets. From left to right: A perfect electric conductor, a weak scattering target, and a cavity. 0  z [m]  0.5 1 1.5  –0.5  0.5  1.5  2.5 x [m]  3.5  4.5  Figure 15.52. The reconstruction of the three targets of Figure 15.50, making use of four-investigation domain. 0  z [m]  0.5 1 1.5  –0.5  0.5  1.5  2.5 x [m]  3.5  4.5  Figure 15.53. The reconstruction of the three targets of Figure 15.50, making use of the four-investigation domain and normalizing each reconstruction to its own level.  Any choice has its pros and cons, and clearly in this example we have an intrinsic physical problem due to the different amount of energy scattered by the targets at hand. However, from Figure 15.50 it is clear that the adopted investigation domain sequence makes much worse the effect of this problem.  NUMERICAL AND EXPERIMENTAL EXAMPLES  292  Summarizing, we work out a first conclusion that, when possible, the choice of the investigation domain should be done such that the targets of interest are all relatively centered with respect to the investigation domains. However, such a sequence is not identifiable in all cases, because it can happen that the distribution of the targets is too “random” and/or the buried targets are too long and/or too many to allow us to identify the desired sequence of adjacent investigation domains. In these cases, a possible solution is the use of a multiple sequence of investigation domains. In particular, let us explain this concept starting with a double sequence of investigation domains. The double sequence is illustrated in Figure 15.54. Of course, some further trivial zero-padding operations are needed at the beginning and at the end of the B-scan in order to identify the two complete sequences. It is clear that, adopting a double sequence of investigation domain, only the central part of each investigation domain is retained, thereby mitigating the problems due to the maximum view angle. On the other hand, each piece of reconstruction is as large as one-half of the width of the investigation domain (labeled “a” in Figure 15.54, analogously to Figure 4.1) instead of its entire width. Actually, it is unavoidable to see a sort of seam point between any two adjacent sub-investigation domains, due to the different average values of the image relative to two adjacent sub-reconstructions. Consequently, when adopting a double sequence, we will see on the reconstruction about twice the seam points with respect to the case with a single sequence. Therefore, the choice should be data-driven. With regard to the computational burden, there is some additional time required for the double sequence but it is marginal. In fact, most of the required RAM and computational time is due to the calculation of the matrix and of its SVD, and this is done once and for all with regard to one single sub-investigation (and sub-observation) domain. The idea of a multiple series of investigation domains is a straightforward extension of the double sequence. In particular, Figure 15.55 shows how a triple sequence might be chosen. In this case the retained part of the reconstruction is still more centered, but the number of seams is about threefold with respect to those needed for a single sequence of investigation domains. However, on the other hand, the difference between the average  N–4  a  a/2  N–3  N–1  N–2  a/2  N+1  N  N+3  N+2  N+4  Figure 15.54. Double sequence of investigation domains. The second sequence is shifted with respect to the first one-half of an investigation domain. For each investigation domain the central half of the focused area is retained. Then the retained pieces of reconstruction are joined side by side after the indicated order.  EXERCISES ON THE EFFECT OF THE EXTENT OF THE INVESTIGATION DOMAIN  a  a/3  N–1  N+2  N–2  N–3 a/3  293  N+1  N a/3  Figure 15.55. Triple sequence of investigation domains. The second sequence is shifted with respect to the first one-third of an investigation domain, and the third sequence is shifted with respect to the second one-third of an investigation domain. For each investigation domain the central one-third of the focused area is retained. Then the retained pieces of reconstruction are joined side by side after the indicated order.  value of the reconstruction between two adjacent domains is expected to be reduced because the amount of the shift between two adjacent sets of data is reduced. Finally, there will also be a further marginal increase of the required computational time with respect to the double sequence. At this point, we provide an example of reconstruction achieved from a double investigation domain. In this example, the targets are nine square cavities sized 30 × 30 cm2 with the depth of the top equal to 1 m. The abscissas of the centers of the cavities are at 0.20 m, 0.75 m, 1.30 m, 1.70 m, 2.25 m, 2.80 m, 3.20 m, 3.75 m, and 4.30 m, respectively. The scenario and measurement parameters are the same as those given in the previous examples. In this case, the investigation domains are too “crowded” to allow us to identify any well-advised single sequence. In particular, making use of the single sequence with three investigation domains (as in Figure 15.46), we achieve the result of Figure 15.56, and making use of the single sequence of four investigation domains (as in Figure 15.47) we achieve the result of Figure 15.57. In both cases, limited view angle effects are quite evident with regard to some of the peripheral targets. In particular, in Figure 15.57 some of the cavities cross the boundary between two adjacent investigation domains, and this affects in a particularly negative fashion their focusing. In Figure 15.58, instead, the result achieved from the double sequence (with seven investigation domains) is shown. The seam-points have not been indicated in this case, in order not to make the figure confusing; this also shows that their locations are intrinsically evident. The focusing of all the targets is meaningfully better by making use of a double sequence of investigation domains. Actually, some artifacts appear too, but these are due to some unavoidable interference between the targets, which  NUMERICAL AND EXPERIMENTAL EXAMPLES  294  0  z [m]  0.5  1  1.5 0  0.5  1  1.5  2  2.5  3  3.5  4  4.5  x [m]  Figure 15.56. The reconstruction of nine cavities with three investigation domains.  0  z [m]  0.5 1 1.5  –0.5  0.5  1.5  2.5 x [m]  3.5  4.5  Figure 15.57. The reconstruction of nine cavities with four investigation domains.  0  z [m]  0.5 1 1.5  –0.5  0.5  1.5  2.5 x [m]  3.5  4.5  Figure 15.58. The reconstruction of nine cavities with a double sequence of investigation domains.  are quite close to each other. Such artifacts are present (and actually appear even worse) if the reconstruction is achieved from a Kirchhoff migration, as shown in Figure 15.59. As in some previous cases, the image of Figure 15.59 has been enhanced with some gain variable versus the depth.  EXERCISES ON THE EFFECTS OF THE BACKGROUND REMOVAL  295  0  z [m]  0.5  1  1.5  0  0.5  1  1.5  2  2.5  3  3.5  4  4.5  x [m]  Figure 15.59. The reconstruction of nine cavities with a Kirchhoff migration.  For the interested reader, the effects of the observation and investigation domain subdivision have been tested also versus experimental data (Persico and Sala, 2014).  15.8 EXERCISES ON THE EFFECTS OF THE BACKGROUND REMOVAL In this section, some examples about the background removal are shown. Preliminarily, let us show how to discretize the linear scattering operator so that the operation of the background removal is included. Let us consider at the moment a single frequency. To do this, let us start considering the matrix relative to a common offset prospecting and let us focus on a single-frequency case with K measurement points and H trial basis functions. It is taken for granted that the observation line is of the same length of the underlying investigation domain and is perfectly superposed to it. Let us label s the spatial step, so that the length of the investigation and observation domains is equal to s(K − 1). Let us label M the matrix of the system and c the column vector of the coefficients. Given any combination of coefficients, the product Mc is, by definition, the scattered field at the first order (with respect to the Born series, defined in Section 8.1) produced by the chosen combination of coefficients, which in turn represents some chosen buried target. Let us now consider, as chosen target, the first trial basis function. In this case the first element of the column vector of the coefficients is equal to 1, and the remaining H − 1 are equal to 0. Consequently, the relative scattered field at the first order is given by 0  10 1 0 1 1 M11 M11 M12 …M1H B M21 M22 …M2H CB 0 C B M21 C CB C = B C Mc = B @… A@ … A @ … A 0 MK1 MK2 …MKH MK1  ð15:13Þ  Equation (15.13) shows that the first column of the matrix represents the scattered field relative to the first trial basis function. In the same way, the generic hth column  NUMERICAL AND EXPERIMENTAL EXAMPLES  296  of the matrix represents the scattered field relative to the hth trial basis function. At this point, in order to perform a background removal on 2N + 1 traces, we need N additional traces before the original scan and N additional traces after it. This means that we have to calculate the common offset matrix relative to K + 2N measurement points, and these K + 2N points have to be referred to an enlarged equivalent observation line of length (K − 1)s + 2Ns, centered on the investigation domain. These K + 2N measurement points lead to a matrix (at single frequency) with K + 2N lines. Let us call M 1 this “augmented” matrix. Now, referring the background removal to the first-order samples of the scattered fields—that is, to the columns of the matrix—it is immediate that Mb ð k,hÞ = M1 ðk + N, hÞ +  N 1 X M1 ðk + n + N, hÞ k = 1…K 2N + 1 n = − N  ð15:14Þ  where M b is the matrix relative to the scattering operator including the background removal. As can be seen, M b has K rows as the original common offset matrix. With regard to the data, instead, the extra data needed for BKGR can be fictitious or actual if we are considering a long observation line partitioned into adjacent sub-lines for inversion purposes as discussed in the previous section. The best choice is case-dependent. In a first example, we consider a stratified medium with a thin cavity between the two media as shown in Figure 15.60. The cavity is large (55 cm) and thick (2 cm). The depth of its top is 69 cm. The data have been simulated with GPRMAX, and the soil shows a relative dielectric permittivity equal to εsr = 5 and an electric conductivity equal to σ = 0.01 S/m. The underlying rock shows a relative dielectric permittivity equal to εrr = 35 and an electric conductivity equal to σ r = 0.01 S/m The soil–rock interface is at the depth of 70 cm. The data are shown in Figure 15.61. In particular, a central measurement line 1.5 m long has been considered for the common offset data, prolonged with an additional 25 cm on both sides for gathering  –0.2  Air  0  Soil  0.2  x [m]  0.4 Cavity  0.6 0.8  Rock  1 1.2 1.4 1.6 –2.5  –2  –1.5  –1  –0.5  0 z [m]  0.5  1  1.5  2  Figure 15.60. Geometry of the case history at hand in a stratified medium.  2.5  EXERCISES ON THE EFFECTS OF THE BACKGROUND REMOVAL  0  297  Before background removal  ×10–8  t [sec]  1  2  3  –0.6  –0.4  –0.2  0  0.2  0.4  0.6  0.4  0.6  x [m]  t [sec]  0  After background removal  ×10–8  1  2  3  –0.6  –0.4  –0.2  0 x [m]  0.2  Figure 15.61. The data before (upper panel) and after (lower panel) a background removal on 11 traces in the layered medium of Figure 15.60.  the extra data needed for the background removal, which is performed on 11 traces (corresponding to a distance of 50 cm). The data have been gathered with spatial step 5 cm, and the source is a Ricker pulse with central frequency 300 MHz. Gaussian noise has been added to the data with signal-to-noise ratio equal to 60 dB, evaluated on the total field data. The data shown in Figure 15.61 have been filtered in the band 300–620 MHz, which is the band used for the inversion, about corresponding to the (−6 dB) band of the source. From Figure 15.61, we appreciate that the operation of background removal makes the target much more visible in the case at hand. This is obvious, because the target is embedded in the interface between two buried layers. In Figure 15.62, the result of an inversion of these data without and with applying background removal on 11 traces is shown. In particular, the two inversion results of Figure 15.62 are achieved from two different data (namely the data without and with background removal) and the two different matrixes (namely the common offset matrix relative to an observation line 1.5 m long and the matrix including the background removal operation on the same observation line, which is achieved from a common offset matrix relative to an augmented common offset observation line, 2 m long). It can be seen that the target is visible only in the lower panel, because the upper one substantially  NUMERICAL AND EXPERIMENTAL EXAMPLES  298  Without background removal 0  z [m]  0.5  1  1.5 –0.5  0  0.5  x [m] With background removal 0  z [m]  0.5  1  Figure 15.62. Reconstruction without (upper panel) and with (lower panel) back1.5 –0.5  0 x [m]  0.5  ground removal. The target is the same as in Figure 15.60. The reconstruction is based on a linear inversion.  represents the interface between the soil and the underlying rock. The reconstruction in the lower panel, however, shows a band-pass version of the target along both the horizontal and the vertical directions, in agreement with the considerations discussed in Chapter 9. Let us note that, in the case at hand, the critical length as defined in Eq. (9.85) is just 55 cm long, so the length of the target is equal to the critical length. This is the reason why the background removal affects its reconstruction but does not “destroy” it completely. In Figure 15.63, the homologous migration-based results are shown. Let us note that Figure 15.63 is based on the same procedure applied to two different sets of data.2 In other words, since we have migrated the data with a commercial code, 2 Unlike Figure 15.62, where the matrix (i.e., the model) combined with the two different sets of data was not the same.  EXERCISES ON THE EFFECTS OF THE BACKGROUND REMOVAL  299  Without background removal 0.2 0.4  z [m]  0.6 0.8 1 1.2 1.4 –0.5  0  0.5  x [m] With background removal 0.2 0.4 z [m]  0.6 0.8 1  Figure  15.63. Reconstruction without (upper panel) and with (lower panel) background removal. The target is the same as in Figure 15.60. The reconstruction is based on Kirchhoff migration.  1.2 1.4 –0.5  0  0.5  x [m]  we didn’t have the possibility to apply a migration algorithm conceived “ad hoc” for data undergoing background removal, and this can cause artifacts. In particular, in Figure 15.63 (lower panel) we have a spurious prolongation of the target, due to the “weight” of the cavity on the average trace at the time corresponding to its depth. This did not happen in the inversion result of Figure 15.62 (lower panel), where the filtering effect is accounted for in the model. The distortion of the spectrum of the target can be reduced adopting a background removal on all the (31) traces. In Figure 15.64 we compare the migration result achieved after background removal on all the traces (upper panel) and background removal on 11 traces (lower panel). It can be seen that the target is better retrieved with background removal on all the traces but, on the other hand, the background removal on all the traces leaves a “contrail” as long as the entire scan.  NUMERICAL AND EXPERIMENTAL EXAMPLES  300  BKG removal on all the traces 0.2 0.4  z [m]  0.6 0.8 1 1.2 1.4 –0.5  0  0.5  x [m] BKG removal on 11 traces 0.2 0.4 z [m]  0.6 0.8 1  Figure 15.64. Upper panel: Migration performed with Reflexw after background  1.2  removal on all the traces. Lower panel:  1.4 –0.5  0 x [m]  0.5  Migration performed with Reflexw after background removal on 11 the traces. The scenario is that of Figure 15.60.  This happens because the weight of the target at its time depth is spread out over all the traces [the phenomenon is analogous to the belt shown in Figure 7.3 (panel b)]. At this point, let us consider the case analogous in a homogeneous (not layered) half-space. The geometry of the problem is shown in Figure 15.65. The values of the parameters are the same as in the previous example, with the only exception that the rock of Figure 15.60 is replaced with the same overlying soil. The data without and with background removal are shown in Figure 15.66. The data shown in Figure 15.66 are noisy (SNR = 60 dB) and filtered in the band 300–620 MHz, analogously to those in Figure 15.60. It can be appreciated that the data this time appear clearer without background removal than with background removal. Indeed, in this case the background removal is not really needed at the depth level of the target, because the host medium is homogeneous. This is confirmed by the inversion results shown in Figure 15.67 without (upper panel) and with (lower panel) background  EXERCISES ON THE EFFECTS OF THE BACKGROUND REMOVAL  –0.2 0 0.2  301  Air Soil  z [m]  0.4 Cavity  0.6 0.8 1 1.2 1.4 1.6 –2.5  –2  –1.5  –1  –0.5  0 x [m]  0.5  1  1.5  2  2.5  Figure 15.65. Geometry of a problem analogous to that represented in Figure 15.60, in the case of a homogeneous (not layered) soil.  0  Before background removal  ×10–8  t [sec]  1  2  3  –0.6  –0.4  –0.2  0  0.2  0.4  0.6  0.4  0.6  x [m]  t [sec]  0  After background removal  ×10–8  1  2  3  –0.6  –0.4  –0.2  0 x [m]  0.2  Figure 15.66. The data before (upper panel) and after (lower panel) a background removal on 11 traces in the homogeneous medium of Figure 15.65.  NUMERICAL AND EXPERIMENTAL EXAMPLES  302  removal on 11 traces. The reconstruction of the upper panel this time is much better than that of the lower panel, because it doesn’t suffer the filtering effect accounted for in the inversion algorithm, nor does any particular distortion occur in the data with the possible generation of horizontal artifacts. In Figure 15.68, two migration results are shown, obtained from the commercial code Reflexw. The upper panel refers to a Kirchhoff migration applied without any background removal, whereas the lower panel refers to a Kirchhoff migration applied after background removal on 11 traces. As said, this is a commercial migration code and does not account for the fact that one has applied any background removal on the data. At any rate, the results of Figure 15.68 confirm the fact that in this case the best result is achieved without any background removal.  Without background removal 0  z [m]  0.5  1  1.5 –0.5  0  0.5  x [m] With background removal 0  z [m]  0.5  1  Figure  15.67. Reconstruction without (upper panel) and with (lower panel) of the  1.5 –0.5  0 x [m]  0.5  target in Figure 15.65, based on a linear inversion.  303  EXERCISES ON THE EFFECTS OF THE BACKGROUND REMOVAL  Without background removal 0.2 0.4  z [m]  0.6 0.8 1 1.2 1.4 –0.5  0  0.5  x [m] With background removal 0.2 0.4 z [m]  0.6 0.8 1  Figure  15.68. Reconstruction without  1.2  (upper panel) and with (lower panel) background removal. The target is the same as in Figure 15.65. The reconstruction is based on Kirchhoff migration.  1.4 –0.5  0  0.5  x [m]  In Figure 15.69 we see that the background removal on all the traces drives to a better reconstruction of the target, but prolongs the contrail of the cavity along the entire scan, analogously to the case of Figure 15.64. In order to mitigate this problem, one might apply a filtering of the data after the migration, in order to erase the false horizontal belts possibly produced in the data by the background removal procedure. This erasing should be result-driven, because it should not erase the targets of interest too. In particular, we have applied such a filtering to the result of Figure 15.69 relative to background removal on all the traces. The filter was an ideal high-pass one with respect to the horizontal frequencies equal or greater than twice the inverse of the critical length. The filter has been implemented by a homemade MATLAB code, and the result is shown in Figure 15.70. As can be seen, the contrail is attenuated by the filtering without any meaningful distortion of the focused target.  NUMERICAL AND EXPERIMENTAL EXAMPLES  304  BKG removal on all the traces 0.2 0.4  z [m]  0.6 0.8 1 1.2 1.4 –0.5  0  0.5  x [m] BKG removal on 11 traces 0.2 0.4 z [m]  0.6 0.8 1  Figure 15.69. Upper panel: Migration performed with Reflexw after background  1.2  removal on all the traces. Lower panel:  1.4 –0.5  0 x [m]  0.5  Migration performed with Reflexw after background removal on 11 the traces. The scenario is that of Figure 15.65.  15.9 2D AND 3D MIGRATION EXAMPLES WITH A SINGLE SET AND TWO CROSSED SETS OF B-SCANS Marcello Ciminale, Giovanni Leucci, Loredana Matera, and Raffaele Persico In this section we aim to show both a 2D and a 3D migration algorithm applied to field data. Moreover, since it can be an aspect of interest too, we will show both results achieved from a set of B-scans parallel to each other and from two sets of crossed B-scans. In this last case, quite common in GPR prospecting, the final result can be considered as achieved as some combination of the two images achieved from the two sets of B-scans. The data were gathered in the archaeological park of Egnazia (Apulia, Southern Italy). The park is one of the largest in Apulia. However, its importance lies  2D AND 3D MIGRATION EXAMPLES WITH A SINGLE SET AND TWO CROSSED SETS  305  BKG removal on all the traces 0.2 0.4  z [m]  0.6 0.8 1 1.2 1.4 –0.5  0  0.5  x [m] BKG removal and horizontal filtering 0.2 0.4 z [m]  0.6 0.8 1  Figure 15.70. Upper panel: The same  1.2  migration result of the upper panel in  1.4  Figure 15.69. Lower panel: The migration result of the upper panel after high-pass horizontal filtering.  –0.5  0  0.5  x [m]  not only in its extension, but also in the continuous frequentation that occurred over time, which is well-documented in the archaeological remains. The first occupation concerning Egnazia dates back to the Bronze Age; and after a period of abandonment, the site was occupied again. In particular, very important are the periods of Messapian (from 8th to 3rd century B.C.) and Roman (starting from the year 267 B.C.) civilizations. Testimonies of the Messapian period are the mighty defensive walls and the necropolis, while the main remains of the Roman town are the civil basilica, the amphitheater, an arcaded square, and the well-preserved cryptoporticus. The plunder and destruction (545 A.D.) carried out by Totila, the Goths’ king, could not impede a further rebirth of Egnazia, at least up to the 8th century A.D., when its definitive decline started. The GPR investigated area is a square zone sized 12 × 12 m2, located near an underground and accessible portico (the cryptoporticus) where a previous, more  306  NUMERICAL AND EXPERIMENTAL EXAMPLES  extended magnetic survey revealed, at a shallow depth, an articulated plan composed of a main rectangular building (15 m × 17 m) and several rooms connected to it (Caggiani et al., 2012). The GPR data have been gathered in the framework of a Ph.D. research activity in collaboration between the University of Bari and the Institute for Archaeological and Monumental Heritage IBAM-CNR and these data have been used to test an innovative stepped-frequency GPR system (Persico et al., 2013a). This innovative system has been projected by IBAM-CNR, IDS, and University of Florence within the research project AITECH (http://www.aitechnet.com/home.html), financed by the Puglia Region. Here, the purpose is to show the results achieved from both a 2D and a 3D migration algorithm on this area, exploiting data gathered with this prototypal system. The system at hand, in particular, is equipped with three equivalent couples of antennas, achieved by means of suitable switches programmable versus the frequency, according to the scheme of Figure 15.71. In particular, the equivalent comprehensive covered band ranges from 50 MHz to 1 GHz and the system can gather up to three sets of data for each going through, one with the “short antennas” one with the “medium antennas,” and one with the “long antennas.” As is well known, the band and the central frequency of each equivalent couple of antennas tend to increase when the antennas become shorter. With reference to the scheme of Figure 15.71, in this section we show results obtained from the “medium length” antennas, whose band (evaluated directly from the spectrum of the data) in the case at hand ranged between approximately 150 and 600 MHz.  External series of switches  Internal series of switches  “Short antenna” “Medium antenna” “Long antenna”  Figure 15.71. Schematic (nonquantitative) of the exploited reconfigurable GPR antennas. The system is equipped with “short antennas” if all the switches are open. It is equipped with “medium antennas” if the internal switches are closed and the external ones are open. It is equipped with “long antennas” if all the switches are closed.  2D AND 3D MIGRATION EXAMPLES WITH A SINGLE SET AND TWO CROSSED SETS  307  The data have been gathered with an interline space (transect) of 50 cm, and two sets of orthogonal B-scans have been gathered. With regard to the spatial step of the data along any single B-scan, for technical reasons, the system is equipped with an odometer that records both the position at which each burst is radiated, but does not guarantees by itself a constant spatial step during the data acquisition. This does not cause any undersampling problem because the maximum recorded spatial step is in any case small enough to avoid aliasing. However, in order to achieve data with a constant spatial step, a homemade interpolation code has been implemented. In the case at hand, we have interpolated the data with a 2-cm spatial step along each B-scan. The data have first undergone a 2D processing, essentially based on the 2D Kirchhoff migration in the time domain (the complete sequence of steps has been zero timing, background removal, and numerical gain variable versus the depth, migration, and time slicing). The processing has been implemented twice, the first time making use of the commercial software Reflexw (Sandmayer, 2003) and the second time with the commercial software GPRSLICE (Goodman and Piro, 2013). In Figure 15.72, three depth slices are obtained from the software Reflexw. The chosen depth is 47 cm, because it seemed to be the most interesting one. Some division wall structures are well visible, and an oblique rectangular anomaly may be ascribable to a floor. In Figure 15.73, the homologous of Figure 15.72 achieved from a 2D processing performed with GPRSLICE is shown. The fundamental anomalies in the two cases are the same, but some important differences also appear between the Refexw and the GPRSLICE results. In particular, the slices obtained with GPRSLICE appear more “definite” in the case at hand. Here, it is of interest to note that the use of crossed B-scan had in both cases a well-perceivable, even if not dramatic, effect. In particular, rather than “adding” features, the effect of the crossed B-scans seem to have cleaned the image. Let us now discuss the case of a 3D migration, performed again by means of GPRSLICE. In Figure 15.74 the results obtained from the x-directed B-scans, the y-directed B-scans, and both joined together are shown. Unlike the 2D cases, in Figure 15.74 it seems that the use of two crossed sets of of B-scans improves the image in a meaningful fashion. In the case at hand the 2D migration-based images appear better than the image obtained from a 3D migration-based image. However, this should not lead to the precipitous conclusion that 2D algorithms are better than 3D ones. Indeed, a nonnegligible point is the fact that the transect is much larger than one-fourth of the central wavelength, which for the 3D cases yields a meaningful undersampling. On the other hand, the data have been obtained with a GPR system able to gather data along a single B-scan for each going-through, and so it would have been experimentally prohibitive to gather data with an adequate interline step. Things are probably going to change in the future with a larger use of GPR systems equipped with arrays of antennas. In this case, it is possible to gather up to 14 or more parallel B-scans with an interline space of the order of 10 cm (Sala and Linford, 2010) with a unique “going-through.” Under these conditions, the performance of a 3D migration algorithm versus field data can improve meaningfully.  Y-Distance [Meter] 3 2 1 0 0  XM00100010.00T  12 11 10 9 8 7 6 5 4  10  Y-Distance [Meter] 3 2 1 0 0  YM00100010.00T  12 11 10 9 8 7 6 5 4  10  Y-Distance [Meter] 3 2 1 0 0  XYMBIS00100010.00T  12 11 10 9 8 7 6 5 4  10  Figure 15.72. Depth slices at 47 cm obtained with Reflexw through a 2D migration-based processing. Upper panel: Result obtained from the B-scans parallel to only the x-axis. Middle panel: Result obtained from the B-scans parallel to only the y-axis. Lower panel: Result obtained from the B-scans parallel to both the x-axis and the y-axis. The axes are in meters. For color detail, please see color plate section.  0  2  4  6  8  10  12  0  2  4  6  8  10  12  0  2  4  6  8  10  12  0 2 4 6 8 10 12  0 2 4 6 8 10 12 0 2 4 6 8 10 12  Figure 15.73. Depth slices at 47 cm obtained with GPRSLICE through 2D migration-based processing. Upper panel: Result obtained from the B-scans parallel to only the x-axis. Middle panel: Result obtained from the B-scans parallel to only the y-axis. Lower panel: Result obtained from the B-scans parallel to both the x-axis and the y-axis. The axes are in meters. For color detail, please see color plate section.  0  2  4  6  8  10  12  0  2  4  6  8  10  12  0  2  4  6  8  10  12  0 2 4 6 8 10  0 2 4 6 8 10  0 2 4 6 8 10  Figure 15.74. Depth slices at 47 cm obtained with GPRSLICE through a 3D migration-based processing. Upper panel: Result obtained from the B-scans parallel to only the x-axis. Middle panel: Result obtained from the B-scans parallel to only the y-axis. Lower panel: Result obtained from the B-scans parallel to both the x-axis and the y-axis. The axes are in meters. For color detail, please see color plate section.  2D AND 3D INVERSION EXAMPLES  15.10  311  2D AND 3D INVERSION EXAMPLES  Ilaria Catapano and Raffaele Persico This section aims at investigating a full 3D linear inversion-based GPR data processing versus the commonly adopted pseudo 3D imaging, which is achieved by interpolating 2-D reconstructions obtained by processing independently the radargrams collected along each B-scan, as shown in the previous section. We will show both tests with synthetic and experimental data. In the first examples, synthetic data are considered. These data have been generated by means of the free software GPRMAX (the 3D version). In particular, let us now refer to the case of a square box, whose side is 2 m long, filled by dry sand having relative permittivity εB = 4 and conductivity σB = 10 m S/m, hosting one or more voids with different shape. The data have been acquired along five parallel 1.5-m-long measurement lines and moving the antenna system in seven different positions spaced 0.25 m apart. This spatial step is electrically large (as it will be clear in a while), but this example is introductive. The offset between the antennas is 0.25 m too. The simulated primary source is a y-oriented Hertzian dipole, according to the reference system introduced in Figure 11.1, that is fed with a Richer pulse signal having central frequency fc = 300 MHz. The data have been simulated by assuming a time windows of 45 ns and discretizing the box with cubes whose edge is 0.02 m long. For the inversion, the investigation domain has been discretized in 3D cells with edge equal to 0.0625 m. The simulated data have been pre-processed by means of a background removal filtering procedure. Moreover, since the inversion procedure works in the frequency domain, a discrete Fourier transform has been applied to transform the filtered time domain data; and the meaningful bandwidth, which ranges between fmin = 150 MHz and fmax = 450 MHz, has been sampled with a frequency offset of 30 MHz (11 frequencies). As a first example, let us consider the case of two voids both having size 0.30 m × 0.30 m × 0.5 m and centered in (−0.25 m, −0.25 m, 0.5 m) and (0.25 m, 0.25 m, 0.5 m), respectively (see Figure 15.75). The reconstruction obtained by applying the full 3D imaging approach are shown in Figure 15.76 panels a and b, while those provided by the interpolation of the 2D results are in Figure 15.77, panels a and b. The reconstruction figures show the amplitude of the reconstructed contrast function normalized to its maximum value. By comparing these images, we see that, in the case at hand, the use of a full 3D imaging procedure allows an improvement of the localization and shape reconstruction of the upper side of the objects. As a second case, we have considered an L-shaped cavity, made of two parallelepipeds having size 0.25 m × 0.80 m × 0.25 m and 0.55 m × 0.25 m × 0.25 m, respectively, hidden into the sandy box as shown in Figure 15.78, panels a and b. The reconstruction obtained with the full 3D imaging approach is shown in Figure 15.79, panels a and b, while that provided by the interpolation of the 2D results is in Figure 15.80, panels a and b. By comparing these figures, we can clearly appreciate the advantages offered by the use of a full 3D data processing procedure. As a matter of fact, it allows us to correctly estimate the shape of the target (more precisely, the shape of its upper face) as well as its size in the (x, y) plane.  (a)  1  –0.5  0 0.5 –1  –0.5  0 x [m] z = 1.9355  –0.5  0 0.5 –1  0 x [m]  1  –0.5  1  0 x [m] z = 1.6774  –0.5  0 0.5 –1  0 x [m]  1  z = 1.3548  0 x [m] z = 1.7419  –0.5  0.5 –1  0 x [m]  –0.5  1  z=2  0 0.5 –1  0 x [m]  y [m]  –0.5 y [m]  0 x [m] z = 1.4194  1  Figure 15.75. Reference profile. Panel a: Depth slices.  0 x [m] z = 1.8065  –0.5  –0.5  0 0.5 –1  0 x [m]  1  0 x [m] z = 1.0968  1  0 x [m]  1  z = 1.4839  0 0.5 –1  1  1  0 0.5 –1  1  0 x [m] z = 0.70968  0 0.5 –1  1  0 0.5 –1  1  0  –0.5  0 0.5 –1  1  y [m]  y [m] y [m]  0 x [m]  0 0.5 –1  1  –0.5  0 x [m] z = 1.0323  z = 0.32258  0 0.5 –1  1  y [m]  –0.5  0.5 –1  1  0 x [m] z = 0.64516  0  y [m]  y [m] y [m] y [m]  y [m] y [m] y [m]  0 x [m]  z = 1.2903  –0.5  0 0.5 –1  1  0 0.5 –1  1  0 0.5 –1  1  0 x [m] z = 1.6129  0 x [m]  0 x [m] z = 0.96774  –0.5  y [m]  –0.5  0 x [m] z = 1.5484  –0.5  0 0.5 –1  –0.5  0.5 –1  1  0 0.5 –1  1  0 x [m] z = 0.58065  z = 0.25806  0  y [m]  0 0.5 –1  z = 1.2258  –0.5  0 0.5 –1  1  0 x [m] z = 0.90323  –0.5  y [m]  –0.5  0.5 –1  z = 0.19355  0 0.5 –1  1  y [m]  z = 1.1613  0 x [m]  0 x [m] z = 0.51613  0  –0.5  0 0.5 –1  1  –0.5  1  –0.5  y [m]  –0.5  0 x [m]  0 x [m] z = 0.83871  z = 0.12903  0 0.5 –1  1  y [m]  y [m]  –0.5  0 0.5 –1  0 x [m] z = 0.45161  0 0.5 –1  1  –0.5  y [m]  y [m] y [m]  –0.5  y [m]  y [m]  –0.5  0 x [m] z = 0.77419  z = 0.064516  0 0.5 –1  1  0 0.5 –1  y [m]  0 x [m] z = 0.3871  y [m]  y [m]  –0.5  y [m]  –0.5  0 0.5 –1  y [m]  z=0  y [m]  y [m]  –0.5  0 x [m] z = 1.871  1  0 x [m]  1  0 0.5 –1  (b)  2 1.8 1.6 1.4  z [m]  1.2 1 0.8 0.6 0.4 0.2 0 0.5 0 y [m] –0.5  –1  –0.8  –0.6  –0.4  –0.2  0 x [m]  Figure 15.75. (Continued) Panel b: 3D view.  0.2  0.4  0.6  0.8  1  (a)  –0.5  0 0.5 –1 –0.5  0 x [m] z = 1.9355  0 x [m]  –0.5  1  –0.5  0 x [m] z=2  1  0 x [m]  1  0 x [m] z = 1.6774  –0.5  0 0.5 –1  0 x [m]  1  –0.5  –0.5  0 0.5 –1  0 x [m]  1  y [m] y [m]  0 x [m] z = 1.8065  –0.5  0 x [m]  –0.5  Figure 15.76. Full 3D linear inversion reconstruction. Panel a: Depth slices.  1  0 x [m] z = 1.0968  1  0 x [m] z = 1.4839  1  0 x [m] z = 1.871  1  0 x [m]  1  0 0.5 –1  1  1  0 0.5 –1  1  0 0.5 –1  0 0.5 –1  –0.5  0 0.5 –1  1  0 x [m] z = 1.4194  0 x [m] z = 0.70968  0 0.5 –1  1  y [m]  y [m] y [m] y [m]  0 x [m] z = 1.7419  –0.5  0 0.5 –1  1  0 0.5 –1  1  –0.5  0 x [m] z = 1.0323  z = 0.32258  0 0.5 –1  1  y [m]  –0.5  0 x [m] z = 1.3548  0 x [m] z = 0.64516  0 0.5 –1  1  0 0.5 –1  1  –0.5  y [m]  y [m] y [m]  0 x [m] z = 1.2903  0 0.5 –1  1  y [m]  y [m] y [m] y [m]  0 x [m] z = 1.6129  0 0.5 –1  1  0 0.5 –1  0.5 –1  1  –0.5  0  –0.5  0 x [m] z = 0.96774  –0.5  0 0.5 –1  1  0 0.5 –1  1  0 0.5 –1  1  –0.5  0 x [m] z = 0.58065  z = 0.25806  y [m]  –0.5  0 x [m] z = 1.5484  0 x [m] z = 1.2258  0 x [m] z = 0.90323  –0.5  y [m]  –0.5  0 0.5 –1  0.5 –1  1  0.5 –1  z = 0.19355  0 0.5 –1  1  0  –0.5  0  0 x [m] z = 0.51613  y [m]  –0.5  0 x [m] z = 1.1613  –0.5  1  –0.5  y [m]  0.5 –1  0 x [m] z = 0.83871  z = 0.12903  0 0.5 –1  1  y [m]  y [m]  –0.5  0  0 x [m] z = 0.45161  0 0.5 –1  1  –0.5  y [m]  y [m] y [m]  –0.5  y [m]  y [m]  –0.5  0 x [m] z = 0.77419  z = 0.064516  0 0.5 –1  1  0 0.5 –1  y [m]  0 x [m] z = 0.3871  y [m]  y [m]  –0.5  y [m]  –0.5  0 0.5 –1  y [m]  z=0  y [m]  y [m]  –0.5  0 0.5 –1  (b)  2 1.8 1.6 1.4  z [m]  1.2 1 0.8 0.6 0.4 0.2 0 0.5 0 y [m] –0.5  –1  –0.8  –0.6  –0.4  –0.2  0 x [m]  Figure 15.76. (Continued) Panel b: 3D view.  0.2  0.4  0.6  0.8  1  (a)  –0.5  0 x [m] z = 1.5484  1  –0.5  0 0.5 –1 –0.5  0 x [m] z = 1.9355  –0.5  0 0.5 –1  0 x [m]  1  –0.5  0 x [m] z=2  1  0 x [m]  1  0 x [m] z = 1.6774  –0.5  0 0.5 –1  0 x [m]  1  –0.5  –0.5  0 0.5 –1  0 x [m]  1  y [m] y [m]  0 x [m] z = 1.4194  0 x [m] z = 1.8065  0.5 –1  0.5 –1 –0.5  0 x [m]  0.5 –1 –0.5  0 x [m] z = 1.0968  1  0 x [m] z = 1.4839  1  0 x [m] z = 1.871  1  0 x [m]  1  0 0.5 –1  1  –0.5  1  0 0.5 –1  1  0  1  0  0 x [m] z = 0.70968  0  1  0 0.5 –1  1  –0.5  y [m]  y [m] y [m] y [m]  0 x [m] z = 1.7419  1  0 0.5 –1  1  0 0.5 –1  1  –0.5  0 x [m] z = 1.0323  z = 0.32258  0 0.5 –1  y [m]  –0.5  0 x [m] z = 1.3548  0 x [m] z = 0.64516  0 0.5 –1  1  0 0.5 –1  1  –0.5  y [m]  y [m] y [m]  0 x [m] z = 1.2903  0 0.5 –1  1  y [m]  y [m] y [m]  0 x [m] z = 1.6129  0 0.5 –1  1  –0.5  0 0.5 –1  –0.5  0 x [m] z = 0.96774  –0.5  0 0.5 –1  1  0 0.5 –1  1  0 0.5 –1  1  –0.5  0 x [m] z = 0.58065  z = 0.25806  y [m]  0.5 –1  –0.5  0 x [m] z = 0.90323  –0.5  y [m]  –0.5  0  0 x [m] z = 1.2258  1  z = 0.19355  0 0.5 –1  y [m]  1  0 x [m] z = 0.51613  0 0.5 –1  1  –0.5  y [m]  –0.5  0 x [m] z = 1.1613  0 x [m] z = 0.83871  0 0.5 –1  y [m]  0.5 –1  –0.5  y [m]  –0.5  0  1  0 0.5 –1  1  0 x [m] z = 0.45161  z = 0.12903  0 0.5 –1  y [m]  0 x [m] z = 0.77419  –0.5  y [m]  y [m] y [m]  –0.5  y [m]  –0.5 y [m]  1  0 0.5 –1  y [m]  0 x [m] z = 0.3871  z = 0.064516  0 0.5 –1  y [m]  y [m]  –0.5  y [m]  –0.5  0 0.5 –1  y [m]  z=0  y [m]  y [m]  –0.5  Figure 15.77. Tomographich reconstruction via 2D slice reconstruction method. Panel a: Depth slices.  0 0.5 –1  (b)  2 1.8 1.6 1.4  z [m]  1.2 1 0.8 0.6 0.4 0.2 0 0.5 0 y [m] –0.5  –1  –0.8  –0.6  –0.4  –0.2  0 x [m]  Figure 15.77. (Continued) Panel b: 3D view.  0.2  0.4  0.6  0.8  1  (a)  –0.5  0 0.5 –1 –0.5  0 x [m] z = 1.9355  0 x [m]  –0.5  1  –0.5  0 x [m] z=2  1  0 x [m]  1  0 x [m] z = 1.6774  –0.5  0 0.5 –1  0 x [m]  1  –0.5  –0.5  0 0.5 –1  0 x [m]  1  y [m] y [m]  –0.5  0 x [m] z = 1.8065  –0.5  0.5 –1  Figure 15.78. Reference profile. Panel a: Depth slices.  0 x [m]  –0.5  1  0 x [m] z = 1.0968  1  0 x [m] z = 1.4839  1  0 x [m] z = 1.871  1  0 x [m]  1  0 0.5 –1  1  1  0 0.5 –1  1  0  0 0.5 –1  0 x [m] z = 1.4194  0 x [m] z = 0.70968  0 0.5 –1  1  0 0.5 –1  1  y [m]  y [m] y [m] y [m]  0 x [m] z = 1.7419  –0.5  0 0.5 –1  1  0 0.5 –1  1  –0.5  0 x [m] z = 1.0323  z = 0.32258  0 0.5 –1  1  y [m]  –0.5  0 x [m] z = 1.3548  0 x [m] z = 0.64516  0 0.5 –1  1  0 0.5 –1  1  –0.5  y [m]  y [m] y [m]  0 x [m] z = 1.2903  0 0.5 –1  1  y [m]  y [m] y [m] y [m]  0 x [m] z = 1.6129  0 0.5 –1  1  0 0.5 –1  0.5 –1  1  –0.5  0 x [m] z = 0.96774  –0.5  0 0.5 –1  1  0 0.5 –1  1  0 x [m] z = 0.58065  z = 0.25806  y [m]  –0.5  0 x [m] z = 1.5484  –0.5  0  –0.5  0 0.5 –1  1  0 x [m] z = 0.90323  –0.5  y [m]  0.5 –1  0.5 –1  z = 0.19355  0 0.5 –1  1  y [m]  –0.5  0  0 x [m] z = 1.2258  0 x [m] z = 0.51613  0  –0.5  0 0.5 –1  1  –0.5  1  –0.5  y [m]  –0.5  0 x [m] z = 1.1613  0 x [m] z = 0.83871  z = 0.12903  0 0.5 –1  1  y [m]  y [m]  –0.5  0 0.5 –1  0 x [m] z = 0.45161  0 0.5 –1  1  –0.5  y [m]  y [m] y [m]  –0.5  y [m]  y [m]  –0.5  0 x [m] z = 0.77419  z = 0.064516  0 0.5 –1  1  0 0.5 –1  y [m]  0 x [m] z = 0.3871  y [m]  y [m]  –0.5  y [m]  –0.5  0 0.5 –1  y [m]  z=0  y [m]  y [m]  –0.5  0 0.5 –1  (b)  2 1.8 1.6 1.4  z [m]  1.2 1 0.8 0.6 0.4 0.2 0 0.5 0 y [m] –0.5  –1  –0.8  –0.6  –0.4  –0.2  0 x [m]  Figure 15.78. (Continued) Panel b: 3D view.  0.2  0.4  0.6  0.8  1  (a)  –0.5  0 x [m] z = 1.5484  –0.5  0 0.5 –1 –0.5  0 x [m] z = 1.9355  0 x [m]  –0.5  1  –0.5  0 x [m] z=2  1  0 x [m]  1  0 x [m] z = 1.6774  1  –0.5  0 0.5 –1  0 x [m]  1  –0.5  –0.5  0 0.5 –1  0 x [m]  1  y [m] y [m]  0 x [m] z = 1.8065  –0.5  0.5 –1  0 x [m]  –0.5  Figure 15.79. Full 3D linear inversion reconstruction. Panel a: Depth slices.  1  0 x [m] z = 1.0968  1  0 x [m] z = 1.4839  1  0 x [m] z = 1.871  1  0 x [m]  1  0 0.5 –1  1  1  0 0.5 –1  1  0  0 0.5 –1  –0.5 y [m]  0 x [m] z = 1.4194  0 x [m] z = 0.70968  0 0.5 –1  1  0 0.5 –1  1  –0.5  y [m]  y [m] y [m]  0 x [m] z = 1.7419  0 x [m] z = 1.0323  z = 0.32258  0 0.5 –1  1  0 0.5 –1  1  0 0.5 –1  0.5 –1  y [m]  y [m] y [m]  –0.5  0 x [m] z = 1.3548  0 x [m] z = 0.64516  0  –0.5  0 0.5 –1  1  0 0.5 –1  1  y [m]  y [m] y [m] y [m]  0 x [m] z = 1.6129  0 0.5 –1  1  0 0.5 –1  0 0.5 –1  1  –0.5  0 x [m] z = 1.2903  –0.5  1  –0.5  y [m]  0.5 –1  –0.5  0 x [m] z = 0.96774  z = 0.25806  0 0.5 –1  1  0 0.5 –1  1  0 0.5 –1  1  –0.5  0 x [m] z = 0.58065  y [m]  –0.5  0  0 x [m] z = 1.2258  0 x [m] z = 0.90323  –0.5  y [m]  1  0.5 –1  z = 0.19355  0 0.5 –1  1  0  –0.5  0 0.5 –1  0 x [m] z = 0.51613  y [m]  –0.5  0 x [m] z = 1.1613  –0.5  1  –0.5  y [m]  0.5 –1  0 x [m] z = 0.83871  z = 0.12903  0 0.5 –1  1  y [m]  y [m]  –0.5  0  0 x [m] z = 0.45161  0 0.5 –1  1  –0.5  y [m]  y [m] y [m]  –0.5  y [m]  y [m]  –0.5  0 x [m] z = 0.77419  z = 0.064516  0 0.5 –1  1  0 0.5 –1  y [m]  0 x [m] z = 0.3871  y [m]  y [m]  –0.5  y [m]  –0.5  0 0.5 –1  y [m]  z=0  y [m]  y [m]  –0.5  0 0.5 –1  (b)  2 1.8 1.6 1.4  z [m]  1.2 1 0.8 0.6 0.4 0.2 0 0.5 0 y [m] –0.5  –1  –0.8  –0.6  –0.4  –0.2  0 x [m]  Figure 15.79. (Continued) Panel b: 3D view.  0.2  0.4  0.6  0.8  1  (a)  –0.5  0 0.5 –1 –0.5  0 x [m] z = 1.9355  –0.5  0 0.5 –1  0 x [m]  1  –0.5  0 x [m] z=2  1  0 x [m]  1  0 x [m] z = 1.6774  –0.5  0 0.5 –1  0 x [m]  1  –0.5  –0.5  0 0.5 –1  0 x [m]  1  y [m] y [m]  –0.5  0 x [m] z = 1.4194  0 x [m] z = 1.8065  –0.5  –0.5  0 0.5 –1  0 x [m]  1  0 0.5 –1  Figure 15.80. Tomographic reconstruction via 2D slice reconstruction method. Panel a: Depth slices.  0 x [m] z = 1.0968  1  0 x [m] z = 1.4839  1  0 x [m] z = 1.871  1  0 x [m]  1  0 0.5 –1  1  1  0 0.5 –1  1  0 0.5 –1  1  1  0 x [m] z = 0.70968  0 0.5 –1  y [m]  y [m] y [m] y [m]  0 x [m] z = 1.7419  –0.5  0 0.5 –1  1  0 0.5 –1  1  –0.5  0 x [m] z = 1.0323  z = 0.32258  0 0.5 –1  1  y [m]  –0.5  0 x [m] z = 1.3548  0 x [m] z = 0.64516  0 0.5 –1  1  0 0.5 –1  1  –0.5  y [m]  y [m] y [m]  0 x [m] z = 1.2903  0 0.5 –1  1  y [m]  y [m] y [m] y [m]  0 x [m] z = 1.6129  0 0.5 –1  1  –0.5  0 0.5 –1  1  0.5 –1  1  0 x [m] z = 0.96774  –0.5  0 0.5 –1  1  0 0.5 –1 –0.5  0  0 x [m] z = 0.58065  z = 0.25806  y [m]  –0.5  0 x [m] z = 1.5484  0 x [m] z = 1.2258  –0.5  1  –0.5  y [m]  –0.5  0 0.5 –1  0.5 –1  1  0 x [m] z = 0.90323  z = 0.19355  0 0.5 –1  1  0 0.5 –1 –0.5  0  0 x [m] z = 0.51613  y [m]  –0.5  0 x [m] z = 1.1613  –0.5  1  –0.5  y [m]  0.5 –1  0 x [m] z = 0.83871  z = 0.12903  0 0.5 –1  1  y [m]  y [m]  –0.5  0  0 x [m] z = 0.45161  0 0.5 –1  1  –0.5  y [m]  y [m] y [m]  –0.5  y [m]  y [m]  –0.5  0 x [m] z = 0.77419  z = 0.064516  0 0.5 –1  1  0 0.5 –1  y [m]  0 x [m] z = 0.3871  y [m]  y [m]  –0.5  y [m]  –0.5  0 0.5 –1  y [m]  z=0  y [m]  y [m]  –0.5  0 0.5 –1  (b)  2 1.8 1.6 1.4  z [m]  1.2 1 0.8 0.6 0.4 0.2 0 0.5 0 y [m] –0.5  –1  –0.8  –0.6  –0.4  –0.2  0 x [m]  Figure 15.80. (Continued) Panel b: 3D view.  0.2  0.4  0.6  0.8  1  NUMERICAL AND EXPERIMENTAL EXAMPLES  324  Let us now consider an example concerning experimental data. The experiment has been carried out at the Electromagnetic Diagnostic Laboratory of IREA-CNR. The data have been gathered by using a GPR system, manufactured by IDS Corporation, working in the time domain and equipped with a single polarization antenna pair with central frequency fc = 2 GHz. The antenna has been manually moved along the upper surface of a solid polystyrene box wherein the object to be imagedP was concealed. The data have been collected over a rectangular measurement domain = 30 × 30 cm2 at height h = 0.001 m above the air–polystyrene interface. The measurements were taken with a spatial discretization step equal to 0.05 m along both the x- and y- axis (49 points) in a time window of 32 ns, which was sampled in 512 points spaced 0.0625 ns from each other. The measured data had been pre-processed by means of a background removal filtering procedure in order to eliminate the direct coupling between the antennas and the signal due to  (a) 0 –10  σn/σ0 (dB)  –20 –30 –40 –50 –60 –70  0  100  200  300  400  500  n  (b) 0 –5 –10  σn/σ0 (dB)  –15 –20 –25 –30 –35 –40 –45 –50  0  10  20  30  40 n  50  60  70  80  Figure 15.81. Singular values of the discretized operator: (a) Full 3D case; and (b) 2D case.  2D AND 3D INVERSION EXAMPLES  325  the air–polystyrene interface, and then they were transformed into the frequency domain. The frequency range [850, 1950] MHz with a step of 110 MHz (11 points) has been considered for the inversion. The relative permittivity of the box εB is assumed constant and equal to 2.7. With regard to the selection of the investigation region Ω to be used for the full 3D inversion, it is a cubic domain with edge 0.6 m and its discretization for the pixel basis expansion has been set to 0.02 m along x, y, and z directions. The following example accounts for a U-shaped chipboard object made by three parallelepipeds, each of which are 0.2 × 0.05 × 0.02 m3and located about 0.1 m apart from the air–polystyrene interface. The typical value of the relative dielectric permittivity of the chipboard is around 2, so the object is likely to act as a weak scattering target. Such an example enables a comparison between the imaging capabilities of the full 3D inversion strategy and the 2D slice reconstruction one. In this respect, the amplitude (b)  0  0  0.2 0.4 x [m]  (e)  0  y [m]  (g)  0.2 0.4 x [m]  (f)  0  0  0.2 0.4 x [m]  (h)  0 0.2 0.4  0  0.2 0.4 x [m]  0.2 0.4 x [m]  0.6  (i)  0 0.2  0.6  0.2 0.4 x [m]  0.6  0  0.2 0.4 x [m]  0.6  0  0.2 0.4 x [m]  0.6  0  0.4 0.6  0.6  0.4  0  0  0.2  0.4 0.6  0.6  0.4 0.6  0.6  y [m]  y [m]  0.4  0.6  0  0.2  y [m]  y [m]  0.2  0.6  0.4 0.6  0.6  0  0.2 y [m]  0.4 0.6  (d)  0.2 y [m]  y [m]  0.2  (c)  0  y [m]  (a)  0 0.2 0.4  0  0.2 0.4 x [m]  0.6  0.6  Figure 15.82. Full 3D tomographic reconstruction of the chipboard C. (a) z = 0.02 m, (b) z = 0.04 m, (c) z = 0.06 m, (d) z = 0.08 m, (e) z = 0.1 m, (f ) z = 0.12 m, (g) z 0.14 m, (h) z = 0.16 m, (i) z = 0.18 m.  NUMERICAL AND EXPERIMENTAL EXAMPLES  326  (a)  (b)  0.3 0.4 0.2 0.4 x [m]  0.6  (d)  0.2 0.4 x [m]  0.6  (e)  0.3 0.4  0  0.2 0.4 x [m]  0.6  (g)  0.2 0.4 x [m]  y [m]  y [m] 0.2 0.4 x [m]  0.6  0.6  0  0.2 0.4 x [m]  0.6  0.2  0.3 0.4  0  0.2 0.4 x [m]  (i) 0.2  0.4  0  0.3  0.6  (h)  0.3  0.6  0.4 0  0.2  0.2 0.4 x [m]  0.2 y [m]  y [m]  0.4  0  (f) 0.2  0.3  0.3 0.4  0  0.2 y [m]  0.3 0.4  0  y [m]  0.2 y [m]  0.2 y [m]  y [m]  0.2  (c)  0.3 0.4  0  0.2 0.4 x [m]  0.6  Figure 15.83. Tomographic reconstructions of the chipboard C via the 2D slice reconstruction method. (a) z = 0.02 m, (b) z = 0.04 m, (c) z = 0.06 m, (d) z = 0.08 m, (e) z = 0.1 m, (f ) z = 0.12 m, (g) z = 0.14 m, (h) z = 0.16 m, (i) z = 0.18 m.  of the reconstructed contrast χ() is shown over cut planes XY located at different depths with respect to the interface. According to Figure 15.81, panels a and b, which show the behavior of the singular values of the discretized version of the 3D and 2Dlinear operators, respectively, the provided reconstructions have been obtained by setting the threshold in a specific manner to neglect the singular values that are lower than −20 dB with respect to the first one. Figure 15.82 shows the reconstructions attained with the full 3D linear imaging approach. As can be seen, the object can be clearly identified at a depth of about 0.1 m. Moreover, its size can be estimated from this reconstruction, and it closely resembles the actual one. The results of the 2D slice reconstruction algorithm are shown in Figure 15.83. From Figure 15.83, we can detect the presence of a buried target, but its actual shape cannot be identified at all.  APPENDICES  APPENDIX A Raffaele Persico and Raffaele Solimene  The purpose of this appendix is to show that sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ  2 ﬃ !  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2ω 2ω 2 z0 exp j − η +∞ +∞ ð ð exp j ðx − x0 Þ2 + z0 2 + y2 c c sﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ expð − jηðx − x0 ÞÞ dη = dy  2 ﬃ 0 Þ2 + z0 2 + y2 2ω ð x − x −∞ −∞ j − η2 c ðA:1Þ To do that, let us start from the following equation: r2 Gðx,y,zÞ + k2 Gðx, y, zÞ = − δðx − x0 Þδðy − y0 Þδðz− z0 Þ  ðA:2Þ  Equation (A.2) is, as is well known, the equation of the three-dimensional scalar Green’s function in a homogeneous medium with wavenumber k. Let us Fourier transform Eq. (A.2) according to the convention ^^ ^ðk1 ,k2 ,k3 Þ = G  +∞ ð +∞ ð +∞ ð  Gðx, y, zÞexpð − jxk1 − jyk2 − jzk3 Þ dxdydz  ðA:3Þ  −∞ −∞ −∞  In the transformed domain, Eq. (A.2) can be rewritten as    !   ^^ ^^ ^ðk1 ,k2 ,k3 Þ = − ^ðk1 ,k2 ,k3 Þ = − exp − jkr!0 ) G k2 − k12 − k22 − k32 G   !  ! exp − jkr 0   k 2 − k12 + k22 + k32 ðA:4Þ  !  !  where k = k1 ix + k2 iy + k3 iz and r 0 = x0 ix + y0 iy + z0 iz . The multiplication dot stands for scalar product. Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  329  APPENDIX A  330  Considering the inverse Fourier transform of Eq. (A.4), we have  Gðx,y,zÞ = −  =−  1 8π 3  1 8π 3  +∞ ð +∞ ð +∞ ð  −∞ −∞ −∞ +∞ ð +∞ ð +∞ ð  −∞ −∞ −∞   !  ! ! exp j k  r −r 0   dk1 dk2 dk3 k 2 − k12 + k22 + k32  !  ! ! exp −j k r −r 0   dk1 dk2 dk3 k 2 − k12 + k22 + k32  ðA:5Þ  !  !  !  where r = xix + yiy + ziz and, in Eq. (A.5), a change of integration variable from k to − k has been performed too. Now, let us rewrite Eq. (A.5) as Gðx,y, zÞ 1 =− 2× 4π  +∞ ð +∞ ð  −∞ −∞  1 expð −jk1 ðx −x0 Þ−jk2 ðy −y0 ÞÞdk1 dk2 2π  +∞ ð  −∞  	  expð − jk3 ðz −z0 ÞÞ    dk3 k 2 − k12 + k22 −k32 ðA:6Þ  The integral in dk3 is calculable on the basis of the theory of the residuals and of Jordan’s lemma. They are both well known, so they will taken for granted here. In particular, qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ   since the poles of the function are placed at k3 = ± kz = ± k 2 − k12 + k22 , the result of the integral is j Gðx, y,zÞ = − 2 8π  +∞ ð +∞ ð  −∞ −∞  expð −jk1 ðx −x0 Þ − jk2 ðy −y0 ÞÞ expð −jkz jz− z0 jÞ dk1 dk2 ðA:7Þ kz  At this point, Eq. (A.1) can be rewritten in spherical coordinative as  ! !   r2 Gðr,θ,φÞ + k 2 Gðr,θ,φÞ = −δ r − r0   ðA:8Þ  Due to the intrinsic symmetries of Eq. (A.8), it is licit to postulate a solution that depends only on the distance between the observation point and the source; thus, under the change ! ! ! of variable r 1 = r −r0 , we have r2 Gðr1 Þ + k 2 Gðr1 Þ = −δðr1 Þ  ðA:9Þ  Making use of the expression of the scalar Laplacian operator in polar coordinates in the case of no dependence from the angular coordinates, we rewrite Eq. (A.9) as (Collin, 1985)  APPENDIX A  331  d2 2 d Gðr1 Þ + Gðr1 Þ + k2 Gðr1 Þ = − δðr1 Þ r1 dr1 dr12  ðA:10Þ  Let us now examine the associated homogeneous equation: d2 2 d Gðr1 Þ + Gðr1 Þ + k2 Gðr1 Þ = 0 r1 dr1 dr12  ðA:11Þ  The general solution is in this case is easily found after putting Gðr1 Þ = gðr1 Þ=r1 and substituting in Eq. (A.11). This yields to a harmonic equation in the unknown g(r1) and consequently we obtain Gðr1 Þ = C  e −jkr1 e + jkr1 +D r1 r1  ðA:12Þ  Since waves propagate away from the sources toward the infinite but not vice versa, there is only one physically meaningful term, so that necessarily we have D = 0 and Eq. (A.12) is rewritten as Gðr1 Þ = C  e − jkr1 r1  ðA:13Þ  Of course, Eq. (A.13) also represents the solution with an impulsive source [i.e., the solution of Eq. (A.10)] in any point except the origin, where the impulsive source makes the function singular. The integration of Eq. (A.9) about the source provides the value of the constant C. In fact, substituting the solution (A.13) into Eq. (A.9) and considering the volume integral within a small sphere centered about the origin, we obtain ððð rr  C  e − jkr1 dV + C r1  V  ððð k2  e − jkr1 dV = − r1  V  ððð δðr1 Þ = − 1  ðA:14Þ  V  The second integral term vanishes for r1 ! diverges as the  0 because the integrand  inverse of the ray but the volume element r12 sin ðθÞ dθdφ dr1 vanishes more rapidly. Using the Gauss divergence theorem, we obtain ððð rr V  e −jkr1 dV = r1  ðð r S  e − jkr1 dS = r1  ðð  d e − jkr1 d e − jkr1 dS = 4πr12 dr1 r1 dr1 r1  S  Substituting (A.15) into (A.14), and taking the limit of r1 ! 0, we obtain  ðA:15Þ  APPENDIX A  332  2 6 d e − jkr1 6 lim 6C4πr12 r1 !0 4 dr1 r1 2  3 !0 zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ ﬄ }|ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ{ ððð 7 e − jkr1 7 +C k2 dV 7 = − 1 ) 5 r1 V  0  13 jk 1 ) lim C44πr12 e −jkr1 @ − − 2 A5 = − 1 r1 !0 r1 r1  ðA:16Þ  which becomes C=  1 4π  ðA:17Þ  So, the final solution of Eq. (A.13) is pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2 2 2 e − jkr1 e − jkkr − r0 k e − jk ðx − x0 Þ + ðy− y0 Þ + ðz − z0 Þ   Gðx, y, zÞ = = = qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 4πr1 4π r!− r!0  4π ðx − x Þ2 + ðy − y Þ2 + ðz − z Þ2 !  !  0  0  ðA:18Þ  0  The comparison between Eq. (A.7) and Eq. (A.18) provides the equality pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ +∞ 2 2 2 ð ð +∞ e −jk ðx − x0 Þ + ðy − y0 Þ + ðz − z0 Þ 1 expð − jk1 ðx − x0 Þ− jk2 ðy − y0 Þ− jkz jz− z0 jÞ qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ = dk1 dk2 kz 2jπ 2 2 2 ðx − x0 Þ + ðy − y0 Þ + ðz− z0 Þ −∞ −∞  ðA:19Þ Integrating Eq. (A.19) in the variable y − y0 we obtain pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ 2 2 2 e −jk ðx− x0 Þ + y + ðz − z0 Þ qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ dy ðx − x0 Þ2 + y2 + ðz − z0 Þ2 −∞ +∞ ð  1 = 2jπ 1 = 2jπ  +∞ ð +∞ ð +∞ ð  −∞ −∞ −∞ +∞ ð +∞ ð  −∞ −∞ +∞ ð ð +∞  expð − jk1 ðx − x0 Þ − jk2 y − jkz jz − z0 jÞ dk1 dk2 dy kz  expð − jk1 ðx −x0 Þ − jkz jz − z0 jÞ dk1 dk2 kz  +∞ ð  expð − jk2 yÞ dy −∞  expð − jk1 ðx − x0 Þ − jkz jz − z0 jÞ δðk2 Þ dk1 dk2 kz −∞ −∞   pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ +∞ ð exp − jk1 ðx − x0 Þ − j k 2 − k2 jz− z0 j 1 pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ dk1 = 2 2 j k − k1 =  1 j  −∞  ðA:20Þ  APPENDIX A  333  Equation (A.20) holds for any value of x − x0, k, and z − z0. At this point, let us remind ourselves that z0 in Eq. (A.1) is nonnegative because it is the depth coordinate of the generic buried point within the investigation domain, which is positive because of the downward verse of the z-axis (see Figure 4.1). Consequently, it is easily recognized that Eq. (A.20) is fully equivalent to Eq. (A.1), which completes the demonstration.  APPENDIX B  The purpose of this appendix is to show the expression of the half-derivative in the time domain. The half-derivative is defined as the operation p that ﬃﬃﬃﬃﬃ in frequency domains is expressed by the multiplication of the spectrum times jω, and it is a particular case of the fractional derivative. Therefore, given any function f(t) whose spectrum is F(ω), by definition we have ∂0:5 f 1 ≡ 0:5 ∂ t 2π 1 = 2π  +∞ ð  −∞ +∞ ð  −∞  pﬃﬃﬃﬃﬃ jωF ðωÞ expð jωt Þ dω ðB:1Þ 1 pﬃﬃﬃﬃﬃ jωF ðωÞ expð jωt Þ dω jω  This inverse transform convolution of the inverse transforms of pﬃ pﬃﬃﬃﬃﬃ(B.1) is equal to the p ﬃﬃﬃﬃﬃ the two functions 1= jω and jωF(ω). Now, 1= jω back-transforms into H ðt Þ= t , where H is the Heaviside function, equal to 1 for positive arguments and equal to 0 for negative arguments. Moreover as is well known, jωF(ω) back-transforms into ∂f =∂t. This leads to the expression of the half-derivative in the time domain, which is ∂0:5 f = ∂0:5 t  +∞ ð  −∞  H ðτ − t Þ ∂f pﬃﬃﬃﬃﬃﬃﬃﬃ ðτÞ dτ τ − t ∂t  ðB:2Þ  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  334  APPENDIX C  The purpose of this appendix is to provide the solution for the potential vector in a homogeneous space related to a current element z-directed and placed in the origin of the geometrical reference system. Let us start from the Helmholtz equation (11.25), here repeated for commodity of reading: r2 A + k02 A = − μ0 J  ðC:1Þ  since r2 A = ix r2 Ax + iy r2 Ay + iz r2 Az We can decompose (C.1) as r2 Ax + k02 Ax = − μ0 Jx , r2 Ay + k02 Ay = − μ0 Jy ,  ðC:2Þ  r2 Az + k02 Az = − μ0 Jz In order to solve any of Eqs. (C.2), let us preliminary study the solution of the following scalar differential equation: r2 ϕðrÞ + k02 ϕðrÞ = − δðrÞ  ðC:3Þ  Since the source is point-like, it is expected that the solution has spherical symmetry. Therefore, using the spherical representation of the curl operator, we obtain d2 2d ϕðr Þ + ϕðrÞ + k02 ϕðrÞ = − δðr Þ 2 dr r dr  ðC:4Þ  pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ where r = x2 + y2 + z2 . Actually, this equation has been already examined in Appendix A [see Eq. (A.10)]. Therefore, without repeating the procedure, the solution is Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  335  APPENDIX C  336  ϕðrÞ =  e − jk0 r 4πr  ðC:5Þ  Now, Eqs. (C.2) are linear, and so we can retrieve their solution integrating the solution of the corresponding impulsive problem. The procedure has been widely dealt with and exploited in Chapter 4, and so we will not discuss it again. So, Eq. (C.5) provides a result to be integrated all over the elementary equivalent source points [see Section 4.2, and in particular Eqs. (4.41) and (4.42)]. This provides immediately the result of Eq. (11.28) with regard to the potential vector and the result of Eq. (11.29) with regard to the scalar potential function.  APPENDIX D  In this appendix the decomposition of a generic plane wave impinging at the air–soil interface (from the air side) along its TE and TM components is retrieved, with the purpose of applying this decomposition to the plane waves that compose the homogeneous Green’s function. The generic impinging plane wave has the form   E = expðjuðx − x0 ÞÞexpðjvðy − y0 ÞÞexpðjkz10 ðz− z0 ÞÞ vx ðu, vÞix + vy ðu, vÞiy + vz ðu, vÞiz ðD:1Þ It is immediate to see that the solenoidality of the plane wave imposes the condition1 vz ðu, vÞ = −  uvx ðu, vÞ + vvy ðu, vÞ kz10 ðu, vÞ  ðD:2Þ  Substituting Eq. (D.2) into Eq. (D.1), we have that the expression of the generic plane wave composing the Green’s function is given by   uvx ðu,vÞ + vvy ðu, vÞ E = expðjuðx− x0 ÞÞ expðjvðy− y0 ÞÞ expðjkz10 ðz− z0 ÞÞ vx ðu, vÞix + vy ðu, vÞiy − iz kz10 ðu, vÞ  ðD:3Þ The air–soil interface is the plane of the equation z = 0. The TE component of the plane wave of Eq. (D.3) has an electrical field parallel to this interface, by definition. Thus, the electric field of the TE component does not have the z-component, and consequently we can write it as   ETE = expðjuðx − x0 ÞÞ expðjvðy − y0 ÞÞ expðjkz10 ðz − z0 ÞÞ vx1 ðu, vÞix + vy1 ðu, vÞiy  ðD:4Þ  1  As an exercise, the reader can verify that the columns of the plane wave spectrum of the homogeneous dyadic Green’s function [Eq. (11.55)] satisfy Eq. (D.2).  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  337  APPENDIX D  338  The solenoidality of the plane wave D.4 imposes the condition uvx1 ðu, vÞ + vvy1 ðu, vÞ = 0  ðD:5Þ  The TM component of the plane wave of Eq. (D.3) has to be equal to the difference between Eq. (D.3) and Eq. (D.4): ETM = expð juðx − x0 ÞÞ expðjvðy − y0 ÞÞ expðjkz10 ðz − z0 ÞÞ     uvx ðu, vÞ + vvy ðu, vÞ × ðvx ðu, vÞ − vx1 ðu, vÞÞix + vy ðu, vÞ− vy1 ðu, vÞ iy − iz kz10 ðu, vÞ ðD:6Þ The magnetic field relative to this TM component is given by   ix   1 1  ∂ HTM = − r × ETM = −  jω jω  ∂x   ETMx  iy ∂ ∂y ETMy      ∂   ∂z   ETMz  iz  ðD:7Þ  In particular, the z-component of this quantity has to be equal to zero, by definition of TM field. Therefore, substituting the component of the electric field from Eq. (D.6), we retrieve the condition   u vy ðu, vÞ − vy1 ðu, vÞ − vðvx ðu,vÞ− vx1 ðu, vÞÞ = 0  ðD:8Þ  Equations (D.5) and (D.8) provide a linear algebraic system that allows us to retrieve vx1 and vy1 versus vx and vy. The solution is vx1 =  v2 vx ðu, vÞ − uvvy ðu,vÞ , u2 + v2  vy1 =  u2 vy ðu, vÞ − uvvx ðu,vÞ u2 + v2  ðD:9Þ  Substituting Eq. (D.9) into Eqs. (D.4) and (D.6), we retrieve the TE and TM components of the plane wave, which are ETE = expð juðx − x0 ÞÞ expðjvðy − y0 ÞÞ expðjkz10 ðz− z0 ÞÞ 0 1 2 2 v v ð u,v Þ− uvv ð u, v Þ u v ð u, v Þ− uvv ð u, v Þ x y y x ×@ ix + iy A u2 + v 2 u2 + v2  ðD:10Þ  APPENDIX D  339  ETM = expðjuðx− x0 ÞÞ expðjvðy− y0 ÞÞ expðjkz10 ðz− z0 ÞÞ 0 1 2 2 u v ð u, v Þ + uvv ð u, v Þ v v ð u,v Þ + uvv ð u, v Þ uv ð u, v Þ + vv ð u, v Þ x y y x x y ix + iy − iz A ×@ u2 + v2 u2 + v2 kz10 ðu, vÞ ðD:11Þ Substituting Eqs. (D.10) and (D.11) into the columns of the plane wave spectrum of the homogeneous Green’s function in air [Eq. (11.62)], we achieve Eqs. (11.66) and (11.67).  APPENDIX E  In this appendix the reflection and transmission coefficients are retrieved for a TE and a TM plane wave impinging on the air–soil interface. Let us consider a generic TE impinging plane wave. Since phase factors are not of interest in this appendix, we can make use of a simple general expression of the following kind2:   Ei = E0 expð jðux + vy + kz10 zÞÞ vxi ix + vyi iy  ðE:1Þ  There is no z-component of the field because the wave is TE with respect to the plane z = 0. Moreover, the condition of solenoidality of the field imposes the constraint u uvxi + vvyi = 0 , vyi = − vxi v  ðE:2Þ  Substituting into Eq. (E.1), we can write the generic TE impinging wave as  u  Ei = E0 vxi expðjðux + vy + kz10 zÞÞ ix − iy v  ðE:3Þ  Coherently, the reflected and the refracted waves are expressed in general as   u1 Er = E0 vxr expðjðu1 x + v1 y − kz101 zÞÞ ix − iy v1   u2 Et = E0 vxt expðjðu2 x + v2 y + kz1s2 zÞÞ ix − iy v2  ðE:4Þ ðE:5Þ  with  2  The p dependence ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ along z is related to the dependence along x and y by means of the relationship kz10 = k02 −u2 − v2 , which is a constraint due to the Maxwell’s equations.  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  340  APPENDIX E  341  pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ k02 − u21 − v21 , pﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ kz1s2 = ks2 − u22 − v22 kz101 =  ðE:6Þ  where the square roots are meant with nonpositive imaginary parts. Equations (E.4) and (E.5) account for the Maxwell’s equations, the different propagation media and the fact that the reflected waves back-propagate with respect to the interface, which arises the minus sign before kz101 in Eq. (E.4). At the interface, the Maxwell’s equations impose that the tangential components of both the electric and magnetic fields are equal at the air and soil sides. This has to hold for any point of the interface, which leads to the conditions u1 = u2 = u, v 1 = v2 = v  ðE:7Þ  Substituting Eq. (E.7) into Eqs. (E.4) and (E.5) we rewrite the reflected and the transmitted wave as follows:  u  Er = E0 vxr expðjðux + vy − kz10 zÞÞ ix − iy v  u  Et = E0 vxt expðjðux + vy + kz1s zÞÞ ix − iy v  ðE:8Þ ðE:9Þ  Equations (E.1), (E.8), and (E.9) show that the incident, reflected, and transmitted electric fields are parallel to each other, and so the preservation of the tangential component of the electric field before and after the interface reduces to the equation vxi + vxr = vxt  ðE:10Þ  Let us now consider the magnetic field. This is retrieved from the incident electric field from the first Maxwell equations. In particular, distinguishing also for the magnetic field an incident, a reflected, and a transmitted wave, we have Hi =  1 r × Ei , − jωμ0  Hr =  1 r × Er , − jωμ0  Ht =  1 r × Et − jωμ0  ðE:11Þ  In Eq. (E.11) we have accounted for the fact that the soil does not show magnetic properties.  APPENDIX E  342  By expanding the expression of the incident magnetic field, we achieve  iy  ix  ∂ ∂  E0 vxi  ∂x ∂y Hi = − jωμ0  u   expðÞ − expðÞ  v   iz   ∂   ∂z     0    ðE:12Þ  where for brevity exp() stands for exp(j(ux + vy + kz10z)). Calculating the derivatives, we obtain  Hi =      E0 vxi jukz10 ju2 ix + jkz10 iy + − − jv iz expðjðux + vy + kz10 zÞÞ − jωμ0 v v    2 2  E0 vxi kz10 u u +v =− ix + iy − iz expðjðux + vy + kz10 zÞÞ ωμ0 vkz10 v  ðE:13Þ  Following the same passages with the reflected and refracted waves, we obtain Hr =    2 2  E0 vxr kz10 u u +v ix + iy + iz expðjðux + vy − kz10 zÞÞ ωμ0 vkz10 v    2 2  E0 vxt kz1s u u +v Ht = − ix + iy − iz expðjðux + vy + kz1s zÞÞ ωμ0 vkz1s v  ðE:14Þ  ðE:15Þ  From Eqs. (E.13)–(E.15), the preservation of the tangential component of the magnetic field at the interface imposes the condition: vxi − vxr = vxt  kz1s kz10  ðE:16Þ  Considering the scalar complex amplitude of the incident, reflected, and refracted wave at the interface (i.e., Ei, Er and Et), the reflection and transmission coefficients are by definition given by RTE = Er =Ei = vxr =vxi and TTE = Et =Ei = vxt =vxi , respectively. Let us note that, even if only the x-component appears, RTE and TTE are the ratios between the complex amplitudes of the field, because the y-component is proportional to the x-component of the field [see Eq. (E.2)]. Equation (E.10) and (E.16) provide the algebraic system 1 + RTE = TTE , 1 − RTE = TTE  kz1s kz10  ðE:17Þ  APPENDIX E  343  Solving the algebraic system, we obtain RTE =  kz10 − kz1s 2kz10 , TTE = kz10 + kz1s kz10 + kz1s  ðE:18Þ  Substituting into Eqs. (E.8) and (E.9), the reflected and transmitted waves can be then expressed as  u  Er ðx,y,zÞ = E0 RTE vxi expðjðux + vy − kz10 zÞÞ ix − iy = RTE Ei ðx, y,0Þexpð − jkz10 zÞ v ðE:19Þ   u Et ðx, y, zÞ = E0 TTE vxi expðjðux + vy + kz1s zÞÞ ix − iy = TTE Ei ðx, y,0Þ expð jkz1s zÞ v ðE:20Þ Let us now consider the case of a TM impinging plane wave. In this case, by definition, the incident magnetic field is expressed as   Hi = H0 expðjðux + vy + kz10 zÞÞ vxi ix + vyi iy  ðE:21Þ  Considering the solenoidality of the magnetic field, as well as the condition of continuity at any interface point of the tangential component of the magnetic field, dually to the TE case we can rewrite the incident, reflected, and transmitted magnetic fields as  u  Hi = H0 vxi expðjðux + vy + kz10 zÞÞ ix − iy v  u  Hr = H0 vxr expðjðux + vy − kz10 zÞÞ ix − iy v  u  Ht = H0 vxt expðjðux + vy + kz1s zÞÞ ix − iy v  ðE:22Þ ðE:23Þ ðE:24Þ  The electric field is retrieved versus the magnetic one from the (homogeneous, i.e. without sources) Maxwell’s equations, so that we have Ei =  1 r × Hi , jωε0  Er =  1 r × Hr , jωε0  Et =  1 r × Ht jωεs  Developing the spatial derivatives, Eq. (E.25) can be rewritten as  ðE:25Þ  APPENDIX E  344  Ei =    H0 vxi kz10 u u2 + v2 expðjðux + vy + kz10 zÞÞ ix + iy − iz v ωε0 kz10 v    H0 vxr kz10 u u2 + v2 expðjðux + vy − kz10 zÞÞ ix + iy + Er = − iz v ωε0 kz10 v Et =    H0 vxt kz1s u u2 + v2 expðjðux + vy + kz1s zÞÞ ix + iy − iz v ωεs kz1s v  ðE:26Þ  ðE:27Þ  ðE:28Þ  From Eqs. (E.22)–(E.24) and from Eqs. (E.26)–(E.28) we retrieve the conditions on the amplitudes of the waves in order to verify the continuity of the tangential components of the fields at the interface: 8 > > vxr vxt > > 1+ = , > > vxi + vxr = vxt < vxi vxi ðE:29Þ vxi kz10 vxr kz10 vxt kz1s , > − = > v v k ε xr xt z1s 0 > > ε0 ε0 εs = 1− > > : vxi vxi kz10 εs Now, let us remind that the reflection coefficient is defined the ratio between the tangential components of the reflected and incident electric fields, whereas the transmission coefficient is defined as the ratio between the tangential component of the transmitted and incident electric fields, so that we have vxr RTM ≡− vxi kz1s ε0 vxt TTM ≡ kz10 εs vxi  ,  8 > vxr > > > ≡− RTM , > > < vxi > vxt kz10 εs > > > ≡ TTM > > : vxi kz1s ε0  ðE:30Þ  Substituting Eqs. (E.30) in Eqs. (E.29), we achieve 1 − RTM = TTM  kz10 εs , 1 + RTM = TTM kz1s ε0  ðE:31Þ  which eventually provide RTM =  kz1s ε0 − kz10 εs 2kz1s ε0 , TTM = kz1s ε0 + kz10 εs kz1s ε0 + kz10 εs  ðE:32Þ  APPENDIX E  345  Finally, substituting Eqs. (E.32) into Eqs. (E.27) and (E.28), the reflected and transmitted waves can be rewritten as Er ðx, y, zÞ =    H0 vxi RTM kz10 u u2 + v2 expðjðux + vy − kz10 zÞÞ ix + iy + iz v ωε0 kz10 v  ðE:33Þ  = Eixy ðx, y,0ÞRTM expð − jkz10 zÞ− Eiz ðx, y,0ÞRTM expð − jkz10 zÞ Et ðx, y, zÞ =    H0 vxi TTM kz10 u u2 + v2 iz expðjðux + vy + kz1s zÞÞ ix + iy − ωε0 kz1s v v  kz10 = Eixy ðx, y,0ÞTTM expðjkz1s zÞ + Eiz ðx,y,0ÞTTM expðjkz1s zÞ kz1s  ðE:34Þ  where Eixy is the (vector) component of the incident field along the plane xy and Eiz is the (vector) component of the incident field along the z-axis. The calculated Fresnel coefficients are “from air to soil.” If the plane waves impinge from underground, it is straightforward to recognize that the Fresnel coefficients are obtained by exchanging the permittivity and the wavenumber in the soil with those in air and viceversa. In particular, this means that the soil–air reflection coefficients are the opposite of the air–soil reflection coefficients.  APPENDIX F Raffaele Persico and Raffaele Solimene  In this appendix we provide the solution in terms of Bessel’s functions of the integral in polar coordinatives in Eq. (12.27), namely, 2ksc sin ððθe max Þ  f ðρ1 , 2ksc sin ðθe max ÞÞ =  2π ð ρ dρ expðjρρ1 cos ðφÞÞ dφ  0  ðF:1Þ  0  where [see Eq. (12.26)] ρ1 =  qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ ðx0 − x0 Þ2 + ðy0 −y0 Þ2  ðF:2Þ  To do this, let us start reporting one of the integral expressions for Bessel’s functions of the first kind and integer order (Abramowitz and Stegun, 1972), namely, ðπ ðπ j−n j−n Jn ðxÞ = expð jx cos ðφÞÞcos ðnφÞ dφ = expð − jxcos ðφÞÞcos ðnφÞ dφ π π 0  ðF:3Þ  0  The sign of the imaginary exponential is indifferent because the real part of the integrand is even with regard to the central point φ = π=2 and the imaginary part is odd with respect to the same central point. Particularizing to the two cases n = 0, 1, we have ðπ ðπ 1 1 J0 ðxÞ = expðjx cos ðφÞÞdφ = expð −jx cos ðφÞÞ dφ π π 0  ðπ  J1 ðxÞ =  0  ðπ  1 1 expð jx cos ðφÞÞcos ðφÞ dφ = expð −jx cos ðφÞÞ cos ðφÞ dφ jπ jπ 0  ðF:4Þ  ðF:5Þ  0  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  346  APPENDIX F  347  From Eq. (F.3), it is also easy to recognize that Bessel’s functions of integer order are real for real values of their argument (which is the only case that we will consider). Moreover, from Eqs. (F.3) and (F.4), it is easily recognized that J0 is an even function and J1 is an odd function and that J0(0) = 1 and J1(0) = 0 (as due because of the oddness). That said, by integrating Eq. (F.3) for parts, we obtain J n ðx Þ =  ðπ j −n expðjxcos ðφÞÞ cos ðnφÞ dφ π 0  π −n ð j π j expðjx cos ðφÞÞð − jx sin ðφÞÞ sin ðnφÞ dφ ½ expðjx cos ðφÞÞsin ðnφÞ0 − = nπ nπ −n  =  xj  )  π −n + 1 ð  nπ j  0 π −n + 1 ð  π  0  expðjxcos ðφÞÞ sin ðnφÞsin ðφÞ dφ ) expðjx cos ðφÞÞsin ðnφÞ sin ðφÞ dφ =  nJn ðxÞ x  ðF:6Þ  0  Let us now consider the derivative of Bessel’s function of integer order ðπ dJ n ðxÞ j − n = j cos ðφÞ expðjx cos ðφÞÞ cos ðnφÞdφ dx π 0  ðπ j − ðn− 1Þ = expð − jx cos ðφÞÞcos ðnφÞ cos ðφÞdφ π =  j  0 π − ðn− 1Þ ð  π  expð − jx cos ðφÞÞð cos ðnφÞ cos ðφÞ  0  + sin ðnφÞ sin ðφÞ − sin ðnφÞ sin ðφÞÞ dφ ðπ j − ðn− 1Þ = expð − jxcos ðφÞÞ cos ððn − 1ÞφÞ dφ π −  j  0 π − ðn− 1Þ ð  π  expð − jxcos ðφÞÞ sin ðnφÞsin ðφÞ dφ  0  ðπ j−n + 1 expð −jx cos ðφÞÞ sin ðnφÞ sin ðφÞ dφ = Jn− 1 ðxÞ − π  ðF:7Þ  0  Substituting Eq. (F.6) into Eq. (F.7), we obtain dJ n ðxÞ nJn ðxÞ = Jn− 1 ðxÞ − dx x  ðF:8Þ  APPENDIX F  348  Particularizing to the case n = 1, we obtain dJ 1 ðxÞ J1 ðxÞ = J0 ðxÞ − dx x  ðF:9Þ  As a consequence of Eq. (F.9), we have   d dJ1 ðxÞ J1 ðxÞ = J1 ðxÞ + x J0 ðxÞ− = xJ0 ðxÞ ðxJ1 ðxÞÞ = J1 ðxÞ + x dx dx x  ðF:10Þ  Thus, we have worked out that the function xJ1(x) is a primitive of the function of xJ0(x). At this point, coming back to Eq. (F.1), through some straightforward calculation steps, we obtain 2ksc sin ððθe max Þ  f ðρ1 ,2ksc sin ðθemax ÞÞ =  2π ð  ρd ρ expðjρρ1 cos ðφÞÞ dφ 0  0  2π 3 2ksc sin 2π ððθemax Þ ð ð = ρdρ4 expðjρρ1 cos ðφÞÞ dφ + expðjρρ1 cos ðφÞÞdφ5 0 2ksc sin ððθemax Þ  = 0  2ksc sin ððθemax Þ  =  0  π  0  0  0  0  2π 3 ð ðπ 0 0 ρdρ4 expðjρρ1 cos ðφÞÞ dφ + expðjρρ1 cos ðφ −π ÞÞdφ 5 2π 3 ð ðπ ρdρ4 expðjρρ1 cos ðφÞÞ dφ + expð −jρρ1 cos ðφ0 ÞÞdφ0 5  0  2ksc sin ððθe max Þ  ρJ0 ðρρ1 Þdρ =  = 2π 0  2π ρ21  2ksc ρ1 sin ð ðθemax Þ  αJ0 ðαÞ dα 0  =  2π 2k ρ sin ðθemax Þ 2π ½αJ1 ðαÞ0 sc 1 = 2 2ksc ρ1 sin ðθemax ÞJ1 ð2ksc ρ1 sin ðθemax ÞÞ ρ21 ρ1  =  4πksc sin ðθemax ÞJ1 ð2ksc ρ1 sin ðθe max ÞÞ J1 ð2ksc ρ1 sin ðθemax ÞÞ = 8πksc2 sin 2 ðθemax Þ ρ1 2ksc ρ1 sin ðθemax Þ   qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ J1 2ksc sin ðθemax Þ ðx0 −x0 Þ2 + ðy0 −y0 Þ2 qﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ = 8πksc2 sin 2 ðθemax Þ 2ksc sin ðθemax Þ ðx0 −x0 Þ2 + ðy0 −y0 Þ2  Substituting into Eq. (F.11) into Eq. (12.27), we obtain Eq. (12.28).  ðF:11Þ  APPENDIX G: ANSWERS TO QUESTIONS  Chapter 2 1. No, GPR data essentially can help to retrieve the propagation velocity and (with some more difficulty) the losses in the soil. This is sufficient in most cases, but (for example) we cannot distinguish whether the soil has magnetic properties from the mere GPR data. 2. Yes they do, because the electric conductivity influences the imaginary part of the equivalent permittivity. The propagation velocity of the waves is inversely proportional to the real part of the square root of the equivalent complex permittivity, and thus it is rigorously influenced by both the permittivity and the conductivity of the soil (further than by possible magnetic properties of the soil). However, in the relatively common case of low lossy soil, a first-order approximation of the square root of the complex permittivity can be exploited, and in this case the influence of the conductivity of the soil on the propagation velocity is usually negligible with respect to the effect of the permittivity (the relative calculations are straightforward and are left as an exercise). 3. In general we can’t, even theoretically. For example, if we know that the buried target is circular and we apply the diffraction equation (2.7) to any two points, we have two equations and four unknowns (the ray, the propagation velocity, the minimum return time, and the abscissa of the minimum return time). Of course we can read the couple (x0,t0) from the data too, but this is to say that “any two points” of the curve in any case are not enough. In the case of a point-like target, instead, two points are sufficient because there is no need to have or achieve information about the size and the shape of the target. However, this is not the general case and, even in this case, to evaluate the propagation velocity from two points it is not well-advised, because a more extended matching between model and data can average better all the sources of uncertainty. 4. Essentially because in CMP the reflection comes from the same point: This makes the diffraction curve less dependent on the size and shape of the buried target from which it comes. In particular, the hypothesis of point-like reflector can be relaxed. 5. A TDR probe forces a reflection from a point at known depth without a meaningful alteration of the consistence of the soil, which is impossible to achieve with a cooperative target buried on purpose and looked for with a GPR. Moreover, the wave received with a TDR probe is a guided wave, and this provides the possibility to retrieve not only the propagation velocity of the wave (related to the product between the dielectric permittivity and the magnetic permeability of the soil), but also the impedance of the transmission line (related to the ratio between the dielectric Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  349  350  APPENDIX G: ANSWERS TO QUESTIONS  permittivity and the magnetic permeability of the soil). Incidentally, GPR data are instead not able to provide the wave impedance, essentially because the datum is proportional to the electric field and does not provide information on the magnetic field in the observation point. 6. A TDR probe knocked in the soil provides a local measure, usually up to a depth not greater than 50 cm. A GPR system can prospect more extended areas and can provide data based on deeper targets, which means to average the propagation velocity on a more extended range of depths.  Chapter 3 1. No, it isn’t. Actually, 75 MHz is a frequency step equal to one-half of the frequency step at which the nonambiguous depth is equal to 50 cm, which would guarantee against any spurious replica of targets embedded in the first 50 cm and would guarantee also against the Hermitian image of any target embedded in the first 50 cm. In other words, the frequency step of 75 MHz corresponds to a nonambiguous depth of 100 cm in the case at hand. However, in a dry sandy (in particular, not clay) soil the penetration of the wave is expected quite good, up to a depth depending on the exploited antennas (in particular their central frequency) but likely to be quite greater than 100 cm. So, for example a target with its top buried at 101 cm might provide a strong replica with its top at the depth of 1 cm. Even without a specific deeper knowledge about the penetration of the radiation in the case at hand, it is certainly better advised to hypothesize the possibility of a maximum penetration of 5 m (even more if low-frequency antennas were used, but in this case the targets of interest would probably be deeper than 50 cm), which leads to a frequency step of 15 MHz if the Hermitian images can be neglected, 7.5 MHz otherwise. 2. The required time step is given by the Nyquist criterion [Eq. (3.39)]. As said, lacking more specific information, we can assume that the band and the central frequency of the antennas are quantities of the same order, which leads to B = 2 GHz and consequently Δt = 0.5 ns. Let us be reminded that the effect of the soil might change the band of the antennas with respect to its nominal one. However, generally this effect is some decrease of the central frequency and not an increase of the band. That said, the bottom scale in time corresponding to a maximum pﬃﬃﬃﬃﬃﬃ reached depth of 50 cm is given by T = 2p=c = 2p εsr =c0 = 3:3 ns. This would lead to seven time samples. However, as it is shown in Chapter 9, in order to focus in the best way the buried targets up to 50 cm, it is well-advised that the bottom scale time be longer than that needed to reach the depth of 50 cm along a vertical path. Actually, this would make us “see” a target at 50 cm only when the GPR system is over it, whereas it is better to also have some possibility of lateral view. Moreover, in order to amortize possible uncertainties that we can have about the band of the antennas and the characteristics of the soil, and in order to better average (and so filter out) the noise, it is also well-advised to make narrow the time step. It is not possible to provide exact numbers for these choices, but let us suppose that we want to guarantee that the GPR can still receive an echo from a target at the depth of 50 cm when it is 2 m beyond this target. In this case, theﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ maximum “communicative” distance between the target and the GPR can be estimated as p 22 + 0:52 m = 2:062 m, and the corresponding time bottom scale is about 27 ns. Narrowing the time step to 0.25 ns, this leads to 109 samples. 3. The effect of the aliasing for a stepped frequency GPR system is the production of replicas of the echoes from the targets in time domain; practically, this means the production of spurious targets along the depth, which add to the actual ones. These replicas can be in some cases recognized  APPENDIX G: ANSWERS TO QUESTIONS  351  from the result because they are somehow similar to some actual target that gets “copied,” but they can be eliminated only repeating the measure with a correct frequency step. 4. The effect of the aliasing for a pulsed system is to provide replicas of the spectra of the echoes from the targets in frequency domain. This generates a distortion of the targets and possibly artifacts, but it is not immediate to quantify it from the results. In other words, the aliasing in frequency domain is more easily recognized from the results with respect to that in time domain. 5. No, we can’t. In particular, with a stepped frequency system we gather the data directly in the frequency domain. Thus, we obtain the time domain data to be truncated by back Fourier transforming the gathered stepped frequency data. However, these data are already sampled in frequency domain, and so they should already be aliasing-free. 6. No, we can’t. In this case we obtain the data in the frequency domain by forward Fourier transforming the gathered pulsed GPR data. Also in this case, the sampling comes intrinsically before the Fourier transformation, and so we can’t think of erasing the aliasing effects by filtering them.  Chapter 4 1. No. The scattering equations essentially link the targets with the scattered field in the observation point. Any antenna system in the observation point measures a voltage approximately proportional to the total field in the observation point. It is a task of the human operator to extract the scattered field data from the total field data. 2. No. The incident field in the subsoil will be not the same as what we would have in a homogeneous medium, even if the energy radiated toward the air is strongly dissipated. In particular, the air–soil interface is necessarily a direction of null of the radiation pattern. Notwithstanding, a model based on a homogeneous propagation medium can be exploited in GPR data processing providing useful results in many cases. 3. The reason of this dissymmetry is the fact that the primary source is an electrical filamentary current, or in any case a source that radiates an electric field parallel to the axis of invariance. In order to have a formulation where the dielectric permittivities appear explicitly instead of the magnetic permeabilities, we should solve the scattering problem for a filamentary magnetic current, and the datum should be the magnetic scattered field instead of the electric one. 4. No. In this way we would implement a long wire antenna where the current behaves as a wave propagating along the wire. In particular, in the case of a sinusoidal imposed voltage, we would have a sinusoidal current along the wire but the phase of this sine would change from point to point. 5. No. The reciprocity theorem assures us (under wide hypotheses) that the behavior in reception of an antenna is linked to its behavior in transmission mode, because the effective lengths are equal for the two modes. In particular, it is impossible that an antenna behaves as a 3D structure in transmission mode and as a 2D structure in reception mode. 6. No. In particular, for energy conservation reasons, in a lossless medium, the geometrical spreading of the far field is proportional to the inverse of the distance from the source in 3D and is instead proportional to the square root of the inverse of the distance from the source in 2D. Notwithstanding, in GPR prospecting, usually the phase behavior is sufficiently similar and the distances involved are not so large to make the different geometrical spreading cause dramatic effects. Therefore, a 2D model in many cases provides a useful representation of a 3D buried scenario.  352  APPENDIX G: ANSWERS TO QUESTIONS  Chapter 5 1. No, it is solenoidal in the absence of a net accumulation of charges. However, within a 2D model we have a current flux without having accumulation of charges, and this makes the electric field solenoidal. 2. No. What is solenoidal in any case is the magnetic induction. Within the kind of propagation media considered in this text, this is equivalent to saying that the product between the magnetic field and the magnetic permeability is a solenoidal quantity, but not necessarily the magnetic field alone. 3. No. The incident field is the field in the background medium without targets, and it depends only on the sources and on the characteristics of the soil. 4. Yes, because both quantities are involved in the determination of the internal field. Actually, the magnetic part and the dielectric part of the contrast interact as two targets placed in the same volume. 5. Yes, because the total field is the sum of the incident and scattered field. 6. Yes. In particular, if the source is a filamentary magnetic (instead of electric) current, then the magnetic field is parallel to the axis of invariance and the electric field is orthogonal to it. The same happens if the source is constituted by a continuous series of parallel Hertzian dipoles directed along any direction orthogonal to the axis of invariance. This situation is usually labeled as the vector 2D case (the 2D geometry dealt with in this text, instead, is more precisely labeled as the 2D scalar geometry).  Chapter 6 1. No, both the statements are not true because in general the Born series is not guaranteed to converge. 2. Yes, because the scattered field is a linear quantity with respect to the incident field, which in turn is a linear quantity with respect to the density current that generated it. 3. No, because the antennas are not structures that impose a density current but essentially structures where a voltage (real or equivalent) can be imposed. Now, especially if close to each other, the two antennas interact with each other (i.e., are coupled), and the current densities that develop along their arms are not the same that we would have on each of them in absence of the other one. 4. No, because the two targets interact with each other, which leads to the nonlinearity of the relationship between contrast and scattered field. 5. Yes, because the amount of energy that causes the interactions between the targets is decreased if they are placed far from each other. 6. Yes, because in this case the amount of energy that causes the interactions between the targets is decreased by the losses, which transform part of the electromagnetic energy into heat.  Chapter 7 1. No, because in any case there is the propagation time of the signal inside the GPR, which can be amortized by means of zero timing that is easily performed only in the time domain. 2. Yes: This can be done in a hardware way (e.g., by means of a differential configuration) or in a software way (e.g., by means of a background removal).  APPENDIX G: ANSWERS TO QUESTIONS  353  3. No, and actually a negative effect is expected in this case. In fact, in the limit for a very narrow spatial step, the N averaged traces become too close to each other (in terms of the central wavelength). In these conditions, the field does not have a sufficient “space” to vary meaningfully within the considered set of traces. Consequently, the central trace and the average trace become the same, and their difference vanishes. 4. No. We have to gather the maximum extractable information from the scattered field, and this makes it in any case well-advised to keep the spatial step not too large. A quantification in this sense is worked out in Chapter 9. 5. No, it provides an approximation of the scattered field. The only way to achieve the scattered field from the total one is to subtract the incident field, which should be measured or calculated some way. This is difficult to be performed in a reliable way in the case of the GPR prospecting. 6. Yes, because the incident field in the case of homogeneous soil (of course with a flat air soil interface) is the same for any observation point.  Chapter 8 1. When the target is embedded in the masonry, the impinging radiation crosses it more times, due to the presence of the far interface of the masonry that leads to a partial reflection of the waves impinging on it. This makes the mutual interactions between different parts of the targets change, and so it is highly probable that the ratio between the norms of the internal incident field and the internal total field is not the same in the two cases. This shows that the degree on nonlinearity of the scattering also depends on the kind of background medium. It is implicit that a masonry is expected to worsen the nonlinearity with respect to a homogeneous soil ideally composed of the same material.  Chapter 9 1. The visible interval depends on the frequency, the dielectric permittivity of the soil, the magnetic permeability of the soil and on the maximum effective view angle. 2. Formally they don’t, because the retrievable spectral set is related to the visible intervals achieved at all the available frequencies and therefore depends on the frequency band, the dielectric and magnetic permeability of the soil and the maximum effective view angle. However, the spatial and frequency step are essential in order to “sample” the retrievable spectral set properly. 3. Formally they don’t, but a proper time step is indispensable in order to calculate an un-aliased version of the spectrum, and an adequate time bottom scale is indispensable to include and focus properly the targets of interest. 4. No, because we have identified and quantified the Nyquist rate for the spatial and frequency (and also time) step. Below the Nyquist rate, there is no theoretical improvement still available, because the sampled function can be perfectly reconstructed from its samples. 5. The resolution improves when the observation line is longer, because the maximum view angle increases. However, this improvement is not progressive because at a certain point we reach the maximum effective view angle, which no longer increases even if the maximum geometrical view angle continues to increase. 6. No, because an excessive directivity makes the antennas look only under them and hinders the lateral view of the targets, which is instead essential in order to allow a processing that improves the resolution.  354  APPENDIX G: ANSWERS TO QUESTIONS  7. No, because the vertical resolution is essentially influenced by the available frequency band, as said. 8. Yes, this can be done muting the data in time domain before and after the time-depth range of interest. This truncation of the signal in time domain has to be done before the frequency resampling, and it allows us to relax the frequency step. This one, in fact, can be found on the basis of the Nyquist the criterion in the frequency domain relative to a “narrower” function in the time domain. The price paid for this is the renounce to focus targets before or beyond the chosen depth range. 9. Yes, this can be done filtering the data in the frequency domain before and after the band of interest. This truncation of the signal in the frequency domain has to be done before the time resampling, and it allows us to relax the time step. This one can be found on the basis of the Nyquist criterion in the time domain relative to a narrower function in frequency domain. The price paid for this is to renounce to retrieve part of the band of the signal, which leads to a loss of resolution. 10. An enlargement of the band can of course improve the reconstruction because the resolution can improve in this case. However, a progressive increasing of the band can also cause problems, both computational and related to the fact that the Born approximation, underlying the diffraction tomography deductions proposed in this chapter, eventually becomes poor because the targets become large in terms of wavelength. Moreover, a larger band can be more sensible to interferences caused by other sources. Notwithstanding, from a practical point of view, it is usually better to have at disposal a larger band because, after gathering the data, commercial codes for the processing usually make it possible to filter them, thereby making the results less detailed but more robust. The computational extra-price paid for this is usually not dramatic. 11. No, because the increasing is negligible beyond a certain limit. In particular, the number of averaged traces can be indefinitely increased by a progressive artificial prolongation of the B-scan, achieved by adding the average trace on both sides. In particular, the number of averaged traces in this way can go even beyond the same actual number of traces of the B-scan. However, the substantial effect is a progressive narrowing of the spatial filtering constituted by the complement to one of the Dirichlet sine (see Section 9.14), which involves progressively marginal effects. 12. Not necessarily. As said, the information we need in GPR prospecting is not merely quantitative but above all qualitative: We are not merely interested in the potentialities of the involved mathematical operator, but in the reliability and usefulness of the interpretation of the results that we can provide. For example, if a larger band provides a too noisy signal, it is better to use a narrower band. If some not perfectly horizontal layer is present, a background removal on a smaller number of traces can make the datum more readable, even if the available information is formally larger with a background removal on more traces (because the spatial filtering effect is reduced). Eventually, the quality of the result is optimal when we have a useful “combination” between the data and the exploited mathematical model (not between some mathematical model and itself ).  Chapter 10 1. No. Migrations are linear algorithms derived under the Born approximation and do not account for the intrinsic nonlinearity of the scattering phenomenon. 2. No. They are derived under the Born approximation, but formally require the further conditions that the soil is lossless and the targets are not shallow.  APPENDIX G: ANSWERS TO QUESTIONS  355  3. It depends on whether the spectral weight is accounted for or not. In fact, the refraction at the air–soil interface is accounted for by means of the spectral weight. 4. Yes, because we can usually choose the number of traces involved in the migration algorithm (at least in the case of the Kirchhoff migration algorithm). This indirectly means to account for the maximum effective view angle, which is influenced, among other things, also by the radiation pattern of the antennas. Of course, this does not mean to account for the radiation pattern in a rigorous way. 5. No, because it depends on whether we reliably know the involved parameters—in particular, the effective length of the antennas. 6. The target at hand is a strong scattering object quite large with respect to the central wavelength in the soil (equal to 20 cm in the case at hand), and therefore a linear BA model cannot provide a precise model of the scattering in the case at hand, and so we cannot hope to retrieve the exact shape of such a big target with a standard migration algorithm, unless some a priori extra information is available or alternatively some nonlinear and/or iterative approach can be tried. That said, if the room is empty, the propagation velocity in it is 3 times larger than that in the surrounding soil. Since the migration has been supposed to account for the propagation velocity of the waves in the soil, the room is imaged compressed in the depth direction, and after time–depth conversion its thickness will appear to be of the order of 1 m instead of 3. More correctly, the distance between the top and the bottom of the reconstructed main anomaly appears of the order of 1 m instead of 3. Instead, if the room is filled with fresh water (whose relative dielectric permittivity is well known to be of the order of 81), then the propagation velocity in the room is 3 times smaller than that in the surrounding soil, and the room is imaged elongated. In particular, its top and bottom are imaged at the distance of 9 m (instead of 3) from each other.  Chapter 11 1. Yes it is. The proof might be performed as a straightforward extension of that exposed in Chapter 6 with regard to the 2D inverse scattering. In particular, a contrast varying as a sinusoid along all the three directions x, y, and z can be exploited. Also in this case, this would demonstrate that the problem is ill-posed but would not provide a full characterization of the nonretrievable targets. 2. No. In general the electric field (either incident, scattered, or total) has three components. However, at least for wire antennas parallel to the air–soil interface, the component of the incident field parallel to the transmitting antenna is usually the most important one. 3. The gauge of Lorenz applied in Chapter 5 was referred to the potential (Fitzgerald) vector relative to the electric scattered field in the case of secondary magnetic sources. In the 3D case dealt with in Chapter 10, the gauge of Lorentz is referred to a potential vector relative to the magnetic field. 4. In the scalar 2D case dealt with, we have only TM polarized waves—that is, waves where the electric field is directed along the axis of invariance and the magnetic field is orthogonal to it. So, in that case there is no reason to distinguish a TE from a TM reflection or transmission coefficient. 5. No, it isn’t. In particular, the GPR datum is the same whatever (2D or 3D) processing we apply on it. In particular, the GPR gathers a scalar quantity in any observation point, given by the retrieved voltage, which is proportional to the scalar product of the electric field and of the effective length of the antenna.  356  APPENDIX G: ANSWERS TO QUESTIONS  Chapter 12 1. No, the ideal visible interval translates into the ideal visible circle, given by the rotation of the (symmetric) visible interval around the origin. 2. Rigorously not, essentially because the antenna pattern is not symmetrical around the broadcast (depth) direction. However, this dissymmetry can be neglected if an order of size for the resolution and the needed spatial step along x and y are looked for. In this case, the 3D retrievable spectral set is given by the 2D retrievable spectral set rotated around its symmetry axis. 3. No, the horizontal resolution is essentially the same, with a theoretical worsening of 22% in the 3D case [see Eqs. (12.30) and (9.44)]. 4. Fortunately it is not indispensable, because the target might be relatively large and this makes somehow smoother the spatial behavior of the scattered field. In particular, as said, it is customarily quite easy to gather data at the Nyquist rate along the direction of the B-scan, but it is critical to do the same with respect to the transect. Therefore, as a matter of fact, along the transect direction we have in most cases a spatial undersampling. To gather B-scans along two orthogonal directions partially mitigates the effects of this undersampling, but not rigorously and not completely.  Chapter 13 1. No, and the physical reason has been explicitly shown in Section 12.3. 2. Yes, the calculations would be analogous to those exposed [see, in particular, Eq. (12.9)], but with different unit vectors, which would lead to the multiplication of two different columns of the matrixes of Eq. (12.9). The final result would be a formulation with the same retrievable spectral set but with a different spectral weight. 3. No, because in the case at hand two orthogonal B-scans would gather data in the same points but with the antennas oriented along two orthogonal directions: in particular, the scattered field also depends on the relative angle between the incident field and the buried target, that of course would change in the two cases. 4. Yes, but the array should be constituted by two couples of orthogonal dipoles, so that two orthogonal polarizations would be radiated and received at each observation point with a unique going-through.  Chapter 14 1. Yes, an SVD algorithm accounts for losses of the soil and near field effects. Moreover, the truncation of the investigation domain is accounted for without introducing further approximations. 2. No, it depends (among other things) on the reliability of our knowledge about the involved parameters, such as e.g., the losses and the characteristics of the antennas. 3. No, first of all there is a problem of RAM availability. In particular, commercial routine for the calculation of the SVD can fail if the RAM requirements are too high. Second, the computational burden implicates the necessity of the partition of the B-scan into several observation–inversion domains. This can cause some problems, described in detail in Chapter 15 (see in particular Section 15.7).  APPENDIX G: ANSWERS TO QUESTIONS  357  4. No, the SVD ideally provides a least square solution of the problem, which coincides with the exact one if and only if the problem admits an exact solution. With overdetermined linear problems, this happens very rarely. 5. No. The regularization parameter that we have at our disposal when performing a migration is the number of involved traces, which is related to the maximum view angle that we can exploit. This does not drive directly to a check of the investigated depth. 6. Yes, we can perform this “check” thanks to the spatial content of the upper-threshold singular functions.  REFERENCES  M. Abramowitz and I. Stegun (1972). Handbook of Mathematical Functions with Formulas, Graphs, and Mathematical Tables, Dover Publications, New York. M. N. Afsar, J. R. Birch, R. N. Clarke, and G. W. Chantry (1986). The measurement of the properties of materials, Proceedings of IEEE 74(1), 183–199. G. Alberti, L. Ciofaniello, M. Della Noce, S. Esposito, G. Galiero, R. Persico, M. Sacchettino, and S. Vetrella (2002). A stepped frequency GPR system for underground prospecting, Annals of Geophysics 45(2), 375–391. S. A. Arcone, V. B. Spikes, and G. S. Hamilton (2005). Stratigraphic variation within polar firn caused by differential accumulation and ice flow: Interpretation of a 400 MHz short-pulse radar profile from West Antarctica, J. Glaciology 51, 407–422. C. A. Balanis (1989). Advanced Engineering Electromagnetics, John Wiley & Sons, New York. M. Bertero and P. Boccacci (1998). Introduction to Inverse Problems in Imaging, Institute of Physics Publishing, Bristol and Philadelphia. U. Böniger and J. Tronicke (2010). Symmetry based 3D GPR feature enhancement and extraction, in Proceedings of the XIII International Conference on Ground Penetrating, Lecce, Italy, June 21–25. M. Born and E. Wolf (1999). Principles of Optics, 7th (expanded) edition, Cambridge University Press, New York. M. C. Caggiani, M. Ciminale, D. Gallo, M. Noviello, and F. Salvemini (2012). Online non destructive archaeology: The Archaeological Park of Egnazia (Southern Italy) study case, Journal of Archaeological Science 39, 67–75. S. Caorsi, G. L. Gragnani, S. Medicina, M. Pastorino, and G. Zunino (1991). Microwave imaging method using a simulated annealing approach, IEEE Microwave and Guided Wave Letters, MGWL-1 (11), 331–333. E. Cardarelli, C. Marrone, and L. Orlando (2003). Evaluation of tunnel stability using integrated geophysical methods, Journal of Applied Geophysics 52(2–3), 93–102. A. Cataldo, E. De Benedetto, and G. Cannazza (2011). Broadband Reflectometry for Enhanced Diagnostics and Monitoring Applications, Springer-Verlag, New York. I. Catapano, L. Crocco, R. Persico, M. Pieraccini, and F. Soldovieri (2006). Linear and non-linear microwave tomography approaches for subsurface prospecting: Validation on real data, IEEE Transactions. on Antennas and Wireless Propagation Letters 5, 49–53.  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  358  REFERENCES  359  W. C. Chew (1995). Waves and Fields in Inhomogeneous Media, Institute of Electrical and Electronics Engineers, Piscataway, NJ. R. J. Chignell (2004). The radio licensing of GPR systems in Europe, Proceedings of 10th International Conference on Ground Penetrating Radar, Delft, the Netherlands. P. C. Clemmow (1996). The Plane Wave Spectrum Representation of Electromagnetic Fields, Wiley-IEEE Press, Now York. R. E. Collin (1985). Antennas and Radiowave Propagation, McGraw-Hill, New York. D. Colton and R. Kress (1992). Inverse Acoustic and Electromagnetic Scattering Theory, Springer Verlag, New York. D. Colton, H. Haddar, and M. Piana (2003). The linear sampling method in inverse electromagnetic scattering theory, Inverse Problems 19(6), S105–S137. L. B. Conyers (2004). Ground Penetrating Radar for Archaeology, AltaMira Press, Lanham, MD. J. C. Cook (1975). Radar transparencies of mine and tunnel rocks, Geophysics 40, 865–885. T. J. Cui and W. C. Chew (2002). Diffraction Tomographic algorithm for the detection of three-dimensional objects buried in a lossy half space, IEEE Trans. on Antennas and Propagation 50(1), 42–49, January 2002. D. J. Daniels (2004). Ground Penetrating Radar, 2nd edition, IEE Press, Luxembourg. J. L. Davis and A. P. Annan (1989). Ground-penetrating radar for high resolution mapping of soil and rock stratigraphy, Geophysical Prospecting 37(5), 531–551. R. Deming and A. J. Devaney (1996). A filtered backpropagation algorithm for GPR, Journal of Environmental & Engineering Geophysics 0(2). A. J. Devaney (1981). Inverse-scattering theory within the Rytov approximation, Optics Letters 6(8), 374–376. M. D' Urso, I. Catapano, L. Crocco, and T. Isernia (2007). Effective solution of 3D scattering problems via series expansions: Applicability and a new hybrid scheme, IEEE Transactions on Geoscience and Remote Sensing 45, 639–648. S. Ebihara, M. Sato, and H. Niitsuma (2000). Super-resolution of coherent targets by a directional borehole radar, IEEE Transactions on Geoscience and Remote Sensing 38(4), 1725–1732. N. Engheta, C.H. Papas, and C. Elachi (1982). Radiation pattern of interfacial dipole antennas, Radio Science 17(6), 1557–1566. L. B. Felsen and N. Marcuvitz (1994). Radiation and Scattering of Waves, Wiley-IEEE, New York. G. Franceschetti. Electromagnetics: Theory, Techniques and Engineering Paradigms, Plenum Press, New York. J. Francke (2010). Applications of GPR in mineral resource evaluations, in Proceedings of the XIII International Conference on Ground Penetrating, Lecce, Italy. S. P. Friedman (2005). Soil properties influencing apparent electrical conductivity: A review, Computers and Electronics in Agriculture 46(1–3), 45–70. J. Gazdag and P. Squazzero (1984). Migration of seismic data, Proceedings of IEEE 72, 1302–1315. G. Gentili and U. Spagnolini (2000). Electromagnetic inversion in monostatic ground penetrating radar: TEM horn calibration and application, IEEE Transactions on Geoscience and Remote Sensing 38(4), 1936–1946.  360  REFERENCES  A. Giannopoulos (2003). GprMax2D V 1.5 (Electromagnetic simulator for Ground Probing Radar, the software is available at www.gprmax.org). G. H. Golub and C. F. van Loan (1996). Matrix Computations, 3rd edition, Johns Hopkins University Press Baltimore. D. Goodman and S. Piro (2013). GPR Remote Sensing in Archaeology, Springer-Verlag, New York. G. Grandjean, J. C. Gourry, and A. Bitri (2000). Evaluation of GPR techniques for civilengineering applications: Study on a test site, Journal of Applied Geophysics, 45(3), 141–156. F. Grasso, G. Leucci, N. Masini, and R. Persico (2011). GPR Prospecting in Renaissance and Baroque Monuments in Lecce (Southern Italy), Proceedings of VI International Workshop on Ground Penetrating Radar, IWAGPR, Aachen, Germany. M. Grodner (2001). Delineation of rockburst fractures with ground penetrating radar in the Witwatersrand Basin, South Africa, International Journal of Applied Geophysics 38(6), 885–891. J. Groenenboom and A. Yarovoy (2002). Data processing and imaging in GPR system dedicated for landmine detection, Subsurface Sensing Technologies and Applications 3(4), 437–452. L. Gurel and U. Oguz (2003). Optimization of the transmitter–receiver separation in the ground penetrating radar, IEEE Transactions on Antennas and Propagation 51(3), 362–370. J. Hadamard (1923). Lectures on Cauchy's Problem in Linear Partial Differential Equations, Yale University Press,. New Haven. W. S. Hammon, G. A. McMechan, and X. Zeng (2000). Forensic GPR: Finite-difference simulations of responses from buried human remains, Journal of Applied Geophysics 45(3), 171–186. R. F. Harrington (1961). Time-Harmonic Electromagnetic Fields, McGraw-Hill, New York. K. Heidary (2003). Ultra-wideband radiation and scattering from a thin filament, in Proceedings. Antennas and Propagation Society International Symposium, June, pp. 551–554. J. R. Higgins, Sampling Theory in Fourier and Signal Analysis, Oxford University Press, New York, 1996. J. Hugenschmidt, M. N. Partl, and H. de Witte (1998). GPR inspection of a mountain motorway in Switzerland, Journal of Applied Geophysics 40, 95–104. M. Idemen and I. Ackduman (1990). Two dimensional inverse scattering problems connected with bodies buried in a slab, Inverse Problems 6, 749–766. K. Iizuka, A. P. Freundorfer K. H. Wu, H. Mori, H. Ogura, and V-K. Nguyen (1984). Step frequency radar, Journal of Applied Physics 56(9), 2572–2583. J. D. Jackson (1998). Classical Electrodynamics, 3 edition, John Wiley Sons, New York. H. Jol (2009). Ground Penetrating Radar: Theory and Applications, Elsevier, New York. A. Kirsh (1996). An Introduction to the Mathematical Theory of Inverse Problems, SpringerVerlag, New York. K. S. Kunz and R. J. Luebbers (1993). The Finite Difference Time Domain Method for Electromagnetics, CRC Press, Boca Raton, FL. S. Lambot, E. C. Slob, I. van den Bosch, B. Stockbroeckx, and M. Vanclooster (2004). Modeling of ground-penetrating radar for accurate characterization of subsurface electric properties, IEEE Transactions on Geoscience and Remote Sensing 42(11), 2555–2568. H. J. Landau and H. O. Pollak (1961). Prolate spheroidal wave functions, Fourier analysis and uncertainty—II, The Bell System Technical Journal 40(1), 65–84. H. J. Landau and H. O. Pollak (1962). Prolate spheroidal wave functions, Fourier analysis and uncertainty—III, The Bell System Technical Journal 41(4), 1295–1336.  REFERENCES  361  G. Leone, R. Persico, and R. Solimene (2003). A quadratic model for electromagnetic subsurface prospecting, AEÜ, International Journal of Electronics and Communications 57(1), 33–46. D. Lesselier and B. Duchene (1996). Wavefield inversion of objects in stratified environments: From back-propagation schemes to full solutions, in R. Stone, ed., Review of Radio Science 1993–1996, pp. 235–268, Oxford University Press, New York. A. A. Lestari, A. G. Yarovoy, and L. P. Ligthart (2004). Numerical and experimental analysis of circular-end wire bow-tie antennas lossy a ground, IEEE Transactions on Antennas and Propagation 52, 26–35. G. Leucci (2008). Ground penetrating radar: The electromagnetic signal attenuation and maximum penetration depth, Scholarly Research Exchange, Article ID 926091, doi:10.3814/2008/ 926091. N. Levanon (1988). Radar Principles, John Wiley & Sons, New York. W. Li, H. Zhou, and X. Wan (2012). Generalized Hough transform and ANN for subsurface cylindrical object location and parameters inversion from GPR data, in Proceedings of 14th International Conference on Ground Penetrating Radar, pp. 285–289, Shanghai, China, June. A. Liseno, F. Tartaglione, and F. Soldovieri (2004). Shape reconstruction of 2d buried objects under a Kirchhoff approximation, IEEE Geoscience and Remote Sensing Letters 1(2), 118–121. L. Lo Monte, D. Erricolo, F. Soldovieri, and M. C. Wicks (2010). Radio frequency tomography for tunnel detection, IEEE Transactions on Geoscience and Remote Sensing 48(3), 1128–1137. N. Masini, R. Persico, E. Rizzo, A. Calia, M. T. Giannotta, G. Quarta, and A. Pagliuca (2010). Integrated techniques for analysis and monitoring of historical monuments: the case of San Giovanni al Sepolcro in Brindisi, southern Italy, Near Surface Geophysics 8(5), 423–432. P. Meincke (2001). Linear GPR inversion for lossy soil and a planar air–soil interface, IEEE Transactions on Geoscience and Remote Sensing 39(12), 2713–2721. P. Meincke and T. B. Hansen (2004). Plane wave characterization of antennas close to a plane interface, IEEE Transactions on Geoscience and Remote Sensing 42(6), 1222–1232. M. Moghaddam and W. C. Chew (1992). Nonlinear two-dimensional velocity profile inversion using time domain data, IEEE Transactions on Geoscience and Remote Sensing 30(1), 147–156. M. Nabighian (1987). Electromagnetic Methods in Applied Geophysics—Theory, Vol. 1, Society of Exploration Geophysics, Tulsa, OK. D. A. Noon (1996). Stepped-Frequency Radar Design and Signal Processing Enhances Ground Penetrating Radar Performance, Ph.D. thesis, Department of Electrical & Computer Engineering, University of Queensland, Australia. K. M. O’Connor and C. H. Dowding (1999). Geomeasurements by Pulsing TDR Cables and Probes, CRC Press, Boca Raton, FL. C. P. Oden, M. H. Powers, D. L. Wright, and G. R. Olhoeft (2007). Improving GPR Image resolution in lossy ground using dispersive migration, IEEE Transactions on Geoscience and Remote Sensing 45(8), 2492–2500. G. P. Otto and W. C. Chew (1994). Microwave inverse scattering—Local shape function imaging for improved resolution of strong scatterers, IEEE on Microwave Theory and Techniques 42(1), 137–141. M. Pastorino (2010). Microwave Imaging, John Wiley & Sons, Hoboken, N J. R. Persico (2006). On the role of measurement configuration in contactless GPR data processing by means of linear inverse scattering, IEEE Transactions on Antennas and Propagation 54(7), 2062–2071.  362  REFERENCES  R. Persico and G. Prisco (2008). A reconfigurative approach for SF-GPR prospecting, IEEE Transactions on Antennas and Propagation 56(8), 2673–2680. R. Persico and J. Sala (2011). Some possibilities and problems related to 2D linear inverse scattering algorithms on large scale GPR data, in Proceedings of 6th International Workshop on advanced Ground penetrating Radar (IWAGPR), Aachen, Germany, June. R. Persico and J. Sala (2014). Single and double sequence of investigation. domains in 2D linear inversions applied to GPR data, IEEE Geosciences and Remote Sensing Letters. DOI 10.1109/ LGRS.2013.220008. R. Persico and F. Soldovieri (2004). One-dimensional inverse scattering with a Born model in a three-layered medium, Journal of Optical Society of America Part A 21(1), 35–45. R. Persico and F. Soldovieri (2006). A microwave tomography approach for a differential configuration in GPR prospecting, IEEE Transactions on Antennas and Propagation 54(11), 3541–3548. R. Persico and F. Soldovieri (2008). Effects of the background removal in linear inverse scattering, IEEE Transactions on Geoscience and Remote Sensing 46(4), 1104–1114. R. Persico and F. Soldovieri (2010). Recent issues relevant to GPR prospecting, invited paper, Proceedings of EMTS, 2010, Berlin Germany. R. Persico and F. Soldovieri (2011). Two dimensional linear inverse scattering for dielectric and magnetic anomalies, Near Surface Geophysics 9(3), 287–295. R. Persico, F. Soldovieri, and R. Pierri (2002). On the convergence properties of a quadratic approach to the inverse scattering problem, Journal of Optical Society of America Part A, 19(12), 2424–2428. R. Persico, R. Bernini, and F. Soldovieri (2005). On the configuration of the measurements in inverse scattering from buried objects under the distorted Born approximation, IEEE Transactions on Antennas and Propagation 53(6), 1875–1886. R. Persico, F. Soldovieri, and E. Utsi (2010). Microwave tomography for processing of GPR data at Ballachulish, Journal of Geophysics and Engineering, 7(2), 164. R. Persico N. Romano, and F. Soldovieri (2011). Design of a balun for a bow tie antenna in reconfigurable ground penetrating radar systems, Progress In Electromagnetics Research C 18, 123–135. R. Persico, G. Leucci, L. Matera, M. Ciminale, D. Dei, F. Parrini, and M. Pieraccini (2013a). Applications of a reconfigurable stepped frequency GPR in the Chapel of the Holy Spirit, Lecce (Italy), in Proceedings of 7th International Workshop on Advanced Ground Penetrating Radar (IWAGPR), Nantes (France), July. R.Persico, G. Leucci, and F. Soldovieri (2013b). The effect of the height of the GPR antennas on the diffraction curve, in Proceedings of 7th International Workshop on Advanced Ground Penetrating Radar (IWAGPR), Nantes (France), July. E. Pettinelli, A. Di Matteo, E. Mattei, L. Crocco, F. Soldovieri, D. J. Redman, and A. P. Annan (2009). GPR response from buried pipes: Measurement on field site and tomographic reconstructions, IEEE Transactions on Geosciences and Remote Sensing 47(8), 2639–2645. G. Picardi, J. J. Plaut, D. Biccari, OrnellaBombaci, D. Calabrese, M. Cartacci, A. Cicchetti, S. M. Clifford, P. Edenhofer, W. M. Farrell, C. Federico, A. Frigeri, D. A. Gurnett, T. Hagfors, E Heggy, A. Herique, R. L. Huff, A. B. Ivanov, W. T. K. Johnson, R. L. Jordan, D. L. Kirchner, W. Kofman, C. J. Leuschen, E. Nielsen, R. Orosei, E. Pettinelli, R. J. Phillips, D. Plettemeier, A. Safaeinili, R. Seu, E. R. Stofan, G. Vannaroni, T. R. Watters, and E. Zampolini (2005). Radar soundings of the subsurface of Mars, Science 310, 1925–1928.  REFERENCES  363  M. Pieraccini, L. Noferini, D. Mecatti, C. Atzeni, R. Persico, and F. Soldovieri (2006). Advanced processing techniques for step-frequency continuous-wave penetrating radar: The case study of “Palazzo Vecchio” walls (Firenze, Italy), Research on Nondestructive Evaluation 17, 71–83. W. H. Press, B. P. Flannery, S. A. Teukolsky, and W. T. Vetterling (1987). Numerical Recipes, Cambridge University Press, Cambridge, UK. J. C. Ralston and D. W. Hainsworth (2000). Use of ground penetrating radar in underground coal mining, in Proceedings of the VIII International Conference on Ground Penetrating, pp. 731–736. L. Robinson, W. B. Weirand, and L. Yung (1974). Location and recognition of discontinuities in dielectric media using synthetic RF pulses, Proceedings of the IEEE 62(1), 36–44. J. Sala and N. Linford (2010). Processing stepped frequency continuous wave GPR system to obtain maximum value from archaeological data sets, in Proceedings of the XIII International Conference on Ground Penetrating, Lecce, Italy, June 21–25. L. Sambuelli, G. Bohm, P. Capizzi, E. Cardarelli, and P. Cosentino (2011). Comparison between GPR measurements and ultrasonic tomography with different inversion algorithms: an application to the base o fan ancient Egyptian sculpture, Journal of Geophysics and Engineering 8(3), 106–116. K. J. Sandmeier (2003). Reflexw 3.0 manual, Sandmeier Software, ZipserStrabe1 D-76227, Karlsruhe, Germany. M. Sato and K. Takahashi (2009). Development of dual sensors and deployment in mine affected countries, in K. Furuta and J. Ishikawa, eds., Anti-personnel Landmine Detection for Humanitarian Demining, pp. 27–44, Springer, London. W. A. Schneider (1978). Integral formulation for migration in two and three dimensions, Geophysics 43(1), 49–76. R. E. Sheriff (1980). Nomogram for Fresnel-zone calculation, Geophysics 45(5), 968–972. M. Slaney, A. C. Kak, and L. E. Larsen (1984). Limitations of imaging with first order diffraction tomography, IEEE Trans. Microwave Theory and Techniques MTT-32, 860–874. D. Slepian and H. O. Pollak (1961). Prolate spheroidal wave functions, Fourier analysis and uncertainty—I, The Bell System Technical Journal, 40(1), 43–63. E. Slob, M. Sato, and G. Olhoeft (2010). Surface and borehole ground-penetrating-radar developments, Geophysics, 75(5), 75A103-75A120. D. G. Smith and H. M. Jol (1997). Radar structure of a Gilbert-type delta, Peyto Lake, Banff National Park, Canada, Sedimentary Geology 113(3–4), 195–209. F. Soldovieri, R. Persico, and G. Leone (2005a). Frequency diversity in a linear inversion algorithm for GPR prospecting Subsurface Sensing Technology and Applications 6(1), 25–42. F. Soldovieri, R. Persico, and G. Leone (2005b). Effect of source and receiver radiation characteristics in subsurface prospecting within the DBA, Radio Science 40, RS3006. F. Soldovieri, J. Hugenschmidt, R. Persico, and G. Leone (2007). A linear inverse scattering algorithm for realistic GPR applications, Near Surface Geophysics 5(1), 29–42. F. Soldovieri, G. Prisco, and R. Persico (2009). A strategy for the determination of the dielectric permittivity of a lossy soil exploiting GPR surface measurements and a cooperative target, Journal of Applied Geophysics 67(4), 288–295. M. Solla, C. Caamano, B. Riveiro, and H. Lorenzo (2011). GPR analysis of a masonry arch for structural assessment, in Proceedings of sixth International Workshop on Advanced Ground Penetrating Radar IWAGPR. Aachen, Germany. A. Sommerfeld (1912). Die Greensche Funktion der Schwingungsgleichung, Jber. Deutsch. Math. Verein. 21, 309–353.  364  REFERENCES  G. F. Stickley, D. A. Noon, M. Cherniakov, and I. D. Longstaff (1999). Gated stepped-frequency ground penetrating radar, Journal of Applied Geophysics 43(2), 259–269. D. E. Stillman and G. R. Olhoeft (2004). GPR and magnetic minerals at Mars temperatures, in Tenth International Conference on Ground Penetrating Radar, pp. 735–738. R. H. Stolt (1978). Migration by Fourier transform, Geophysics 43(1), 23–48. W. L. Stutzman and G. A. Thiele (1998). Antenna Theory and Design, 2nd edition, John Wiley & Sons, New York. W. Tabbra, B. Duchene, Ch. Pichot, D. Lesselier, L. Chommeloux, and N. Joachimowicz (1988). Diffraction tomography: Contribution to the analysis of some applications in microwave and ultrasonics, Inverse problems 4, 305–331. C. T. Tai (1991). Generalized Vector and Dyadic Analysis, IEEE Press, Piscataway, NJ. C. T. Tai (1994). Dyadic Green Functions in Electromagnetic Theory, 2nd edition, IEEE Press Series on Electromagnetic Waves, New York. A. N. Tikhonov and V. Y. Arsenine (1977). Solution of Ill-Posed Problems, Winston, Washington, DC. G. S. Timofei and M. Sato (2004). Comparative analysis of UWB deconvolution and featureextraction algorithms for GPR landmine detection, in R. S. Harmon, J. T. Broach, and J.H. Holloway, Jr., eds., Proceedings of the SPIE, Detection and Remediation Technologies for Mines and Minelike Targets IX, Vol. 5415, pp. 1008–1018. G. C. Topp, J. L. Davis, and A. P. Annan (1980). Electromagnetic determination of soil water content: Measurements in coaxial transmission lines, Water Resources Research 16(3), 574–582. C. Torres-Verdín and T. M. Habashy (2001). Rapid numerical simulation of axisymmetric singlewell induction data using the extended Born approximation, Radio Science 36(6), 1287–1306. V. Utsi and E. Utsi (2004). Measurement of reinforcement bar depths and diameters in concrete, in E. Slob, A. Yarovoy, and Rhebergen J, eds., Proceedings of the Tenth International Conference on Ground Penetrating Radar, pp. 658–662, Delft, the Netherlands. J. Van Bladel (2007). Electromagnetic Fields, 2nd edition, IEEE Press, Hoboken, NJ. G. Villain, X. Dérobert, Z. M. Sbartaï, and J. P. Balayssac (2010). Evaluation of concrete water content and other durability indicators by electromagnetic measurements, in Proceedings of XIII International Conference on Ground Penetrating Radar, pp. 165–170, Lecce, Italy. A. Witten, A. Schatzenberg, and A. Devaney (1996). Vector radar diffraction tomography maximum likelihood estimation, Journal of Environmental & Engineering Geophysics 1(B), 91–104. R. Yelf (2004). Where is the true zero time?, in Proceedings of Tenth International Conference on Ground Penetrating Radar, pp. 279–282. O. Yilmaz (1987). Seismic Data Processing, B. Edwin Neitzel, ed., Society of Exploration Geophysicists, p. 339, Tulsa, OK.  INDEX  Adjoint operator, 232 Agriculture, 6 Aliasing, 32, 35, 45–46 Angle critic, 152 effective maximum view, 140–143, 154–157, 181, 210–213, 221, 254 effective minimum view, 140 limited view, 130, 137, 169, 210, 288, 293 maximum view, 137–139 minimum view, 137–139 Antenna array, 5–6, 228, 307 bow tie, 7 dipole, 7 Hertzian dipole, 80, 187, 211, 219, 226, 228, 311 horn, 8 spiral, 7 Vivaldi, 8 Antenna pattern, 1, 28, 73, 152, 157 Approximation Born (BA), 8–9, 116, 119, 205 extended Born, 8 Kirchoff, 8 Rytov, 8 Archaeology, 5 Asphalt monitoring, 5–7 Background medium, 10–12, 109–110, 120–121 removal, 111–113, 163–168, 295–304 scenario, see Background, medium  Born Approximation, see Approximation series, 101–102, 116–117 sequence, 101, 116 Civil engineering, 5 Coaxial cable, 7 Coefficient Fresnel, 197–200, 340–345 reflection, 29–30, 68, 197, 198, 202–204, 340–345 transmission, 68, 197–198, 340–345 Common depth point (CDP), see Common midpoint (CMP) Common midpoint (CMP), 7, 25–27, 250–252 Common offset, 13, 17, 242–250 Component in-phase (I), 41–42 in-quadrature (Q), 42 transverse electric (TE), 197–198, 201–202, 337–345 transverse electromagnetic (TEM), 157 transverse magnetic (TM), 197–198, 201–202, 337–345 Content spatial, 240, 274–280 spectral, 239–240, 274–280 Contrast dielectric, 48–49, 59, 94, 100–103, 106, 120–121, 180 magnetic, 49, 86–88, 91–95, 158–160 Convergence least square, 40  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  365  366  Convergence (cont’d) punctual, 40 uniform, 40 Data contactless, 23, 155 interfacial, 13, 17–18, 25, 242, 245 raw, 4, 113, 289 Deconvolution, 8 Delta Dirac, 53, 186 Kronecker, 231 Demining, 5–8 Demodulation heterodyne, 41 homodyne, 41–43 Density electric charge, 50, 53 electric current, 50–51, 61, 183 magnetic charge, 50, 80 magnetic current, 50, 83, 86, 91 Dielectric permittivity, 6, 10–11, 30–31, 35, 48–50, 80, 96, 148 Differential configuration, 110–111, 160–163 Diffraction curves, 15–27, 242, 245, 247–251 Diffraction hyperbola, 14–18, 242, 245–246, 250–252 Diffraction tomography (DT), 122–123, 130, 161, 205 Direct coupling, 26, 108, 187 Dispersion, 7, 11, 31, 49 Double sequence of investigation domains, 292–294 Dynamic, 35, 45 Eigenvalues, 231–234 Eigenvectors, 231–234 Electric conductivity, 10–11, 31, 50, 96 Equation continuity, 50, 80, 190 harmonic, 55, 331 Helmholtz, 54, 62, 82, 189, 335 Maxwell, 50–53, 79–80, 188 scattering, 48, 60, 69, 93–95, 182, 184, 204 Extent of the investigation domain, 284 Fast Fourier transform (FFT), 33 Field electric, 50, 182  INDEX  far, 69, 72–73 incident, 52, 60–61, 68–69, 80, 107–109, 111–113, 118–121, 182, 185–187 magnetic, 50, 67, 80, 84, 183 near, 247, 282, 285 scattered, 8–9, 52–54, 59, 75, 79–80, 84, 86–87, 91–95, 105–113, 117, 120, 182, 204 total, 9, 86, 106–111, 118, 255 Filamentary current, 51, 53, 61, 69, 128, 152, 226 Finite difference in time domain (FDTD), 243, 254, 278 Fitzgerald vector, see Potential Forensic applications, 6 Forward problem, 96 Fourier–Laplace transform, 126 Fourier transform, 4, 33, 45, 49–50, 54–55, 192–194, 220, 329–330 Function basis, 229, 272, 295 Bessel, 216, 346–348 cost, 98–100, 244–245 Dirichlet sine, 38, 45, 165 Green’s, half-space 3D, 197–203 homogeneous 3D (dyadic), 187–188, 191 homogeneous 3D scalar, 329 external 2D, 60, 77 internal 2D, 60 external 3D, 200 internal 3D, 203 Hankel, 176 Heaviside, 178–179, 334 Hermitian, 33 signum, 86 sinc, 37, 144, 162 step, 252, 272 Gain, 9, 259, 289, 294, 307 Gauge of Lorentz, 82, 189 Gauss theorem, 331 Gaussian noise, 255, 266, 272, 278, 297 Geometrical series, 102 Ground penetrating radar (GPR) pulsed, 4, 36, 45–46 reconfigurable, 306 stepped frequency, 4, 32–34, 38, 40, 46, 148, 306 Ground truthing, 14  INDEX  Half derivative, 180, 334 Height of the observation line, 150–155, 249–250 Hermitian image, 40, 45 Hermitian scalar product, 193, 231 Hertzian dipole, see Antenna Ice, 6–7 Ill-conditioning, 237 Ill-posedness, 96–97, 100, 103 Impedance, 28–31, 73 Integration time, 31 Inverse fast Fourier transform (IFFT), 33, 172, 220–221 Jacobian, 221 Laplacian scalar, 54, 189, 330 vector, 54, 81, 189 Least square solution, 18, 98, 234–235 Length critical, 166 effective, 73–74, 182–183, 187 Linear inversion, 48, 262 sampling, 8 Local minima, 98–100 Losses, 10–11, 27–29, 145 Magnetic permeability, 10, 30, 48–49, 51, 54, 80 Marker, 3 Mars, 6 Matrix Hermitian, 236 pseudo-inverse, 235 unitary, 232 Method of moments (MoM), 229 Microwave frequency range, 2, 7, 77 imaging, 109 Migration f–k, see Stolt Kirchhoff 2D, 175, 178–179 3D, 222–226 polar 2D, 173–174 3D, 221  367  Stolt 2D, 9, 173 3D, 219, 222 Mines and pits, 6 Monostatic, 18 Multibistatic, 171 Multimonostatic, 280 Multiple reflections, 12 Muting, 106, 109 Non-ambiguous depth, 35, 46 Non-Hermitian scalar product, 193 Non-interfacial data, see Contactless data Non-linearity, 96–97, 103, 110, 118, 120–121 Nyquist rate, 46–47, 147–148, 150, 212–213 Odometer, 2–3, 213 Optical path, 22, 134 Orthonormal basis, 231 Peripheral targets, 142, 286–288 Point matching, 229 Point spread function, 143, 214 Potential Fitzgerald vector, 80, 82, 88, 93 scalar, 81, 189 vector, 188–189, 335 Plane wave spectrum, 61, 63–65, 69, 192, 196–197, 200, 202 visible, 65 Problem forward, 96 inverse, 97 Propagation velocity, 10–27, 30, 242–252 Radiation condition, 53, 55–56, 62, 72, 83 Rank, 231–232 Reciprocity theorem, 74 Regularization, 97, 219, 233, 237–240 Residuals, 195, 330 Resolution horizontal 2D, 142–145, 155, 252, 261–262 3D, 213, 216–217 vertical 2D, 145–146 3D, 217, 264–270  INDEX  368  Retrievable spectral set 2D, 126–128, 137, 139–140, 143, 171 3D, 210–213, 220 Ringing, 12, 109 Round-trip, 12, 22–23, 35, 110, 134 SAR effect, 8, 145 Scan A-, 4 B-, 4, 8–9, 112, 140, 145, 211, 304 C-, 4, 8, 206, 213 Scattered voltage, 75–76 Scattering 2D, 48, 60, 79, 93–95 3D, 182, 184, 204 inverse, 9, 96–97, 100, 103 Sedimentology, 6 Singular value decomposition (SVD), 229, 234, 236, 238 Singular values, 235–239 Singular vectors, 235–238 Slices, 307–310, 312–322, 325–326 Snell’s law, 23, 26, 67, 152, 281 Sommerfeld’s integrals, 60 Source elementary, 53, 55 primary, 53, 69, 86, 94, 185–186 secondary, 53, 80, 83, 86, 94, 120, 186 Spectral weight, 126–130, 151–167, 175, 208–211, 219, 221 Stationary phase, 71–73, 124–125, 133–135, 151–153, 208 Statistical minimization, see Stochastic minimization  Stochastic minimization, 8, 99 Step frequency, 32–35, 40, 45, 148–149, 217–218, 264–269 spatial, 147–148, 166, 211–213, 252–264 time, 32, 45–47, 149–150, 217–218 Synthetic pulse, 34, 38–42 Synthetic time, 33–35 Thresholding, 237–239 Time domain reflectometry (TDR), 11, 28–31 Transect, 206, 211–213 Trial unknowns, 238, 271–274 Visible circle, 65, 210–214 Visible interval, 126–127, 137–138, 147, 152–154 Waveguide, 8, 26 Wavelength, 14, 99, 122, 139-147, 151–155, 163, 201, 217, 254, 282, 285, 307, 353–355 Wave-number, see Wavenumber Wavenumber, 10, 29, 65, 138, 140, 143, 145, 174, 187, 231, 329, 345 Wavevector, 63, 66, 72–74, 195 Weak scatterer, 120–121 Wide angle reflection and refraction (WARR), 7 Zero padding, 288, 292 Zero timing, 105–106  Return time [sec.]  0  ×10–8  1 2 3 –1.5  –1  –0.5  0  0.5  1  1.5  0.5  1  1.5  Return time [sec.]  x [m] 0  ×10–8  1 2 3 –1.5  –1  –0.5  0 x [m]  Figure 2.6 Quantitative comparison between the diffraction curve with offset equal to 0 cm (blue line), 10 cm (red line), and 50 cm (black line). The propagation velocity is 108 m/s. The depth of the target is 12.5 in the upper panel and 75 cm in the lower panel.  Tx  Rx Air Soil  A  B  Figure 8.1 Schematic for the physical reason of the nonlinearity of the scattering. The black arrows represent the direct contributions of the two small buried targets separately considered. The red arrows represent the contribution of the mutual interaction between A and B to the scattered field.  Introduction to Ground Penetrating Radar: Inverse Scattering and Data Processing, First Edition. Raffaele Persico. © 2014 The Institute of Electrical and Electronics Engineers, Inc. Published 2014 by John Wiley & Sons, Inc.  (a)  ζ [m–1]  80 60 40 20 0  –50  0  50  η [m–1]  (b)  ζ [m–1]  80 60 40 20 0  –50  0  50  η [m–1]  (c)  ζ [m–1]  80 60 40 20 0  –50  0  50  η [m–1]  (d)  ζ [m–1]  80 60 40 20 0  –50  0  50  η [m–1]  Figure 9.19 Red dashed lines: the modulus of the erasing function (emphasized by a factor 5 for graphic reasons). Blue dot lines: the erasing belts deriving from the erasing function. Solid black line: the spectral set without the differential effect. The parameters are: fmin = 200 MHz, fmax = 600 MHz, εsr = 4, μsr = 2. Panel a: Δ = 3.83 cm. Panel b: Δ = 7.65 cm. Panel c: Δ = 10.21 cm. Panel d: Δ = 15.31 cm. The erased belt is calculated according to Eq. (9.75).  Parallel B-scans z Air  x T  h y  Soil  Figure 12.1 Geometrical scheme of the common offset C-scan. (a)  Panel A: 2D Z Observation Point d3b d2b  X d1 d2a d3a Target ... X  Y  Source  (b)  Panel B: 3D Z Observation Point  Source  X Target  d1  Y  Figure 13.1 Pictorial of a 2D (panel A) and a 3D (panel B) geometry with an impulsive point-like source and a point-like target.  Observation line Σ Air Soil  θ3 dmin  h3 h2 h1 = 0 θ2 θ1  Investigation domain D  Figure 15.40 Pictorial of the reduction of the maximum view angle when increasing the height of the observation line.  h = 10 cm  60  60  40  40  ζ [m–1]  ζ [m–1]  h = 0 cm  20 0  –50  0  20 0  50  –50  60  60  40  40  20 0  –50  0  20 0  50  –50  60  60  40  40  20  –50  50  0 –1  η [m ]  0  50  h = 50 cm  ζ [m–1]  ζ [m–1]  h = 40 cm  0  50  h = 30 cm  ζ [m–1]  ζ [m–1]  h = 20 cm  0  20 0  –50  50  0 –1  η [m ]  Figure 15.41 Spectral content of the singular functions (threshold of the singular value at −20 dB), together with the DT bound of the spectral retrievable set (red lines) at variance of the height h of the observation line.  Y-Distance [Meter] 3 2 1 0 0  XM00100010.00T  12 11 10 9 8 7 6 5 4  10  Y-Distance [Meter] 3 2 1 0 0  YM00100010.00T  12 11 10 9 8 7 6 5 4  10  Y-Distance [Meter] 3 2 1 0 0  XYMBIS00100010.00T  12 11 10 9 8 7 6 5 4  10  Figure 15.72 Depth slices at 47 cm obtained with Reflexw through a 2D migration-based processing. Upper panel: Result obtained from the B-scans parallel to only the x-axis. Middle panel: Result obtained from the B-scans parallel to only the y-axis. Lower panel: Result obtained from the B-scans parallel to both the x-axis and the y-axis. The axes are in meters.  0  2  4  6  8  10  12  0  2  4  6  8  10  12  0  2  4  6  8  10  12  0 2 4 6 8 10 12  0 2 4 6 8 10 12 0 2 4 6 8 10 12  Figure 15.73 Depth slices at 47 cm obtained with GPRSLICE through 2D migration-based processing. Upper panel: Result obtained from the B-scans parallel to only the x-axis. Middle panel: Result obtained from the B-scans parallel to only the y-axis. Lower panel: Result obtained from the B-scans parallel to both the x-axis and the y-axis. The axes are in meters.  0  2  4  6  8  10  12  0  2  4  6  8  10  12  0  2  4  6  8  10  12  0 2 4 6 8 10  0 2 4 6 8 10  0 2 4 6 8 10  Figure 15.74 Depth slices at 47 cm obtained with GPRSLICE through a 3D migration-based processing. Upper panel: Result obtained from the B-scans parallel to only the x-axis. Middle panel: Result obtained from the B-scans parallel to only the y-axis. Lower panel: Result obtained from the B-scans parallel to both the x-axis and the y-axis. The axes are in meters.  