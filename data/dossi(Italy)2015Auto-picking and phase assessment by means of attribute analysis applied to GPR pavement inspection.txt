Dossi
Auto-picking and phase assessment by means of attribute analysis applied to GPR pavement inspection
2015
IEEE

Auto-picking and phase assessment by means of attribute analysis applied to GPR pavement inspection
Abstract
We propose an automated procedure, based on attribute analysis, to quickly and objectively detect and characterize reflections along GPR profiles. The process uses the cosine of the instantaneous phase to mark as a horizon any event that shows lateral phase continuity, defining its time-space positions and peak amplitudes, to be used in interpretation and inversion processes. Such attribute allows to efficiently track even the weakest events, as well as those showing large lateral amplitude variations. Furthermore, the algorithm is able to extract the polarity of each reflection, by identifying their actual initial phase. This analysis is done by assessing the behavior of the cosine phase in the vicinity of each picked horizon, searching for other sub-parallel horizons that can be grouped into the same event. The proposed procedure is mostly independent from the interpreter, except for a few required thresholds. Moreover, since it uses only the cosine phase, it can be applied to data sets after basic processing without the need of any amplitude recovery, which introduces a certain degree of subjectivity on the results and prevents further quantitative analyses and data inversion. In this paper we validate the method and discuss its accuracy, as well as its limitations and possible applications. The algorithm successfully tracked events with lateral phase continuity in the tests performed on GPR data acquired on an airport runway.
Keywords
attribute analysis; auto-picking; GPR; pavement inspection; phase assessment.
INTRODUCTION
Since the first tests performed in the early 1980s, common offset GPR surveys have become an important tool for the inspection and maintenance of infrastructures such as road pavements, bridges and tunnel walls [1-4]. GPR surveys are non-destructive, less time-consuming and provide higher data densities with respect to traditional methods like coring.
Moreover, modern GPR systems can perform measurements at high rates, allowing high-speed surveys with negligible impact on traffic. The results are quasi-continuous images of the subsurface, with varying degrees of resolution and penetration, depending on factors like the antennas used, the acquisition parameters, the analyzed structure and materials, as well as external noise sources at the particular survey location [5].
Automated reflection picking and characterization procedures are crucial to quickly extract quantitative information such as reflection amplitudes and travel times.
Such quantities are essential for road inspection and maintenance [1], in particular to study the structural and material properties of the subsurface. Examples of application  include the detection of damaged road sections, characterized for instance by porous zones, delamination or cracks [2-4]; the evaluation of pavement’s thickness and stratification [6, 7]; and the estimation of in-situ density and moisture content [8].
All these applications are helpful in determining the road’s condition and remaining service life, planning possible future rehabilitation work, and improving pavement design.
Several horizon picking methods exist, differing in picking criteria, approximations adopted and accuracy of the results.
Such techniques include manual picking, interpolation, autopicking, voxel tracking and surface slicing [9]. The procedure presented in this paper belongs to the auto-picking methods, whose fundamental purpose is to quickly and accurately perform straightforward event correlations along profiles [10], leaving to the interpreter the possibility to intervene in complex areas where the picking algorithm may fail. In particular, the proposed algorithm uses attribute analysis to automatically track all the events characterized by lateral phase continuity in a GPR profile, without the need of any manually picked control point (or seed). Moreover, besides recording reflection amplitudes and travel times, the algorithm is able to determine the initial phase (i.e. the polarity) of each reflection, which is essential to recover the subsurface reflectivity, and therefore to study its constitutive materials.
In this paper we apply the automated picking and phase assessment procedure to 500 MHz and 1.6 GHz GPR profiles acquired along an airport runway and we critically evaluate its performance. The main procedural steps and mathematical background of the algorithm are also discussed, highlighting both advantages and limitations.
ATTRIBUTE ANALYSIS 
The proposed procedure is based on complex trace analysis, which treats the recorded signal as the real part of a complex trace [11]. The complex GPR trace is defined by a vector with time-varying modulus and phase, respectively called reflection strength and instantaneous phase. These two attributes can be calculated using the imaginary trace, also called quadrature trace, obtained from the recorded trace through a Discrete Hilbert Transform (DHT) operator [11-13].
We are interested in the cosine of the instantaneous phase, also called cosine phase, which removes the ±180° phase wrapping and allows to track reflections better than amplitudes [12, 14].
Let’s consider a digital trace made of N samples An defined in the time interval [0, (N – 1) t], where t is the sampling interval. Assuming that the signal is identically null outside of the recorded time interval, the corresponding samples of the quadrature trace A'n and of the cosine phase trace cos[ n] are respectively given by [11]: A'n =  2 π  M  sin2 πk/2  k  k=–M  cos θn =  An A2 +A'2 n  with k ≠ 0 and n  An – k  n  0, 1, … , N – 1.
In order to avoid attribute distortions, a truncation value M has been applied to the DHT operator in Eq. 1, which would otherwise cover the entire recorded trace. Such distortions can be caused by strong signals, which are able to counteract the 1/k decay of the DHT operator and become dominant in the calculation of the quadrature trace along distant unrelated weaker events. A clear example is the airwave-groundwave interference, which is generally several times stronger than most of the other recorded events in a GPR trace, except for particular sites with very strong and usually shallow reflectors.
Using a truncated DHT operator is equivalent to calculating the attributes over a shorter trace, identically null outside the time interval 2M t. Also the truncation allows to make the attribute calculation noticeably faster. We set M such that the DHT window width 2M t is about the time interval of the transmitted wavelet, however making sure that M is high enough so that the attribute calculation is stable enough.
DESCRIPTION OF THE PROPOSED PROCEDURE 
Automated horizon picking 
The cosine phase profile acts as if all the amplitudes were normalized to 1 in modulus. Each phase in the profile is potentially part of a reflection, and the algorithm identifies all of them by marking the zero-crossings and the cosine maxima (for peaks) and minima (for troughs) between them. Distorted phases can be filtered out by setting thresholds for instance on their time interval (removing those too long or too short) or on their peak cosine (removing those considerably lower than 1 in modulus). The remaining phases are then individually analyzed and automatically connected to form horizons: two phases in adjacent traces are considered part of the same horizon if they show the same polarity and close travel times.
A maximum threshold must be set for the difference in travel times, so that distant unrelated phases are not connected in the same horizon, while also taking into account the possible presence of dipping events. The picked horizons cannot cross one another, and a minimum length is set for a horizon to be accepted. After constructing all possible horizons, the unconnected phases are deleted and the picking results are superimposed on the GPR profile for visual analysis and interpretation. Amplitude-based thresholds can also be set to display just the strongest (or weakest) events.
This process differs from the usual picking techniques, where the interpreter manually picks initial control points from which the selected event is tracked using correlation methods [15]. The absence of initial seeds in the algorithm  greatly reduces the influence of the interpreter on the picking results, and all coherent events are objectively tracked.
However, the described procedure is sensitive to factors like diffractions and noise, which can deform or interrupt the horizons under construction. Therefore appropriate signal processing may be necessary before picking, including bandpass filtering, background removal and migration. Since the algorithm only uses the cosine phase, it can be applied to data without any gain function, which alters the amplitudes and introduces a certain degree of subjectivity.
The presence of noise can cause a long coherent event to be separated into a large number of shorter consecutive horizons. It is possible to automatically link consecutive horizons by using parallel horizons as patches. The algorithm treats each horizon as a potential patch, and searches for possible connectable horizons in its vicinity. Two consecutive horizons are connected if: (1) they have the same polarity and a gap width lower than a set threshold, (2) there is no other horizon crossing the gap, and (3) they are close in terms of travel times to the patching horizon at least at their connectable ends, and anyway closer than a set threshold. This process can greatly reduce the number of horizons, increasing their average length and so improving data interpretation.
Automated phase assessment 
The phase assessment procedure automatically analyzes all the picked horizons in order to identify the initial phase of the reflections to which they belong, determining whether the analyzed horizon is itself the first phase or a later one. Such assessment is done by analyzing the cosine phase in the vicinity of each horizon, searching for sub-parallel events that can be grouped into the same reflection. After selecting a horizon, a predefined number of earlier phases are marked in each trace. Such phases are then connected across adjacent traces on the basis of their marking number, producing lines with constant polarities that do not cross one another: the latest one is the selected horizon itself. The algorithm reconstructs the reflected wavelet by averaging the cosine phase along each line, and then analyzes the resulting shapes.
The general principle is that if a line is marking a sub-parallel event, the corresponding Averaged Cosine Trace (ACT) should preserve the shape of the wavelet, while other events are averaged out. If instead a line is connecting distant unrelated phases, the averaging should be totally destructive.
The algorithm iteratively analyzes each line, starting from the selected horizon, where the wavelet is considered preserved by construction, and then moving on to the earlier ones. The shape of the wavelet is deemed preserved along a given line if the corresponding ACT meets the two following conditions: (1) the peak central phase has to reach in modulus a minimum threshold close to 1, as expected in a cosine trace, otherwise the line is likely connecting unrelated phases with very different shapes and length; (2) the cross-correlation of the wavelet constructed from the line with the wavelet obtained from the previous line has to reach a predefined threshold. We use as cross-correlation threshold a percentage of the peak autocorrelation of the wavelet from the previous line, since we want to determine whether or not the examined wavelets are in fact the same. The first condition allows avoiding peculiar situations where the cross-correlation is acceptable, but both the compared shapes are unrelated to the transmitted wavelet. The analysis is iterated for each line until one of the two conditions is violated. The earliest line that satisfies both conditions can be thus considered the first arrival and marks the initial phase of the analyzed event. A similar procedure can be applied to later phases, in order to recover the last phase of each event and estimate the total number of phases of each reflection. In this way we can disregard those horizons caused by noise or interference that are characterized by an insufficient number of phases.
The phase assessment allows to group separately picked horizons into the same event, and to select the earliest one (or any other) for further analysis and interpretation. The result for a given event does not generally depend on the horizon initially selected, since two horizons from the same reflection should have the same initial phase, except in particular cases of interference or low signal-to-noise ratio. In such cases, the results can be unpredictable. The process is also sensitive to vertical resolution, since close parallel reflections can be grouped into a single event, therefore compromising the analysis of the deeper horizons.
APPLICATION TO PAVEMENT INSPECTION 
We applied the picking and phase assessment procedure to two GPR profiles acquired along the same section of an airport runway, featuring a transition from a concrete plate (left side) to asphalt pavement (right side). We used a dualchannel ProEx GPR system, equipped with 500 MHz and 1.6 GHz ground-coupled bistatic Malå Geoscience shielded antennas. The processing sequence consists of DC removal, drift correction, background removal, band-pass filtering, and muting. The cosine phase was calculated in the two cases using 6 and 3 ns wide DHT windows, respectively, both corresponding to 33 samples (i.e. M equal to 16 in Eq. 1). As discussed in the previous section, the phase assessment was used to isolate those horizons with at least one recognized subparallel event, i.e. belonging to reflections with at least two identified phases, while the other horizons were disregarded.
Figs. 1 and 2 show the results for the 500 MHz and 1.6 GHz profiles, respectively. It is evident from Fig. 1B that the cosine phase allows enhanced tracking of reflections, when compared with the original profile (Fig. 1A), without the need of any amplitude recovery. Distortions in the attribute calculation caused by the airwave-groundwave interference can be noticed between 4 and 6 ns in Fig. 1B, as well as residual high-frequency noise at greater depths. As expected, the 1.6 GHz profile (Fig. 2) shows higher resolution, but lower penetration. The picked horizons (Figs. 1C and 2A) accurately mark all coherent events, regardless of their reflection strength or lateral amplitude variations. The algorithm respectively picked 974 and 1054 initial horizons, then reduced to 679 and 850 by the horizon patching process. We set a minimum horizon length of 5 traces, and a maximum gap width of 7 traces. The phase assessment identified in the two cases 403 (i.e. 59.35%) and 381 (i.e. 44.82%) horizons belonging to events with at least two recognized phases. Of these horizons, those automatically identified as second phases of their respective events are shown in Figs. 1D and 2B.
As explained in the previous section, some of the latter horizons may not be the actual second phases of their respective events, since the analysis is sensitive to noise, interference and overlapping. For example, the second phase of the airwave-groundwave interference is not recognized as such in Fig. 2B, due to distortions in the first phase which interrupt the assessment. Nevertheless, the algorithm is able to automatically recognize in Fig. 1D five main reflectors, marked H1-H5. In Fig. 2B reflector H1 is still visible, while the others could not be recovered due to the lower signal penetration. In fact, most of the deeper horizons in Fig. 2A are caused by random noise, with few of them belonging to events with more than one recognizable phase. On the other hand, the higher frequency in Fig. 2B allows to recover reflector H6, which is not clearly visible in Fig. 1D due to overlapping.
An example of phase assessment is given in Fig. 3, applied to the horizon marked in blue in Fig. 1C. The horizon is flattened and centered to better highlight surrounding subparallel events in the cosine phase profile. The lines used for the analysis are also shown, with the resulting ACTs given below for the horizon (graph 1) and the three earlier lines (graphs 2-4). The cross-correlating wavelets are superimposed in grey, and the analysis shows good correlations in graphs 2 and 3, but not in graph 4, where the shape of the reflected wavelet has not been preserved. This indicates that line 4 is marking unrelated phases, with a totally destructive averaging effect in the corresponding ACT. Therefore the analysis is stopped and the reflection is deemed to start with the positive phase marked by line 3, while the selected horizon is identified as the third phase of the analyzed reflection.
CONCLUSION 
We present an automated horizon picking procedure that uses the cosine phase to quickly and objectively detect and characterize reflections in a GPR data set. The algorithm was tested on 500 MHz and 1.6 GHz profiles from an airport runway. It successfully identified all the recorded events characterized by lateral phase continuity. The phase assessment is able to group the horizons picked in the main reflections. The procedure shows some limitations in areas affected by noise, interference or overlapping, and ultimately the interpreter has to select the horizons to be used for interpretation or inversion. Nevertheless the horizons are picked using well defined and objective criteria, while the phase assessment can help the interpretation by automatically identifying the main reflections. Further research will focus on the effects of the sampling interval on the attribute calculation.
ACKOWLEDGMENT 
This research is partially supported by the “Finanziamento di Ateneo per progetti di ricerca scientifica - FRA 2014” of the University of Trieste. The GPR test data sets are property of Esplora srl, which is gratefully acknowledged.

Figures
Analysis of a 500 MHz GPR runway section, with the processed amplitude profile (A), the corresponding cosine phase profile (B), the picked horizons (C), and those identified as the second phases of reflections with at least two recognized phases (D). The profile features a transition between a concrete plate (left) and asphalt pavement (right). Positive amplitudes are marked in green, negative amplitudes in red. The horizon marked in blue (C) is used in Fig. 3 to better illustrate the phase assessment procedure.
Analysis of a 1.6 GHz GPR profile, acquired along the same section of Fig. 1, with the picking (A) and phase assessment results (B) as in the previous case. Positive amplitudes are marked in green, negative amplitudes in red. The profile shows higher resolution but lower penetration than Fig. 1.
Example of phase assessment applied to the blue horizon of Fig. 1C, here flattened at relative time 0 to better highlight surrounding sub-parallel events. The averaging lines are superimposed to the cosine phase, marking both positive (green) and negative (red) phases. The graphs underneath show the averaged cosine traces (black) of the horizon (1) and of the three earlier lines (2-4), with superimposed the wavelets (grey) used for cross-correlation.