Bostanudin
Computational Methods for Processing Ground Penetrating Radar Data
2013
University of Portsmouth

Abstract The aim of this work was to investigate signal processing and analysis techniques for Ground Penetrating Radar (GPR) and its use in civil engineering and construction industry. GPR is the general term applied to techniques which employ radio waves, typically in the Mega Hertz and Giga Hertz range, to map structures and features buried in the ground or in manmade structures. GPR measurements can suffer from large amount of noise. This is primarily caused by interference from other radio-wave-emitting devices (e.g., cell phones, radios, etc.) that are present in the surrounding area of the GPR system during data collection. In addition to noise, presence of clutter – reflections from other non-target objects buried underground in the vicinity of the target can make GPR measurement difficult to understand and interpret, even for the skilled human, GPR analysts. This thesis is concerned with the improvements and processes that can be applied to GPR data in order to enhance target detection and characterisation process particularly with multivariate signal processing techniques. Those primarily include Principal Component Analysis (PCA) and Independent Component Analysis (ICA). Both techniques have been investigated, implemented and compared regarding their abilities to separate the target originating signals from the noise and clutter type signals present    i        in the data. Combination of PCA and ICA (SVDPICA) and two-dimensional PCA (2DPCA) are the specific approaches adopted and further developed in this work. Ability of those methods to reduce the amount of clutter and unwanted signals present in GPR data have been investigated and reported in this thesis, suggesting that their use in automated analysis of GPR images is a possibility. Further analysis carried out in this work concentrated on analysing the performance of developed multivariate signal processing techniques and at the same time investigating the possibility of identifying and characterising the features of interest in pre-processed GPR images. The driving idea behind this part of work was to extract the resonant modes present in the individual traces of each GPR image and to use properties of those poles to characterise target. Three related but different methods have been implemented and applied in this work – Extended Prony, Linear Prediction Singular Value Decomposition and Matrix Pencil methods. In addition to these approaches, PCA technique has been used to reduce dimensionality of extracted traces and to compare signals measured in various experimental setups.  Performance analysis shows that Matrix Pencil offers the best  results.    ii        Contents Abstract  i  List of Figures  xi  List of Tables  xix  List of Abbreviations  xxi  List of Symbols  xxv  Declaration  xxvii  Acknowledgements  xxviii  Dissemination  xxx  Chapter 1 Introduction ................................................................................ 1 Overview .................................................................................................... 1 1.1  Ground Penetrating Radar................................................................ 1  1.2  Objectives ........................................................................................ 4  1.3  Summary of Previous Work............................................................. 8 1.3.1 GPR as a Detection Tool ...................................................... 8 1.3.2 GPR Technology in Civil Infrastructures ............................ 9 1.3.3 Signal Processing for GPR ................................................... 9  1.4  Thesis Structure ............................................................................. 12  Chapter 2 Ground Penetrating Radar ..................................................... 15 Overview .................................................................................................. 15 2.1  Introduction .................................................................................... 15   iii         2.2  Advantages and Disadvantages of GPR ........................................ 21  2.3  Basic Principles of GPR................................................................. 23 2.3.1 Electromagnetic Properties in Dielectric Materials ........... 24 2.3.1.1 Permeability ..............................................................24 2.3.1.2 Electrical Conductivity.............................................. 25 2.3.1.3 Permittivity ...............................................................26 2.3.2 Data Collection Parameters ................................................ 27 2.3.2.1 Wave Velocity...........................................................27 2.3.2.2 Wavelength................................................................28 2.3.2.3 Relationship between Frequency and Depth ............. 29 2.3.2.4 Relationship between Frequency and Resolution ..... 29 2.3.3 Determination of Layer Thickness and Feature Depth ...... 29 2.3.4 Electromagnetic Wave Physics .......................................... 30 2.3.4.1 Target Reflection and Feature Identification ............ 30 2.3.4.2 Background Noise and Clutter .................................. 33 2.3.5 Distance Normalisation ...................................................... 34  2.4  Types of Data Collection ............................................................... 35  2.5  Types of GPR System .................................................................... 37  2.6  GPR Data ....................................................................................... 40 2.6.1 Simulated Data ................................................................... 40 2.6.1.1 Basic Concepts of GPR Modelling ........................... 41 2.6.1.2 Coordinate System of GPRMax2D ........................... 44    iv        2.6.1.3 GPR Modelling with GPRMax2D ............................ 45 2.6.1.4 General Structure of GPRMax2D Input File Commands ................................................................46 2.6.2 Experimental (Measured) Data .......................................... 50 2.6.2.1 PVC Pipes Detection ................................................. 50 2.6.2.2 Cracks and Defect within Water Reservoirs Detection ...................................................................53 2.6.2.3 Cracks on a Concrete Slab Detection ........................ 56 2.7  Glossary of Terms .......................................................................... 58  Chapter 3 Pre-processing using ReflexW ................................................ 61 Overview .................................................................................................. 61 3.1  Introduction .................................................................................... 61  3.2  ReflexW Software .......................................................................... 64  3.3  Basic GPR Data Processing Steps ................................................. 64 3.3.1 Data Editing ....................................................................... 66 3.3.2 Dewow Filtering ................................................................ 68 3.3.3 Topographic Corrections.................................................... 69 3.3.3.1 Elevation Static Correction ....................................... 70 3.3.3.2 Maximum Phase Correction ...................................... 72 3.3.4 Time-Zero Correction ........................................................ 73 3.3.5 Filtering .............................................................................. 74 3.3.5.1 Temporal Filters ........................................................ 75    v        3.3.5.2 Spatial Filters .. ......................................................... 78 3.3.6 Gain Function ..................................................................... 80 3.3.7 Migration ............................................................................ 84 3.4  ReflexW Processing of the Measured GPR Image in this Work ... 85  3.5  Conclusion ..................................................................................... 88  Chapter 4 Multivariate Pre-processing Techniques for GPR Images .. 90 Overview .................................................................................................. 90 4.1  Introduction .................................................................................... 90  4.2  Review of Prior Research .............................................................. 91 4.2.1 Previous Work in Signal Processing .................................. 91 4.2.2 Multivariate Analysis in GPR Application ........................ 93  4.3  Multivariate Analysis ..................................................................... 95 4.3.1 Principal Component Analysis........................................... 95 4.3.1.1 One-Dimensional Principal Component Analysis (1DPCA)....................................................................99 4.3.1.1.1 PCA via Eigenvalue Decomposition of Covariance Matrix..................................... 99 4.3.1.1.2 PCA via Singular Value Decomposition of Data Matrix ......................................... 104 4.3.1.1.3 Dimensionality Reduction using PCA .... 106 4.3.1.1.4 GPR Clutter Reduction using PCA ......... 109    vi        4.3.1.2 Two-Dimensional Principal Component Analysis (2DPCA) .................................................................111 4.3.1.3 Order Selection........................................................ 114 4.3.2 Independent Component Analysis (ICA) ......................... 114 4.3.2.1 Independent Component Analysis Algorithms ....... 119 4.3.3 Proposed Novel Algorithm .............................................. 121 4.4  Results .......................................................................................... 123 4.4.1 Algorithm Evaluation Parameters .................................... 124 4.4.1.1 Peak-Signal-to-Noise Ratio (PSNR) ....................... 125 4.4.1.2 Mean Structural Similarity (M-SSIM) Index .......... 126 4.4.2 Simulated Data ................................................................. 130 4.4.2.1 Clutter Reduction .................................................... 131 4.4.2.2 Unwanted Signals Reduction .................................. 136 4.4.3 Measured Data ................................................................. 136 4.4.3.1 Clutter Reduction .................................................... 137 4.4.3.2 Unwanted Signals Reduction .................................. 145  4.5  Conclusion ................................................................................... 151  Chapter 5 Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling ............................ 153 Overview ................................................................................................ 153 5.1  Introduction .................................................................................. 154  5.2  Techniques ................................................................................... 155    vii        5.2.1 Prony Analysis ................................................................. 155 5.2.2 Extended Prony Method................................................... 158 5.2.3 Linear Prediction Singular Value Decomposition (Kumaresan-Tufts) Method.............................................. 159 5.2.4 Matrix Pencil Method ...................................................... 160 5.3  Results .......................................................................................... 164 5.3.1 Synthesised Signals .......................................................... 164 5.3.2 GPR Signals and Model Order Estimation ...................... 168 5.3.2.1 Model Order Estimation Problem ........................... 168 5.3.2.2 Analysis of Measured GPR Signals ........................ 171 5.3.3 Towards Target Characterisation – Analysis of GPRMax Simulated Signals ............................................................. 183 5.3.4 Target Characterisation using Principal Component Analysis on Simulated Data ............................................. 187  5.4  Conclusion ................................................................................... 193  Chapter 6 Findings and Conclusions ..................................................... 195 Overview ................................................................................................ 195 6.1  Extended Summary of the Main Ideas and Work Done on the Project .......................................................................................... 195  6.2  Author’s Contributions ................................................................ 203  6.3  Recommendations for Further Work ........................................... 205 6.3.1 GPR Simulations .............................................................. 205    viii        6.3.2 GPR Measurements.......................................................... 205 6.3.3 Pre-processing Algorithms ............................................... 206 6.3.4 Analysis Algorithms ........................................................ 206 Bibliography .............................................................................................208 Appendix A: Chapter 2............................................................................ 227 A.1  Input Files of GPRMax Simulation on Joints, Holes and Cracks Detection ...................................................................................... 227 A.1.1 GPR 4 GHz Frequency for Joints and Holes ................... 227 A.1.2 GPR 4 GHz Frequency for Crack .................................... 228  A.2  Input Files of GPRMax Simulation on Pipes Detection .............. 229 A.2.1 GPR 4 GHz Frequency for Three Pipes in a Box ............ 229  A.3  Media File of the GPRMax Data ................................................. 230  A.4  Matlab Code for GPRMax ........................................................... 231  Appendix B: Chapter 4 ............................................................................ 233 B.1  Clutter Reduction Algorithms Code ............................................ 233  B.2  Unwanted Signals Reduction Algorithms Code .......................... 238  B.3  Built-in Functions Code ............................................................... 244 B.3.1 mrem.m ............................................................................ 244 B.3.2 imscale.m ......................................................................... 244  Appendix C: Chapter 5............................................................................ 246 C.1  One-dimensional Analysis Code.................................................. 246  C.2  Selecting Model Order Code ....................................................... 251    ix        C.3  Built-in Functions Code ............................................................... 255 C.3.1 myprincomp.m ................................................................. 255 C.3.2 spread.m ........................................................................... 256 C.3.3 sortpoles.m ....................................................................... 257    x        List of Figures Figure 1.1: Research system implementation. ............................................... 5 Figure 2.1: Typical GPR system. ................................................................. 16 Figure 2.2: Basic functional principle of a GPR device............................... 18 Figure 2.3: Principles of GPR in CMP mode which the transmitting and receiving antennas are moved away from each other [44]. ....... 19 Figure 2.4: Linescan and oscilloscope displays (right) show the (a) direct coupling and (b) reflections and diffraction hyperbola of GPR data scanned over the plywood top panel of the pipe in a box.. 31 Figure 2.5: Collecting the position of cracks in practical approach with measuring tape. ......................................................................... 34 Figure 2.6: GPR measurement taken across a pipe in a box of (a) onedimensional and (b) two-dimensional GPR data. The one dimensional data is taken at the distance of 0.4m in twodimensional image. (c) Three-dimensional GPR data represents an empty box. ............................................................................ 37 Figure 2.7: GPR Groundvue 5. .................................................................... 38 Figure 2.8: GPR Groundvue 3 with 400 MHz, 1 GHz, and Crack Detection Head antenna systems. .............................................................. 39 Figure 2.9: The two-dimensional GPR forward problem and its GPRMax2D domain bounded by ABC. ......................................................... 43   xi        Figure 2.10: The two-dimensional FDTD cell [58]. .................................... 45 Figure 2.11: Example of GPRMax2D input file in simulating concrete slab with joints using 1.5 GHz frequency radar. Red arrows represent lines that were deactivated and ignored by the program as the first character of each command starts without the hash character (#). ............................................................. 48 Figure 2.12: Example of GPRMax2D model............................................... 49 Figure 2.13: (a) Experimental setup used in collecting GPR data for pipes detection, (b) sand was placed in the small container box, (c) top panel with grid drawn on it, and (d) position of three pipes in the container box. ................................................................ 51 Figure 2.14: (a) Completed container boxes and (b) sand preparation for dry condition tests. ......................................................................... 54 Figure 2.15: (a) Preparation of concrete slabs and (b) two concrete slabs were ready with joints attached ............................................... 55 Figure 2.16: Introduction of holes and cracks on the concrete slabs. .......... 55 Figure 2.17: (a) Depiction of joints, holes, and cracks position and (b) the approximate positions of the radar traverses during the experiments. ............................................................................ 56 Figure 2.18: Data collection over a cracked concrete metal fibre mixtures slab. ......................................................................................... 57 Figure 3.1: Overview of GPR data processing flow [37], [62]. ................... 63    xii        Figure 3.2: GPR processing flow using ReflexW. ....................................... 65 Figure 3.3: Example of 'desaturation' function is used in correcting the clipped form of saturated traces [37]. ....................................... 67 Figure 3.4: Dewow filter correction on a raw GPR trace [37]. .................... 69 Figure 3.5: Datum statistics terminology [64]. ............................................ 70 Figure 3.6: The position of Sender/Receiver distance. ................................ 71 Figure 3.7: The application of maximum phase correction step to measured GPR data (a) before and (b) after. ............................................. 72 Figure 3.8: Time-zero variations in a selected 1.5 GHz GPR data. (a) Timezero position on the original GPR data (white dashed-line) and (b) the white dashed-line change in time-zero position. ........... 74 Figure 3.9: Principle of a simple band-pass filter in the frequency domain and the form of two common filter functions: a notch and Butterworth filters [37]. ............................................................ 77 Figure 3.10: Realistic example of the use band-pass Butterworth, background removal, and average subtraction filtering on a 4 GHz GPR section collected over a concrete slab with crack structure at 0.18 m. .................................................................. 80 Figure 3.11: Concept of time-varying gain where signal amplification varies with time [81]. ......................................................................... 81 Figure 3.12: The effect of inordinate acquisition gain selection [7]. ........... 82 Figure 3.13: Acquisition gain removal during pre-processing [7]. .............. 83    xiii        Figure 3.14: The problem – the reflected energy of the object is spread out over the different receiver positions leading to the measurement hyperbola. The idea of migration is to recombine this energy in one position [79]. .............................................. 84 Figure 3.15: Example of ReflexW process on GPR data to detect leakages from joints. .............................................................................. 88 Figure 4.1: Graphical model for Principal Component Analysis................. 97 Figure 4.2: (a) GPR image contained in data matrix X and (b) single GPR trace xi (i = 120) from X – A-scan. ......................................... 100 Figure 4.3: Graphical depiction of SVD of data matrix X. ........................ 104 Figure 4.4: One-dimensional Principal Component Analysis (1DPCA). .. 111 Figure 4.5: Two-dimensional Principal Component Analysis (2DPCA). . 113 Figure 4.6: Blind Source Separation (BSS) block diagram. s(t) are the sources, x(t) are the recordings, ŝ(t) are the estimated sources, A is a mixing matrix and W is an un-mixing matrix [111]. .... 118 Figure 4.7: ICA method in GPR application.............................................. 119 Figure 4.8: Three stages of SVDPICA method – SVD decomposition of original data matrix X, discarding of the first l and last n  k  ˆ to PCs, ICA un-mixing the reduced matrix of eigenvectors U R  . ................................................................... 123 obtain matrix U R  Figure 4.9: Diagram of the structural similarity (SSIM) measurement system [122]. ........................................................................... 127   xiv        Figure 4.10: Plot of eigenvalues against space sample (component number) of simulated GPR data represent joints (a) with PCA via SVD and (b) selected 30 PCs via SVDPICA method. ................... 132 Figure 4.11: Results of GPR image decluttering on simulated data represent joints using different techniques (a) original raw image, (b) mean removal, (c) PCA via SVD, (d) SVDPICA and (e) “Ideal” data which is obtained by subtracting the image of concrete from the image of concrete containing joints. ........ 133 Figure 4.12: Evaluation of clutter reduction methods in terms of PSNR for simulated data to detect leakages from joints, holes and cracks. .................................................................................... 134 Figure 4.13: Evaluation of clutter reduction methods in terms of PSNR for simulated data in detecting pipes........................................... 135 Figure 4.14: Plot of eigenvalues against space sample (component number) of measured GPR data in detecting pipes – big size (a) with PCA via SVD and (b) selected 30 PCs via SVDPICA method. .................................................................................. 138 Figure 4.15: Results of GPR image decluttering on measured data – big pipe using different techniques (a) original raw image, (b) mean removal, (c) PCA via SVD, (d) SVDPICA and (e) ReflexW software. ................................................................................ 139    xv        Figure 4.16: Evaluation of clutter reduction methods in terms of PSNR for pipes detection of measured data........................................... 141 Figure 4.17: Evaluation of clutter reduction methods in terms of PSNR for measured data to detect leakages from joints, holes and cracks (GPR GV3). ........................................................................... 142 Figure 4.18: Evaluation of clutter reduction methods in terms of PSNR for measured data to detect leakages from joints, holes and cracks (GPR GV5). ........................................................................... 143 Figure 4.19: Evaluation of clutter reduction methods in terms of PSNR for measured data to detect cracked concrete. ............................ 144 Figure 4.20: GPR images with removed mean trace (a) empty box and (b) box with three plastic pipes. .................................................. 145 Figure 4.21: (a) Eigenvalues spectrum of PCs obtained using 2DPCA procedure and (b) reconstructed side reflection using 2DPCA eigenimages 1 – 6. ................................................................. 146 Figure 4.22: Independent images obtained using ICA in reconstructing unwanted features (side reflections). ..................................... 147 Figure 4.23: Unwanted signals (side reflections) reduction results via (a) 2DPCA and (b) ICA algorithms. ..................................... 148 Figure 4.24: The "difference" image is obtained by subtracting the empty box image from the image with three pipes. ......................... 149    xvi        Figure 4.25: Evaluation results of unwanted signals reduction techniques for pipes detection of measured data. .................................... 150 Figure 5.1: Performance of studied algorithms for SNR = 10 dB case, (a) original signal, (b), (c) and (d) reconstructed signals and residual using (b) EP, (c) LPSVD and (d) MP. ....................... 167 Figure 5.2: (a) Singular Entropy Increment and (b) Differential of Singular Entropy Increment characteristics for simulated signal (SNR = 10 dB) depicting correct signal model order at L = 6. ............ 171 Figure 5.3: Big pipe image after pre-processing via (a) mean removal, (b) 2DPCA, (c) ICA and (d) difference techniques. The white line in (a) represents the position of analysed trace – column 83. ............................................................................................ 172 Figure 5.4: Extracted GPR traces of pre-processed data via (a) mean removal, (b) 2DPCA, (c) ICA and (d) difference techniques. 173 Figure 5.5: (a) SEI and (b) DSEI for each of extracted traces. .................. 174 Figure 5.6: The signal reconstructions using selected model order of a single trace. ........................................................................................ 176 Figure 5.7: Results of Matrix Pencil on a single trace. .............................. 177 Figure 5.8: (a) Power and (b) maximal amplitude of the residual signal for different model orders L. ......................................................... 178    xvii        Figure 5.9: Comparative results of MP analysis obtained for a single pipe in the box (a) frequency-amplitude and (b) frequency-damping characteristics. ......................................................................... 180 Figure 5.10: Image of all three pipes in the box after pre-processing via (a) mean removal, (b) 2DPCA, (c) ICA and (d) difference techniques. The white lines in (a) represent the positions of analysed traces – column 25, 83 and 138. ............................. 181 Figure 5.11: Comparative results of MP analysis obtained for all three pipes in the box (a) frequency-amplitude and (b) frequency-damping characteristics (for traces 25, 83 and 138 from Figure 5.10). 182 Figure 5.12: Simulated GPRMax images with indicated traces (white lines) used in further analysis (a) joint, (b) crack, (c) crack and healthy concrete and (d) hole at the joint position. ............... 185 Figure 5.13: Comparative results of MP analysis obtained from simulated images containing various targets in concrete slab (a) frequency-amplitude and (b) frequency-damping characteristics. ....................................................................... 186 Figure 5.14: PCs represent different target types on simulated data in (a) two-dimensional and (b) three-dimensional. ......................... 191    xviii        List of Tables Table 2.1: Pipe dimensions used in the experiment performed for pipes detection. ..................................................................................... 52  Table 3.1: Sender/Receiver distance values. ................................................ 71  Table 3.2: Band-pass Butterworth filter cut-off frequencies. ...................... 76  Table 4.1: Two ways of performing PCA including common dimensionality reduction and data reconstruction steps implemented in Matlab; left column – Eigenvalue Decomposition approach and right column – SVD approach. .......................................................... 108  Table 4.2: PSNR and M-SSIM index indicators for described clutter reduction algorithms of simulated data experiment to detect leakages from joints, holes and cracks. ..................................... 134  Table 4.3: PSNR and M-SSIM index indicators for described clutter reduction algorithms of simulated data experiment to detect pipes. ......................................................................................... 135  Table 4.4: PSNR and M-SSIM index indicators for described clutter reduction algorithms of measured data experiment to detect pipes. ......................................................................................... 141  Table 4.5: PSNR and M-SSIM index indicators for described clutter reduction algorithms of measured data experiment to detect leakages from joints, holes and cracks (GPR GV3).................. 142    xix        Table 4.6: PSNR and M-SSIM index indicators for described clutter reduction methods of measured experiment to detect leakages from joints, holes and cracks (GPR GV5). ............................... 143  Table 4.7: PSNR and M-SSIM index indicators for described clutter reduction methods of measured experiment to detect cracked concrete. .................................................................................... 144  Table 4.8: Comparison of proposed algorithms in reducing unwanted signals using PSNR measure of pipes detection experiment. ............... 150  Table 5.1: Performance of three signal modelling algorithms using simulated signals with different SNRs. ..................................... 166  Table 5.2: Extracted traces of GPR simulated data on different target types. ......................................................................................... 188  Table 5.3: Calculated distance of each target depicted in Figure 5.14 (a). 192     xx        List of Abbreviations 1D  One-dimensional  2D  Two-dimensional  3D  Three-dimensional  1DPCA  One-dimensional Principal Component Analysis  2DPCA  Two-dimensional Principal Component Analysis  ABC  Absorbing Boundary Condition  AGC  Automatic Gain Control  AM  Amplitude Modulation  AP  Anti-Personal  ASCII  American Standard Code for Information Interchange  BSS  Blind Signal Separation  CDH  Crack Detection Head  CFL  Courant, Freidrichs, and Lewy  cm  Centimetre  CMP  Common-Mid-Point  dB  Decibel  DC  Direct Current  DSEI  Differential of Singular Entropy Increment  EM  Electromagnetic  EP  Extended Prony   xxi         F  Farads  FA  Factor Analysis  FastICA  Fixed-Point ICA  FDTD  Finite-Difference Time-Domain  FFT  Fast Fourier Transform  GHz  Giga Hertz  GPR  Ground Penetrating Radar  GPS  Global Positioning System  GV3  Groundvue 3  GV5  Groundvue 5  H  Henries  HVS  Human Visual System  Hz  Hertz, cycle per second  IC  Independent Component  ICA  Independent Component Analysis  Infomax  Information Maximisation  JADE  Joint Approximate Diagonalisation of Eigen-matrices  kg  Kilogram  KT  Kumaresan-Tufts  LDA  Linear Discriminant Analysis  LPSVD  Linear Prediction Singular Value Decomposition  LS  Least-Squares    xxii        m  Metre  MHz  Mega Hertz  mm  Millimetre  MP  Matrix Pencil  MR  Mean Removal  ms  Millisecond  MSE  Mean Square Error  M-SSIM  Mean Structural Similarity  m/ns  Metre per nanosecond  m/s  Metre per second  NDCD  Non-Destructive Crack Depth  ns  Nanosecond  PA  Prony Analysis  PC  Principal Component  PCA  Principal Component Analysis  PML  Perfectly Matched Layer  ps  Picosecond  PSNR  Peak-Signal-to-Noise Ratio  rads  Radians  RMS  Root Mean Square  s  Second  S  Siemens    xxiii        SE  Singular Entropy  SEI  Singular Entropy Increment  SNR  Signal-to-Noise Ratio  S/R  Sender/Receiver  SSA  Singular Spectrum Analysis  SSIM  Structural Similarity  SVD  Singular Value Decomposition  SVDPICA  Singular Value Decomposition of PCA and ICA  TDSEP  Temporal Decorrelation Source Separation  V  Voltage    xxiv        List of Symbols   Wave number  c  Wave velocity of free space  d  Depth  E  Electric  e  Reference image    Permittivity  0  Permittivity of free space  r  Relative permittivity  s  DC permittivity    Permittivity at light frequencies  f  Frequency  g  Test image  H  Magnetic    Wavelength  m  Number of data samples    Permeability  0  Permeability of free space  r  Relative permeability    xxv        n  Number of GPR traces    Conductivity  0  Conductivity of free space  i  Damping  Rx  Receiver  Tx  Transmitter  t  Time    Velocity  r  Relative propagation velocity    Angular frequency  l  Discretisation step  t  Time step  x  Spatial step in x direction  y  Spatial step in y direction  z  Spatial step in z direction    xxvi        Declaration ‘Whilst registered as a candidate for the above degree, I have not been registered for any other research award. The results and conclusions embodied in this thesis are the work of the named candidate and have not been submitted for any other academic award.’ This thesis has 30876 words.    xxvii        Acknowledgements This dissertation would not have been possible without the guidance and help of several individuals who in one way or another contributed and extended their valuable assistance in the preparation and completion of this study. First and foremost I offer my deepest gratitude to my supervisor Dr. Branislav Vuksanovic, whose encouragement, guidance, and support from the initial to the final level enabled me to develop and understanding of the subject. I also would like to show my gratitude to Dr. Alan Hewitt, my second supervisor, for his technical guidance on Image and Signal Processing, and also his support throughout this study. My sincere gratitude goes to Dr. Boris Gremont and Mr. Hassan Parchizadeh for the time and expertise contributed to the enhancement of this research. I sincerely thank Mr. Andrew Farrar, whose enormous contributions to the measurement lab greatly facilitated the progress of my work. I would like to express my gratitude to the members of the School of Engineering of the University of Portsmouth, for giving continuous support in various ways, including the opportunities for attending relevant training workshops, seminars, and presenting my work at conferences. Special thanks go to Prof. Dr. Amir Alani from University of Greenwich for his assistance in collecting GPR measurements, and Utsi Electronics Ltd, Erica and Vincent for their great help in training and conducting GPR   xxviii        system. I offer my regards and blessing to all of those who supported me in any respect during the completion of the thesis. I am indebted to my friend Dr. Dragana Nikolic for her support and motivation. Sincere gratitude goes to my family especially to my parents, Bostanudin and Nasriah, my sister, Nurul A, my brothers, Fikri, Fauzi, and Fawwaz for their love and encouragement when it was most required. Their pride in my accomplishments guided me throughout the best and the worst moments of my work. But, most of all to my fiancé, Sham for his love, belief in me, and constant support. His guidance, patience and understanding helped me finalise this research.    xxix        Dissemination   Publication: -  Vuksanovic, B., Bostanudin, N. J. F., Hidzir, H., and Parchizadeh, H. (2013). Discarding Unwanted Features from GPR Images Using 2DPCA and ICA Techniques. International Journal of Information  and  Electronic  Engineering.  DOI:  10.7763/IJIEE.2013.V3.326   Conference Proceedings: -  Vuksanovic, B., and Bostanudin, N. J. F. (2012). Clutter Removal Techniques for GPR Images in Structure Inspection Tasks. 4th International Conference on Digital Image Processing (ICDIP 2012), Kuala Lumpur, Malaysia.  -  Vuksanovic, B., and Bostanudin, N. J. F. (2012). Unwanted Signals Removal for GPR Images. 2012 5th International Conference on Computer Science and Information Technology (ICCSIT 2012), Hong Kong.    Poster: -  Vuksanovic, B., Bostanudin, N. J. F., and Alani, A. (2011). Ground Penetrating Radars in Construction Industry. Autonomous Systems and Robotics Annual Conference, Warwick University International Digital Laboratory, Conventry, UK.    xxx          Chapter 1  	  Introduction Overview This chapter describes the problems associated with GPR data and the significance of the research undertaken in analysing and improving the performance of GPR to detect and characterise objects in civil engineering structures. It outlines the objectives of the research reported in this thesis. A summary of the work that has been conducted to date concerning detection using GPR and signal processing is provided. Finally an overview of the rest of the thesis is presented.  1.1 Ground Penetrating Radar Radar is used to detect an object based on radio waves. The theory of electromagnetism on which radar operation is based was described in detail by the Scottish physicist, James Clerk Maxwell in [1]. It is governed by four equations referred to as Maxwell’s equations. The principle of radar was found to be applicable for detecting airborne objects in the early 1900s  1     Introduction    which consists of transmitting electromagnetic (EM) waves and receiving the reflected signals from any object in the path of the beam [2]. Ground Penetrating Radar (GPR) is a geophysical method that uses EM wave designed primarily to locate an object that are buried beneath the earth’s surface or image the subsurface. In the recent 30 years, the technique of GPR has become an effective method for detecting shallowly buried targets [3]. It is a non-destructive and non-invasive geophysical technique with a wide variety of applications in site and ground investigations [4]. A GPR system uses the difference in the permittivity of both the target and the surrounding medium to detect a target [5]. A target is declared present if the GPR detect a local change (or discontinuity) in the media’s (such as soil) dielectric [6]. During data collection, radar antennas do not need to be in contact with the surface of the medium. This gives benefit to GPR for enabling rapid surveying as well as time consuming [7]. It is expected that the interest in, and demand for, GPR surveys will grow even more in the near future. However, there are a number of limitations which exist that are related mainly to interpretion of the results of GPR test [2]:   the obtained images produced by the reflected signals are not photographs of the subsurface features. These images, which are plotted in colours using user-defined colour codes, represent the amplitude of the radar-reflected signals from the interfaces with    2     Introduction    different dielectric properties. A considerable amount of experience and operator skills are therefore required to interpret subsurface radar results correctly;   extensive amount of data;    a prior knowledge of the dielectric properties of the material is necessary to determine the exact location of a reflecting feature beneath the surface;    change of dielectric constant with depth mainly because of the presence of moisture;    losses in the materials, especially due to the presence of moisture or conducting subgrade soils;    reflections from thin layers may overlap depending on the GPR system resolution;    insufficient dielectric contrast between layers may hinder the detection of the layers underneath.  GPR is very sensitive to changes in the EM characteristics of a medium, which gives it the ability to detect both metallic and non-metallic targets [8]. However, in a large number of situations, the signals reflected by the target are very weak and usually overlap with the clutter and noise – signals that are uncorrelated to the target scattering characteristics but occupy the same frequency band as the target [6], [8]. This causes difficulties in    3     Introduction    distinguishing the signal from noise without applying proper signal processing techniques. Background clutter and noise consist of three main components [9]: (i)  the cross-talk between the transmitting and receiving antennas;  (ii)  the reflection from the air-ground interface;  (iii)  the scattered signals from other objects within the soil.  Due to constant distance between both antennas, the cross-talk signal will arrive at the antenna receiver earlier than any other signal which makes it easier to distinguish and reject the noise component in (i) [10]. The clutter signal due to the reflection from the ground surface is usually very strong and represents a major problem in processing GPR signals. Removing signals scattered from other objects within the soil is a difficult problem as well since it cannot be effectively tackled with clutter reduction methods. Signal processing techniques have recently been applied to GPR signals in order to improve the quality of obtained data and enable easier understanding and classification of buried objects and surveyed area.  1.2 Objectives This thesis addresses the problem of analysing and improving the performance of GPR in detecting and characterising objects in civil engineering infrastructures. Significant amount of works in this area has been attempted recently including detection of pipes, cables and   4     Introduction    reinforcement [11], locating subsurface cavities and fractures in bedrock [12], as well as ground water and moisture [13]. This work tackles some of the issues outlined above, by developing and adapting a range of image and signal processing techniques from other disciplines into a comprehensive automated detection system that can be used effectively by untrained radar practitioners in site survey situations. The goal is to develop and apply the necessary techniques without the requirement for extensive off-site processing by a radar expert. The topics and tasks tackled in this work are outlined in Figure 1.1.  Figure 1.1: Research system implementation.    5     Introduction    The objectives of the thesis can be summarised as follows: 1. study the process of acquiring raw GPR data to establish the properties and problems introduced during the GPR survey and the measurement process; 2. design the simulated data using GPRMax simulation program to replicate the laboratory or on-site conditions during the measurement procedure; 3. study GPR software package (ReflexW) to pre-process measured GPR data; 4. investigate subspace and data decomposition techniques to reduce clutter and unwanted signals presented in GPR data; 5. compare and evaluate the performance of the subspace and data decomposition techniques on measured data against the preprocessed data using ReflexW; 6. investigate signal modelling analysis to evaluate the performance of the subspace and data decomposition techniques; 7. identify and characterise features. These objectives have been achieved and the author’s specific contributions can be summarised as follows:   design and implementation of simulated data for the comparison and evaluation against measured data in reducing the amount of clutter and unwanted signals presented in GPR data;   6      Introduction      analysis and interpretation of pre-processing GPR data using ReflexW to be used in the evaluation of subspace and data decomposition techniques applied to GPR data;    analysis of subspace and data decomposition techniques – Principal Component Analysis (PCA) and Independent Component Analysis (ICA) on GPR data;    implementation and modification of traditional PCA and ICA techniques to improve their performance in image processing and GPR clutter removal tasks – combination of Singular Value Decomposition of PCA and ICA (SVDPICA) and 2DPCA, not previously suggested in GPR field;    analysis and implementation of signal modelling techniques – Extended  Prony  (EP),  Linear  Prediction  Singular  Value  Decomposition (LPSVD) and Matrix Pencil (MP) to evaluate the subspace  and  data  decomposition  algorithms  as  well  as  characterisation of surveyed targets;   implementation of Singular Entropy based model order estimation method to be used with MP analysis on GPR signals;    analysis of subspace method – PCA to characterise features.    7     Introduction    1.3 Summary of Previous Work 1.3.1 GPR as a Detection Tool Research in the field of GPR can broadly be divided into the categories of radar system and hardware design, geophysical inversion and modelling, and image and signal processing and analysis [7]. The application of GPR to detect and monitor cracks induced on a historical building by a landslide is discussed in [14] using 2 GHz bipolar antenna, which allows the acquisition of multi-component data. The interpretation of processed data on its profiles is in good correlation with the structure of the floor. The profiles and time slices managed to detect two different kinds of anomalies, only a few which can be due to utilities and the metallic mesh, whilst others were associated with cracks induced by the landslide. A processing chain for the spatial analysis of the data recorded by GPR is presented in [15]. In particular, the detection and localisation of pipes is implemented by exploiting the a priori knowledge that a buried cylinder gives rise to a hyperbolic signature in GPR images. The image interpretation is performed by a suitably trained simple neural detector after some preprocessing steps aiming towards the enhancement of the buried objects’ signatures.    8     Introduction    1.3.2 GPR Technology in Civil Infrastructures Interest in radar as a possible non-destructive evaluation tool in civil engineering has developed and various researchers have shown interest in pavement structure. Non-Destructive Crack Depth (NDCD) detector developed by Utsi Electronics in [16], which is based on a slow speed GPR, was used to determine crack depth in flexible pavements and road condition monitoring. However, false readings can be made if there are other linear objects/features in the layer, thus it is advisable to take more than one run over a crack to guarantee the detection. Measurement of reinforcement bar depths and diameters in concrete is discussed in [17] where the results of controlled measurements using 4 GHz GPR system are compared to the simulated data by GPRMax3D of a range of rebar sizes at different depths. In-build rebar measurements were done to investigate the depth, position, and diameter of rebars in a series of ceiling slabs.  1.3.3 Signal Processing for GPR The difficulty in reducing clutter presented in GPR data is an important problem in many areas. A number of clutter reduction approaches suggested in the literature cover simple mean scan subtraction that was discussed in [18], two-dimensional digital filtering [19], wavelet packet decomposition [18], likelihood ratio test [10], [18], [20], parametric system identification    9     Introduction    [18], [21], and Kalman filter [20], [22]. Most of these methods depend on the background signal estimation [10] by taking the mean value of the unprocessed ensemble collected GPR data, followed by employing the simple mean scan subtraction. A-scan far away from the target location might be used instead of mean scan subtraction. Although these methods have been used widely in GPR applications, the direct wave from the received data cannot be completely removed due to the air-earth interface and time-shift (jitter) of the radar system. Various researchers have shown interest in subspace techniques including Singular Value Decomposition (SVD) [18], [23], Linear Discriminant Analysis (LDA) [24], Principal Component Analysis (PCA) [25], [26], and Independent Component Analysis (ICA) [6], [25], [27], [28]. These techniques are effective in reducing the higher-order statistical dependencies and established in yielding performance improvements in clutter reduction. The returns are divided into clutter and landmine signals by selecting reasonable principal components (PCs) and independent components (ICs) which are used to determine the subspace for reconstruction. Detection and identification of buried landmines is an important, yet difficult, task [29]. The backscattered echoes in GPR data, which are usually distorted by multiple scattering are used for target identification [8], [30]. However, a serious drawback of a GPR system relies in the limitation of its    10     Introduction    ability in discriminating between landmine and non-landmine echoes. Thus, this leads in need of advanced signal processing and target classification techniques. Several algorithms have been introduced in classification, characterisation, and recognition of GPR and other areas signals such as Prony Analysis (PA) [29], [31], [32], Matrix Pencil (MP) [33], [34], and Linear Prediction Singular Value Decomposition (LPSVD) [35]. Prony proposed fitting a sum of exponentials to equally spaced data points and extended the model to interpolate at intermediate points [31]. In [29], the backscattered GPR echoes is modelled separately from a landmine target as a linear combination of exponential functions. The complex parameters (such as poles) are expected to be characteristic for each targettype, and invariant with respect to target orientation. However, as the Prony Analysis method is based on linear least-squares, it is highly sensitive to the additive measurement noise. Thus, LPSVD method which is known as Kumaresan and Tufts [35] is introduced that offers an improved performance in the application of signals with lower signal-to-noise ratio (SNR). This technique uses backward linear prediction and low-rank data matrix approximation based on SVD. Another approach that can be used to extract poles of complex frequencies is Matrix Pencil [33] which is described to be more robust in the presence of noise in the sampled data and computationally more efficient. It offers a lower statistical variance of the estimated parameters than a    11     Introduction    polynomial-type method (such as PA). This technique is explained in [36], in which the number of spurious poles are reduced by using the dominant eigenvalues in estimating the model number since underestimating its value result in errors whilst overestimating it generates both the correct and spurious poles.  1.4 Thesis Structure The thesis is organised as follows: Chapter 2 Ground Penetrating Radar with its principles is reviewed. The chapter looks at the important principles in conducting GPR survey in field experiments, as well as modelling GPR data using dedicated GPR simulation package. Chapter 3 Commercially available professional GPR software – ReflexW is discussed and used to process measured GPR data in order to reduce the amount of clutter and noise present in the data. The results of this preprocessing are used for comparison with the results achieved using signal pre-processing techniques developed in this work in order to evaluate the performance of each method in clutter reduction. Chapter 4 In order to tackle the problem of clutter in measured GPR images, multivariate data analysis techniques are studied in detail in this chapter. Those techniques are then applied to signals measured on-site and in laboratory as described in Chapter 2. The main algorithms modified and    12     Introduction    applied in this section are: one-dimensional (1D) and two-dimensional (2D) Principal Component Analysis (PCA), Independent Component Analysis (ICA), and a combination of Principal and Independent Component Analysis (SVDPICA). Whilst both PCA and ICA have recently been applied and tested on GPR images, all of the work has been done in landmine detection type tasks. In addition to that, two-dimensional PCA as well as the SVDPICA algorithms have not been proposed for GPR data processing before. The problems of evaluating the performance of each individual algorithm is another issue related to the work done in this chapter. Whilst in most of image or signal processing tasks “ideal” image of “noiseless” signal is available to accurately assess the performance of the applied technique, it does not apply in GPR area. Therefore, high signal-to-noise ratio can imply the significant reduction of clutter and noise present in the raw image but can also hide the fact that some of the important features present in the measured image and related to buried target might have been removed from the image during the applied processing method. Chapter 5 Signal processing methods used for the analysis and characterisation of GPR signals are studied and applied in this section. Extended Prony, Linear Prediction Singular Value Decomposition, and Matrix Pencil techniques are related but significantly different methods. In this chapter those methods are introduced and utilised to analyse preprocessed GPR signals. Accuracy of estimated signal parameters including    13     Introduction    frequency, damping, amplitude, and phase is assessed and compared for various situations and underground objects where large amount of clutter is present in the images. Chapter 6 Conclusions and the summary of the performed work and results are given and some recommendations for further work are presented in the last chapter of the thesis.    14          Chapter 2  		  Ground Penetrating Radar Overview This chapter explains the principles of Ground Penetrating Radar and its electromagnetic properties. The issues of GPR measurements despite of its advantages have been highlighted. GPR simulation software package is introduced and simulated data is compared to the measured experimental data.  2.1 Introduction Application of Ground Penetrating Radar (GPR) is a rapidly growing field that has seen significant progress in the development of theory, techniques and technology over the past 15 – 20 years [37]. It is a non-destructive method that generates EM pulses to record, locate and evaluate the depth of buried objects or subsurface features that cannot be seen visually [38]. GPR system normally consists of data collection unit, transmitting and receiving antennas. The system that contains transmit and receive functions performed by the same antenna is known as mono-static, otherwise it is  15     Ground Penetrating Radar    called bi-static. GPR systems typically have both antennas combined in a single housing that makes the separation between the two antennas is most often fixed [39]. Most common elements of GPR system depicted in Figure 2.1 are:   a display unit that provides a ‘real time’ display of the recorded data such as laptop computer or a dedicated control unit (i.e. data logger);    a control unit that generates EM pulses and records the received energy;    a survey cart with some form of positioning device (GPS receiver or odometer) or, alternatively, a sled, frame or other device that allows the antennas to be pulled across the ground manually;    a battery pack (usually 12V) to power the unit;    an antenna housing containing antenna source electronics and two or more antenna units – transmitter and receiver(s).  Display unit Control unit Survey cart Battery pack Antenna housing  Figure 2.1: Typical GPR system.   16     Ground Penetrating Radar    The operation of a GPR device is based upon the propagation and reflection characteristics of an EM wave or pulse in material. An EM wave is reflected at positions where the penetrated material changes which caused by a change of the EM properties in the subsurface; the permittivity    , the permeability    and electrical conductivity   [13], [40]. However, not all these three parameters provide useful information to the GPR [41]. The conductivity generally affects the penetration of the GPR due to absorption of the radar signals in the medium. Any medium with high moisture content increases the electrical conductivity, thus decreasing penetration. The electrical conductivity of most engineering materials is usually low and the magnetic permeability is often negligible for materials not rich in iron-oxide [13]. Therefore, due to the lack of magnetic content in the earth’s soil, the relative permeability hardly provides any useful information because it offers little contrast in the radiated EM pulses. The relative permittivity which corresponds to the dielectric constant of the medium provides the highest degree of contrast in the reflected wave. This resulted in a good characterisation of the ground and therefore leads to the reflection in the EM pulse [41]. GPR operates in a manner similar to navigational radar systems but it sends pulses of EM waves into the ground in order to identify the shape, size, and locations of subsurface features. In general, GPR is mostly used in    17     Ground Penetrating Radar    reflection mode where a signal is emitted via a transmitter antenna into the structures and soil under investigations as depicted in Figure 2.2 [42].  Figure 2.2: Basic functional principle of a GPR device. When the transmitted EM wave encounter changes in subsurface materials, the properties of the wave are altered, and part of the wave is reflected back to the surface, where data on its amplitude, wavelength, and two-way travel time are collected for analysis and interpreted accordingly [43]. The control device measures the amplitude of the reflected energy for each position at different times. The amplitude and phase of the “echoes” can give information about the scattering properties of the target whilst the   18     Ground Penetrating Radar    time of arrival of different pulses gives indirect distance indications to the subsurface layers of reflectors [7]. This process produces a data matrix with columns containing the reflected amplitudes at certain times for each measurement position along the trace. GPR data assembled in this way can therefore be displayed as a two-dimensional image [40].  Figure 2.3: Principles of GPR in CMP mode which the transmitting and receiving antennas are moved away from each other [44]. A common mid-point dataset (CMP) [44] is another mode that can sometimes be used for GPR measurements. It is also called a velocity sounding, since the technique is commonly used for signal velocity establishment. In CMP mode, the antenna separation is increased for each recording whilst keeping over a common mid-point as in Figure 2.3. This mode of GPR measurements was not used in this project and will therefore not be discussed in more details in this work. The performance of GPR depends upon the surface and subsurface conditions and its specifications. These include requirements and information about reflections, depth of investigation, and resolution. The   19     Ground Penetrating Radar    ability of a GPR to detect objects depends on the wavelength of the input signal, so the quality of the image improves as the wavelength decreases and the frequency increases [41]. At high frequencies, the resolution of GPR system therefore increases but depth of penetration decreases and vice versa for lower frequencies. The detection of the target however becomes difficult in the situations where [8]:   the target is buried close to the surface of the ground;    the target has very small geometrical dimensions;    the object has a small permittivity difference to that of the ground.  In these entire situations, the reflected signal of the target is very weak and is usually overlapped with the clutter – represents any unwanted reflections present in the GPR signal, making it difficult to distinguish between both signals and noise – caused by interference from other radio-wave-emitting devices that are present in the surveyed area during data collection, without applying proper signal processing techniques. The data received from GPR system is essentially consist of [41]: (a) coupling induced by transmitting and receiving antennas; (b) reflection by ground surfaces; (c) stochastic EM, interference either from GPR system itself or from environment; (d) reflection by subsurface targets;   20     Ground Penetrating Radar    (e) dispersion or reflection by the underground inhomogeneities. The signals (a) and (b) are usually known as “clutter”, which are much more intense than the buried-target reflection due to short distance from transmitting to receiving antennas and the attenuation of the target reflection by underground medium like soil, etc. The need for deploying proper clutter reduction methods is therefore necessary in order to enable effective and accurate target detection and identification.  2.2 Advantages and Disadvantages of GPR The use of GPR as a geophysical method of site investigation has several beneficial advantages compared to other subsurface sensing technologies such as [23], [38], [41], [43]:   non-destructive nature;    its ability to maximise research efficiency and minimise the cost;    its capability to cover large areas quickly;    the capability in detecting both metallic and non-metallic targets.  The graphic displays of GPR data often resemble geologic cross sections. This gives benefit in protecting and preserving particularly in archaeology sites where cultural sensitive features (such as human burials) are concerned. Indeed, its ability to survey an area in front of it, unlike other sensors that can only survey an area directly beneath them, gives the potential not only to identify these culturally sensitive area, but also in   21     Ground Penetrating Radar    detecting dangerous objects before the system moves over and past them [43]. In comparison to other subsurface sensing technologies, GPR has the potential to increase research efficiency by conducting surveys quickly at relatively low cost as well as covering larger areas. The antennas of GPR itself may be pulled by hand or with a vehicle which can produce considerable data/unit time that makes the GPR measurements relatively easy to make [43], [45]. Despite of its advantages described earlier, GPR has some limiting factors [23], [38], [41]:   its usage in inhomegeneous soil can increases the number of false alarm and the depth of signal penetration is limited. A trade-off between resolution of the returned signal and penetration depth is therefore required;    GPR method is sensitive to unwanted signals (noise) caused by various geologic (e.g., boulders, tree roots) and cultural factors (i.e. nearby vehicles, buildings, etc.). EM transmission from cellular phones, two-way radios, television, and microwave transmitters may cause noise on GPR records;    the data collected through GPR methods is highly subjective to the interpretation, especially if interferences are not identified correctly.    22     Ground Penetrating Radar    It is therefore important to define clearly the target parameters as there is a considerable difference between the target response from different situations such as buried pipe, buried mine, a void, or a planar interface that has a major impact on signal processing strategy. The resolution and the required depth of penetration should be clearly identified in order to set the frequency and bandwidth of operation, which will in turn influence the choice of modulation technique and hence the hardware design [13].  2.3 Basic Principles of GPR The outcome and quality of raw data obtained from GPR survey is primarily dependent upon two factors [14], [43], [45]:   data acquisition parameters which control the waveform transmitted into the ground;    characteristics of the materials through which the EM wave propagates.  To set the data acquisition parameters properly, it is important to understand the properties of the propagating medium and target objects properly. Important fundamental EM properties of materials are discussed in the following section.    23     Ground Penetrating Radar    2.3.1 Electromagnetic Properties in Dielectric Materials The interactions of EM waves with physical media can be quite complex and the most exact models known for EM interactions use quantum mechanics [46]. The approximation to the quantum representation is given by Maxwell’s equations describing the EM interactions in terms of electric (E) and magnetic (H) field vectors that propagate and reflect as waves [47]. Often, the propagation of EM waves can be represented by scalars instead of vectors, which simplifies the mathematics at the expense of a loss directional information, such as polarisation.   2.3.1.1  Permeability  Magnetic permeability    [39], [45], [48] describes the ability of a  material to become magnetised in the presence of an EM field. It is a measure of the magnetic polarisation of a material that measured in henries per metre  H m  . Materials that are more magnetically permeable will more readily interfere with the magnetic part of the EM wave, thereby attenuating the wave and resulting in shallow subsurface images. The relative permeability,  r of a material is given as,  r   0  (2.1)  where  0 represents the permeability of free space and is given as,  0  4  107  1.256  106 H m  (2.2)    24     Ground Penetrating Radar    in which left the relative permeability with a unit-less quantity. Ferromagnetic materials  r  1 are considered to be magnetically lossy and may have a frequency dependent permeability [39]. Asphalt and concrete are however considered to be non-ferromagnetic materials  r  1 thus it can be assumed that the permeability of these materials is the same as for the space  r  1 .  2.3.1.2  Electrical Conductivity  Electrical conductivity   describes the ability of a material to conduct the electric portion of the EM wave and is measured in Siemens per metre  S m . Materials which are more electrically conductive will more readily conduct the electric part of the EM wave, thereby dissipating or attenuating the wave and resulting in shallow subsurface images. Conversely, materials with a low electrical conductivity will allow greater depth of EM wave permeation [45], [48]. Since GPR is an EM energy, it is subject to attenuation (natural absorption) as it moves through a material [49]. The signal is able to penetrate a great deal of material if the energy is moving through a resistive (low conductivity) material such as very dry sand, ice, or dry concrete which makes the signal stays intact longer, thus being able to go further into the material. However, if the material is conductive such as salt water and    25     Ground Penetrating Radar    wet concrete, the GPR energy will get absorbed before it has had the chance to go very far into the material. As a rule of thumb based on this electrical conductivity, the greater the water content of the material, the greater the conductivity.  2.3.1.3  Permittivity  Permittivity    [48], [49] describes the ability of a material to store and transmit an electric charge induced by an EM field that measured in Farads per metre  F m  . It is a descriptive number that indicates how fast radar energy travels through a material. Radar energy will always move as quickly as possible through a material, but certain materials slow down the energy more than others. The speed moving GPR energy can be deduced by knowing the value of permittivity, e.g. the higher the permittivity, the slower the radar wave moves through the medium. The wet material will for example slow down the radar signals due to the water presence causing the raise of the overall dielectric of the material. The permittivity of free space   0  is assumed to be the same as in a vacuum which is,   0  1 c 2  0  8.854  10 12 F m  (2.3)  The relative permittivity   r  of a material is therefore can be considered as in equation (2.4) and is unit-less.    26     Ground Penetrating Radar    r   0  (2.4)  2.3.2 Data Collection Parameters There are numerous other parameters that can be varied and controlled to achieve the targeted depth and resolution during a GPR survey. These parameters are described in the following section.  2.3.2.1  Wave velocity  The angular frequency   [39] of an EM wave is measured in radians per second  rads s  and is proportional to its frequency, f measured in Hertz:    2 f  (2.5)  The wave number, or propagation constant,    is measured in radians per metre and is given by [50]:       2     1    1  2         (2.6)  For the material with no conductivity, equation (2.6) can be reduced to:       (2.7)  The velocity at which a wave travels through a material   is measured in metres per second and is given by [50]:       (2.8)    27     Ground Penetrating Radar    The wave velocity of free space  c  can be obtained from the equations (2.7) and (2.8) respectively [39]:  c    1    3 108 m s  0   0 0  0 0  (2.9)  For materials with no conductivity   0 and permeability equals to that of free space  r  1 , equation (2.9) can be stated as:  r   2.3.2.2   1 c    r 0 r  0 r  (2.10)  Wavelength  Wavelength    [39] can be described as a propagating wave which repeats itself at a particular distance and is measured in metres:    2     2      f  (2.11)  GPR antennas can typically be distinguished when moving along the concrete features aligned perpendicular to the direction of travel if they are spaced at least one half of a wavelength apart   2  . Features that are stacked on top of each other can typically be distinguished if they are at least a quarter of a wavelength apart   4  [49]. However, features that are closer to each other than these distances may appear as a single feature in GPR data.    28     Ground Penetrating Radar    2.3.2.3  Relationship between Frequency and Depth  Choosing a frequency for a GPR survey is quite critical. Lower frequency with long wavelengths provide the deepest penetration, whereas high frequency with short wavelengths are only able to image shallow features [45], [51], [52].  2.3.2.4  Relationship between Frequency and Resolution  Resolution of subsurface features is in part affected by antenna wavelength which is also directly related to the frequency. Higher frequency radar provides higher resolution than lower frequency radar [45], [51], [52], [53]. The shorter wavelengths of high frequency produce a narrower cone of transmission and give the ability to focus on smaller areas, thereby resolve smaller features. This is differs to lower frequency radar which has more spread out transmission cones due to longer wavelengths [45].  2.3.3 Determination of Layer Thickness and Feature Depth An absolute measurement of depth or thickness can easily be recognised if the propagation velocity can be measured, or derived. For homogeneous and isotropic material, the relative propagation velocity (in metre per second),  r can be obtained as in equation (2.10) [13]. The data recorded from a GPR system are voltages of the received signal versus time [39]. If the velocity of propagation through a material is known,    29     Ground Penetrating Radar    the depth (in metre) to an object  d  can be calculated from the recorded two-way travel time  t  . Notice that since the wave travels from the transmitter to the object and back to the receiver, the two-way travel time is halved to obtain the actual time to the feature. The layer thickness is therefore can be computed as [13]:  d  r  t 2  (2.12)  2.3.4 Electromagnetic Wave Physics 2.3.4.1  Target Reflection and Feature Identification  A typical GPR section has distance along the top and two-way travel time down the side [54]. At each position in the survey, the recorded trace is displayed as a coloured or grey-scale strip of pixels with the entire section being built up from each of these traces. The layers of GPR recorded trace show up as coloured or black-white-black lines (reflections) and isolated ‘blocky’ or smaller-scaled features (such as pipes, foundations, etc.) produce curved, hyperbolic-shaped features (called diffraction hyperbola). When the antenna crosses a target at a right angle, the resulting image looks like an inverted U or V – a hyperbola is the descriptive term for its shape as depicted in Figure 2.4 (b).    30     Ground Penetrating Radar    Surface  Direct Coupling  (a) Surface (top panel) Hyperbola from pipe Pipe Bottom of the box Reflections from the bottom of the box  (b) Figure 2.4: Linescan and oscilloscope displays (right) show the (a) direct coupling and (b) reflections and diffraction hyperbola of GPR data scanned over the plywood top panel of the pipe in a box.   31     Ground Penetrating Radar    The very first signal in GPR scan is often called “direct coupling” between transmitter and receiver and is used to identify the surface position. In Figure 2.4 (a), direct coupling looks like a straight horizontal band on top of the data window. It is a combination of the transmit pulse in the air and surface reflection from the top of the material (plywood). It arrives at the receiver before the signal penetrates into the material, thus direct coupling carries little information about the structure [49]. Hyperbola is a form of point source reflection that is due to the fact that GPR energy is emitted in a cone, which radiates outwards with depth [43]. As such, energy is reflected from objects that are not directly below the antenna; the reflections, however is recorded as being directly below the antenna, and at a greater depth due to the oblique transmission of the wave. The hyperbola shape happens because the radiated antenna beam has the shape of a wide cone, thus the radar can see the target not only when on top of it, but also in several scans before and after that position. The apex of the hyperbola denotes the actual location of the target. The shape of a hyperbola depends on two parameters [49]:   scan spacing: smaller scan spacing (more scans per inch/cm) produces wider hyperbolas;    radar wave velocity: higher velocity (lower dielectric) produces wider hyperbolas.    32     Ground Penetrating Radar    Target of larger diameter produce brighter reflections. The shape of hyperbola does not change significantly with target size for any diameter less than 2 inches – all such targets are point-like for the radar as their size is a fraction of the wavelength. The target size can be roughly estimated from the width of the hyperbola’s flat top. Therefore, any targets below 2 inches in diameter will produce hyperbolas of the same size and shape [49].  2.3.4.2  Background Noise and Clutter  Background noise [13], [43] termed clutter in case of a GPR can be defined as those signals that are unrelated to the target scattering characteristics but occur in the same sample time window and have similar spectral characteristics to the target wavelength. It refers to point targets and small discontinuities that reflect energy and obscure the signals of other more important reflected waves. The clutter can be caused by breakthrough between the transmitter and receiver antennas as well as multiple reflections between the antenna and the ground surface. Local variations in the characteristic impedance of the ground can also cause clutter, as well as inclusions of groups of small reflection sources within the material. The background noise may also be generated by other nearby sources of EM waves, including televisions, cell phones, and radio transmission antennas [45], [55].    33     Ground Penetrating Radar    2.3.5 Distance Normalisation In GPR, the position of the targets should be given in relation to surrounding objects or to a reference grid on the ground surface. The acquired data can be of any practical use if there is enough spatial positioning information exists in the data to correlate any detected features with these surface coordinates [7].  Figure 2.5: Collecting the position of cracks in practical approach with measuring tape. The most common method for incorporating this spatial positioning information into the radar file, considering the radar operating system in continuous mode is by placing event markers in the data when the antenna covers a given lateral distance [7]. Practically, these markers are often introduced by a manual switch or button controlled by the radar operator, with the distance calibrated by means of a measuring tape, regularly-spaced survey pegs or spray markers, or in certain circumstances by human    34     Ground Penetrating Radar    estimation. The yellow dots depicted in Figure 2.4 (b) represent the markers position being taken during the measurements whilst Figure 2.5 illustrates the situation where measuring tape is being used in practice.  2.4 Types of Data Collection The objective of GPR data presentation is to provide a visual display of the processed data that closely approximates an image of the subsurface, with the anomalies that are associated with the objects of interest located in their proper spatial positions [41]. Data display is a key to data interpretation and in fact, producing a good display is an integral part of interpretation. This section explains three types of data representations used in GPR for a better understanding of the terminology [9], [39], [41], [47]. (a) A-scan A-scan (or one-dimensional data presentation) is a time-amplitude plot that is obtained by a stationary measurement, emission, and collection of a signal after placing the antenna above the position of interest. (b) B-scan Most of GPR data analysis is based on interpretation of a series of GPR signals presented as a B-scan. It is a two-dimensional dataset or image obtained as the horizontal collection from the ensemble of Ascans. The horizontal axis of the two-dimensional image is the    35     Ground Penetrating Radar    surface position, and the vertical axis is the round-trip marvel time of the EM wave. A matrix is then performed where each row represents a sample point (or time) and column represents a trace. The value of the element of the matrix is the amplitude of the voltage for the associated trace and sample point. Assigning intensity to the amplitude of the voltage allows the matrix to be displayed as an image. (c) C-scan C-scan (or three-dimensional data presentation) signal is obtained from the ensemble of B-scans, measured by repeated line scans along the plane. Three-dimensional displays are fundamentally block views of GPR traces that are recorded at different positions on the surface. Obtaining good three-dimensional images are very useful for interpreting specific targets. Targets of interest are generally easier to identify and isolate on three-dimensional datasets than on conventional two-dimensional profile lines.    36     Ground Penetrating Radar    (a)  (b)  (c) Figure 2.6: GPR measurement taken across a pipe in a box of (a) onedimensional and (b) two-dimensional GPR data. The one dimensional data is taken at the distance of 0.4m in two-dimensional image. (c) Threedimensional GPR data represents an empty box.  2.5 Types of GPR System The School of Engineering at the University of Portsmouth has purchased a number of GPRs designed and developed by Utsi Electronics Ltd. Some of these devices have been utilised to perform laboratory experiments. Two types of radars used in this work are:   37     Ground Penetrating Radar    (a) Groundvue 3 (GV3) It is used with a dual bowtie antenna pair. There are two types of frequency used during the measurements which are 1 GHz radar system (transmitter and receiver) and 1.5 GHz Crack Detection Head (CDH). The CDH is specifically developed for the detection and measurement of vertical cracks in concrete and asphalt/tarmac. The operating depth (measured in travel time) and the distance between samples must be defined accurately whilst other parameters can be reset after the survey. The depth range for this radar is from 0 – 5 metres in dry conditions, and a little less in water logged grounds. Figure 2.8 shows the GPR of GV3 system. (b) Groundvue 5 (GV5) It is a 4 GHz horn antenna system with high resolution capability. Similar to GV3, the operating depth and distance between samples must be defined clearly. The GV5 can be used on its own as one (or more) of the four channels of the multi-channel GV3.  Figure 2.7: GPR Groundvue 5.   38     Ground Penetrating Radar    GPR GV3 system (Front view)  The overall radar system of GV3 containing 400 MHz, 1 GHz, and 1.5 GHz CDH frequencies.  GPR GV3 system (Side view) 1.5 GHz CDH 1 GHz antenna system 400 MHz antenna system  GPR GV3 with 1 GHz and 1.5 GHz system  1 GHz transmitter 1 GHz receiver 1.5 GHz CDH  Figure 2.8: GPR Groundvue 3 with 400 MHz, 1 GHz, and Crack Detection Head antenna systems.   39     Ground Penetrating Radar    Most of GPR systems operate in the frequency range from DC to the highest frequency, which can reach to the buried objects. GPR is therefore a very wide frequency system, and its centre frequency is referred as its operational frequency. For concrete inspection, GPR is typically operates around 1 – 1.5 GHz, where the object is 1 cm large and depth is 20 – 50 cm [4].  2.6 GPR Data Two types of data have been used in determining the effectiveness of the proposed algorithms, simulated and experimental (measured) data. GPRMax software has been used in simulating the GPR data whilst three types of experimental data have been obtained in three different sets of measurements.  2.6.1 Simulated Data In this work, the presented GPR simulations have been computed in twodimensional only via Finite-Difference Time-Domain (FDTD) [56], [57] algorithm implemented via GPRMax2D. It is an EM wave simulator for GPR modelling that is based on the FDTD numerical method [58], [59]. The general structure of an input file of the GPRMax software is a plain American Standard Code for Information Interchange (ASCII) text file which can be prepared with any editor or word-processing program. The software used the hash character (#) to denote the beginning of a command   40     Ground Penetrating Radar    with its parameters occupied in a single line of the input file. Other characters can be used to comment or describe the input file. In the presence of misspelled command, the program will be terminated and hence issued an error message. A white space character is used to separate a command that requires more than one parameter [58].  2.6.1.1  Basic Concepts of GPR Modelling  The GPR response from a particular target or set of targets can be simulated by solving the Maxwell’s equations subject to the geometry of the problem and the initial condition. The initial condition (i.e. the excitation of the GPR transmitting antenna) is defined to avoid the propagation through space reaching a zero value at infinity. This is due to the reason of no specific boundary limits the problem’s geometry and where the EM fields can take a pre-determined value. The nature of the GPR forward problem can therefore be classified as an initial value – open boundary problem [58]. In general, the FDTD approach to the numerical solution of Maxwell’s equations is to discretise both the space and time continua [58]. The discretisation spatial  x ,  y , and z , and temporal  t steps are therefore play a significant role since the smaller they are, the closer the FDTD model is to a real representation of the problem. However, the values of the discretisation steps always have to be finite since computers have a limited amount of storage and finite processing speed. Hence, the FDTD model represents a discretised version of the real problem and of limited size. The   41     Ground Penetrating Radar    building block of the discretised FDTD grid is called Yee cell [60] name after Kane Yee who pioneered the FDTD method. A FDTD simulation starts by defining the structure to be modelled and identifying the range of wavelengths for which to compute a response. A grid is defined based on the grid spacing which must be small enough to sufficiently resolve the shortest wavelength of interest (typically  10 to   30 ) and resolve the finest feature of the structure [61]. The numerical solution is obtained in an iterative fashion where the EM fields propagate in the FDTD grid. The FDTD simulated the fields for a given time window by specifying the number of iterations and each iteration corresponds to an elapsed simulated time of one t . Energy can never travel farther than one grid spacing in a single time step due to the manner in which the fields are updated. The time step is therefore should be small enough to accurately portray physical fields. The values of x , y , z , and t are therefore can not be assigned independently due to its conditionally stable numerical process that is known as the CFL condition, which is after the initials of Courant, Freidrichs, and Lewy, and is given by [58], [61]: 1  t  c  1   x   2    1   y   2    (2.13)  1   z   2    42     Ground Penetrating Radar    where c is the speed of light. Hence, t is bounded by the values of x , y , and z . The stability condition for the two-dimensional case is easily  obtained by letting z   . As stated previously, the excitation of the GPR transmitting antenna should be defined first to terminate the computational region at a finite distance from sources and targets. An approximate condition known as Absorbing Boundary Condition (ABC) is introduced at a sufficient distance from the source to truncate and limit the computational space by absorbing any waves impinging on it. This program used ABC as its default, however, when modelling more than six layers in the GPR, Perfectly Matched Layer (PML) – a layer of non-physical absorbing material is advisable to be used due to its superior performance compare to ABC. Figure 2.9 illustrates the basic difference between the problem to be modelled using ABC and the actual FDTD modelled space [58].  Figure 2.9: The two-dimensional GPR forward problem and its GPRMax2D domain bounded by ABC.   43     Ground Penetrating Radar    2.6.1.2  Coordinate System of GPRMax2D  The GPRMax2D FDTD algorithm is implemented in the  x  y  plane where the origin of the coordinate system is the lower left corner at  0,0  . The smallest space that can be allocated to represent a specific medium is a 2D cell   x y   with the reference point at its centre. The space  coordinates are however range from the left edge of the first cell to the right edge of the last one as depicted in Figure 2.10. For a given set of space coordinates  x, y  , the actual positions of the EM field components are [58]:   x y   ,y x  for E z ; 2 2      x   , y  for H x ; x 2      y    x, y   for H y ; 2    which are due to the staggered arrangement of field components in the FDTD algorithm. Therefore, the interference between two cells of different constitutive parameters is located on the positions of the magnetic  H  field components and all sources are actually located at the positions of the electric  E  field component.    44     Ground Penetrating Radar    Figure 2.10: The two-dimensional FDTD cell [58].  2.6.1.3  GPR Modelling with GPRMax2D  There are two important points should be concerned when modelling the GPR with GPRMax2D. This is to cover the most fundamental aspects of using FDTD based program as well as avoiding the common errors which are [58]:   discretisation;    Absorbing Boundary Condition (ABC).  In general, discretisation depends on the required accuracy, the frequency content of the source’s pulse, and the size of the targets [58]. Errors associated with numerical induced dispersion are another factor that influences discretisation. This is opposing to the real world where EM waves propagate with the same velocity irrespectively of their direction and frequency (assuming no dispersive media and far-field conditions). This error [56], [59] can be kept minimum by following the rule of thumb which    45     Ground Penetrating Radar    the discretisation step should be at least ten times smaller than the smallest wavelength of the propagating EM fields and is described as:  l    10  (2.14)  The ABCs employed in GPRMax2D perform well (i.e., without introducing significant artificial reflections) if all sources and targets are kept at least 15 cells away from them. Although the PML absorbing boundaries has a user adjustable thickness, it absorbs very efficient most waves that propagate in them. Placing a source and output in these layers should be avoided to obtain a correct GPR modelling. These requirements should be considered when deciding the size of the model and free space (i.e. air) should be always included above a source for at least 15 to 20 cells for the same reason [58].  2.6.1.4  General Structure of GPRMax2D Input File Commands  There are some principles in modelling GPR to describe the GPRMax2D commands and their parameters [58]. Parameters associated with simulated space and spatial coordinates should be specified in metres. Time and frequency parameters are however identified in seconds and Hertz. An example of input file in constructing a model by using GPRMax2D is depicted in Figure 2.11. The output is illustrated in Figure 2.12 together with an image representation of the model’s space constructed using the   46     Ground Penetrating Radar    information stored in the geometry file. Based on Figure 2.12 of GPR trace, the GPR receiving antenna records amplitude at a particular sampling rate, for a particular time duration. GPRMax2D program converts spatial and temporal parameters given in metres and seconds respectively to integer values corresponding to FDTD cell coordinates and iteration numbers. The time between sample points can be identified using this information which 2827 samples were generated in 10 ns (the value of time_window in the input file given in Figure 2.11) yielding a time between samples of approximately 3.5373 ps. Time scale is referred to as two-way travel time taken to transmit and reflect from the target. This information should be considered when computing the distance between features [39].    47     Ground Penetrating Radar    Figure 2.11: Example of GPRMax2D input file in simulating concrete slab with joints using 1.5 GHz frequency radar. Red arrows represent lines that were deactivated and ignored by the program as the first character of each command starts without the hash character (#).   48     Ground Penetrating Radar    Joints  Free space  (a) Geometry image representation of  Concrete Concrete Concrete Concrete block 1 block 2 block 3 block 4  Wet sand Free space Concrete  the model  The free space above the source is included in the model according to ABC rules. Wooden box (b) Simulated GPR scan of the model  The GPRMax2D converts spatial  and  parameters  temporal to  integer  values corresponding to FDTD cell coordinates and iteration numbers.  (c) A-scan representation  The A-scan represents the GPR trace number 60 of the GPR scan depicted in (b).  Figure 2.12: Example of GPRMax2D model.   49     Ground Penetrating Radar    2.6.2 Experimental (Measured) Data There are three types of experimental data used for this research which was prepared by:   School of Engineering, University of Portsmouth – to evaluate the performance of GPR GV5 system in detecting and characterising three PVC pipes samples of different diameters with and without the presence of sand;    Department of Mechanical and Design Engineering, University of Portsmouth and Utsi Electronics Ltd – to investigate the potential and applicability of GPR GV5 and GV3 CDH systems in detecting cracks and defect within their water reservoirs and infrastructure (floor slab and slab joints);    School of Engineering, University of Greenwich – to assess the performance of GPR GV5 system in detecting cracks on a concrete metal fibre mixtures slab.  The description and physical model of each experiment is illustrated and discussed in the subsequent chapters.  2.6.2.1  PVC Pipes Detection  The experiment was performed on a prototype laboratory model that was carefully designed and constructed with the intention of detecting pipes with different diameters. Two open-top wooden container boxes were   50     Ground Penetrating Radar    constructed using a minimum amount of metals (nails, screws, etc.) to prevent metal interference with the radar signal. The construction of the container boxes and the preparation of these models for experimental purposes are described in Figure 2.13.  (a)  (b)  (c)  (d)  Figure 2.13: (a) Experimental setup used in collecting GPR data for pipes detection, (b) sand was placed in the small container box, (c) top panel with grid drawn on it, and (d) position of three pipes in the container box. The container boxes were made in two different sizes from 2.5 cm plywood  measuring  1.23 m  1.23 m  0.175 m  (small)  and    51     Ground Penetrating Radar    1.27 m  1.27 m  0.265 m (big) sitting on four supporting beams with  measurements of 0.07 m  0.095 m  1.3 m . PVC pond liner material was used to line both boxes that were securely stapled into position. In order to carry  out  the  GPR  measurements,  plywood  measuring  1.4 m  1 m  0.018 m was placed on top of the constructed container boxes  and scanned lines along the 10 cm grid drawn on the top panel. Three different sizes of PVC pipes with thickness of 0.2 cm, which were sealed with tape at each end, were used during the GPR measurements. The dimensions of the pipes are given in Table 2.1. In the presence of sand, the PVC pipes were buried at a depth of 15 cm from the sand surface. During data collection, markers were introduced manually into the data at the beginning and end points of the top panel as depicted in Figure 2.13 (c). Table 2.1: Pipe dimensions used in the experiment performed for pipes detection. Pipe size Diameter (cm) Length (cm)  Big  10.8  25  Medium  4.3  31.5  Small  2.8  30    52     Ground Penetrating Radar    2.6.2.2  Cracks and Defect within Water Reservoirs Detection  The physical model was built to provide a realistic laboratory representation of joint structures with and without the presence of water. Two concrete slab test-beds, A and B, were used to simulate storage reservoirs with leakage problems and also those, which remain intact. The construction of the slabs and the preparation of these models for experimental purposes are described in [42]. In order to perform experiment of concrete with and without the presence of water, the concrete slabs required container boxes to allow the slab to be submerged in the water. Two container boxes were made from 2 cm plywood measuring 1.2 m  1.2 m  0.15 m sitting on four under supported beams with the measurements of 0.07 m  0.09 m  1.3 m . Both boxes were lined with PVC pond liner material, which was securely stapled into position. A simple PVC drain was fitted through the base in the corner of each box. The right angle that bends the drain was turned into a “U” tube by using a 2.2 cm PVC tube with the outside leg is able to turn down to allow for free drainage of the boxes. The drain was filled with plastic pan scrub material to prevent the sand from flowing down the drain whilst allowing the flow water when required.    53     Ground Penetrating Radar    (a)  (b)  Figure 2.14: (a) Completed container boxes and (b) sand preparation for dry condition tests. The sand was prepared with bags of washed sand that were spread out on polythene sheets on the laboratory floor with a blowing fan heater to dry the sand. The 9  25 kg bags of dry sand were placed in the slab A whilst the slab B contained the same quantity of damp/wet sand. The sand was levelled and covered with a weed control fabric to prevent sand interfering with the joints when the concrete blocks were laid out (Figure 2.15). Each slab was constructed by building four concrete blocks with the measurements of 0.915 m  0.25 m  0.125 m . The first block was laid on the fabric on its side and 7 mm joint of F-Bondpolyester resin FIP 300SF was applied to the side of the second block to be matted to the first block. This was repeated with the third block with the exception of the thickness of the joint which is 25 mm. The last block was jointed with an interior white sealant (used in UPVC windows) with 12 mm thickness.    54     Ground Penetrating Radar    (a)  (b)  Figure 2.15: (a) Preparation of concrete slabs and (a) two concrete slabs were ready with joints attached. During data collection, markers were introduced manually into the data when the radar crossed the concrete slab joints or a large crack. In order to carry out experiments involving holes and cracks, both slabs were drilled and hit with a club-hammer. The approximate positions of joints, holes, and cracks are depicted in Figure 2.17. Application of hammer resulted in the development of a large crack along the middle joint and goes all the way to the bottom of the slabs.  (a)  (b)  Figure 2.16: Introduction of holes and cracks on the concrete slabs.   55     Ground Penetrating Radar    (a)  (b) Figure 2.17: (a) Depiction of joints, holes, and cracks position and (b) the approximate positions of the radar traverses during the experiments.  2.6.2.3  Cracks on a Concrete Slab Detection  A laboratory experiment was conducted at dedicated concrete testing facility in detecting cracks on a concrete slab  6 m  6 m  0.25 m reinforced with metal fibre mixtures  3 cm  0.1 cm . During data collection, 20 cm grid was used to collect each scan that covers the whole concrete slab and    56     Ground Penetrating Radar    markers were introduced manually into the data when the radar crossed the crack. In addition to this, measuring the position of each crack was also made using measuring tape.  (a) Concrete slab containing metal  (b) The 20 cm grid measurement.  fibre mixtures.  (c) Cracked concrete block.  (d) Practical approach measuring the crack position.  Figure 2.18: Data collection over a cracked concrete metal fibre mixtures slab.    57     Ground Penetrating Radar    2.7 Glossary of Terms The following section provides description of some terms related to GPR technology, commonly used in this section [54]: Antenna  It is the transmitting or receiving transducer of the GPR system. The transmitting antenna produces the radiating GPR wave whilst the receiving  antenna  captures  the  reflected/scattered energy from the targets. Attenuation  The loss of signal energy affecting GPR waves  as  they  propagate  through  the  subsurface. The attenuation is caused by a combination of material losses and the spreading loss of energy as the wave travels outwards. EM energy  Propagating energy made up of coupled, alternating electrical and magnetic fields. GPR uses radio wave EM energy at MHz.  GPR section  The cross-sectional image of the subsurface generated by the GPR system in the form of a collection of coloured or grey-scale strips that relate to the amplitude of the recorded voltage signal trace. The GPR section usually has   58      Ground Penetrating Radar    distance along the survey line as the horizontal axis and recorded time (as two-way travel time in ns) as the vertical axis. GPS  Global Positioning System – device for spatial navigation and positioning. Only differential GPS systems at lower frequencies antenna are accurate enough for GPR.  Grey-scale  A sequence of grey shades from black through greys to white used to show the amplitude of a GPR trace. It produces a GPR section that has the same colouring as a ‘black and white’ photograph.  Radio waves  It is an EM energy at a frequency of MHz. At these frequencies, EM energy is able to travel through air or ground relatively easily – called radiating EM energy. These frequencies are referred to as ‘radio waves’ as this is the frequency band of AM radio stations.  Two-way travel time  The time it takes the GPR wave to travel down to a target and back up to the receiving antenna in ns.    59     Ground Penetrating Radar    Trace  This is the recorded output of the received GPR signal. It is a simple recording of the voltage at the receiving antenna over a specific period of time from the start or ‘triggering’ of the GPR system. The trace takes the form of wiggles or wavelets and is usually converted into a coloured or greyscale strip of pixels in a GPR section.  Velocity  The ‘speed’ of a propagating GPR wave through a material in m/s or m/ns.    60          Chapter 3  	  Pre-processing using ReflexW Overview This chapter describes the details of dedicated GPR software package, ReflexWTM, used to pre-process GPR data analysed in this project. It gives details of the processing steps available in the software to improve the raw data quality before further processing and techniques developed in this work are applied.  3.1 Introduction GPR has been used extensively for a variety of applications in many fields. Processing GPR data using computers are commonly used nowadays, due to the inexpensive access to computer facilities [62]. The processing procedure consists of a sum of operations applied to the raw data in order to enhance the signal-to-noise ratio (SNR) and produce a more realistic image of the ground. GPR provides a quick and easy way to image the first few metres of the subsurface with a relative good resolution in determining shallow void  61     Pre-processing using ReflexW    characteristics where individual anomalies are not distinguishable by the other non-destructive geophysical methods [63]. A GPR display typically consists of a collection of time-series returns viewed stacked side-by-side giving a depth profile of the subsurface, resulting in either the B-scan displays common in seismic surveys, or a hard-limited intensity modulated raster plot of echo-strength vs. travel time [7]. These plots of radargrams are complex and difficult to comprehend without some level of signal processing to put them in a format that is amenable to human examination [47]. The purpose of GPR data processing is to improve the raw data quality by manipulating the acquired data into an image that can be used to infer the subsurface structure. Minimal processing is required in the present of a perfect acquisition system. In general, the processing routines fall into one of the following categories [64]:   enhancing signal at the expense of noise;    providing velocity information;    collapsing diffractions and placing dipping events in their true subsurface locations (migration);    increasing resolution.  A variety of data processing techniques have been developed to aid in the interpretation of the data. Ultimately, most users process GPR data with dedicated proprietary software [37], either system-specific (e.g., RADANTM   62     Pre-processing using ReflexW    [49]) or independent packages that can import a range of different data types (e.g., IXGPRTM [65], Radar Unix [66], RadExplorerTM [67], ReflexWTM [68]). Two types of GPR data processing have been classified in this work called pre-processing and one-dimensional processing. In the pre-processing step, two different approaches have been applied to the GPR raw data using ReflexWTM [68] and some other manual simple steps such as simple mean removal, PCA, and ICA which explained further in the next chapter. The one-dimensional signal processing techniques are discussed in Chapter 5.  Figure 3.1: Overview of GPR data processing flow [37], [62].    63     Pre-processing using ReflexW    Typical processing flow for GPR data is depicted in Figure 3.1 [37], [62]. Data processing focuses on the purple highlighted areas: data editing, basic processing, advanced processing, and visualisation/interpretation processing. Processing is usually an iterative activity in which the data will flow through the processing loop several times before it is finalised in the visualisation step. Batch processing with limited interactive control may be applied on large datasets after initial testing on selected data samples have been performed.  3.2 ReflexW Software In this work, the collected GPR data was imported and processed using ReflexWTM [68], which is an independent package software that can import a range of different data types. It has been developed by K. J. Sandmeier for the processing and interpretation of reflection and transmission data specifically in GPR application, and reflection and refraction of seismic and ultrasound data [69].  3.3 Basic GPR Data Processing Steps The basic processing steps are usually applied to the raw data (often automatically) and introduce minimal operator bias into the data without the need for additional subsurface information, typically in the form of trace    64     Pre-processing using ReflexW    editing, filtering or data correction [37]. These procedures are in general applicable to most collection modes.  Figure 3.2: GPR processing flow using ReflexW. Figure 3.2 describes the processing flow used for analysing GPR data using ReflexW. The basic descriptions of each step are as follows [37]:   data editing – removal and correction of bad/poor data and sorting of data files;    dewow filtering – correction of low frequency and DC bias in data;    topographic corrections – correction of topography effects;    time-zero correction – correction of start time to match with surface position;    filtering – 1D and 2D filtering to improve SNR and visual quality;   65      Pre-processing using ReflexW      gain function – improvement of data display and interpretation;    migration – correction of the survey geometry and spatial distribution of energy effects.  During data processing in ReflexW, the filenames of the GPR data is recommended to be numerically sequential for the purpose of viewing data in three-dimensional before the processing steps taken into action. Moreover, the sequence processing stage is easier to be applied in processing batch of data. Details analysis of each step is discussed in the subsequent chapters.  3.3.1 Data Editing In any processing sequence, data editing is often the most time-consuming since the files usually need sorting and rearranging as the first step in the post collection. Effective maintenance of the data from the start is vital for good-quality interpretation, particularly with large volumes of data [44]. The incorrect recording of survey parameters (e.g., spatial increment, section interval, and start position) results inaccuracy of data file headers, thus affecting the way of the data being imported into the processing program. It is therefore a good practice to view the header files of each section before the processing to check the consistency and accuracy of the survey parameters [37].    66     Pre-processing using ReflexW    Incoherent, noisy or missed traces require editing out and/or filtering to improve the visual nature of the section [37]. This is commonly caused by the overenthusiastic triggering, external noise sources, equipment failure/problems, or traversing too fast if odometer is being used. In most cases, only the occasional trace is corrupted and a simple interpolation between traces is sufficient.  Figure 3.3: Example of 'desaturation' function is used in correcting the clipped form of saturated traces [37]. ‘Desaturation’ or ‘declipping’ feature is a useful editing tool available in some programs [37]. Under certain circumstances, the initial ground wave signal can become ‘clipped’ as the GPR receiver system saturates with   67     Pre-processing using ReflexW    strong ground coupling, and thus the recorded trace does not represent the true peak amplitude of the returned signal (Figure 3.3). If trace normalising is being used to account for differences in antenna-ground coupling, the late arrivals of saturated traces will be artificially enhanced in comparison to the non-saturated traces. The ‘desaturation’ function attempts to correct this effect by reconstructing the form of the ground wave pulse using interpolation methods (Figure 3.3) as long as the trace is not too noisy and the form of the saturated ground wave wavelet is ‘clean’.  3.3.2 Dewow Filtering Due to the close position of transmitter and receiver antennas, the fields near the transmitter contain low frequency energy associated with electrostatic and inductive fields, which decay rapidly with distance. This low frequency energy caused the base level of the received signal to bow up or down, and this effect is known as baseline ‘wow’ in the GPR technology [37]. Dewow filtering is used to remove the low frequency components presented in the data by applying a running average filter to each trace and eliminate a long waved part of the signal that is caused by the EM induction [43], [44], [70]. It is a vital step as it reduces the data to a mean zero level and therefore, allows positive-negative colour filling to be used in the recorded traces (Figure 3.4) [37].    68     Pre-processing using ReflexW    Figure 3.4: Dewow filter correction on a raw GPR trace [37].  3.3.3 Topographic Corrections Topographic correction is an essential component of GPR data editing, especially in cases where there is significant topographic variation in order to ‘position’ the data in its correct spatial context [37], [43]. Compensation for topography is often important due to the shallow exploration depth of GPR. For minor surface variations, time-shifting data traces can largely compensate for topographic variations [37]. Two types of topographic corrections were applied to GPR data which are elevation static and maximum phase corrections.   69     Pre-processing using ReflexW    3.3.3.1  Elevation Static Correction  Flattening a GPR profile based on the airwave does not account when near surface has significantly different radar velocities than underlying units [71]. The elevation and velocity static correction is therefore should be performed to obtain more realistic subsurface images in order to correct any changes in topography over the survey [43]. Elevation static correction is normally performed with a simple constant velocity correction that acts in a vertical sense [72]. It corrects the two-way travel time of the traces to a flat datum level some distance above the air/ground interface. Figure 3.5 describes the datum statics terminology of static correction [64].  Figure 3.5: Datum statistics terminology [64]. ReflexW requires the user to specify the subsurface velocity profile independently to shift the data to positive (or negative) times from a given   70     Pre-processing using ReflexW    datum reference, usually either lowest or the highest point in the whole survey line. Table 3.1 [73] represents the value of distance and time correspond to the selection of radar frequencies as the interactive input of the static correction values. The position of the Sender/Receiver distance is depicted in Figure 3.6. Table 3.1: Sender/Receiver distance values. GPR Frequency  S/R Distance (m) Velocity (m/s)  GV3 400MHz  0.3  0.1  GV3 1GHz  0.12  0.1  GV3 1.5GHz and CDH  0.07  0.1  GV5 4GHz  0.03  0.1  Figure 3.6: The position of Sender/Receiver distance.    71     Pre-processing using ReflexW    3.3.3.2  Maximum Phase Correction  Maximum phase correction is used to correct the phase of maximum amplitude in a zone near the coupling and direct energy by flatten on one of these for a better look of the GPR data. This step is often useful in the presence of rough ground [70]. The application of maximum phase correction can be seen in Figure 3.7.  Concrete surface Crack  (a) The concrete surface is a bit uneven during the data collection using GPR GV5.  Concrete surface  (b) The concrete surface Crack  was corrected according to white line.  Figure 3.7: The application of maximum phase correction step to measured GPR data (a) before and (b) after.   72     Pre-processing using ReflexW    3.3.4 Time-Zero Correction The zero time may not have been detected precisely by the instrument in the field and should therefore be repacked to ensure correct depths in the profile. Furthermore, drift of the zero time along the profile can occur because of the temperature difference between the instrument electronics and the air temperature or damaged cables. The drift cases misalignment of the reflections and the zero time has to be re-positioned for all traces along the profile [44]. The time-zero positioning is usually achieved using some particular criteria such as the air wave first break point or first negative peak of the trace [37]. During data time-zero positioning, it is important to ensure that the mean value of the data (A-scan) is near to zero, which assumes that the amplitude probability distribution of the data is symmetric about the mean value and not skewed. The short time mean value is therefore constant over the time duration of the A-scan [13]. In general, the grey area on top of each radar signal in GPR image (usually applied to low frequency radar) is removed since it contains very little information for a better processing (Figure 3.8) [74]. This step might be unnecessary for high frequency radar which has good resolution that gives better view on the surface rather than depth.    73     Pre-processing using ReflexW    Grey area  (a)  (b)  Figure 3.8: Time-zero variations in a selected 1.5 GHz GPR data. (a) Timezero position on the original GPR data (white dashed-line) and (b) the white dashed-line change in time-zero position.  3.3.5 Filtering Filtering [37] is generally applied to the data to remove cultural (i.e., human-induced), system noise (e.g., high frequency ‘speckle’ from radio transmission [75]) or the striping effect from the antenna ringing [76] for the visual quality improvement of the data. It is useful in extracting particular aspects of the data and aiding interpretation (e.g., emphasising flat-lying reflectors, diffractions [62], [77]). Simple filters are often very effective at removing high/low frequency noise, whilst sophisticated methods are more appropriate for specific problems (e.g., excessive ringing or noise spikes [62], [78]). Filters can be applied before and after gains but pre-gain filters do operate on the data in its truest form [37]. If filters are being applied post-    74     Pre-processing using ReflexW    gain, the effect of the gain on the amplitude and spectral content of the data is therefore must be fully understood first. In general, filters can be classified into two basic types:   temporal – applied down the individual traces in time;    spatial – applied across a number of traces in distance.  These are often combined to produce advanced two-dimensional filters that operate on the data by removing, suppressing or enhancing signals of given frequency or across a specific number of traces in space of samples (time) [37].  3.3.5.1  Temporal Filters  Temporal filters alter the shape of single traces in the vertical (time) direction to enhance or eliminate noise at frequencies either higher or lower than the main GPR signal bandwidth and, as such, are ultimately just ‘cleanup’ filters that make the GPR section visually better. The typical onedimensional temporal filters include [37]:   simple mean – takes the mean of the data across a specified time window and smoothes the data to remove excessive higher frequency noise;    simple median – takes the median of the data across a specified time window for power spike removal;    75     Pre-processing using ReflexW      low- or high-pass (frequency domain filters) – the low frequency component is used to remove the noise in the data whilst the high frequency components eliminate the signal drift and low frequencies;    band-pass (frequency domain filters) – it is a combination of both high- and low-pass filters that will let through a specific range of frequency components which are defined by a ‘pass region’.  Band-pass Butterworth filter (Figure 3.9) is used in processing the GPR data using ReflexW. The decision of pass region should be selective as excessive in narrowing down the pass region cause in removing the actual recorded signal components and the outcome of GPR section will become poorer [37]. Table 3.2 [74] shows the cut-off frequencies used with bandpass Butterworth filter. Table 3.2: Band-pass Butterworth filter cut-off frequencies. Radar type  Lower frequency  Upper cut-off frequency  GV3 400 MHz  200 MHz  600 MHz  GV3 1 GHz  500 MHz  1500 MHz  GV3 1.5 GHz and CDH  750 MHz  Between 2250 – 3000 MHz  GV5 4 GHz  700 MHz  600 MHz    76     Pre-processing using ReflexW    Figure 3.9: Principle of a simple band-pass filter in the frequency domain and the form of two common filter functions: a notch and Butterworth filters [37].    77     Pre-processing using ReflexW    3.3.5.2  Spatial Filters  Spatial filters operate in the same manner as temporal filters but, instead, perform the filtering operation across the traces in distance to enhance or eliminate certain frequencies and emphasise or suppress features. The most common of spatial filters are [37], [44]:   simple running average – takes the mean of a large number of traces to smooth the data horizontally and emphasises flat-lying reflectors whilst suppressing dipping reflectors and diffractions;    average subtraction – takes the mean of a small number of traces in a window to be subtracted from each individual trace in sequence to suppress flat-lying reflectors and emphasises dipping reflectors and diffractions;    background removal – takes the mean of all traces in a section to be subtracted from each trace to remove background noise and antenna ringing, and eliminates continuous flat-lying reflectors.  One of the major problems in processing GPR data is the removal of the air ground reflection [79]. Spatial filters operate well with good-quality, low-clutter data and, in general, tend to be good at removing the strong air/ground wave response and ringing from the datasets. Background removal and average subtraction were used during data processing in ReflexW. The background removal was able to remove the striping effects from the image and enhance the curved and dipping reflectors whilst the   78     Pre-processing using ReflexW    average subtraction is very effective to allow subtle weaker signals that are lost to become visible in a processed section [62], [70]. 4 GHz GPR data: Basic Processing  GPR Crack structure  section  collected  over a concrete slab with crack structure at 0.18 m. Basic  processing  –  Dewow filtering. High frequency noise (“speckle”) 4 GHz GPR data: Bandpass filter applied  Band-pass  Butterworth  filter was applied to all traces equally. Pass region is 700 – 6000 MHz. High frequency noise (“speckle”) removed    79     Pre-processing using ReflexW    4 GHz GPR data: Background removal filter applied  Mean of all traces was removed from each trace individually. Air-ground wave removed  4 GHz GPR data: Average subtraction Crack structure is more visible  filter applied  The subtle weaker signal is become visible.  Figure 3.10: Realistic example of the use band-pass Butterworth, background removal, and average subtraction filtering on a 4 GHz GPR section collected over a concrete slab with crack structure at 0.18 m.  3.3.6 Gain Function Radar signals can be rapidly attenuated during the propagation into the ground. Signals from greater depths are very small compared to signals from shallower depth [37]. The simultaneous display of these signals   80     Pre-processing using ReflexW    requires conditioning before visual display due to the attenuation and spherical EM wave spreading of the signals [44]. The related amplitude information can be recovered by applying gain function to compensate the propagation losses at higher depths as well as increasing the visibility of deep objects [80]. The data structure is altered in some way (i.e., relative amplitude and/or phase relationships are changed) in the application of gain function [37], [43]. It is therefore very important to understand the effect of gain function before its application and the data are treated with care when interpreting [62]. Figure 3.11 shows the compensation of decreased signal amplitude at increasing travel by designing a custom gain to increase the signal strength. Gain is applied to the data which increases in time after the transmit pulse and the rise of the gain function is tailored to accommodate the drop-off and signal amplitude versus time [81].  Figure 3.11: Concept of time-varying gain where signal amplification varies with time [81].   81     Pre-processing using ReflexW    Several procedures can be used in gain function such as constant gain, exponential gain and automatic gain control (AGC) [82]. All gain functions tend to operate in a similar fashion by applying some multiplying factor to successive regions of the trace in time (referred to as time window) and can be easily changed, typically the window length (in ns), the procedure type (linear, exponential, user-defined, etc.) and the maximum gain allowed. In general, both noise and coherent signals are usually amplified together in an indiscriminate way [37]. The choice of the range gain function applied during acquisition depends on the data handling. The gain can either be designed to enhance the visibility of the data for on-site interpretation which is the most common among radar operators, or set to a constant value throughout to preserve the information content of the signal that is more beneficial when further digital signal processing is to be performed on the data [7].  (a) Excessive gain applied  (b) After removal of gain  Figure 3.12: The effect of inordinate acquisition gain selection [7].   82     Pre-processing using ReflexW    It is however possible for the receiver to clip some portions of the signal that exceed the range gain. This clipping enhances the appearance of the image by highlighting the edges of any anomalies and the contrast for the detection of weak signals is increased. However, this situation is known as data distortion (Figure 3.12 (a)) and is therefore important to include this effect during the range gain selection [7].  (a) Moderate gain applied  (b) After removal of gain  Figure 3.13: Acquisition gain removal during pre-processing [7]. In general, gain should be selected based on some priori physical model and the objective should be to modify the data whilst retaining its full utility without introducing artefacts. Time gain is a non-linear operation, thus the application of filtering operations before and after time gain should be accounted as the output will not be equivalent [37], [81].    83     Pre-processing using ReflexW    3.3.7 Migration Migration [13], [37] is an image processing technique that used to improve section resolution and develop more spatially realistic images of the subsurface. The objective is to reconstruct, on the basis of reflection data, acquired at the surface, the entire reflecting structure that is present in the subsurface, and is causing said reflection data [79]. It applies a synthetic aperture image reconstruction process to focus scattered signals, collapse hyperbolas to their apices, and re-position dipping reflections [43]. The idea of migration is illustrated in Figure 3.14 [79].  Figure 3.14: The problem – the reflected energy of the object is spread out over the different receiver positions leading to the measurement hyperbola. The idea of migration is to recombine this energy in one position [79]. Migration requires an accurate radar velocity structure and the origin knowledge of the distorted reflections and wave travel paths before it can be applied to the data [37], [62]. In general, migration often enhances the   84     Pre-processing using ReflexW    display of the reflections significantly by moving the collapsed of diffraction hyperbolas and dipping reflections to the true geometrical position [44].  3.4 ReflexW Processing of the Measured GPR Image in this Work Figure 3.15 represents the example of the ReflexW process on the GPR data to detect the presence of joints within water reservoirs with 4 GHz frequency radar. Note that the time-zero correction step is not applied to this data due to the high frequency GPR is used. 4 GHz GPR data: Original raw data and data editing Joint 1  Joint 2  Joint 3  Data editing – correction of poor data and sorting data files. High frequency noise (“speckle”)    85     Pre-processing using ReflexW    Basic processing – dewow filtering applied  The  low  frequency  presented in the data is removed.  Topographic correction – static correction applied  ‘Positioning’ the data in its correct spatial context since  the  collected  data over  is un-  flattened surface.  Topographic correction – maximum phase correction applied  Correct the maximum phase in a zone near the coupling  and  direct  energy due to rough concrete surface.    86     Pre-processing using ReflexW    Filtering – band-pass applied  Band-pass  Butterworth  filter was applied to all traces equally. Pass region is 700 – 6000 MHz. High frequency noise (“speckle”) removed  Filtering – background removal applied  The striping effect is removed. Air-ground wave removed  Filtering – average subtraction applied  The  subtle  weaker  signals become visible.    87     Pre-processing using ReflexW    Gain function applied  Improve the data display and interpretation. Gain function selected – exponential.  Migration applied  Correct the effects of Joint structures are more visible  survey  geometry  spatial  and  distribution  energy.  Sand layers  Figure 3.15: Example of ReflexW process on GPR data to detect leakages from joints.  3.5 Conclusion Traditional approach of using commercially available ReflexW software for geophysical and GPR data processing has been investigated as an alternative way to pre-process data using signal processing techniques. Basic and simple processing steps such as one-dimensional filtering, topographic and   88     Pre-processing using ReflexW    time-zero corrections, band-pass filtering, background removal and average subtraction were used to process the data without altering the main features or targets present in the data. However, highly skilled and trained human operator is usually needed to process the measured data using this dedicated software to make sense of the captured images and interpret accordingly.    89          Chapter 4  	  Multivariate Pre-processing Techniques for GPR Images Overview Pre-processing methods for clutter and unwanted signal reduction in GPR data presented in this chapter is accomplished using multivariate techniques before further analysis can be undertaken. PCA and ICA algorithms are discussed in details as well as the two novel approaches adopted in this work – SVDPICA and 2DPCA. A comparison of pre-processed images between these algorithms and ReflexW is given as part of the research reported in this thesis.  4.1 Introduction GPR radargram provides information about the subsurface layers and anomalies that can be used to detect and investigate buried targets. Radargram is a two-dimensional dataset representing a collection of reflected traces corresponding to a vertical slice through the surveyed  90     Multivariate Pre-processing Techniques for GPR Images    ground. One of the most attractive features of GPR technology is the high resolution of subsurface imagery provided although shallower penetration depth is usually achieved compared to some other geophysical methods. The depth of GPR investigation may become even shallower due to the contamination of GPR data by severe ringing which can mask the reflected signals [83]. In the presence of a target, the GPR reflection results in an “inverted hyperbola” shape and image processing techniques can be used to extract and analyse this signature from the radargram [84]. It is however important that the background noise, clutter effects, antenna and ground coupling be removed or suppressed as much as possible before those techniques are applied. The obtained GPR profiles, acquired in “real-time” can be analysed in a raw format but some pre-processing is usually necessary to clean up the data and enable its reliable interpretation [85].  4.2 Review of Prior Research 4.2.1 Previous Work in Signal Processing A number of methods have been developed in order to reduce the presence of unwanted signals which can often dominate the GPR data and obscure the “real” reflections containing target information. Time gating technique [10], [21] has been used to distinguish a target from the backscattered signal of the surface in the situations where target is buried deep below the surface. This technique has been used to remove the ground reflection from GPR    91     Multivariate Pre-processing Techniques for GPR Images    measurements of deep targets such as buried pipes, exploded ordnance and tunnels [86]. However, choosing an appropriate time gate can be challenging for shallow targets buried near the surface. This is due to the overlapping responses from the targets and clutter, which the backscattered signal from both the targets and the surface will arrive almost simultaneously [21]. The simplest clutter reduction technique is background subtraction method [8], [83], [87] whereby the background signal is estimated as the mean of the unprocessed ensemble of GPR signals without a buried object [18], [88]. This method is most effective if the ground is flat and uniform over the antenna path – an ideal situation, rarely encountered in the field [86]. This approach also tends to remove parts of the target of any of the used scan paths that include the target response. In the case of soil which is an inhomogeneous medium and its statistical properties vary with position along the surface, subtracting the average may not lead to sufficient clutter reduction [21]. Alternatively, the background subtraction can be performed by estimating the background to be subtracted from the unprocessed GPR signals by using either moving average [89], [90] or median filter [18]. However, the estimation of the background will be affected in the presence of an object and the estimation will not be accurate. It is worth noting again that most of the above listed and discussed methods depend on the background signal estimation [10]. The background    92     Multivariate Pre-processing Techniques for GPR Images    signal is estimated first, as the mean value of the unprocessed ensemble of the collected GPR data before the simple mean scan subtraction method is employed. Alternatively, A-scan far away from the landmine location might also be used. Although this method cannot completely remove the direct wave from the received data due to the air-earth interface and time-shift of the radar system, it has been widely used in GPR applications.  4.2.2 Multivariate Analysis in GPR Application Another group of techniques, known as multivariate data analysis techniques has also been applied to process the obtained radargram before further analysis of the recorded GPR image takes place. The application of PCA analysis to GPR data for mines detection using cross track-depth scans is presented in [91]. In [92] clutter was reduced by reconstructing the GPR image from the most significant eigenvectors, and generalised SVD has been used in [86] to separate noise and signal spaces. A different unsupervised approach is introduced in [27] where characteristics of the source signals (principal components) and associated eigenimages were used to determine the subspace for reconstruction. ICA is another technique widely used in many applications such as brain imaging, econometrics, feature extraction [93], acoustical signal processing, edge detection, and face recognition [94]. This technique has been applied in [25] by implementing the Joint Approximate Diagonalisation of Eigenmatrices (JADE) to reduce clutter for anti-personal (AP) landmine. The   93     Multivariate Pre-processing Techniques for GPR Images    spatial and temporal ICA approaches is compared in [26] and [27] on buried iron and plastic AP landmine dummies. In [6], ICA has been used to analyse the GPR signal characteristics via Fixed-Point ICA (FastICA). Other related multivariate methods also include Factor Analysis (FA) [95], [96] and Singular Spectrum Analysis (SSA) [85]. Factor Analysis [41], [96] is a method for modelling the correlations in multidimensional data, by low-dimensional latent variables typically called factors or sources. A set of factors will be extracted from the dataset which are orthogonal and ordered according to the proportion of the variance of the original data. In general, only a (small) subset of factors is kept for further consideration and the remaining factors are considered as either irrelevant or non-existent (i.e., they are assumed to reflect measurement error or noise) [97]. Singular Spectrum Analysis [80], [85], [98] is an approach closely related to PCA. SSA decomposes the original time series (GPR traces) into a sum of a small number of independent and interpretable components such as low-frequency trends, narrowband quasi-periodic signals and noise. It consists of four steps which are embedding (i.e. a one-dimensional time series of observations is transformed into the multidimensional series), the SVD application to obtain a set of vectors that are linearly independent to be formed into several groups before the full reconstruction of the given radar traces time series by using a diagonal average procedure.    94     Multivariate Pre-processing Techniques for GPR Images    The application of these multivariate techniques analysis represents the main approach and contribution of this work. Fundamentals of these techniques are explained in the continuation of this chapter. Two particular techniques from this group – Principal Component Analysis and Independent Component Analysis are discussed in details and their application in processing obtained GPR data explained. Modifications introduced to both techniques in order to improve their performance in processing GPR data are given followed by some results and conclusions.  4.3 Multivariate Analysis The measured GPR data can be considered to consists of a large number of variables [41], where each corresponding sample in returned GPR trace represents one variable. It is to be expected that those variables are highly correlated with each other thus affecting the accuracy and reliability of target detection and characterisation methods. Unnecessary variables can also increase the data-storage and data-processing costs of deploying a model on a large database. One of the key reasons for applying multivariate analysis in processing GPR data is to find the ways to reduce dimensionality of GPR data without sacrificing the accuracy of measured datasets.  4.3.1 Principal Component Analysis Principal Component Analysis (PCA) is one of the most popular techniques for pattern recognition and signal processing [99], [100]. In fact, it is   95     Multivariate Pre-processing Techniques for GPR Images    important in many engineering and scientific disciplines, e.g., in data compression, feature extraction, noise filtering, signal restoration and classification [101]. PCA [102] is a technique usually employed to reduce dimensionality of a multivariate dataset without significant loss of information by finding the principal components (PCs) with which the given data can be most compactly represented. Among the purposes of PCA are the following [99]:   dimensionality reduction;    determination of linear combinations of variables;    feature selection: the choosing of the most useful variables;    visualisation of multidimensional data;    identification of underlying variables;    identification of groups of objects or of outliers.  PCA is a second-order statistical method which uses covariances between the observed variables in the estimation in order to express datasets in terms of linear combinations of a small set of factors that are assumed to be uncorrelated and Gaussianly distributed [41]. It is therefore worth pointing out that for the already uncorrelated variables contained in a dataset, application of PCA is of no value. In addition to being uncorrelated, the PCs are orthogonal and ordered in terms of the variability they represent [103]. That is, the first PC accounts for as much of the variability in the data as possible and each succeeding   96     Multivariate Pre-processing Techniques for GPR Images    component accounts for as much of the remaining variability as possible. In most cases, the representation is sought as a linear transform of the observed variables [41]. Often the PCs (i.e., directions on which the input data have the largest variances) are regarded as important, whilst those components with the smallest values are regarded as unimportant since they are considered to be associated with noise and not contribute very much information to the overall dataset and, hence can be eliminated. It is sometimes possible to eliminate a large number of variables that contribute only marginally to the total information with the appropriate transformation [99].  Figure 4.1: Graphical model for Principal Component Analysis. The motivating idea behind the use of PCA in GPR data processing is the high dimensionality of GPR signals. It is therefore very likely that those variables can be highly correlated with each other. The accuracy and reliability of various detection methods will suffer if the analysed datasets    97     Multivariate Pre-processing Techniques for GPR Images    are containing highly correlated set of variables that are unrelated to the outcome of interest. One of the key steps in processing the GPR data is finding ways to reduce dimensionality without sacrificing accuracy, thus PCA has to be one of the most suitable candidate approaches. Geometrically, PCA treats the samples from each GPR scan at a given time moment as a point in the space of dimension n equal to the number of performed GPR scans. One instance of this data forms a cloud of points in n-dimensional space. This cloud can spread in some directions more than in the others where variance of data in a given direction represents the measure of the data spread. The PCA finds a set of orthogonal axes, a base, such that each consecutive axis spans the directions with consecutively decreasing variance. The projections of the points onto these axes constitute the components. Each component can be visualised as a time series. The original time series can be recovered as a linear combination of these components. Components corresponding to very small variances can be neglected hence a data dimensionality can be reduced. Besides, the clutter information for GPR measurements is usually contained in one or a couple of PCs with the highest variance, therefore clutter and noise-free GPR dataset can be obtained by discarding those components [104]. Two types of PCA – one-dimensional PCA (1DPCA) and twodimensional PCA (2DPCA) were used in this work. The subsequent chapters described each of these algorithms in details.    98     Multivariate Pre-processing Techniques for GPR Images    4.3.1.1  One-Dimensional Principal Component Analysis (1DPCA)  The PCA algorithm can be performed via two approaches which are Eigenvalue Decomposition of Covariance Matrix and Singular Value Decomposition. The differences of these methods are described in the following sections.  4.3.1.1.1  PCA via Eigenvalue Decomposition of Covariance Matrix  For the purpose of implementing PCA algorithm on GPR dataset, a m  n GPR data matrix X containing n measurements – GPR traces, each consisting of m data samples, variables can be considered as indicated in Figure 4.2. Dimensionality of measured data in this case is the length of each GPR trace from the set m. The main goal of PCA is to transform the original dataset to another domain – variable space where same data can be represented with smaller number of variables. In this way, dimensionality of the data is reduced and better understanding of the measured data enabled. The linear transformation to accomplish this can be defined as: Y  SX  (4.1)  The original dataset X, where columns denote particular measurements and rows stand for individual data samples in each measurement, is now expressed by a new transformed matrix Y through the transformation   99     Multivariate Pre-processing Techniques for GPR Images    defined with matrix S. Calculation of matrix S such that the transformed dataset contained in Y is mutually uncorrelated, represents the main objective of the PCA algorithm. The structure of data matrix X can be represented as: x1,2 x2,2  xm,2  x1, n  x2, n    x1      xm ,n     x 2  xi  x n   (4.2)  Relative Amplitude  Data samples  X mn   x1,1 x 2,1      xm,1  clutter crack  GPR traces  (a)  Data samples  (b)  Figure 4.2: (a) GPR image contained in data matrix X and (b) single GPR trace xi (i = 120) from X – A-scan. Covariance matrix CX of the original data X has to be calculated first in order to obtain S. The covariance matrix consists of the correlation characteristics (covariances and variances) between each pair of data from X. The covariance between two measured values indicates the degree of  mutual similarity, where large absolute value denotes a high correlation and therefore redundancy of respective data. Zero covariance, on the other side   100     Multivariate Pre-processing Techniques for GPR Images    indicates completely uncorrelated data. To construct the covariance matrix for the dataset X, it is first necessary to calculate and remove the mean value from each measurement:  xij  xij   1 n  xij n j 1  (4.3)  where xij denotes the i-th data sample in the j-th measurement (i.e., j-th column of matrix X). In this way, each dimension is centred around zero and new, centred data matrix is obtained:  x1,1 x 2,1 X0       xm ,1  x1,2 x2,2  xm ,2  x1, n  x2, n    x1     xm ,n       x2  xn   (4.4)  The covariance matrix is obtained as a dot product of centred data matrix X0 divided by the number of measurements, traces in the analysed dataset X:  CX  cov  X   1 X0 XT0 n 1  (4.5)  In (4.5), n  1 is usually used instead of full number of measurements n in order to obtain unbiased covariance estimate. Obtained covariance can now be decomposed via spectral or eigenvalue decomposition into product of three matrices: C X  U  D  UT  (4.6)  where U is an orthonormal matrix (matrix of orthogonal unit vectors, i.e. UT U  I or  n  u k 1  ki  u kj  u Ti u j   ij , ui is the i-th column of U) and D is a   101      Multivariate Pre-processing Techniques for GPR Images    diagonal matrix. The columns of U are the eigenvectors of matrix X and the diagonal elements of D are the eigenvalues of X. If X is positive-definite, the eigenvalues will all be positive. Equation (4.6) can be multiplied with U and rewritten as: C X  U  U  D  UT  U  U  D  (4.7)  This can then be written as a normal eigenvalue equation: C X  u i  i  u i  (4.8)  where ui represents the i-th column of U, i.e. the i-th eigenvector and  i  D ii is the i-th eigenvalue. Using S  U T for the linear transformation defined in (4.1), covariance matrix of transformed dataset Y can be expressed as: CY  cov  Y    T 1 1 YYT  UT X  UT X   n 1 n 1 1 UT XXT U  n 1  UT C X U  (4.9)  Equation (4.9) can be rewritten in the form similar to matrix diagonalisation equation given with (4.6), i.e., C X  UCY U T  (4.10)  It is clear that the linear transformation to achieve diagonal covariance matrix CY can be accomplished using matrix S whose columns are the eigenvectors of the original data matrix X, thus S  U T . Rows of transformed data matrix Y are usually referred to as PCs. Slight ambiguity   102     Multivariate Pre-processing Techniques for GPR Images    in using this term should be pointed out at this stage as some of the surveyed literature and websites uses this term for the columns of transformation vector U, i.e. eigenvectors which is not correct. Y can be mapped back to X by inversing the transformation, which is simplified since the inverse of the transformation is equal to its transpose, i.e., U 1  U T  (4.11)  This can be proven by reconsidering the form given with the equation (4.10)  U   T 1  CY U1  CX  (4.12)  Since the covariance matrix is symmetric, i.e. C X  CTX then   UT  CY U1   U1  CY 1  T     UT     1 T  (4.13)  which implies that  U   T 1    U1   T    and U1   UT     1 T  (4.14)  These equations can only be true if the inverse of U is equal to its transpose. Thus, to obtain X from the transformed dataset Y, equation (4.1) can be rewritten as:  YT  XT ST  XT  UT   XT U T  (4.15)  which after multiplication with U 1 results in: Y T U 1  X T UU 1  (4.16)   103      Multivariate Pre-processing Techniques for GPR Images    or  X   YT U1   T  (4.17)  Taking into consideration that U 1  U T equation (4.17) can be rewritten as  X   YT U1    YT UT   UY T  T  (4.18)  This completes the round trip from the original data X to the PCs contained in Y and back to the original data. It is worth pointing out that to completely recover the original data contained in X, mean for each dimension removed in (4.3) should be added back to the data recovered in (4.18). This step has been avoided for simplicity, but should be considered when implementing PCA into software.  4.3.1.1.2  PCA via Singular Value Decomposition of Data Matrix  In practice, PCs of data matrix X can also be obtained directly – via Singular Value Decomposition (SVD) of data matrix X. SVD decomposes X into three new matrices as shown in Figure 4.3.  Figure 4.3: Graphical depiction of SVD of data matrix X.    104     Multivariate Pre-processing Techniques for GPR Images    SVD is a known algorithm for “diagonalisation” of rectangular matrices [105]. The diagonalising process produces diagonal and two orthonormal matrices. Mathematically, the SVD of data matrix X is given by: X  UΣV T  (4.19)  In the context of GPR data, the centred data matrix is usually transposed first to perform the SVD:  XT   UΣVT   VΣT UT  VΣUT T  (4.20)  since matrix Σ is a diagonal matrix and Σ  ΣT . The covariance matrix C X , can now be expressed as: C X  XXT  UΣV T VΣU T  UΣIΣU T  UΣ 2 U T  (4.21)  Result obtained in (4.21) compared to equation (4.6) indicates that matrix U obtained via SVD again contains the eigenvectors of data matrix X. Matrix Σ 2  D contains the eigenvalues of X, i.e.,  Σ2  diag 1 , 2 ,, n   (4.22)  The columns of U  m  n  and V  n  n  are sometimes called the left and right singular vectors, which are the eigenvectors of two covariance matrices, XXT and XT X respectively. Consequently,  UUT  UT U  I VV T  V T V  I  (4.23)  where I is the identity matrix.    105     Multivariate Pre-processing Techniques for GPR Images    Elements of matrix Σ are non-negative values, known as singular values of X, whilst the columns of matrix U and rows of matrix V represent the eigenvectors of matrices XXT and XTX respectively. This is easily observed from spectral decomposition of XXT and XTX:  XXT  UΣVT  UΣVT   UΣVT VΣUT  UΣ2 UT  (4.24)  XT X   UΣVT  UΣVT  VΣUT UΣVT  VΣ2 VT  (4.25)  T  and T  4.3.1.1.3  Dimensionality Reduction using PCA  This section explains the process of dimensionality reduction of original dataset X. Regardless of the approach used to obtain transformation matrix U, the process is the same as explained in the rest of this section. The amount of information, variance, contained in each eigenvector from U is indicated by the corresponding eigenvalues from Σ 2  D . Singular values in Σ or eigenvalues from D can thus be sorted in descending order and the corresponding eigenvectors in U and V are reordered in the same way. Denoting the reordered matrices with Û and V̂ , PCA transformation of data matrix X can again be obtained as:  ˆ TX YU  (4.26)  By selecting only the first k rows from the n  n matrix Y, the k  n matrix Yk is obtained. Thus data from X is in this way projected from n to k    106     Multivariate Pre-processing Techniques for GPR Images    dimensions. Since the original data contained in matrix X can be fully recovered using:  ˆ X  UY  (4.27)  partial recovery of the original data can be achieved by:  ˆ Y Xrec  U k k  (4.28)  ˆ represents the matrix obtained from Û by discarding the last where U k n  k columns of matrix Û . Therefore, the matrix X rec now contains most  of the information from the original matrix having lost the details contained in the last n  k eigenvectors. Summary of both approaches, including the dimensionality reduction and data reconstruction steps is given in Table 4.1 using Matlab code. Identical result can be achieved via modified SVD equation:  ˆ Σ ˆ ˆT Xrec  U k k Vk  (4.29)  ˆ , Σ ˆ and V ˆ represent the reordered matrices U, Σ and V. The where U k k k ˆ with n  k diagonal elements is set to zero, reordered diagonal matrix Σ k the multiplication given by equation (4.29) effectively rejects the last n  k eigenvectors from Û (columns) and V̂ (rows).    107     Multivariate Pre-processing Techniques for GPR Images    Table 4.1: Two ways of performing PCA including common dimensionality reduction and data reconstruction steps implemented in Matlab; left column – Eigenvalue Decomposition approach and right column – SVD approach. Data set/matrix:  X  (m×n)  m - number of dimensions/variables (samples in each recorded trace) n – number of measurements/trials (individual traces)  % get the size of the data set [m,n] = size(X); % obtain the mean trace and remove it from each measurement % note: this effectively removes the mean for each dimension mn = mean(X,2); X = X - repmat(mn,1,n); %% via: eigenvalue  decomposition  % calculate the covariance matrix Cx = 1 / (n-1) * X * X’; % find the eigenvectors and % eigenvalues [U, D] = eig(Cx); % extract eigenvalues to vector D = diag(D); % sort the eigenvalues and % eigenvectors in decreasing % order [junk, rindices] = sort(-1*D); D = D(rindices); U = U(:,rindices);  %% via SVD % transpose and scale the data % matrix needed because Matlab % “svd” function assumes % measurements in rows, not in % columns as with our GPR data X = X’ / sqrt(n-1); % SVD [U,S,V] = svd(X); % calculate the eigenvalues S = diag(S); D = S .* S; % no need for sorting, SVD did it % all  % transform the original data Y = U’*X; % reduce data dimensionality % i.e. consider only the first r rows of Y Yr = Y(1:k,:); % recover the original data % addition of mean trace is optional % for image analysis tasks Xrec = U*Y + mn; % recover the original data with losses % due to dimensionality reduction Xkrec = U(:,1:k)*Yr + mn;    108     Multivariate Pre-processing Techniques for GPR Images    4.3.1.1.4  GPR Clutter Reduction using PCA  For most natural images, eigenvalues decrease so rapidly and it is usually necessary to retain only a few largest values from Σ and the corresponding eigenvectors from U to significantly reduce dimensionality of data from X with minimal loss of information, particularly taking into consideration that the last eigenvectors usually represent measurement noise. Decluttering of GPR images requires somewhat reverse reasoning. For GPR images where clutter or other non-target related signals usually dominate the GPR image, most of this information is contained in the first few eigenvectors from U. It is therefore possible to reduce the amount of clutter for the SVDreconstructed image by setting the largest (i.e. first) or a couple of largest singular values from diagonal matrix, Σ to zero. As previously explained, discarding the last n  k columns and rows from Σ̂ would also reduce the amount of noise present in dataset X without affecting the amount of information contained in the GPR image. Therefore, in order to remove both clutter and noise present in the original dataset X, the following SVD reconstruction can be used:  ˆ Σ ˆ ˆT Xrec  U R R VR  (4.30)  where:   ˆ is an m  r orthonormal matrix  r  k  l  obtained from matrix U R U by reordering the columns corresponding to the descending values    109     Multivariate Pre-processing Techniques for GPR Images    of diagonal matrix Σ and discarding the first few l as well as the last n  k columns;    ˆ is an r  n orthonormal matrix obtained from matrix V by V R reordering the rows corresponding to the descending values of diagonal matrix Σ and discarding the first few l as well as the last n  k rows;    ˆ is an r  r diagonal matrix obtained from reordered matrix Σ̂ Σ R by discarding the first few element l as well as the last n  k columns  and  rows,  i.e.,  ˆ  diag  ,  , ,   Σ R 2 3 k  and  2  3    k . The above approach can also be recast in terms of superposition of individual eigenimages of the original GPR image X. Each eigenimage [106] Ei is obtained by multiplying a single row from matrix U, ui with the corresponding but transposed row from matrix V, v Ti : Ei  ui vTi  (4.31)  The contribution of each eigenimage to the original dataset is described by the corresponding singular value from Σ . The original GPR image is then easily obtained by scaling and adding all eigenimages, where the scaling factor for each eigenimage is the corresponding singular value from Σ . n  X    iEi  (4.32)  i 1    110     Multivariate Pre-processing Techniques for GPR Images    Thus, by discarding the strongest l eigenimages as well as the weakest n  k eigenimages from the measured GPR image, a decluttered and denoised GPR image can be obtained: nk  X rec    i E i  (4.33)  i l  Figure 4.4: One-dimensional Principal Component Analysis (1DPCA).  4.3.1.2  Two-Dimensional Principal Component Analysis (2DPCA)  One-dimensional PCA (1DPCA) can also be performed on the group of images or other 2D datasets. The traditional approach is to turn each of the 2D datasets into a 1D sequence by placing each column of the individual image below the previous one and then generating a new 2D dataset by   111     Multivariate Pre-processing Techniques for GPR Images    placing each “column image” into a new data matrix. 1DPCA via SVD is then being performed on this new dataset. Recently, an extension of PCA, called two-dimensional PCA (2DPCA) [107] has been developed in order to address some shortcomings of this traditional way that 1DPCA is performed on 2D datasets. 2DPCA starts by computing a new, 2D data matrix: H  1 m   Xi  μ  m i 1  (4.34)  Here X i represents the i-th image or some other 2D dataset from the group of m such images and μ refers to the average of all images in the set, calculated as: μ  1 m  Xi m i 1  (4.35)  The PCs are then computed in the usual way as in 1DPCA using SVD of data matrix H. This approach has been used in some image recognition tasks and has been reported to provide a higher recognition rate with a smaller computational complexity compared to 1DPCA [108]. Detailed analysis of this approach has also been performed in [109]. In this work, 2DPCA approach has been used to remove clutter and other types of strong interference from the set of GPR data images obtained in the same measurement session, under the assumption that the first l PCs for each collected image contains most of the unwanted information contained in all images from the group. Once the PCs are obtained using    112     Multivariate Pre-processing Techniques for GPR Images    2DPCA technique, decluttering procedure is performed in the same way as in the case of 1DPCA.  Figure 4.5: Two-dimensional Principal Component Analysis (2DPCA). Unfortunately, whilst PCA can be, and is, used to transform one set of variables into another smaller set, the newly created variables are not usually easy to interpret. PCA has been most successful in applications such as image compression where data reduction – and not interpretation – is of primary importance. In many applications, PCA is used only to provide information on the true dimensionality of a dataset [103].    113     Multivariate Pre-processing Techniques for GPR Images    4.3.1.3  Order Selection  The obtained eigenvalues of PCA describe the importance of the variance to the associated PC and can be very helpful to determine the components that are really significant as well as how much the dataset can be reduced when ordering by size. The associated PCs contribute little to the data if several eigenvalues are zero or close to zero, thus can be eliminated. The eigenvalue threshold can be determined by [103]:   eliminate some percentage below the sum of all eigenvectors;    eigenvalues is plotted against the order number to look for breakpoints in the slope of the curve which the eigenvalues of noise should not change much in value and hence produce a flatter slope.  4.3.2 Independent Component Analysis (ICA) The multivariate techniques PCA discussed previously differ from ICA in the criteria applied to the transformation. In PCA, the object is to transform the dataset so as to produce a new set of variables (termed PCs) that are uncorrelated. The goal is to reduce the dimensionality of the data, not necessarily to produce more meaningful variables. The application of both PCA approaches described earlier show that decorrelating the data is not sufficient to produce independence between the variables, at least when the variables have non-Gaussian distributions and resulting in the mutually orthogonal set of eigenvectors which makes it difficult to interpret or assign    114     Multivariate Pre-processing Techniques for GPR Images    any physical meaning to the obtained PCs. Although obtained PCs are decorrelated, they still represent a linear combination of independent variables from the original dataset. This inability to make the extracted components independent of each other provides the motivation to try and use an alternative technique known as Independent Component Analysis (ICA) [93], [110] for further improvement of PCA decluttered GPR images. The goal of ICA is however more ambitious which is finding new variables (termed independent components, ICs) that are both statistically independent and non-Gaussian [103]. The fundamental principle of ICA [93], [110] consists in estimating the set of independent signals from the mixture of the given signals by estimating the un-mixing matrix. ICA seeks to transform the original dataset into a number of independent variables. The motivation for this transformation is primarily to uncover more meaningful variables and not to reduce the dimensions of the dataset. Thus, pre-processing the dataset using PCA is needed when it involves in dataset reduction [103]. ICA is sometimes referred to as a Blind Signal Separation (BSS). The term ‘blind’ is intended to imply that BSS separates data into source signals when no or very little information about the nature of those source signals is available [110], [111] although it is worth noting that some researchers make distinction between the ICA and BSS methods.    115     Multivariate Pre-processing Techniques for GPR Images    The spirit of the suggested method for ICA clutter reduction resembles that of the PCA based technique. The most significant computational difference between ICA and PCA is the fact that PCA uses only secondorder statistics whilst ICA employs higher-order statistics. In contrast to correlation-based transformations such as PCA, ICA not only decorrelates the signals (second-order statistics) but also reduces higher-order statistical dependencies, attempting to make the signals as independent as possible. Restricting the analysis to use only second-order statistics gives satisfactory results for signals with a Gaussian distribution where statistical moments above second-order are zero. However, the majority of signals measured in nature (natural signals), do not have a Gaussian distribution and have higher-order moments. This property is exploited by ICA as it assumes the statistical independence and non-Gaussian nature of original signal components [25]. The subspace formed by ICA is therefore not orthogonal as is the case with components extracted by PCA. The mathematical model for ICA, assuming the same structure of data matrix X as in the PCA case can be written succinctly as: X  SA  (4.36)  where m  n matrix S now represents the matrix containing n original source signals as its columns and A is the mixing matrix. Matrix X is therefore represents a set of n mixtures of original signals contained in S and element aij from the mixing matrix A specifies the contribution of the i-th   116     Multivariate Pre-processing Techniques for GPR Images    source signal (column) from S to j-th mixture (column) of X. The main computational issue in ICA process is the estimation of mixing matrix A, so that the ICs, i.e. columns of matrix S can be obtained by: S  XA 1  (4.37)  To estimate the mixing matrix, ICA makes two basic assumptions: that the source variables are truly independent and that they are non-Gaussian. Both conditions are usually satisfied when the sources are real signals. A third restriction is that the mixing matrix A must be square, i.e. the number of sources should equal to the number of measured signals. This problem is usually solved by using PCA to pre-process the matrix X and reduce its dimensions, i.e. new matrix X K can be formed in such a way that the number of columns in X K becomes equal to the number of columns in S. The ICA technique can in analogy to PCA be reconsidered in terms of independent images, where i-th independent image of the original GPR image X, can be obtained by multiplying the i-th column from S, si with the i-th row, from the mixing matrix A, aTi : I i  s i aTi  (4.38)  Original image can be reconstructed through the addition of all independent images. GPR image with much stronger target information compared to original image can be obtained by rejecting non-target related independent images before the reconstruction.    117     Multivariate Pre-processing Techniques for GPR Images    One of the problems related to ICA used in this context is that, unlike PCA, there is no direct method to estimate the importance of each extracted independent variable, as can be done in PCA by sorting the eigenvalues in  Σ2 . Although some approaches to automatically order components extracted by ICA procedure have been reported [112], [113], [114], this question remains open in research literature. Thus, the visual inspection of obtained independent images has been used in this work to decide which of the independent images represents clutter and other non-target related information in order to reject those images. In addition to that, ICs can be randomly scaled and permutated after the ICA process. The ICA source separation and source estimation process is depicted in Figure 4.6 [111].  Figure 4.6: Blind Source Separation (BSS) block diagram. s(t) are the sources, x(t) are the recordings, ŝ(t) are the estimated sources, A is a mixing matrix and W is an un-mixing matrix [111].    118     Multivariate Pre-processing Techniques for GPR Images    Figure 4.7: ICA method in GPR application.  4.3.2.1  Independent Component Analysis Algorithms  Implementation of an ICA algorithm is not a trivial task, however, a number of excellent algorithms can be found such as Fixed-Point ICA (FastICA) [115], information maximisation (Infomax) [116], temporal decorrelation source separation (TDSEP) [117] and Joint Approximate Diagonalisation of Eigen-matrices (JADE) [25], [99], [118] which have been used widely in numerous signal processing applications. Each algorithm used a different approach to solve equation [111]:    119     Multivariate Pre-processing Techniques for GPR Images      FastICA – it employs higher-order statistics for the recovery of independent sources that uses simple negentropy estimation based on the maximum entropy principle [93], [115];    Infomax – it is a gradient-based neural network algorithm that uses higher-order statistics with a learning rule for information maximisation which is attained by maximising the joint entropy of a transformed vector [116];    TDSEP – it is based on the simultaneous diagonalisation of several time-delayed correlation matrices that able to separate signals whose amplitude distribution is near Gaussian [117];    JADE – it is based on the joint diagonalisation of cumulant matrices under the assumption that the sources have non-Gaussian distributions. This algorithm uses second and fourth-order cumulants that measured the mutual information between cross cumulants. Second-order cumulant is used to decorrelate the data, i.e. to obtain a  ˆ . The separation matrix is estimated as R Zˆ , whitening matrix Z where R is a rotation matrix used to make the cumulant matrices as diagonal as possible [119]. In this work, ICA is used via JADE algorithm to process the GPR data.    120     Multivariate Pre-processing Techniques for GPR Images    4.3.3 Proposed Novel Algorithm The objective of PCA is primarily to reduce the dimensionality of the data whilst ICA is to uncover more meaningful variables of the dataset. Majority of measured signals including GPR are non-Gaussian and above the secondorder moments. This work is therefore proposed a combination of these two methods, called SVDPICA – Singular Value Decomposition of PCA and ICA for data reduction and interpretation. The motivating behind this idea is the problem of orthogonality of the extracted PCs in PCA method (obtained by reconsidering the SVD data reconstruction equation (4.30)) and the problem of ordering the obtained ICs  ˆ in equation of ICA algorithm. Realising that the columns of matrix U R (4.30) are orthogonal but not mutually independent, ICA can be performed  ˆ , thus estimating the mixing matrix A such that: on matrix U R ˆ U  A U R R  (4.39)   obtained in this ICA process now represents a matrix New matrix U R  with un-mixed PCs from matrix X as its columns. Those are now identical to ICs that can be obtained by performing the ICA on the original data matrix X. This can therefore be combined with the SVD reconstruction equation (4.30) such that:  ˆ Σ ˆ ˆT  ˆ ˆT  Xrec  U R R VR  U R AΣR VR  U R TR  (4.40)  where   121     Multivariate Pre-processing Techniques for GPR Images    ˆ V ˆT TR  AΣ R R  (4.41)  Newly obtained matrix TR can be “decomposed” into two new matrices  T and Σ , i.e.: V R R  ˆ V ˆT  T TR  AΣ R R  ΣR VR  (4.42)  in such a way that one of the two matrices, Σ R , becomes diagonal matrix. This can be achieved by setting each element of new diagonal matrix Σ R to be:   i ,i  norm  t Ri   (4.43)  where t Ri represents the i-th column of matrix TR . Each column of new matrix V R , v Ri is obtained by scaling the columns from TR in the following way: v Ri   t Ri norm  t Ri   (4.44)  Thus, a “new” SVD like decomposition of data matrix X is obtained:  Σ V T X rec  U R R R  (4.45)  with the additional “quality” of containing the matrix of un-mixed  as well as the “importance” matrix Σ . Discarding one or eigenvectors U R R  can now further refine and more first and last eigenvectors from U R  improve decluttering and denoising effects achieved via PCA or simple mean removal in the first stage of this process. This can be easily automated   122     Multivariate Pre-processing Techniques for GPR Images     is as the information about the importance of each eigenvector from U R  contained in the diagonal elements of matrix Σ R . Summary of the proposed SVDPICA method is illustrated in Figure 4.8.  Figure 4.8: Three stages of SVDPICA method – SVD decomposition of original data matrix X, discarding of the first l and last n  k PCs, ICA un-  ˆ to obtain matrix U . mixing the reduced matrix of eigenvectors U R R  4.4 Results The main objective of this phase of the project is to reduce the amount of clutter and other unwanted signals present in the GPR data which are not    123     Multivariate Pre-processing Techniques for GPR Images    related to the target characteristics. Techniques described in the previous section have at this stage been used and applied in two related but different tasks:   uniform (or close to uniform) clutter reduction – for this purpose, PCA and SVDPICA methods have been applied and tested on the simulated and measured data to detect pipes, leakages from joints, holes and cracks, and cracked concrete;    non-uniform clutter reduction – significant amount of GPR data was measured and collected in the experiment aimed at detecting and characterising buried pipework. This data contained strong unwanted signals originating from the sides of the boxes used to hold buried pipes. Those signals varied non-uniformly across the image and as such could not be reduced with other, conventional clutter reduction techniques. The two-dimensional PCA and ICA algorithms have been applied to this data with the aim to improve image quality by removing target uncorrelated features from the image and prepare data for classification tasks which is envisaged to be the next stage in the project.  4.4.1 Algorithm Evaluation Parameters The performance of applied algorithms in clutter and unwanted signal reduction tasks has been evaluated in terms of Signal-to-Noise Ratio (SNR). SNR can be described as the ratio of average energy of the image matrix   124     Multivariate Pre-processing Techniques for GPR Images    after clutter and unwanted signals reduction to the average of matrix containing clutter and noise [120]:  SNR =  Pclutter and unwanted signals reduced image Pclutter + noise  (4.46)  where the average energy of the clutter and noise can be retrieved by subtracting it from raw B-scan image. The idea behind this approach is that the processed GPR image should contain the information about the target only with no clutter, noise and unwanted signals present in the data. It is however difficult to obtain a clutter-and-noise-free dataset for GPR images to be used as a reference for evaluating its performance in terms of SNR and related measures. Therefore, in addition to Peak-Signal-to-Noise Ratio (PSNR), Mean Structural Similarity (M-SSIM) Index measure has also been used in this work to evaluate the performance of the proposed techniques and give a better sense of validity as well as to indicate the potential advantages of the techniques for clutter and unwanted signals reduction developed and applied in this project. Both evaluation measures PSNR and M-SSIM index are discussed in details in the following sections.  4.4.1.1  Peak-Signal-to-Noise Ratio (PSNR)  Given two 8-bit grey-level, m  n images, a reference image, e and a test image, g , the PSNR between e and g is defined by [121]:  PSNR  e, g   10 log10  2552 MSE  e, g    (4.47)    125     Multivariate Pre-processing Techniques for GPR Images    where  MSE  e, g    2 1 m n eij  gij    mn i 1 j 1  (4.48)  For identical images, the MSE approaches zero and the PSNR value tends to infinity. At the other end of the scale, a small value of PSNR implies high numerical differences between two images which in the case of GPR images could indicate high amount of noise removed from the raw image. This can however be misleading as the removed components could also contain a useful part of the GPR signal. To account for this possibility, in addition to PSNR measure, measure of structural similarity is also used in this work.  4.4.1.2  Mean Structural Similarity (M-SSIM) Index  Measure of Structural Similarity (SSIM) index is used for quality assessment that indicates the resemblance between the image processed via one of the proposed methods and the “ideal” image with the values between 0 and 1, where 1 represents the identical images. Diagram in Figure 4.9 [122] indicates how the SSIM Index between two images is calculated through comparison in three stages – luminance, contrast and structure. Assuming two signals, x and y, the similarity measure is defined by considering one of the signals having perfect quality which can then be used as a quantitative measurement of the second signal quality.    126     Multivariate Pre-processing Techniques for GPR Images    Figure 4.9: Diagram of the structural similarity (SSIM) measurement system [122].    127     Multivariate Pre-processing Techniques for GPR Images    The luminance, contrast and structure comparisons of two signals (x and y) are computed using the following functions [122]:   Luminance comparison: l  x, y      (4.49)  x2  y2  C1  Contrast comparison: c  x, y      2  x y  C1  2 x y  C2  (4.50)   x2   y2  C2  Structure comparison: s  x, y     xy  C3  x y  C3  (4.51)  where 1 n  xi n i 1 1 n mean intensity,  y   y i n i 1 mean intensity,  x   1   1 n 2 2 base contrast,  x    xi   x     n  1 i 1  1  2 2  1 n y i  y   base contrast,  y      n  1 i 1  n 1 base contrast,  xy    xi   x   y i   y  n  1 i 1  constant C1   K1 L   2  constant C2   K 2 L  constant C3   2  C2 2    128        Multivariate Pre-processing Techniques for GPR Images    constant K1  1 constant K 2  1 L  dynamic range of pixel values   255 for 8-bit grayscale image  . Combining these three relations results in similarity measure the SSIM index between signals x and y which is: SSIM  x, y     2     x  2 x  y   C1  2 xy  C2     y2  C1  x2   y2  C2   (4.52)  The above equations are given for two vectors, i.e. one-dimensional signals only. In the context of image processing, there are more than two vectors to be compared and a single overall quality measure of the entire image is usually required. Therefore, a mean of SSIM index of the corresponding columns of the two images is computed resulting in the mean structural similarity (M-SSIM) index [122] given as:  M-SSIM  X, Y    1 m SSIM  x j , y j  m j 1  (4.53)  where X and Y are the reference (“ideal”) and the processed images respectively, x j and y j are the image contents at the j-th local window, and m is the number of local windows of the image. The SSIM index is a method for measuring the similarity between two images that can be viewed as a quality measure for one of the images being compared if the other image is regarded as the image of desired image quality. It is an improved version of the universal image quality index   129     Multivariate Pre-processing Techniques for GPR Images    proposed earlier [123] in order to improve the image quality assessment in a number of applications by measuring structural distortion of the image. In comparison to MSE or PSNR type measures which are mainly sensitive to the error energy, the SSIM index exhibits higher consistency with subjective quality measurement but avoids using complex human visual system (HVS) based indicators which usually result in a high computational complexity without clear advantage over simple MSE or PSNR type measures.  4.4.2 Simulated Data As the overall aim of this research is to evaluate the potential and applicability of GPR in detecting pipes, leakages from joints, holes and cracks, and cracked concrete, simulations and laboratory measurements have been performed in order to replicate those conditions. However, due to data complexity of metal fibre presence in the cracked concrete mixture slab, the simulated data was not able to be reproduced. Analysis of this data is therefore can not be performed to any further extent. The evaluation of the simulated data has been done in terms of PSNR and M-SSIM index to indicate the performance of the proposed clutter reduction methods. The simulated data has the benefit of controlled the amount of clutter and noise present in the GPR image, thus the “ideal” image of simulated data can be simulated directly or obtained by subtracting the clutter image from the original raw GPR image to be used for the evaluation purposes. The performance of PSNR and M-SSIM index is   130     Multivariate Pre-processing Techniques for GPR Images    calculated by comparing the degraded image to the “ideal”, undistorted image. High values of PSNR and M-SSIM index indicates high similarity between the “ideal” and distorted image thus indicating a possible advantage of the proposed pre-processing technique.  4.4.2.1  Clutter Reduction  Two multivariate techniques – PCA and SVDPICA, have been applied to the simulated GPR images in testing the effectiveness of the proposed methods in reducing the amount of clutter presented in GPR data. Initial results and the entire process in this section illustrated using the image simulated on joints with 1.5 GHz radar frequency. Similar procedure is repeated for other simulated images and results are summarised at the end of the chapter. Figure 4.10 (a) illustrates the eigenspectra of selected GPR data via SVD. The dimensionality reduction has been done by removing the first eigenvector which represents clutter with the highest variance as well as the components with very small variances – claimed to be noise. The selection number of PCs to be used is 30 and the results of clutter reduction approaches are given Figure 4.11. Basic mean removal (MR) technique has also been included to evaluate the performance of the proposed methods. It can be observed that the joint features are well recovered using both techniques, as well as the basic mean removal method. Also, the strong signals from the edge of the box (both sides) can easily be distinguished as   131     Multivariate Pre-processing Techniques for GPR Images    much as the joint signals. Table 4.2 and Table 4.3 summarise the performance of the decluttering techniques of the remaining simulated data of the performed experiments described in Chapter 2.  Clutter  Noise  (a)  (b) Figure 4.10: Plot of eigenvalues against space sample (component number) of simulated GPR data represent joints (a) with PCA via SVD and (b) selected 30 PCs via SVDPICA method.   132     Multivariate Pre-processing Techniques for GPR Images    (a)  (b)  (c)  (d)  (e) Figure 4.11: Results of GPR image decluttering on simulated data represent joints using different techniques (a) original raw image, (b) mean removal, (c) PCA via SVD, (d) SVDPICA and (e) “Ideal” data which is obtained by subtracting the image of concrete from the image of concrete containing joints.   133     Multivariate Pre-processing Techniques for GPR Images    Table 4.2: PSNR and M-SSIM index indicators for described clutter reduction algorithms of simulated data experiment to detect leakages from joints, holes and cracks. Data  Features  PSNR  M-SSIM Index  MR  PCA  SVDPICA  MR  PCA  SVDPICA  1  Joints  70.4701  71.9973  71.8160  0.9992  0.9995  0.9994  2  Holes  74.3522  72.1234  74.4133  0.9997  0.9995  0.9997  3  Crack1  61.8449  62.1144  63.6562  0.9939  0.9942  0.9960  4  Crack2  61.4218  61.6739  62.6750  0.9932  0.9936  0.9950  5  Crack3  61.4232  61.6747  62.4960  0.9932  0.9936  0.9948  6  Crack4  61.2889  61.5340  62.1987  0.9930  0.9934  0.9944  Figure 4.12: Evaluation of clutter reduction methods in terms of PSNR for simulated data to detect leakages from joints, holes and cracks.    134     Multivariate Pre-processing Techniques for GPR Images    Table 4.3: PSNR and M-SSIM index indicators for described clutter reduction algorithms of simulated data experiment to detect pipes. Data  Features  PSNR  M-SSIM Index  MR  PCA  SVDPICA  MR  PCA  SVDPICA  1  Big  78.1583  80.0656  78.4144  0.9999  0.9999  0.9985  2  Medium  70.5832  70.4405  70.7282  0.9992  0.9992  0.9992  3  Small  71.4841  70.7910  80.3945  0.9994  0.9993  0.9999  4  All pipes  73.7019  73.0961  73.2996  0.9996  0.9995  0.9968  Figure 4.13: Evaluation of clutter reduction methods in terms of PSNR for simulated data in detecting pipes.    135     Multivariate Pre-processing Techniques for GPR Images    4.4.2.2  Unwanted Signals Reduction  The proposed unwanted signals reduction methods used 2DPCA and ICA to encounter the problem of unwanted features appears in GPR images. Due to inability of simulation software to generate equivalent set of data, this section only provides results achieved by pre-processing measured datasets.  4.4.3 Measured Data The laboratory experiments have been performed on three different sets of experiments as described in Chapter 2. The types of radar used to perform each experiment are:   pipes detection – GPR GV5;    detection of leakages from joints, holes and cracks – GPR GV5 and GV3 CDH system;    cracks detection on metal fibre mixtures concrete slab – GPR GV5.  The evaluation results for GPR images employed both PSNR and M-SSIM index indicators are summarised in the next sections. In the situations where degraded image can be compared to original, undistorted image, high PSNR value indicates high similarity between the original and distorted image, i.e. low level of noise in the distorted image. However, in reality, this undistorted image is hardly available thus the processed images can only be compared to original, distorted image. Lower PSNR value should therefore indicates “better” algorithm performance as this would imply increase in   136     Multivariate Pre-processing Techniques for GPR Images    RMS difference between the raw and the processed images. However, care should be taken when interpreting the PSNR values of measured GPR data as the large RMS difference between the original and processed images might also imply that some of the important, target related features in the raw image are not very well preserved. For the similarity performance, the “ideal” image is used as a reference to be compared to the processed data. This “ideal” image is obtained from a trained human – GPR image analyst by using ReflexW software. Although some of the steps in ReflexW can actually distort the original image, MSSIM index measure can still be used to assess the validity of automated clutter reduction techniques in comparison to supervised GPR image processing.  4.4.3.1  Clutter Reduction  The same procedures of decluttering methods to simulated data have been applied to evaluate the performance of the proposed methods on experimental measured data. As stated previously, clutter usually dominates the GPR data by having the strongest signal and most of the clutter information is contained in the first eigenvector with the highest variance whilst noise corresponds to the components with very small variances. A dimensionality reduction can therefore be obtained by discarding those components.    137     Multivariate Pre-processing Techniques for GPR Images    Clutter  Noise  (a)  (b) Figure 4.14: Plot of eigenvalues against space sample (component number) of measured GPR data in detecting pipes – big size (a) with PCA via SVD and (b) selected 30 PCs via SVDPICA method.    138     Multivariate Pre-processing Techniques for GPR Images    (a)  (b)  (c)  (d)  (e) Figure 4.15: Results of GPR image decluttering on measured data – big pipe using different techniques (a) original raw image, (b) mean removal, (c) PCA via SVD, (d) SVDPICA and (e) ReflexW software.    139     Multivariate Pre-processing Techniques for GPR Images    Figure 4.15 shows the obtained results of clutter reduction for one measured GPR image – big pipe. Pipe feature is located towards the middle of the image (traces 70 – 90) and although it is well recovered using both proposed techniques, the SVDPICA method depicted in Figure 4.15 (d) removes more clutter from the original image, thus improved the visibility of the pipe related feature compared to the standard PCA method depicted in Figure 4.15 (c). Table 4.4 illustrates the obtained PSNR and M-SSIM index results of clutter reduction methods for pipes detection whilst experiments to detect leakages from joints, holes and cracks are presented in Table 4.5 (GPR GV3) and Table 4.6 (GPR GV5). The evaluation of cracked concrete with metal fibre mixtures experiment is described in Table 4.7. Basic mean removal method has also been included for comparison purposes in assessing these methods.    140     Multivariate Pre-processing Techniques for GPR Images    Table 4.4: PSNR and M-SSIM index indicators for described clutter reduction algorithms of measured data experiment to detect pipes. Data  Features  PSNR  M-SSIM Index  MR  PCA  SVDPICA  MR  PCA  SVDPICA  1  Big  63.0997  63.0092  62.9751  0.9998  0.9998  0.9998  2  Medium  64.0282  64.0084  62.8146  0.9998  0.9998  0.9998  3  Small  64.0399  64.0545  63.5188  0.9999  0.9999  0.9990  4  All pipes  63.8272  63.8189  63.6846  0.9996  0.9995  0.9997  Figure 4.16: Evaluation of clutter reduction methods in terms of PSNR for pipes detection of measured data.    141     Multivariate Pre-processing Techniques for GPR Images    Table 4.5: PSNR and M-SSIM index indicators for described clutter reduction algorithms of measured data experiment to detect leakages from joints, holes and cracks (GPR GV3). Data  Features  PSNR  M-SSIM Index  MR  PCA  SVDPICA  MR  PCA  SVDPICA  1  Joints  66.7388  65.8015  66.2664  0.9981  0.9977  0.9979  2  Holes  68.8345  67.8838  67.5901  0.9997  0.9998  0.9997  3  Crack1  66.6830  63.4232  65.4647  0.9998  0.9990  0.9996  4  Crack2  66.4185  62.3803  62.9419  0.9996  0.9982  0.9984  5  Crack3  64.3476  64.6666  63.0502  0.9996  0.9997  0.9991  6  Crack4  63.0630  66.8946  63.1535  0.9995  0.9987  0.9994  Figure 4.17: Evaluation of clutter reduction methods in terms of PSNR for measured data to detect leakages from joints, holes and cracks (GPR GV3).    142     Multivariate Pre-processing Techniques for GPR Images    Table 4.6: PSNR and M-SSIM index indicators for described clutter reduction methods of measured experiment to detect leakages from joints, holes and cracks (GPR GV5). Data  Features  PSNR  M-SSIM Index  MR  PCA  SVDPICA  MR  PCA  SVDPICA  1  Joints  66.3082  65.2599  65.2255  0.9996  0.9996  0.9997  2  Holes  65.0095  63.9253  61.9706  0.9993  0.9987  0.9969  3  Crack1  64.1771  63.5505  64.1941  0.9994  0.9994  0.9993  4  Crack2  64.3296  64.0813  63.7687  0.9995  0.9995  0.9994  5  Crack3  66.3176  65.9510  66.1146  0.9993  0.9994  0.9994  6  Crack4  61.0167  61.4956  61.0483  0.9995  0.9993  0.9995  Figure 4.18: Evaluation of clutter reduction methods in terms of PSNR for measured data to detect leakages from joints, holes and cracks (GPR GV5).    143     Multivariate Pre-processing Techniques for GPR Images    Table 4.7: PSNR and M-SSIM index indicators for described clutter reduction methods of measured experiment to detect cracked concrete. Data  PSNR  M-SSIM Index  MR  PCA  SVDPICA  MR  PCA  SVDPICA  1  62.6275  63.1238  62.6234  0.9994  0.9998  0.9994  2  62.1551  62.0268  62.1095  0.9997  0.9997  0.9998  3  65.8766  65.8387  65.8512  0.9999  0.9999  0.9998  4  63.7718  63.7623  63.6927  0.9993  0.9993  0.9993  5  62.7176  62.8797  62.6720  0.9996  0.9996  0.9995  6  63.8803  64.0282  63.8532  0.9998  0.9998  0.9998  Figure 4.19: Evaluation of clutter reduction methods in terms of PSNR for measured data to detect cracked concrete.    144     Multivariate Pre-processing Techniques for GPR Images    4.4.3.2  Unwanted Signals Reduction  In the pipes detection experiment, the main feature present in the GPR images involved with an empty container box is the strong signal on the left and right sides indicated with black and white arrows (Figure 4.20) which caused by the reflection of the EM waves from the left and right sides of the box. Both side reflections which are the unwanted signals of the GPR data are the strongest features in the image and as such they heavily obscure the hyperbolas corresponding to plastic pipes to be detected and characterised. The proposed techniques – 2DPCA and ICA are aiming to reduce those features in the image without significantly affecting the content of the remaining image, thus making the hyperbolas related to the pipes in the box more prominent in the final, processed image.  (a)  (b)  Figure 4.20: GPR images with removed mean trace (a) empty box and (b) box with three plastic pipes.    145     Multivariate Pre-processing Techniques for GPR Images    In Figure 4.20, mean trace was calculated and removed from both images before applying to any other processing to reduce the amount of clutter corresponds to the air-wooden panel interface present in both images. Several images were obtained by scanning along the lines before and after the interest line (i.e., the interest line is line 7, thus the scan was made from line 5 – 9) of the measurement grid to be used as input images for both algorithms. Spectrum of eigenvalues obtained after 2DPCA shown in Figure 4.21 (a) indicates the most of the image energy is concentrated in the first 5 – 10 eigenimages.  (a)  (b)  Figure 4.21: (a) Eigenvalues spectrum of PCs obtained using 2DPCA procedure and (b) reconstructed side reflection using 2DPCA eigenimages 1 – 6. The side reflections were removed by adding the first 6 eigenimages to be subtracted from the original image (Figure 4.20 (b)). Cumulative image containing the first 6 eigenimages obtained using 2DPCA decomposition is    146     Multivariate Pre-processing Techniques for GPR Images    depicted in Figure 4.21 (b) whilst Figure 4.22 represents the first 6 independent images, results of ICA un-mixing procedure. The first independent image has been identified to contain most of the unwanted features by visual inspection. This image is therefore subtracted from the original image as in 2DPCA procedure to achieve the same aim – unwanted features reduction (i.e. side reflections) present in the original image and improvement of features corresponding to pipes placed in the box.  Figure 4.22: Independent images obtained using ICA in reconstructing unwanted features (side reflections). Results of the side reflections reduction using both approaches – 2DPCA and ICA are depicted in Figure 4.23. Both techniques can be seen as effective in reducing significant amount of unwanted features from the original image. Hyperbolas caused by the reflections from the largest and   147     Multivariate Pre-processing Techniques for GPR Images    middle size pipes can now be seen more clearly in both images of 2DPCA and ICA. The weakest hyperbola feature indicates the presence of the smallest pipe in box can also be observed.  (a)  (b) Figure 4.23: Unwanted signals (side reflections) reduction results via (a) 2DPCA and (b) ICA algorithms.    148     Multivariate Pre-processing Techniques for GPR Images    The performance of both algorithms for images measured in pipes detection experiment is summarised in Table 4.8. The processed GPR images using both algorithms were compared to the original, raw image in terms of PSNR. The field labelled “difference” in Table 4.8 indicates the PSNR between the raw image and image obtained using direct subtraction (i.e. subtraction of the pipes image to the empty box image). The idea of using the “difference” approach is that the “empty” image which contains only interference features can be subtracted from the measured image to obtain significantly improved GPR image. Although this “technique” can not be applied in practical situations as the interference-only image is never available, the “difference” approach was used in this work to compare and evaluate the other two techniques.  Figure 4.24: The "difference" image is obtained by subtracting the empty box image from the image with three pipes.    149     Multivariate Pre-processing Techniques for GPR Images    Table 4.8: Comparison of proposed algorithms in reducing unwanted signals using PSNR measure of pipes detection experiment. Data  Pipe size  PSNR 2DPCA  ICA  Difference  1  Big  72.7788  69.4238  74.8429  2  Medium  66.4575  68.1856  68.3998  3  Small  67.3531  68.5401  68.3570  4  All three  64.8607  68.9848  66.0883  Figure 4.25: Evaluation results of unwanted signals reduction techniques for pipes detection of measured data.    150     Multivariate Pre-processing Techniques for GPR Images    4.5 Conclusion Four groups of multivariate techniques to improve the quality of raw GPR images in reducing the amount of clutter and unwanted signals have been described and evaluated in this work using simulated and measured GPR images. The proposed techniques to be used at the pre-processing stage is aim to improve GPR image quality and enable easier detection and characterisation features (i.e. pipes and leakage from joints, holes and cracks) in the final stage of this work. GPR measurements obtained in those conditions suffer from the presence of noise and clutter as well as the unwanted signals. The proposed signal processing techniques represent an effective way of solving these problems. Clutter reduction algorithms (PCA and SVDPICA) and unwanted signals reduction algorithms (2DPCA and ICA) have been used, and the obtained results demonstrate the effectiveness of each approach. The proposed clutter reduction algorithms show improvements in reducing the amount of clutter and noise presented in the simulated GPR data. Although these amounts are controlled during the simulations, the obtained results demonstrate that these techniques can enhance the GPR data more than the basic mean removal method for further processing. Despite the benefits of being able to generate “ideal” data which is clutterand-noise-free image that can be used as a reference in the evaluation of GPR data performance, the simulated data has its drawback; it produces the   151     Multivariate Pre-processing Techniques for GPR Images    same GPR scans when it is run with the same condition settings. This differs from the measured data because GPR scans in one condition can produce different images each time a scan is made. For this reason, it is difficult to use experimentally simulated data to evaluate algorithms developed to reduce unwanted signals e.g. 2DPCA and ICA. The measured data have been processed using the clutter reduction algorithms as well as the unwanted signals reduction techniques. The index numbers of PSNR and M-SSIM of the proposed clutter reduction algorithms indicate the potentials of these techniques to reduce the amount of clutter and noise presented in the GPR data. The obtained results suggest that the automated use of both algorithms to pre-process GPR images in order to detect and characterise features of interest in those images is possible. The “difference” method used in the unwanted signals reduction performs just as well, if not better than the proposed techniques – 2DPCA and ICA.    152          Chapter 5  	  Evaluation of Developed Preprocessing Techniques and Characterisation of Targets using Signal Modelling Overview The proposed clutter reduction techniques described in Chapter 4 require further analysis to evaluate its performance. This chapter introduces signal modelling techniques – Extended Prony (EP), Linear Prediction Singular Value Decomposition (LPSVD) and Matrix Pencil (MP), and subspace method – PCA as an alternative way of evaluating the performance of developed  pre-processing  techniques  as  well  as  for  the  target  characterisation and classification tasks. Singular Entropy method is described and proposed to be used with MP approach to estimate the model order. 153     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    5.1 Introduction The pre-processing techniques investigated in Chapter 4 indicate possibilities in reducing the clutter and unwanted signals present in the data in order to aid target detection. Although those techniques seem to have a potential to improve target detection, the additional problem of the identification of subsurface targets is a more difficult and as yet unsolved task. On the other hand, there is also a need to further evaluate clutter reduction methods developed and implemented in Chapter 4. In this part, methods to extract resonant frequencies are used and combined with subspace methods described in the previous chapter to both develop an alternative way of evaluating the performance of pre-processing techniques and investigate the use of similar techniques for the target characterisation and classification tasks. In summary, the objective of the methods used in this chapter is to extract information from the signal that can help to characterise the physical/natural properties of the subsurface rather than just help the user to “see something in a radargram”. In this chapter three candidate methods to estimate resonant poles from individual GPR traces are first presented. Those methods include Extended Prony (EP) [124], [125], Linear Prediction combined with Singular Value Decomposition (LPSVD) [29], [126], and Matrix Pencil (MP) [127], [128] algorithms. Those methods are first tested using synthetic signal and the   154     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    influence of noise on their performance examined. MP method shows the most robust performance and was used in the rest of the chapter to analyse both the simulated and measured GPR data. Important problem of correct model order estimation for simulated and measured signal has also been addressed in this chapter and the method using Differential Singular Entropy proposed as a suitable technique to most accurately estimate the model order, i.e. the number of resonant poles present in the signal.  5.2 Techniques 5.2.1 Prony Analysis Prony Analysis [31], [129], [130], [131] is a method of fitting a linear combination of exponential terms to observed, damped oscillatory signal  y  n  . If such signal is represented by P complex exponentials, its estimate can be given with: P    i n 1 T  i yˆ  n    Ak e  k k   k  n  1, 2, , N  (5.1)  k 1  Each of P terms, also known as the modes of the original signal y  n  , is defined with four elements: the magnitude Ak , the damping  k , the angular frequency k and the initial phase k . It can be useful to recast the above equation in a slightly different form: P  yˆ  n    hk z kn 1  (5.2)  k 1    155     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    where hk  Ak e i k  (5.3)  is a complex amplitude representing a time-independent parameter and  zk  e  k ik T  (5.4)  is a complex exponent that represents time-dependent parameter. Those complex exponents are usually referred to as signal poles. The problem of estimating two sets of parameters hk and zk is based on the minimisation of the squared error over N samples of the observed signal  y  n : N  N  N  P  n 1  k 1     e  n    y  n   yˆ  n    y  n    h z 2  n 1  2  n 1  2  n 1 k k  (5.5)  This is a difficult non-linear problem and can be solved using Prony method which utilises linear equations solution. Since the observed signal y  n  is fitted to a given exponential model, i.e. P  y  n    hk z kn 1  (5.6)  k 1  the above equation can be written for 1  n  P in the matrix form:   z10  1  z1    P 1  z1  z20 z12   ... ...   z2P 1  ...    h1   y 1        h2    y  2             zPP 1   hP   y  P   zP0 z1P   (5.7)    156     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    From the above equation, the complex amplitude hk can be obtained providing zk ’s are known. Prony method provides a way to determine zk ’s without having to resort to non-linear minimisation. This method proposed to define polynomial A  z  which has zk ’s as its roots: P  P  k 1  m 0  A  z     z  zk    a  m  z P m  (5.8)  Shifting the index in (5.6) from n to n – m and multiplying by the parameter a  m yields: P  a  m  y  n  m   a  m   hk z kn  m 1  (5.9)  k 1  Equation (5.9) can be further modified by summing from m = 0 to m = P to: P  P  P  m 0  k 1  m 0   a  m  y  n  m    hk zkn  P  a  m  hk zkP  m 1  0  (5.10)  This is a forward linear prediction equation which can be expressed in matrix form as:   y  P   y  P  1     y  2 P  1  y  P  1 y  P  y  2P  2   y  P  1  ... y 1   a 1      ... y  2    a  2   y  P  2               ... y  P    a  P    y  2 P    (5.11)  Thus, the a  m  coefficient can be determined using Prony method which decouples the problem of determining hk and zk parameters. The entire procedure is usually split into three steps:    157     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    1. solve (5.11) to determine coefficient a  m where m  1, 2, , P ; 2. determine the complex exponents, roots zk of polynomial A  z  defined in (5.8). At this point, damping and frequency of each mode can be determined from (5.4) as:   k  Re  log  z k      1  T  (5.12)     1  T  (5.13)   k  Im  log  z k   3. determine complex amplitude hk from (5.7) and use (5.3) to find amplitude Ak and initial phase k as:  Ak  hk    k  Im  ln   (5.14) hk hk      (5.15)  5.2.2 Extended Prony Method It is clear that the method proposed by Prony reduces the non-linear fitting problem to two numerical tasks of solving linear systems of equations (step 1) and finding the roots of polynomial (step 2). The length of data record should and usually does exceed the number of data points needed to fit a model, i.e. N > 2P. In practical situations N should be at least three times larger than the model order P. In this case, matrix form of linear prediction equation (5.11) is modified to:   158     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling     y  P   y  P  1     y  N  1  y  P  1 y  P  y  N  2   y  P  1  ... y 1   a 1      ... y  2   a  2  y  P  2   (5.16)             ... y  N  P    a  P    y  N    This equation can be written in the condensed, matrix form: Ya   y  (5.17)  and solved in the least-squares (LS) sense:  a    YH Y YH y 1  (5.18)  This method is known as “least-squares Prony method” or “extended Prony method”.  5.2.3 Linear Prediction Singular Value Decomposition (Kumaresan-Tufts) Method One of the problems Prony method faces are large variance and bias when analysing noisy signals [29], [129], [132]. Influence of noise can be reduced by setting the number of exponential components to be estimated to L, where L > P. Using SVD, the matrix Y from equation (5.17) can be written as: Y  UΣV H  (5.19)  where Σ is a  N  L   L matrix with the singular values on the diagonal arranged in decreasing order. Noise can be reduced by considering the reduced rank approximation   159     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    ˆ  UΣV ˆ H Y  (5.20)  with  ˆ  ΣP Σ 0   0 0  N  LL  (5.21)  where Σ P is the top-left P  P minor of Σ . An estimate for the coefficients  a  m is then: aˆ  Y† y  (5.22)  where Y† is the pseudo-inverse of Ŷ . The use of truncated SVD improves the SNR, providing a better estimate of the vector â and consequently of the exponential parameters. This approach is known as Kumaresan-Tufts (KT) algorithm [35] but is sometimes also referred to as Linear Prediction Singular Value Decomposition (LPSVD).  5.2.4 Matrix Pencil Method Another method to estimate exponential parameters from noisy signals is Matrix Pencil (MP) method [33], [127]. It is generally more robust than LPSVD by having a lower variance on the estimated parameters with a slightly larger bias. The MP starts with the application of SVD to data matrix Y, where Y is in the form of:    160     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling     y 0  y 1 Y     y  N  L  1  y 1 y  2  y  N  L  y  L     y  L  1       y  N  1   (5.23)  N  L  N  L   Here L denotes the pencil parameter that plays the role of the prediction order parameter in the LPSVD/KT method where P  L  N  P , and is usually  N 2N L . Noise can be reduced by considering the reduced rank 3 3  approximation Y  UΣV T  (5.24)  by taking the first P singular values. Two matrices Y0 and Y1 can be obtained from equation (5.24) by eliminating the last and first row of V  and are defined as:   y  0  y 1 Y0       y  N  L  1  y 1  y  2 Y1       y  N  L   y 1 y  2  y  N  L y  2 y  3   y  N  L  1  y  L  1   y  L  ;     ... y  N  2   ... ...  y  L   ... y  L  1      ... y  N  1  ...  (5.25)  Matrices Y0 and Y1 can now be decomposed as: Y0  Zl HZ r  (5.26)  Y1  Zl HZZ r  (5.27)    161     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    where   1  z Zl   1    N  L 1  z1 1 z1  1 z2 Zr      1 z P  1 z2   ... ...   z2N  L 1  ...    ;   z PN  L 1  1 zP   z1L 1   ... z2L 1      ... z PL 1  ...  (5.28)  H  diag  h1 , h2 ,, hP   (5.29)  Z  diag  z1 , z2 ,, zP   (5.30)  Matrix Pencil Y1  zY0 can be rewritten using decomposition of two matrices as:  Y1  zY0  Zl H  Z  zI p  Z r  (5.31)  When z  zi , the matrix Z  zI p is of rank P. However, for z  zi it is of rank P – 1. Therefore, the poles of the signal reduce the rank of the MP for  P  L  N  P . This is equivalent to saying that the poles z i are the generalised eigenvalues of  Y1 , Y0  , in the sense that  Y1  zY0  v  0 , with v is the eigenvector of Y1  zY0 . To find the poles z i , one can use the fact that Y0† Y1 has P eigenvalues equal to the poles z i and L – P null eigenvalues. Here Y0† denotes a pseudo-inverse (Moore-Penrose) of Y0 .    162     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    In practice, it is impossible to have access to noise-less signal and work directly with the noisy data requires the use of SVD to select singular values of the signal. The basic steps of the MP method can be summarised as follows: 1. build the matrices Y0 and Y1 as in (5.25); 2. perform SVD of Y1 , i.e. Y1  UΣV T ; 3. estimate the signal subspace of Y1 by considering the P largest   U Σ V H , where U and V are built singular values of Σ : Y P P 1 P P P  from the first P columns of U P and VP , and Σ P is the top-left P  P minor of Σ ;  4. the matrix Z L  Y1† Y0  VP Σ P1UTP Y0 has P eigenvalues which provide estimates of the inverse poles 1 zi ; the other L – P eigenvalues are zero. Since Z L has only P non-zero eigenvalues, it is  convenient  to  restrict  attention  to  a  P P  matrix  Z P  Σ P1UTP Y0 VP .  The MP technique exploits the MP structure of the underlying signal, rather than the prediction equations satisfied by it. Nevertheless, there are strong similarities between the MP and LPSVD techniques.    163     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    5.3 Results Methods discussed in the second part of this chapter have been applied to a number of signals in the rest of this section. First, a simple signal containing low number of poles has been simulated and the performance of all three algorithms in the analysis of this signal containing various levels of noise assessed. Most accurate algorithm is selected and used further in the analysis of real and simulated GPR data. Results are presented in the following sections.  5.3.1 Synthesised Signals Simple synthesised signal has been used to assess the performance of all three signal modelling algorithms contained three resonant modes. All three modes are stable, i.e. three related damping coefficients are positive. Complete set of parameters used to generate those signals is given in the first row of Table 5.1. Sampling frequency used in this simulation is 100 Hz and various levels of noise are added to the simulated signal in order to investigate sensitivity to noise of each of proposed algorithms. For the purpose of this study, it is assumed that the correct model order is known. Since the complex signal poles always come in complexconjugate pairs, L  6 is used as the model order for each run of analysis algorithms in order to extract three poles present in the signal. Obtained results for all three cases are summarised in Table 5.1.   164     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    First section of this table represents results achieved with each of the algorithms applied on noise-free signal (SNR = ∞). Each of applied algorithms was able to recover the original parameters of the simulated, noise-free signal with perfect accuracy. For relatively low amount of noise present in the signal (SNR = 80 dB), both LPSVD and MP algorithms were able to estimate correct signal parameters whilst the EP method introduced small errors in the estimated set of parameters. For a very noisy signal (SNR = 10 dB), EP was unable to recover any of the signal parameters correctly. Both LPSVD and MP algorithms performed well although MP method results in slightly more accurate values. For this reason, only MP algorithm is used to analyse measured GPR signals in the next section of the thesis. It is worth noting that the EP algorithm was unable to recover any of the original parameters correctly during the application of the analysis of noisy signals with the exact model order = 6, even for a very low levels of noise present in the signal (SNR = 80 dB). As the model order is increased to 20, the same number of different frequencies present in the signal is obtained upon the application of the EP algorithm. However, most of the amplitudes related to the estimated frequencies were insignificant and therefore have been discarded from the obtained results set. This procedure left only three relevant amplitudes and damping factors in the final set.    165     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    Table 5.1: Performance of three signal modelling algorithms using simulated signals with different SNRs. Frequency (Hz) Original Signal  2.0  3.0  4.0  Amplitude 0.6  0.5  Damping 0.3  0.1  Phase (rad)  0.2  0.05  0.6283 1.0472 0.1234  SNR = ∞ (noise-free signal) EP  2.0  3.0  4.0  0.6  0.5  0.3  0.1  0.2  0.05  0.6283 1.0472 0.1234  LPSVD  2.0  3.0  4.0  0.6  0.5  0.3  0.1  0.2  0.05  0.6283 1.0472 0.1234  MP  2.0  3.0  4.0  0.6  0.5  0.3  0.1  0.2  0.05  0.6283 1.0472 0.1234  SNR = 80 dB EP  2.0001 3.0005 4.0001 0.6027 0.5084 0.3008 0.1018 0.2086 0.0512 0.6261 1.0413 0.1236  LPSVD  2.0  3.0  4.0  0.6  0.5  0.3  0.1  0.2  0.05  0.6283 1.0472 0.1234  MP  2.0  3.0  4.0  0.6  0.5  0.3  0.1  0.2  0.05  0.6283 1.0472 0.1234  SNR = 10 dB EP  2.8  26.18  43.05  2.36  0.51  0.87  7.15  30.014 42.594  LPSVD  1.998  2.996  4.077  0.6383 0.5632 0.3518 0.1288  0.253  MP  1.999  2.997  4.006  0.5996 0.5222 0.3326 0.1026  0.2  0.728  1.6561 2.6406  0.0943 0.6614 1.1161 0.0438 0.05  0.6283 1.0472 0.1234    166     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    The values given in Table 5.1 of EP algorithm are well related to the initial parameters of the simulated signal. The signal has been successfully analysed using this “thresholding” approach and noise-free version of the signal reconstructed. Same procedure is applied in the analysis of signal with high noise level (SNR = 10 dB) but, unlike in the SNR = 80 dB case, the obtained results were not correct as indicated in Table 5.1.  (a)  (b)  (c)  (d)  Figure 5.1: Performance of studied algorithms for SNR = 10 dB case, (a) original signal, (b), (c) and (d) reconstructed signals and residual using (b) EP, (c) LPSVD and (d) MP.    167     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    Simulated signal containing high level of noise (SNR = 10 dB) as well as the signals reconstructed using estimated parameter sets and corresponding residual errors are shown in Figure 5.1. Powers of residual signals shown on plots (b), (c) and (d) are 0.1639 (EP), 0.0013 (LPSVD) and 0.000537 (MP) indicate poor performance of EP algorithm and its sensitivity to noise and somewhat superior performance of MP algorithm.  5.3.2 GPR Signals and Model Order Estimation 5.3.2.1  Model Order Estimation Problem  In this section, a number of simulated and measured GPR traces are analysed using MP method. Unlike the analysis process described in the previous section where the model order of simulated signal is known a priori, for most real signals, measured on the grid, model order is unknown although experienced user may have some idea of the expected model order. If the selected order is too low, some modes will not be estimated, whilst too high order specified for the analysis introduces extra components that are not present in the original signal. Therefore, model order selection is a trade-off between increased resolution and decreased variance in the estimated spectrum. There are several methods and criteria to estimate model order described in literature although guidelines on the usage of some of those criteria in practical situations are rather limited. Some of better known criteria    168     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    investigated in recent decades include Akaike Information Criterion [133] and Minimum Descriptive Length [134] but both of those criteria are known to perform poorly for closely spaced modes [133]. In this work, two simple approaches for model order estimation recommended in the literature have been used and investigated. Power of the residue signal – error between the produced model and the measured signal can be estimated for various model orders and the order resulting in minimum residue power adopted. Singular Entropy (SE) approach is another method used to estimate the optimal model order in this study. As an additional check, Fast Fourier Transform (FFT) based analysis is performed and the obtained power spectrum of the measured signal is compared to the signal estimated using adopted model order. Singular Entropy (SE) approach [135] starts by performing SVD of Hankel matrix in the form of:   y 1  y  2 Y     y  N  L   y  2 y  3  y  N  L  1  y  L  1    y  L  2      y  N     (5.32)  Here, L represents the MP parameter usually chosen to be L  N 4  N 3 and y  n  is the measured signal where n  1, 2, , N . SVD of matrix Y results in three new matrices such that Y  UΣV T  (5.33)    169     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    Matrix Σ is a diagonal matrix containing singular values  ii  i  1, 2,, m where m  min  N  L, L  1 , whilst U and V contain left and right eigenvectors of Y respectively. A Singular Entropy Increment (SEI) is now defined as:    Ei    m ii     jj  j 1       log  m ii       jj   j 1         i  1, 2,..., m  (5.34)  and k-th order Differential of Singular Entropy Increment (DSEI) is:  Ek'   Ek  Ek 1  Ek  Ek 1 k   k  1  k  2,3,..., m  (5.35)  When the effective signal saturates, the SEI converges to a bounded value rapidly and there is an inflection point which corresponds to the signal modal order. After that point, the SEI is small, which can be considered as the effect of noise. Due to this property of SEI, no matter how much the noise is, the increment of Singular Entropy will converge to a bounded value with a noticeable jump when the information of effective signal tends to saturation. With the help of DSEI, it is easy to extract the order of the corresponded inflection point, namely, the model order L. To illustrate this approach, Figure 5.2 shows the SEI and DSEI for simulated signal analysed in the previous section. After the turning point at L = 6 which the SEI is approximately zero, accurately indicates the model order of the simulated   170     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    noisy signal. Since the extracted complex poles always appear in complex conjugate pairs, turning at L = 6 indicates the presence of three modes and therefore three frequency, amplitude, damping and phase sets extracted and shown in Table 5.1.  (a)  (b)  Figure 5.2: (a) Singular Entropy Increment and (b) Differential of Singular Entropy Increment characteristics for simulated signal (SNR = 10 dB) depicting correct signal model order at L = 6.  5.3.2.2  Analysis of Measured GPR Signals  In this section, analysis of GPR images obtained in the experiment involving measurement pipes, described in Chapter 2 is presented. To evaluate the effects of processing techniques described in Chapter 4, same trace is extracted from the image processed in 4 different ways and analysed using MP algorithm. Initial results and the entire process in this section illustrated using the image of big pipe only. Similar procedure is repeated for other measured images and results summarised at the end of the chapter.   171     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    (a)  (b)  (c)  (d)  Figure 5.3: Big pipe image after pre-processing via (a) mean removal, (b) 2DPCA, (c) ICA and (d) difference techniques. The white line in (a) represents the position of analysed trace – column 83. Figure 5.3 shows the pre-processed measured image of big pipe with the application of unwanted signals reduction techniques. Image with only mean removal applied to it (i.e., closest to “raw” image) as well as images after 2DPCA and ICA techniques are depicted in Figure 5.3 (a), (b) and (c) respectively whilst Figure 5.3 (d) contains the “difference” image obtained by subtracting the big pipe image to the empty box image. Careful aligning   172     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    of two images is attempted using correlation method to align these two images before subtraction and improve the obtained “difference” result. In this way, removal of most of the side reflections is attempted. Although this approach could not be attempted on the images obtained in practical GPR surveys, as the “empty” image is usually not available, this result is used in this study as an “ideal” image against which the results of other processing techniques are compared as explained in Chapter 4. Position of analysed trace (column 83 in image matrix) is also indicated in Figure 5.3 (a).  (a)  (b)  (c)  (d)  Figure 5.4: Extracted GPR traces of pre-processed data via (a) mean removal, (b) 2DPCA, (c) ICA and (d) difference techniques.   173     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    (a)  (b)  Figure 5.5: (a) SEI and (b) DSEI for each of extracted traces.   174     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    Figure 5.4 illustrates the traces extracted from each image shown in Figure 5.3. The model order estimation using Singular Entropy approach is depicted in Figure 5.5 and columns (a) and (b) show the SEI and DSEI characteristics for each trace respectively.  Figure 5.6 and Figure 5.7 illustrate the results of MP analysis on the first trace, extracted from the image shown in Figure 5.3 (a) for the models of different orders. The original and estimated signal is depicted in Figure 5.6 whilst columns (a) and (b) of Figure 5.7 show the frequency and amplitude of the extracted poles and damping of each of those poles. FFT has also been performed on this signal to verify the results of MP analysis and result plotted over the frequency-amplitude characteristic shown in column (a) of Figure 5.7 indicates level of agreement between these two methods. Model orders L = 12, 16, 20, 22 and 26 correspond to the last five prominent peaks on DSEI characteristics from column (b) of Figure 5.5 have been used to perform this analysis. Column (b) of Figure 5.7 indicates the amount of damping corresponds to each extracted complex pole, i.e. frequency present in the analysed trace. It is interesting to note the small amount of negative damping in the lower end of the frequency spectrum. This is obviously incorrect but is due to either noise present in the signal or the length of the analysed signal which indicates the penetration depth of the radar. This parameter, as explained in Chapter 2 can be set before the GPR    175     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    survey and it would be good to increase this setting in future experiments in order to remove this artefact.  (a) L = 12  (b) L = 16  (c) L = 20  (d) L = 22  (e) L = 26 Figure 5.6: The signal reconstructions using selected model order of a single trace.    176     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling   -3  300 MP FFT  x 10  10 200  Damping  Relative Amplitude  250  L = 12  15  150 100  5 0  50 0 0  0.1  0.2 0.3 f (Hz)  0.4  -5 0  0.5 +10  x 2.56e  0.05  0.1 f (Hz)  0.15  0.2  0.05  0.1 f (Hz)  0.15  0.2  0.05  0.1 f (Hz)  0.15  0.2 +10   0.05  0.1 f (Hz)  0.15  0.2 +10   0.05  0.1 f (Hz)  0.15  0.2 +10   +10   x 2.56e  -3  800  20  400  200  0 0  0.1  0.2 0.3 f (Hz)  0.4  0.03 Damping  Relative Amplitude  0.04  600 400  0.1  0.2 0.3 f (Hz)  0.4  0 0  0.5 +10  x 2.56e  Damping  Relative Amplitude  0.03  1500  1000  500  0.1  0.2 0.3 f (Hz)  0.4  0.01  -0.01 0  0.5 +10  x 2.56e  x 2.56e  0.05 MP FFT  2000  0.04 Damping  Relative Amplitude  0.02  0  2500  1500 1000 500 0 0  x 2.56e  0.04 MP FFT  L = 26  0.02  0.01  200  0 0  +10   x 2.56e  MP FFT  2000  L = 22  5  -5 0  0.5 +10  x 2.56e  800  0 0  10  0  1000  L = 20  x 10  15  600 Damping  L = 16  Relative Amplitude  MP FFT  0.03 0.02 0.01 0  0.1  0.2 0.3 f (Hz)  (a)  0.4  0.5 +10  x 2.56e  -0.01 0  x 2.56e  (b)  Figure 5.7: Results of Matrix Pencil on a single trace.   177     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    To further evaluate the quality of the obtained results, residual signal, i.e. error between the measured and estimated signal is also considered. Figure 5.8 shows the power of the modelling error and the maximal amplitude of the residual signal for different model orders. It can be observed that increasing the model orders to values significantly higher than 20 contribute very little to further reduction of residual power and maximal amplitude. This finding is therefore in a good agreement with the Singular Entropy approach. Further in the analysis of the results and application of MP algorithm, combination of those two methods was used to determine the correct model order. Residual is used to estimate the approximate model order, with the ability of Singular Entropy model to depict the exact model order to be more accurate by detecting the peaks in the DSEI characteristics.  (a)  (b)  Figure 5.8: (a) Power and (b) maximal amplitude of the residual signal for different model orders L.    178     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    Results of MP analysis for images measured with big pipe are illustrated in the first row of Figure 5.9. Second and third rows of the same figure represent similar results obtained from the MP analysis of images captured with medium and small pipes. Columns (a) and (b) represent the frequencyamplitude and frequency-damping characteristics. It can be observed that both methods developed and tested in Chapter 4 (2DPCA and ICA techniques) aimed at reducing the side reflections related clutter can achieve appreciable reduction of this clutter compared to raw image with only a simple mean removal applied to it. Similarity between two processed traces and the corresponding trace from the difference image is higher for the big pipe case (first row of Figure 5.9) compared to both medium and small pipes traces. Effects of the application of those techniques on frequency-damping characteristic are not so pronounced but are visible. This is expected as the damping is more related to the property of the materials of both target and scatterers which did not change in this experiment.    179     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    Big pipe raw 2DPCA ICA diff  800 600 400  raw 2DPCA ICA diff  0.03  Damping  Relative Amplitude  1000  0.02  0.01 200 0 0  0.05  0.1 0.15 f (Hz)  0.2  0 0  0.25 +10  x 2.56e  0.05  0.1 0.15 f (Hz)  0.2  0.25  x 2.56e+10   Medium pipe 600 Relative Amplitude  400 300 200  0.02 0.01 0  100 0 0  raw 2DPCA ICA diff  0.03  Damping  raw 2DPCA ICA diff  500  0.05  0.1 0.15 f (Hz)  0.2  -0.01  0.25 +10  x 2.56e  0.05  0.1  0.15 f (Hz)  0.2  0.25  x 2.56e+10   Small pipe 0.08 raw 2DPCA ICA diff  1000  500  raw 2DPCA ICA diff  0.06 Damping  Relative Amplitude  1500  0.04 0.02 0  0 0  0.05  0.1 0.15 f (Hz)  (a)  0.2  0.25  x 2.56e+10  0  0.05  0.1 0.15 f (Hz)  0.2  0.25  x 2.56e+10   (b)  Figure 5.9: Comparative results of MP analysis obtained for a single pipe in the box (a) frequency-amplitude and (b) frequency-damping characteristics.    180     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    Similar analysis is applied to images shown in Figure 5.10 obtained with all three pipes in the box. Frequency-amplitude and frequency-damping characteristics for traces correspond to the middle of big, medium and small pipes are depicted in Figure 5.11.  (a)  (b)  (c)  (d)  Figure 5.10: Image of all three pipes in the box after pre-processing via (a) mean removal, (b) 2DPCA, (c) ICA and (d) difference techniques. The white lines in (a) represent the positions of analysed traces – column 25, 83 and 138.    181     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    Big pipe 0.05 raw 2DPCA ICA diff  100  raw 2DPCA ICA diff  0.04 Damping  Relative Amplitude  150  50  0.03 0.02 0.01 0  0 0  0.05  0.1 0.15 f (Hz)  0.2  -0.01 0  0.25 +10  0.05  x 2.56e  0.1 0.15 f (Hz)  0.2  0.25  x 2.56e+10   Medium pipe 0.05 raw 2DPCA ICA diff  150  raw 2DPCA ICA diff  0.04 Damping  Relative Amplitude  200  100  0.03 0.02 0.01  50 0 0 0  0.05  0.1 0.15 f (Hz)  0.2  -0.01 0  0.25 +10  x 2.56e  0.05  0.1 0.15 f (Hz)  0.2  0.25  x 2.56e+10   Small pipe 0.04 raw 2DPCA ICA diff  150  100  0.02 0.01  50  0 0  raw 2DPCA ICA diff  0.03 Damping  Relative Amplitude  200  0  0.05  0.1 0.15 f (Hz)  0.2  0.25 +10  x 2.56e  -0.01 0  0.05  (a)  0.1 0.15 f (Hz)  0.2  0.25  x 2.56e+10   (b)  Figure 5.11: Comparative results of MP analysis obtained for all three pipes in  the  box  (a)  frequency-amplitude  and  (b)  frequency-damping  characteristics (for traces 25, 83 and 138 from Figure 5.10).   182     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    Here, due to the excessively large amount of side reflections present in the traces close to the edges of the box (i.e. big and small pipes), the effects of pre-processing are not as pronounced as in the single image pipe case illustrated before. The trace further away from the edges of the box and less affected by the side reflections clutter (i.e. middle pipe) however exhibits similar behaviour to the one noticed earlier in the case of pre-processing on the single pipe trace, i.e. the frequency-amplitude characteristic of the applied pre-processing techniques is similar to the one obtained on the analysed trace extracted from the difference image.  5.3.3 Towards Target Characterisation – Analysis of GPRMax Simulated Signals In the previous section, MP method has been applied to measured raw and pre-processed images in order to assess the performance of pre-processing algorithms proposed and developed in this work. Although results and clutter reduction achieved with those algorithms have been illustrated, another important task in development of signal processing algorithms for GPR technology is feature extraction for subsequent target characterisation and recognition. This section indicates the potential of using signal modelling and super-resolution techniques discussed in this chapter for those tasks.    183     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    For the initial assessment of suitability of those techniques, simulated rather than measured data has been employed and analysed in this section. GPR images correspond to the experiment in leakages detection from joints, holes and cracks discussed in Chapter 2 were used and analysed using MP algorithm, following the same procedure outlined in the previous section. Availability of clutter-free, simulated data makes it easy to assess the potential of the proposed analysis algorithm before it is applied to measured data, which, as it has been indicated in the previous chapter contained excessively of noise and clutter, thus making it impossible to properly assess the suitability of those algorithms for target characterisation tasks. DSEI characteristics have been generated for each extracted trace before the application of MP algorithm to estimate the model order to be used in the MP analysis. It is interesting to note that the indicated model orders are very similar in value (8 – 12 in most of the cases) which denotes how the presence of clutter increases the complexity of the model to be used for data analysis. Due to the absence of any noise or clutter, analysis of multiple traces corresponds to the same target resulted in almost identical results. For clarity purposes, only the most representative results have been selected and presented in this section. Images with indicated extracted traces are shown in Figure 5.12. The extracted traces correspond to the three main features to be detected in the concrete slab survey via GPR – joint amongst the concrete slab, hole at the   184     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    joint position and cracks in the slab. In addition to that, an extra trace corresponds to a scan along the healthy part of the concrete slab has also been used in the analysis. From the results shown in Figure 5.13, it can be seen that the model orders used in the MP analysis are relatively low, L = 10 is used for modelling cracks whilst L = 12 model order is used to model healthy concrete and joints including the hole at the joint position.  (a)  (b)  (c)  (d)  Figure 5.12: Simulated GPRMax images with indicated traces (white lines) used in further analysis (a) joint, (b) crack, (c) crack and healthy concrete and (d) hole at the joint position.    185     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling   0.03 Joint Crack 1 Crack 2 Hole Concrete  150  100  Joint Crack 1 Crack 2 Hole Concrete  0.025 Damping  Relative Amplitude  200  0.02 0.015 0.01  50 0.005 0 0  0.02  0.04 f (Hz)  0.06  0.08  +11  x 2.83e  0 0  (a)  0.02  0.04 f (Hz)  0.06  0.08  x 2.83e+11  (b)  Figure 5.13: Comparative results of MP analysis obtained from simulated images containing various targets in concrete slab (a) frequency-amplitude and (b) frequency-damping characteristics. The reason for the investigation of signal modelling techniques and the subsequent adoption of MP algorithm is now apparent. Although the frequency-amplitude characteristic reveals little about the features analysed in this study, frequency-damping characteristic for each feature is more significant. Each group of analysed traces – joints (including hole at the joint position), cracks, and healthy concrete can be easily distinguished from the corresponding frequency-damping characteristic. Difference between healthy joint and joint containing hole is also encouraging indicate the potential of both GPR technology on its own as well as the proposed signal processing methods in the construction industry.    186     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    5.3.4 Target Characterisation using Principal Component Analysis on Simulated Data Analysis of GPR traces using MP technique with the aim of extracting resonant poles and dominant frequencies, amplitudes and damping coefficients has been performed in the previous part of this chapter. Results indicate possibility in characterising different targets using the extracted MP parameters. Another approach of using PCA in evaluating the performance and results of pre-processing algorithms and characterising GPR traces of interest is tested in this section. The procedure of PCA in analysing GPR traces for target characterisation is described as follow: 1. single or a group of successive GPR traces are first extracted from GPR images and stored into data matrix X; 2. PCs of the stored traces are obtained via SVD of data matrix X and most of the PCs discarded whilst the most significant ones retained; 3. the extracted traces are then projected back on those PCs. In this way, the dimensionality of the extracted traces is reduced and each trace is represented with a small number of coordinates where number of coordinates correspond to the number of retained PCs. Distance between those points is calculated to establish possible group membership of each trace. Points correspond to each trace are plotted in 2D and 3D cases to visualise their positions in the new (feature) space.   187     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    The extracted traces correspond to joints, holes and cracks in leakages detection experiment are depicted in Table 5.2. Mean removal method was applied to the corresponding images before the extraction of those traces. From the obtained results of PCA based on dimensionality reduction illustrated in Figure 5.14, the cracks can be clustered easily. However, this is differ to joints which the positions are slightly more scattered in the diagram, that is mostly due to the significant differences in size of the simulated joints (i.e. Joint 2 = 25 mm and Joint 3 = 12 mm). As expected, holes performed similar to joints since they were placed at the same position as the joints and scattered away from their cluster. Table 5.3 described the calculated distance between points correspond to each extracted trace for the case of two retained PCs. Table 5.2: Extracted traces of GPR simulated data on different target types. Features GPR trace  Joint 1  Extracted signals  58 – 62    188     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    Joint 2  117 – 121  Joint 3  177 – 181  Joint 4  58 – 62  Hole 1  117 – 121  Hole 2  177 – 181    189     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    Crack 1  62 – 66  Crack 2  75 – 79  Crack 3  74 – 78  Crack 4  104 – 108    190     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    (a)  (b) Figure 5.14: PCs represent different target types on simulated data in (a) two-dimensional and (b) three-dimensional.    191     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    Table 5.3: Calculated distance of each target depicted in Figure 5.14 (a). Joint 1  Joint 2  Joint 3  Joint 4  Hole 1  Hole 2  Crack 1  Crack 2  Crack 3  Crack 4  Joint 1  0  113.6  30.2  4.2  134.4  51.1  95.7  106.5  106.3  103.7  Joint 2  113.6  0  84.2  117.0  23.8  81.1  128.5  127.5  127.1  126.6  Joint 3  30.2  84.2  0  34.1  104.5  28.2  98.9  106.8  106.5  104.3  Joint 4  4.2  117.0  34.1  0  138.1  55.2  94.4  105.5  105.3  102.7  Hole 1  134.4  23.8  104.5  138.1  0  96.6  151.7  150.1  149.7  149.3  Hole 2  51.1  81.1  28.2  55.2  96.6  0  126.0  133.2  132.9  130.8  Crack 1  95.7  128.5  98.9  94.4  151.7  126.0  0  13.3  13.4  10.7  Crack 2  106.5  127.7  106.8  105.5  150.1  133.2  13.3  0  0.4  2.8  Crack 3  106.3  127.1  106.5  105.3  149.7  132.9  13.4  0.4  0  2.8  Crack 4  103.7  126.6  104.3  102.7  149.3  130.8  10.7  2.8  2.8  0    192     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    5.4 Conclusion Extended Prony (EP), Linear Prediction Singular Value Decomposition (LPSVD) and Matrix Pencil (MP) have been investigated and used:   as an alternative to PSNR measure used in Chapter 4;    for target characterisation and classification.  Each of these methods has been applied to the simulated data to evaluate its performance in the presence of additive noise in the GPR data. As stated previously, GPR data suffer from large amount of noise and clutter, thus using simulated data enabled different levels of noise to be added to the data to assess the performance of the algorithms. MP method shows its robustness in analysing noisy data compared to EP and LPSVD, thus was used for the rest of the analysis. The problem of selecting the correct model order in analysing signal has been tackled using Singular Entropy (SE) approach. With the help of Differential Singular Entropy Increment (DSEI), it is easier to extract the exact model order of the observed signal. This was verified by obtaining a minimum of residue power (i.e. error between the produced model and the measured signal). The estimated signal produced by the MP method using the SE approach has been compared to the power spectrum of the measured signal obtained from the Fast Fourier Transform (FFT) based analysis. The results of frequency-amplitude produced by FFT shows an agreement with the MP   193     Evaluation of Developed Pre-processing Techniques and Characterisation of Targets using Signal Modelling    method although the peak of the amplitude using FFT is not exactly the same as that from MP. However, since the MP method has super resolution, it allows the frequencies to be placed exactly at the locations of the dominant frequencies. For target characterisation, the extracted information using the MP method was able to help in characterising the natural properties of the subsurface. The frequency-damping characteristic obtained from the MP analysis was able to characterise features according to their group since the damping is more related to the property of the materials of both target and scatterers. In addition to MP method, subspace method developed in Chapter 4 – Principal Component Analysis (PCA) was used to characterise features based on the extracted Principal Components (PCs) obtained via Singular Value Decomposition (SVD).    194          Chapter 6  	  Findings and Conclusions Overview This chapter summarises the research carried out and the major findings of this thesis. The author’s contributions and recommendations for further work, based on this research are outlined.  6.1 Extended Summary of the Main Ideas and Work Done on the Project The general aim of the work described in this thesis was to investigate the possibility of application of various signal processing algorithms to process, improve and understand data measured by GPR in various situations that can arise in construction industry. The GPR data measured in those conditions usually suffer from excessively large amount of noise and clutter which can completely obscure the target of the GPR survey and make the images and data extremely difficult to understand and interpret. Highly skilled and trained human operator is usually needed in those situations to process measured data and make sense of the captured images. The process 195     Findings and Conclusions    of analysing those images can therefore become both time demanding and very costly. For this reason, the research into signal and artificial intelligence techniques aimed at helping the process of improving and understanding the measured data has been gathered pace in the recent decades. One of the main tasks tackled in this project dealt with the problem of removing clutter and unwanted signals present in GPR data. However, judging how well the applied technique has performed, i.e. what is the overall improvement in the measured data is another important issue for GPR aimed algorithms and techniques. In the most image processing and image improvement problems (image compression and decompression for examples), an “ideal”, i.e. clean or undistorted dataset or image is available to assess the performance of the applied algorithms. Standard image quality metrics (Mean Square Error (MSE), Signal-to-Noise Ratio (SNR) or PeakSignal-to-Noise Ratio (PSNR)) can then be applied to quantify and subsequently decide on the suitability of the algorithm for the image improvement tasks. Unfortunately, this approach is not usually applicable for the GPR data and techniques used to improve this data. Ideal or undistorted image is not readily available and the use of simulated data (obtained using GPR simulation software) can produce only a completely clean and undistorted set of data. Any distortion additionally introduced to    196     Findings and Conclusions    simulated data would be too artificial, not close to real experimental situations. For the purpose of evaluation of decluttering techniques, PSNR metrics has been initially used in this project. The use of PSNR in evaluating the quality of decluttered GPR images is however not a straight forward task. In traditional image processing applications, high PSNR values of well denoised images indicate high similarity between the original (ideal) and denoised image. At the other end of the scale, a small PSNR value implies poor denoising results caused by large numerical differences between the processed and original (ideal) image. In case of GPR, this approach has to be inverted – high differences between the original (raw and noisy) and decluttered image can indicate good performance of decluttering algorithm and well decluttered resulting image. This result however needs to be treated with caution as the removed components could also contain useful, target-related parts of the GPR image. In addition to PSNR measure, this project also adopted and evaluated an alternative approach of using signal modelling algorithms to evaluate preprocessing techniques. In this way, twofold aim can be achieved – assessment of the quality of pre-processing algorithms as well as extracting useful  signal  features  for  further  automatic  or  semi-automatic  characterisation and qualification of the target under survey.    197     Findings and Conclusions    Decluttering algorithms and techniques investigated in this work relied on two related techniques for multivariate data analysis methods – Principal Component Analysis (PCA) and Independent Component Analysis (ICA). Whilst the details of both approaches have been explained in this thesis, it is worth emphasising the general reasons behind the investigation of those two techniques. In contrast to most of traditional techniques used for GPR data processing, multivariate methods such are PCA and ICA, approach the analysis of multiple variables (or measurements) by treating those multiple variables as a single entity. Thus, both PCA and ICA seek to produce results that take into account the relationship between the multiple variables as well as within the variables, and use tools that operate on all of the data. A major concern of both approaches is to find transformations of the multivariate data that make the dataset smaller or easier to understand, i.e. they seek to find the answer to the following questions: Is it possible that the relevant information contained in a multidimensional variable could be expressed using fewer dimensions (i.e. variable) and might the reduced set of variables be more meaningful than the original dataset? If the latter were true, we call the more meaningful variables hidden, or latent, in the original data and can assume that the new variables better represent the underlying processes that produced the original dataset in the first place. This approach has been used in this work in order to try and discard the set of data that might only be related to noise or other non-target objects present in the    198     Findings and Conclusions    surveyed area. Whilst the results demonstrated in this work certainly encourage this philosophy, the problem of identifying the useful variables or set of signals and distinguishing it from the other artefacts present in the data are not an easy one to solve. Each approach has its own advantages and disadvantages. PCA which is a more established and traditional approach, uses the spectrum of eigenvalues of the analysed data matrix to decide and distinguish between the clutter, useful set of signals and noise present in the signal. Still, the useful set of signals might further contain features related to non-target objects present in the area. ICA on the other hand improves on the PCA analysis which merely decorrelates the data by seeking to transform the original dataset into number of truly independent variables. The motivation for this transformation is primarily to uncover more meaningful variables, not just to reduce the dimensions of the dataset. Although both techniques seemed to produce interesting and useful sets of components representing the analysed data, it is difficult to decide, in a completely unsupervised manner, which of the independent components produced by ICA relate to target and which are originating from other, non-target objects in the area. The described problem was approached in this work by suggesting a different way of combining PCA and ICA. This resulted in ranking of extracted components and an opportunity to automatically discard some of    199     Findings and Conclusions    those components from the set. Results given in this work suggest that this approach can, in some situations, be used as a good replacement for supervised clutter reduction approach in use today. For removing strong but non-uniform clutter present in some GPR images, new experiment has been designed and the used of 2DPCA algorithm resulting in significant clutter reduction. Application of 2DPCA algorithm has not been attempted or reported in GPR area elsewhere in literature. In the continuation of this project, signal modelling has been applied to pre-processed data in order to extract useful features that can be used to characterise targets in the survey – possible damages in the structure (cracks, holes and joints) or underground pipework. The main aim of this modelling was to detect and extract resonant poles and use the parameters of those poles – resonant frequency, amplitude and damping of each detected resonant pole to characterise target. Three signal processing algorithms have been proposed for this investigation – Extended Prony (EP), Linear Prediction Singular value Decomposition (LPSVD) and Matrix Pencil (MP) methods. Initial analysis, using synthesised, resonant type signals confirmed high sensitivity of EP method to noise present in the data. This was in agreement with the majority of literature available on this subject. LPSVD and MP methods were much more robust and resilient to presence of noise in the signal but the final set of tests on measured and simulated data was    200     Findings and Conclusions    carried out using mainly MP analysis approach as it was found that MP outperforms LPSVD in the analysis of GPR type data. One of the main problems of using MP method is determining the optimal model order to be used for the analysis. A number of methods suggested elsewhere in the literature to determine the model order have been tested in this project but none of those was found to perform very well for the signals obtained in GPR measurements. Instead, a novel method using Singular Entropy (SE) has been adopted in this project. Although the extraction of resonant poles has been tried in GPR signal processing, MP approach combined with SE technique has only been used and recently reported in the analysis of oscillations in power grids and the adoption and testing of this approach in GPR field represents another novel aspects of this project. To assess the performance of suggested algorithms, detailed investigation into GPR technology and theory behind the operation of GPR system has been undertaken in the first part of this project. Extensive and varied measurements have been performed in three dedicated laboratory facilities, designed to closely resemble conditions in the construction industry. This has been followed by simulations with dedicated GPRMax software, used by most of the researchers in the field. These algorithms have been tested on both simulated and experimental data. The GPR simulation has been implemented via GPRMax2D to replicate the actual experiments    201     Findings and Conclusions    performed in two different controlled laboratories only i.e., pipes detection and leakages detection from joints, holes and cracks. The third experiment to detect cracked concrete slab with metal fibre mixtures is however unable to be simulated due to data complexity. In order to evaluate the performance of the selected processing methods, the measured data have been processed with dedicated proprietary software, ReflexW designed specifically for the purpose of processing GPR and other geophysical type of data. Traditional processing steps have been applied during ReflexW pre-processing such as one-dimensional filtering, topographic and time-zero corrections, band-pass filtering, background removal and average subtraction. In addition to PSNR criteria used in evaluating the performance of different pre-processing techniques in reducing and eliminating the clutter and unwanted signals in the GPR data, structural similarity (SSIM) between the obtained GPR image and the one produced by highly trained GPR image processing expert using ReflexW has been proposed in this work. Mean Structural Similarity (M-SSIM) Index has been used to give a better sense of validity and indicate potential advantages of the proposed pre-processing techniques. This type measure is recently proposed approach for image quality assessment which indicates the similarity between two images with values between 0 and 1 where 1 indicates the test and reference images are identical. The SSIM is based on human visual system and is designed to    202     Findings and Conclusions    improve on traditional metrics like PSNR and MSE, which have been proved to be inconsistent with human eye perception. The measurements performed in detecting cracked concrete slab with metal fibre mixtures, although useful in providing good insight into some problems related to GPR survey, resulted in a complex set of data which did not allow the final conclusions on the performance of the algorithms developed in this work to be made. The pipes detection experiment provided more suitable data for the application of decluttering algorithms, analysis and evaluation of achieved results at this stage of work. This lead to some recommendations and suggestions for further work and continuation of this project outlined at the end of this chapter.  6.2 Author’s Contributions The author’s achievements have been the successful implementation of clutter and unwanted signal reduction techniques as well as identifying and characterising features present in GPR data. The specific contributions can be summarised as follows:   design and implementation of simulated data using dedicated GPRMax software to understand the problem of GPR data clutter and target characterisation;    investigation and interpretation of pre-processing GPR data using commercially available ReflexW software to be used in the    203     Findings and Conclusions    evaluation of subspace and data decomposition techniques applied to GPR data;   analysis of subspace and data decomposition techniques – Principal Component Analysis (PCA) and Independent Component Analysis (ICA) on GPR data;    implementation and modification of traditional PCA and ICA methods to improve their performance in image processing and GPR clutter removal tasks – this resulted in two novel algorithms which are the combination of Singular Value Decomposition of PCA and ICA (SVDPICA) and 2DPCA, not previously suggested in GPR field;    traditional image quality measures (PSNR and M-SSIM in particular) implemented and tested in order to assess the quality of developed pre-processing algorithms;    analysis and implementation of signal modelling techniques – Extended  Prony  (EP),  Linear  Prediction  Singular  Value  Decomposition (LPSVD) and Matrix Pencil (MP) was twofold – evaluation of pre-processing algorithms as well as characterisation of surveyed targets;   implementation of Singular Entropy based model order estimation method to be used with MP analysis on GPR signals;    analysis of subspace method – PCA to characterise features.   204      Findings and Conclusions    6.3 Recommendations for Further Work 6.3.1 GPR Simulations Although GPR simulations via GPRMax software proved very useful in this work, there has been significant disagreement between the measured and simulated data despite taking great care to replicate all measurement conditions in those simulations. Those differences and disagreements should be resolved, i.e. further insight into behaviour of simulation algorithm and electromagnetic theory used in those simulations gained. This is certainly a research project in itself and as such was beyond the boundaries of this project.  6.3.2 GPR Measurements Great care needs to be taken when designing and conducting the GPR surveys intended to be further used for the evaluation and development of new DSP algorithms aimed at helping GPR operators. Some of the “real industrial” conditions should be avoided at first in order to collect a dataset that can easily be interpreted and reproduced later in the lab and simulation. If at all possible, “ideal” or “close-to-ideal” dataset should be obtained in order to assess and evaluate the performance of designed or implemented signal processing algorithms.    205     Findings and Conclusions    6.3.3 Pre-processing Algorithms Multivariate techniques such are PCA and ICA, are showing significant promise in processing GPR data. Modifications proposed in this work did enhance the performance of those techniques in GPR applications although some problems remain. Ordering extracted components and deciding what to discard and what to retain in the final set seems to be the main issue to be tackled and solved if those algorithms are to be applied for unsupervised pre-processing of GPR data. Problem of evaluating the performance of those algorithms is an open issue, mainly due to a lack of “ideal” data to compare against and evaluate achieved results. In this work, both traditional and novel approaches have been implemented and tested.  6.3.4 Analysis Algorithms Although the use of signal modelling has shown some promise in the analysis of measured GPR data, it should be further investigated; perhaps utilising simulated GPR data to a greater extent in the continuations of this work. Simple experimental setups should be initially analysed in more details and the influence of each element established before tackling more complex structures and problems. The use of Singular Entropy approach for model order estimation was appropriate although other methods can still be    206     Findings and Conclusions    investigated, especially if those can result in completely automatic or unsupervised optimal order calculation and detection.    207          Bibliography 1.     Maxwell, J.C., A Treatise on Electricity and Magnetism. Vol. 2. 1873.  2.  Loulizi, A., Development of Ground Penetrating Radar Signal Modeling and Implementation for Transportation Infrastructure Assessment, in Faculty of the Virginia Polytechnic Institute and State University. 2001, Virginia Polytechnic Institute and State University: Blacksburg, Virginia. p. 263.  3.  Luo, Y. and G.Y. Fang, GPR Clutter Reduction and Buried Target Detection by Improved Kalman Filter Technique. Proceedings of 2005  International  Conference  on  Machine  Learning  and  Cybernetics, Vols 1-9, 2005: p. 5432-5436. 4.  Sato, M. and A. Yarovoy, GPR (Ground Penetrating Radar) into Real World. 2008, Union Radio-Scientifique Internationale (URSIFrance): France.  5.  Xiaoyin, X., et al., Statistical Method to Detect Subsurface Objects Using Array Ground-Penetrating Radar Data. IEEE Transactions on Geoscience and Remote Sensing, 2002. 40(4): p. 963-976.  208     Bibliography    6.  Zhao, A., Y. Jiang, and W. Wang. Exploring Independent Component Analysis for GPR Signal Processing. in Progress In Electromagnetics Research Symposium 2005. Hangzhou, China.  7.  Al-Nuaimy, W., Automatic Feature Detection and Interpretation in Ground-Penetrating Radar Data, in Department of Electrical Engineering and Electronics. 1999, University of Liverpool: Liverpool. p. 307.  8.  Daniels,  D.J.,  Surface-Penetrating  Radar.  Electronics  &  Communication Engineering Journal, 1996. 8(4): p. 165-182. 9.  Brooks, J.W., The Detection of Buried Non-Metallic Anti-Personnel Land  Mines,  in  Department  of  Electrical  and  Computer  Engineering. 2000, University of Alabama: Huntsville. p. 127. 10.  Nadim, G., Clutter Reduction and Detection of Landmine Objects in Ground Penetrating Radar Data Using Likelihood Method. 3rd International Symposium on Communications, Control and Signal Processing, 2008. 1-3: p. 98-106.  11.  Benson, R.C., R.A. Glaccum, and M.R. Noel, Geophysical Techniques for Sensing Buried Wastes and Wastes Migration. 1984: Miami, Florida. p. 256.  12.  Davis, J.L. and A.P. Annan, Ground-Penetrating Radar for HighResolution Mapping of Soil and Rock Stratigraphy. Geophysical Prospecting, 1989. 37(5): p. 531-551.    209     Bibliography    13.  Daniels, D.J., Ground Penetrating Radar. 2nd ed. 2004, London: Institution of Electrical Engineers. 726.  14.  Orlando, L. Using GPR to Monitor Cracks in a Historical Building. in 4th International Workshop on Advanced Ground Penetrating Radar. 2007.  15.  Gamba, P. and S. Lossani, Neural Detection of Pipe Signatures in Ground Penetrating Radar Images. IEEE Transactions on Geoscience and Remote Sensing, 2000. 38(2): p. 790-797.  16.  Forest, R. and V. Utsi. Non Destructive Crack Depth Measurements with Ground Penetrating Radar. in Proceedings of the Tenth International Conference on Ground Penetrating Radar. 2004. Delft, Netherlands.  17.  Utsi, V. and E. Utsi. Measurement of Reinforcement Bar Depths and Diameters in Concrete. in Proceedings of the Tenth International Conference on Ground Penetrating Radar. 2004.  18.  Abujarad, F., A. Jostingmeier, and A.S. Omar, Clutter Removal for Landmine  Using  Different  Signal  Processing  Techniques.  Proceedings of the Tenth International Conference on Ground Penetrating Radar, Vols 1 and 2, 2004: p. 697-700. 19.  Potin, D., E. Duflos, and P. Vanheeghe, Landmines GroundPenetrating Radar Signal Enhancement by Digital Filtering. IEEE    210     Bibliography    Transactions on Geoscience and Remote Sensing, 2006. 44(9): p. 2393-2406. 20.  van Kempen, L. and H. Sahli, Signal Processing Techniques for Clutter Parameters Estimation and Clutter Removal in GPR Data for Landmine Detection. IEEE Workshop on Statistical Signal Processing Proceedings, 2001: p. 158-161.  21.  van der Merwe, A. and I.J. Gupta, A Novel Signal Processing Technique for Clutter Reduction in GPR Measurements of Small, Shallow Land Mines. IEEE Transactions on Geoscience and Remote Sensing, 2000. 38(6): p. 2627-2637.  22.  Zoubir, A.M., et al., Signal Processing Techniques for Landmine Detection Using Impulse Ground Penetrating Radar. IEEE on Sensors Journal, 2002. 2(1): p. 41-51.  23.  Abujarad, F., G. Nadim, and A. Omar, Clutter Reduction and Detection of Landmine Objects in Ground Penetrating Radar Data Using Singular Value Decomposition (SVD). Proceedings of the 3rd International Workshop on Advanced Ground Penetrating Radar, 2005: p. 37-41.  24.  Belhumeur, P.N., J.P. Hespanha, and D.J. Kriegman, Eigenfaces vs. Fisherfaces: Recognition Using Class Specific Linear Projection. IEEE Transactions on Pattern Analysis and Machine Intelligence, 1997. 19(7): p. 711-720.    211     Bibliography    25.  Abujarad, F. and A. Omar, GPR Data Processing Using the Component-Separation Methods PCA and ICA. Proceedings of the 2006 IEEE International Workshop on Imaging Systems and Techniques, 2006: p. 59-63.  26.  Karlsen, B., et al., Comparison of PCA and ICA based Clutter Reduction in GPR Systems for Anti-Personal Landmine Detection. IEEE Workshop on Statistical Signal Processing Proceedings, 2001: p. 146-149.  27.  Karlsen, B., et al., Independent Component Analysis for Clutter Reduction in Ground Penetrating Radar Data. Detection and Remediation Technologies for Mines and Minelike Targets Vii, Pts 1 and 2, 2002. 4742: p. 378-389.  28.  Gao, Q., T. Li, and R.B. Wu, A Novel KICA Method for Ground Bounce Removal with GPR. Proceedings of 2006 CIE International Conference on Radar, Vols 1 and 2, 2006: p. 1058-1061.  29.  Carevic, D., An Approach to Characterising Ground Probing Radar Target Echoes for Landmine Recognition. 1998: Defence Science Technology Organisation (DSTO) Electronics and Surveillance Research Laboratory.  30.  Daniels, D.J., D.J. Gunton, and H.F. Scott, Introduction to Subsurface Radar. IEE Proceedings on Radar and Signal Processing, 1988. 135(4): p. 278-320.    212     Bibliography    31.  Singh, S., Application of Prony Analysis to Characterize Pulsed Corona Reactor Measurements. 2003, University of Wyoming.  32.  Chuang, C.W. and D.L. Moffatt, Complex Natural Resonances of Radar Targets Via Prony's Method. 1975: Defense Technical Information Center.  33.  Sarkar, T.K. and O. Pereira, Using the Matrix Pencil Method to Estimate the Parameters of a Sum of Complex Exponentials. IEEE on Antennas and Propagation Magazine, 1995. 37(1): p. 48-55.  34.  Deek, F.G., Microwave Detection of Cracks in Buried Pipes Using the Complex Frequency Technique. 2011: BiblioBazaar.  35.  Kumaresan, R. and D. Tufts, Estimating the Parameters of Exponentially Damped Sinusoids and Pole-Zero Modeling in Noise. IEEE Transactions on Acoustics, Speech and Signal Processing, 1982. 30(6): p. 833-840.  36.  Chen, C.C., L. Peters, J., and W.D. Burnside. Ground Penetration Radar Target Classification via Complex Natural Resonances. in Antennas and Propagation Society International Symposium, 1995 (AP-S. Digest). 1995.  37.  Jol, H.M., Ground Penetrating Radar Theory and Applications. 2009, London: Elsevier Science. 524.  38.  Do, J., Report: Ground Penetrating Radar. 2003, Villanova University: Pennsylvania. p. 5.    213     Bibliography    39.  Belli, K.M., Ground Penetrating Radar Bridge Deck Investigations Using Computational Modeling, in College of Engineering, Department of Mechanical and Industrial Engineering. 2008, Northeastern University: Boston. p. 235.  40.  Scheele, M., Techniques for Clutter Reduction for GPR Images, in Department of Electronic and Computer Engineering. 2011, University of Portsmouth: Portsmouth. p. 41.  41.  Abujarad, F., Ground Penetrating Radar Signal Processing For Landmine Detection, in Institute of Electronics, Signal Processing and Communications Engineering (IESK). 2007, University of Magdeburg: Magdeburg, Germany. p. 124.  42.  Alani, A. and V. Utsi, Preliminary Investigation of Detection of Leakage from Joints and Cracks in Water Reservoirs Using Ground Penetrating Radar. 2007, University of Portsmouth: Portsmouth. p. 25.  43.  Dojack, L., Ground Penetrating Radar Theory, Data Collection, Processing and Interpretation: A guide for Archaeologists, M. A. and S. Daniel, Editors. 2012, University of British Columbia: Vancouver. p. 94.  44.  Group, B.W., Groundwater Resources in Burried Valleys: A Challenge for Geosciences, R. Kirsch, et al., Editors. 2006, Leibniz Institute for Applied Geosciences (GGA-Institut): Hannover. p. 296.    214     Bibliography    45.  Conyers, L.B., Ground-Penetrating Radar for Archaeology. 2004, Walnut Creek, CA ; Oxford: AltaMira Press.  46.  Feynman, R.P., R.B. Leighton, and M.L. Sands, The Feynman Lectures on Physics. 1977: Reading.  47.  Huston, B., et al., Nondestructive Testing of Reinforced Concrete Bridges using Radar Imaging Techniques. 2002, Department of Mechanical Engineering, College of Engineering and Mathematics, University of Vermont: Burlington. p. 182.  48.  Annan, A.P., ed. Electromagnetic Principles of Ground Penetrating Radar. 1st ed. Ground Penetrating Radar: Theory and Applications, ed. H.M. Jol. 2009, Elsevier: Amsterdam. 38.  49.  Geophysical Survey Systems, I., GSSI Handbook for RADAR Inspection of Concrete #MN72-367 Rev D. 2006: New Hampshire. p. 38.  50.  Sadiku, M.N.O., Elements of Electromagnetics. 1989: Saunders. 788.  51.  Grealy, M., Resolution of Ground-Penetrating Radar Reflections at Differing Frequencies. Archaeological Prospection, 2006. 13(2): p. 142-146.  52.  Neubauer, W., et al., Georadar in the Roman Civil Town Carnuntum, Austria: An Approach for Archaeological Interpretation of GPR Data. Archaeological Prospection, 2002. 9(3): p. 135-156.    215     Bibliography    53.  Leckebusch, J., Ground-Penetrating Radar: A Modern ThreeDimensional Prospection Method. Archaeological Prospection, 2003. 10(4): p. 213-240.  54.  Cassidy, N.J., Ground-Penetrating Radar: Operator Training, European GPR Association. p. 19.  55.  Campana, S. and S. Piro, Seeing the Unseen : Geophysics and Landscape Archaeology. 2009, London: Taylor & Francis.  56.  Kunz, K.S. and R.J. Luebbers, The Finite Difference Time Domain Method for Electromagnetics. 1993, London: CRC. 448.  57.  Taflove, A., Computational Electrodynamics : The Finite-Difference Time-Domain Method. 1995, Boston, Mass. ; London: Artech House. 599.  58.  Giannopoulos, A. (2005) GprMax2D/3D User Guide Version 2.0. 69.  59.  Giannopoulos, A., The investigation of Transmission-Line Matrix and Finite-Difference Time-Domain Methods for the Forward Problem of Ground Probing Radar, in Department of Electronics 1997, University of York: York.  60.  Kane, Y., Numerical Solution of Initial Boundary Value Problems Involving  Maxwell's  Equations  in  Isotropic  Media.  IEEE  Transactions on Antennas and Propagation, 1966. 14(3): p. 302-307.    216     Bibliography    61.  Rumpf, R.C., Design and Optimization of Nano-Optical Elements by Coupling Fabrication to Optical Behaviour, in College of Optics. 2006, University of Central Florida: Orlando, Florida. p. 345.  62.  Annan, A.P. Practical Processing of GPR Data. in Proceedings of the Second Government Workshop on Ground Penetrating Radar. 1999. Columbus, Ohio.  63.  Haramy, K., et al. A Comparison of Non-Invasive Geophysical Methods for Mapping Near-Surface Voids.  64.  Rahman, S.M. Seismic Data Processing and Interpretation. 1-15.  65.  Interprex, IXGPRTM. 2008, Interprex Ltd.: Golden, Colorado.  66.  Grandjean, G. and H. Durand, Radar Unix: A Complete Package for GPR Data Processing. Computers & Geosciences, 1999. 25(2): p. 141-149.  67.  Geophysical, D., RadExplorerTM. 2008, Deco Geophysical: Moscow.  68.  Sandmeier, K.J., ReflexWTM. 2009, Sandmeier Scientific Software.  69.  Sandmeier, K.J., ReflexW Version 5.0 Manual. 2009, Sandmeier Scientific Software: Karlsruhe, Germany.  70.  Sheriff, S. (2010) Processing Ramac GPR Data with Reflex. 1-7.  71.  Fisher, S.C., R.R. Stewart, and H.M. Jol, Processing Ground Penetrating Radar (GPR) Data. 1992. p. 1-22.    217     Bibliography    72.  Yilmaz, O., Seismic Data Analysis : Processing, Inversion, and Interpretation of Seismic Data, ed. S.M. Doherty. Vol. 1 & 2. 2001, Tulsa, Okla.: Society of Exploration Geophysicists.  73.  Vuksanovic, B., Notes on Using ReflexW Software and PreProcessing GPR Data. 2010, University of Portsmouth: Portsmouth. p. 1-3.  74.  Bostanudin, N.J.F., Notes for ReflexW in UTSI Cambridge. 2010, University of Portsmouth: Portsmouth. p. 1-5.  75.  Olhoeft, G.R., Maximizing the Information Return from Ground Penetrating Radar. Journal of Applied Geophysics, 2000. 43(2–4): p. 175-187.  76.  Lehmann, F., et al., Georadar Data from the Northern Sahara Desert: Problems and Processing Strategies, in Proceedings of the 6th International Conference on Ground Penetrating Radar 1996: Japan. p. 51-56.  77.  Gerlitz, K., et al. Processing Ground Penetrating Radar Data to Improve Resolution of Near-Surface Targets. in Proceedings of the Symposium on the Application of Geophysics to Engineering and Environmental Problems 1993. San Diego, USA.  78.  Malagodi, S., L. Orlando, and S. Piro, Approaches to Increase Resolution of Radar Signal, in Proceedings of the 6th International Conference on Ground Penetrating Radar 1996: Japan. p. 83-88.    218     Bibliography    79.  Van Kempen, L. and H. Sahli, Ground Penetrating Radar Data Processing: A Selective Survey of the State of the Art Literature. 1999, University of Brussel: Brussels, Belgium. p. 1-38.  80.  Behar, V., B. Vassileva, and C. Kabakchiev, A Software Tool for GPR Data Simulation and Basic Processing. Cybernetics and Information Technologies, 2008. 8(4): p. 69-76.  81.  Annan, A.P., Ground Penetrating Radar Workshop Notes. 2001, Sensors & Software Inc.: Ontario, Canada.  82.  Bristow, C.S. and H.M. Jol, Ground Penetrating Radar in Sediments. 2003, London: Geological Society. 330.  83.  Kim, J.H., S.J. Cho, and M.J. Yi, Removal of Ringing Noise in GPR Data by Signal Processing. Geosciences Journal, 2007. 11(1): p. 7581.  84.  Jain, A.K., Fundamentals of Digital Image Processing. 1989, Englewood Cliffs, NJ: Prentice Hall. 569.  85.  Vassileva, B. and C. Kabakchiev. Singular Spectrum Analysis - an Effective Method for GPR Data Processing. in Proceedings International Radar Symposium. 2008.  86.  Gunatilaka, A.H. and B.A. Baertlein, A Subspace Decomposition Technique to Improve GPR Imaging of Anti-Personnel Mines. Detection and Remediation Technologies for Mines and Minelike Targets V, Pts 1 and 2, 2000. 4038: p. 1008-1018.    219     Bibliography    87.  Khan, U.S. and W. Al-Nuaimy. Background Removal from GPR Data Using Eigenvalues. in 13th International Conference on Ground Penetrating Radar 2010.  88.  van Kempen, L., et al., New Results on Clutter Reduction and Parameter Estimation for Landmine Detection Using GPR. Proceedings of the Eighth International Conference on Ground Penetrating Radar, 2000. 4084: p. 872-879.  89.  Brunzell, H., Detection of Shallowly Buried Objects Using Impulse Radar. IEEE Transactions on Geoscience and Remote Sensing, 1999. 37(2): p. 875-886.  90.  Caldecott, R., et al., An Underground Obstacle Detection and Mapping System. 1985, The Ohio State University, ElectroScience Laboratory, Columbus: Ohio.  91.  Yu, S.H., R.K. Mehra, and T.R. Witten, Automatic Mine Detection Based on Ground Penetrating Radar. Detection and Remediation Technologies for Mines and Minelike Targets Iv, Pts 1 and 2, 1999. 3710: p. 961-972.  92.  Shaw, A.K. and V. Bhatnagar, Automatic Target Recognition Using Eigen-Templates. Algorithms for Synthetic Aperture Radar Imagery V, 1998. 3370: p. 448-459.  93.  Hyvärinen, A., J. Karhunen, and E. Oja, Independent Component Analysis. 2001, New York ; Chichester: Wiley. 481.    220     Bibliography    94.  Hyvärinen, A. and E. Oja, Independent Component Analysis: Algorithms and Applications. Neural Networks, 2000. 13(4-5): p. 411-430.  95.  Ghahramani, Z. and G.E. Hinton, The EM Algorithm for Mixtures of Factor Analyzers. 1996, University of Toronto: Toronto. p. 1-8.  96.  Nielsen, F.B., Variational Approach to Factor Analysis and Related Models, in Institute of Informatics and Mathematical Modelling. 2004, Technical University of Denmark: Denmark. p. 97.  97.  Reyment, R.A. and K.G. Joreskog, Applied Factor Analysis in the Natural Sciences. 2nd ed. 1993, Cambridge [England] ; New York: Cambridge University Press.  98.  Moore, J.C. and A. Grinsted, Singular Spectrum Analysis and Envelope Detection: Methods of Enhancing the Utility of GroundPenetrating Radar Data. Journal of Glaciology, 2006. 52(176): p. 159-163.  99.  Cichocki, A. and S.B. Amari, Adaptive Blind Signal and Image Processing : Learning Algorithms and Applications. 2002, Chichester: John Wiley. 554.  100.  Tipping, M.E. and C.M. Bishop, Mixtures of Probabilistic Principal Component Analyzers. Neural Computation, 1999. 11(2): p. 443482.    221     Bibliography    101.  Diamantaras, K.I. and S.Y. Kung, Principal Component Neural Networks : Theory and Applications. 1996, New York ; Chichester: Wiley.  102.  Duda, R.O., P.E. Hart, and D.G. Stork, Pattern Classification. 2nd ed. 2001, New York ; Chichester: Wiley.  103.  Semmlow, J.L., Biosignal and Biomedical Image Processing : MATLAB-Based Applications. 2004, New York Marcel Dekker.  104.  Vuksanovic, B. and N.J.F. Bostanudin, Clutter Removal Techniques for GPR Images in Structure Inspection Tasks. 2012: p. 833413833413.  105.  Berrar, D.P., W. Dubitzky, and M. Granzow, A Practical Approach to Microarray Data Analysis. 2002, Boston: Kluwer Academic.  106.  Ulrych, T.J. and M.D. Sacchi, Information-Based Inversion and Processing with Applications. 2005, Amsterdam: Elsevier.  107.  Kong, H., et al. Generalized 2D Principal Component Analysis. in Proceedings 2005 IEEE International Joint Conference on Neural Networks. 2005.  108.  Yang, J., et al., Two-dimensional PCA: A New Approach to Appearance-Based Face Representation and Recognition. IEEE Transactions on Pattern Analysis and Machine Intelligence, 2004. 26(1): p. 131-137.    222     Bibliography    109.  Wang, L.W., et al., Is Two-dimensional PCA a New Technique? Acta Automatica Sinica, 2005. 31(5): p. 2-7.  110.  Stone, J.V., Independent Component Analysis : A Tutorial Introduction. 2004, Cambridge, Mass. ; London: MIT Press. 193.  111.  Naik, G.R., D.K. Kumar, and H. Weghorn. Performance Comparison of ICA Algorithms for Isometric Hand Gesture Identification Using Surface EMG. in 3rd International Conference on Intelligent Sensors, Sensor Networks and Information. 2007.  112.  Hyvärinen, A., J. Karhunen, and E. Oja, Independent Component Analysis. Adaptive and Learning Systems for Signal Processing, Communications, and Control. Vol. 1. 2001, New York Wiley. 482.  113.  Back, A.D. and T.P. Trappenberg, Input Variable Selection using Independent Component Analysis, in International Joint Conference on Neural Networks. 1999. p. 989-992.  114.  Cheung, Y. and L. Xu, Independent Component Ordering in ICA Time Series Analysis. Neurocomputing, 2001. 41(1–4): p. 145-152.  115.  Hyvarinen, A., Fast and Robust Fixed-Point Algorithms for Independent Component Analysis. IEEE Transactions on Neural Networks, 1999. 10(3): p. 626-634.  116.  Bell, A.J. and T.J. Sejnowski, An Information Maximization Approach to Blind Separation and Blind Deconvolution. Neural Computation, 1995. 7(6): p. 1129-1159.    223     Bibliography    117.  Ziehe, A., et al., Artifact Reduction in Magnetoneurography based on Time-Delayed Second-Order Correlations. IEEE Transactions on Biomedical Engineering, 2000. 47(1): p. 75-87.  118.  Cardoso, J.F. and A. Souloumiac, Blind Beamforming for nonGaussian Signals. IEE Proceedings-F on Radar and Signal Processing, 1993. 140(6): p. 362-370.  119.  Cardoso, J.F. and A. Souloumiac, Jacobi Angles for Simultaneous Diagonalization. Siam Journal on Matrix Analysis and Applications, 1996. 17(1): p. 161-164.  120.  Verma, P.K., et al., Analysis of Clutter Reduction Techniques for Through Wall Imaging in UWB Range. Progress in Electromagnetics Research B, 2009. 17: p. 29-48.  121.  Wei, G.W., Generalized Perona-Malik Equation for Image Restoration. IEEE on Signal Processing Letters, 1999. 6(7): p. 165167.  122.  Wang, Z., et al., Image Quality Assessment: From Error Visibility to Structural Similarity. IEEE Transactions on Image Processing, 2004. 13(4): p. 600-612.  123.  Zhou, W. and A.C. Bovik, A Universal Image Quality Index. IEEE on Signal Processing Letters, 2002. 9(3): p. 81-84.  124.  Kumaresan, R., D.W. Tufts, and L.L. Scharf, A Prony Method for Noisy Data: Choosing the Signal Components and Selecting the    224     Bibliography    Order in Exponential Signal Models. Proceedings of the IEEE, 1984. 72(2): p. 230-233. 125.  Hoffmann, G., Pattern Recognition of Multiple Signals from Ground Penetrating Radar for Metal and Pastic Objects. IEE Proceedings Radar, Sonar and Navigation, 2004. 151(2): p. 91-99.  126.  Stepan, M., LPSVD Algorithm for Parameter Estimation of Damped Sinusoids, in Proceedings of 9th Conference and Competition STUDENT EEICT 2003. p. 546-552.  127.  Hua, Y. and T.K. Sarkar, Matrix Pencil Method for Estimating Parameters of Exponentially Damped/Undamped Sinusoids in Noise. IEEE Transactions on Acoustics, Speech and Signal Processing, 1990. 38(5): p. 814-824.  128.  Hua, Y. and T.K. Sarkar, Generalized Pencil-of-Function Method for Extracting Poles of an EM System from Its Transient Response. IEEE Transactions on Antennas and Propagation, 1989. 37(2): p. 229-234.  129.  Marple, S.L., Digital Spectral Analysis : with Applications. 1987, Englewood Cliffs: Prentice-Hall  130.  Lobos, T., J. Rezmer, and J. Schegner. Parameter Estimation of Distorted Signals using Prony Method. in IEEE Bologna Power Tech Conference Proceedings. 2003.    225     Bibliography    131.  Qi, L., et al. Chapter 25 Prony Analysis for Power System Transient Harmonics. 17.  132.  Duflos, E., et al. Time-Frequency Analysis of Ground Penetrating Radar Signals for Mines Detection Applications. in IEEE International Conference on Systems, Man, and Cybernetics. 1999.  133.  Trudnowski, D.J., J. Hauer , and G. Rogers, DSI Tools- Power System Modal Analysis, Application Guide Pacific Northwest National Laboratory. 1995.  134.  Wax, M. and T. Kailath, Detection of Signals by Information Theoretic Criteria. IEEE Transactions on Acoustics, Speech and Signal Processing, 1985. 33(2): p. 387-392.  135.  Zeng, Z., H. Yang, and R. Zhao, Study on Small Signal Stability of Microgrids: A Review and A New Approach. Renewable and Sustainable Energy Reviews, 2011. 15(9): p. 4818-4828.       226          Appendix Appendix A: Chapter 2 A.1 Input Files of GPRMax Simulation on Joints, Holes and Cracks Detection A.1.1 GPR 4 GHz Frequency for Joints and Holes -- GPR joints, holes and cracks simulation based on Amir's -------- experiment at UoP ---------------------------------------------- NB, 29/11/2012 ------------------------------------------------------------------------------------------------------------------- GprMax model for holes + joints in a concrete block for GV5 ---- The size of the holes are 10 mm (width) by 40 mm (depth) ------- Frequency: 4 GHz ------------------------------------------------------------- hole1 = at the position of joint2 ------------------------------ hole2 = at the position of joint3 ------------------------------ joint1 = 7 mm width -------------------------------------------- joint2 = 25 mm width ------------------------------------------- joint3 = 12 mm width -------------------------------------------------------------------------------------------#media_file: d:\gpr\media\media_nurul.dat -------------------------------------------------------------------------- #domain defines size of domain --------#domain: 1.27 0.6 --------- #dx_dy defines spatial steps = radius of smallest pipe/10 --------- or smallest wavelength to be resolved/10 #dx_dy: 0.0015 0.0015 --------- #time_window defines length of each trace --------- it is related to the depth to be reached #time_window: 5.0e-9 -------------------------------------------------------------------------- Geometry of the problem defined here ----- Container box #box: 0.0 0.0 1.27 0.15 concrete #box: 0.0 0.24 1.27 0.26 wood -- bottom panel #box: 0.0 0.26 0.02 0.50 wood -- left panel #box: 1.25 0.26 1.27 0.50 wood -- right panel #box: 0.02 0.26 1.25 0.36 wet_sand ----- Concrete slabs #box: 0.113 0.36 0.363 0.485 concrete -- slab 1 #box: 0.370 0.36 0.620 0.485 concrete -- slab 2 #box: 0.645 0.36 0.895 0.485 concrete -- slab 3 #box: 0.907 0.36 1.157 0.485 concrete -- slab 4 ----- Joints #box: 0.363 0.36 0.370 0.485 fbond_polyester -- joint 1  227     Appendix   #box: 0.620 0.36 0.645 0.485 fbond_polyester -- joint 2 #box: 0.895 0.36 0.907 0.485 fbond_polyester -- joint 3 ----- Holes #box: 0.6275 0.445 0.6375 0.485 free_space -- hole 1 #box: 0.8960 0.445 0.9070 0.485 free_space -- hole 2 --------------------------------------------------------------------------- #line_source defines GPR used #line_source: 1.0 4e9 ricker MyLineSource --------- #analysis determines the number of traces #analysis: 234 amirmodelv1_5.sca b --------- #tx defines starting position of the transmitting antenna #tx: 0.075 0.493 MyLineSource 0.0 5.0e-9 --------- #rx defines starting position of the receiving antenna #rx: 0.125 0.493 #tx_steps: 0.005 0.0 #rx_steps: 0.005 0.0 #end_analysis: -----------------------------------------------------------------#title: 2 holes + 3 joints in a concrete block (GV5) model #messages: y #geometry_file: amirmodelv1_5.geo  A.1.2 GPR 4 GHz Frequency for Crack -- GPR joints, holes and cracks simulation based on Amir's -------- experiment at UoP ---------------------------------------------- NB, 29/11/2012 ---------------------------------------------------------------------------------------------------------------------- GprMax model of crack in a concrete slab 1 for GV5 ------------- Crack dimension is 0.4 cm (width) and 12 cm (depth ------------- Crack slab1 = at the position 27 cm from the edge -------------- of the concrete ------------------------------------------------ Frequency: 4 GHz ----------------------------------------------------------------------------------------------------------#media_file: d:\gpr\media\media_nurul.dat -------------------------------------------------------------------------- #domain defines size of domain --------#domain: 1.27 0.6 --------- #dx_dy defines spatial steps = radius of smallest pipe/10 --------- or smallest wavelength to be resolved/10 #dx_dy: 0.0015 0.0015 --------- #time_window defines length of each trace --------- it is related to the depth to be reached #time_window: 5.0e-9 -------------------------------------------------------------------------- Geometry of the problem defined here ----- Container box #box: 0.0 0.0 1.27 0.15 concrete #box: 0.0 0.24 1.27 0.26 wood -- bottom panel #box: 0.0 0.26 0.02 0.50 wood -- left panel #box: 1.25 0.26 1.27 0.50 wood -- right panel #box: 0.02 0.26 1.25 0.36 wet_sand ----- Concrete slabs #box: 0.113 0.36 1.157 0.485 concrete ----- Crack Concrete Slab 1 #triangle: 0.379 0.485 0.387 0.485 0.383 0.365 free_space ------------------------------------------------------------------    228     Appendix   --------- #line_source defines GPR used #line_source: 1.0 4e9 ricker MyLineSource --------- #analysis determines the number of traces #analysis: 234 amirmodelv1_7.sca b --------- #tx defines starting position of the transmitting antenna #tx: 0.075 0.493 MyLineSource 0.0 5.0e-9 --------- #rx defines starting position of the receiving antenna #rx: 0.125 0.493 #tx_steps: 0.005 0.0 #rx_steps: 0.005 0.0 #end_analysis: -----------------------------------------------------------------#title: Crack slab 1 in a concrete block (GV5) model #messages: y #geometry_file: amirmodelv1_7.geo  A.2 Input Files of GPRMax Simulation on Pipes Detection A.2.1 GPR 4 GHz Frequency for Three Pipes in a Box -- GPR pipes simulation based on July 2012 experiment at UoP ------ NB, 06/12/2012 ------------------------------------------------------------------------------------------------------------------------- GprMax model for 3 pipes in the box experiment ----------------- with the ground added below the box ---------------------------- For accurate model air gap is added ---------------------------- between the bottom of the box and soil surface ----------------- Use plywood instead of wood for the top panel ------------------ Frequency: 4 GHz -------------------------------------------------------- Dimension of the pipes: -------------------------------------------- Big: 10.8 cm ---------------------------------------------- Medium: 4.3 cm ----------------------------------------------- Small: 2.8 cm ------------------------------------------------------------------------------------------#media_file: d:\gpr\media\media_nurul.dat -------------------------------------------------------------------------- #domain defines size of domain --------#domain: 1.27 0.6 --------- #dx_dy defines spatial steps = radius of smallest pipe/10 --------- or smallest wavelength to be resolved/10 #dx_dy: 0.0015 0.0015 --------- #time_window defines length of each trace --------- it is related to the depth to be reached #time_window: 10.0e-9 -------------------------------------------------------------------------- Geometry of the problem defined here #box: 0.0 0.217 1.27 0.242 wood -- bottom panel #box: 0.0 0.482 1.27 0.50 plywood -- top panel #box: 0.0 0.242 0.025 0.482 wood -- left panel #box: 1.245 0.242 1.27 0.482 wood -- right panel #box: 0.0 0.0 1.27 0.122 dry_claysoil --------- three pipes = plastic cylinders with air cylinders inside #cylinder: 0.37 0.296 0.054 plastic -- big #cylinder: 0.37 0.296 0.052 free_space #cylinder: 0.675 0.2635 0.0215 plastic -- medium #cylinder: 0.675 0.2635 0.0195 free_space    229     Appendix   #cylinder: 0.935 0.256 0.014 plastic -- small #cylinder: 0.935 0.256 0.012 free_space -------------------------------------------------------------------------- #line_source defines GPR used #line_source: 1.0 4e9 ricker MyLineSource --------- #analysis determines the number of traces #analysis: 234 3pipesmodelv5_4.sca b --------- #tx defines starting position of the transmitting antenna #tx: 0.15 0.508 MyLineSource 0.0 10.0e-9 --------- #rx defines starting position of the receiving antenna #rx: 0.20 0.508 #tx_steps: 0.005 0.0 #rx_steps: 0.005 0.0 #end_analysis: -----------------------------------------------------------------#title: 3 pipes in a box (on the ground + gap) experiment #messages: y #geometry_file: 3pipesmodelv5_4.geo  A.3 Media File of the GPRMax Data The media file has the role of a simple database of frequently used materials which is very simple and the (#) character is reserved, similarly to an input file. Each definition of a medium parameters should occupy a single line in the media file. A general entry in a media file is:  #f1 f2 f3 f4 f5 f6 strl Each parameter represents:   f1 the DC (static) relative permittivity of the medium  rs    f2 the relative permittivity at the theoretically infinite frequency  r    f3 the relaxation time of the medium  (seconds)    f4 the DC (static) conductivity of the medium  (Siemens/metre)    f5 the relative permeability of the medium  r    f6 the magnetic conductivity of the medium  *    strl a string characterising the medium   230      Appendix   -- media file for GPR simulated data -- NB, 01/11/2012 # # # # # # # # # # # # # #  3.0 0.0 0.0 0.0 1.0 1.0 fbond_polyester 6.0 0.0 0.0 0.01 1.0 0.0 concrete 3.0 0.0 0.0 0.01 1.0 0.0 plastic 2.2 0.0 0.0 0.01 1.0 0.0 wood 7.0 0.0 0.0 0.11 3.0 0.0 plywood 20.0 0.0 0.0 0.1 1.0 0.0 wet_sand 8.0 0.0 0.0 0.01 1.0 0.0 damp_sand 3.0 0.0 0.0 0.001 1.0 0.0 dry_sand 10.0 0.0 0.0 0.01 1.0 0.0 dry_claysoil 12.0 0.0 0.0 0.01 1.0 0.0 wet_claysoil 10.0 0.0 0.0 0.001 1.0 0.0 dry_loamsoil 80.0 0.0 0.0 0.5 1.0 0.0 fresh_water 80.0 0.0 0.0 0.01 1.0 0.0 distilled_water 2.8 0.0 0.0 0.21 5.56 0.0 white_sealant  A.4 Matlab Code for GPRMax The following code is used to run the input files of GPRMax. % Script to start GprMax simulation and display the results % BV, NB, June 2009 clear all; close all; clc; filename = 'amirmodelv1_1'; geo = '.geo'; sca = '.sca'; geofile = [filename geo]; scafile = [filename sca]; %% Invoking GPR simulation % *** Select output/results directory directory_out = 'C:\GPR\Amir_Simulations\Output'; % *** Select exe and input directories dos 'C:\GPR\GprMax2D C:\GPR\Amir_Simulations\Input\amirmodelv1_1.in' %% Results display % Geometry data [mesh,header,media] = gprmax2g(geofile); modeltitle = header.title; dx = header.dx; % cell size in x direction - horizontal for GprMax dy = header.dy; % cell size in y direction - vertical for GprMax nx = header.nx; ny = header.ny; x = nx*dx; y = ny*dy; % Scan data [Header,Fields]=gprmax(scafile); modeltitle = Header.title; Nsteps = Header.NSteps;  % no. of scans in the file    231     Appendix   iterations = Header.iterations;  % % dt = Header.dt; % timew = Header.removed; % ez = reshape(Fields.ez, iterations,  no. of iterations (in the given time window) time for each iteration time window (s) Nsteps); % reshape scan data % into matrix  %% Display GPR image - geometry and scan % Geometry figure(1); imagesc(0:dx:x, 0:dy:y, mesh); set(gca,'YDir','normal') colormap(gray); xlabel('[m]'); ylabel('[m]'); title(modeltitle); % Scan figure(2); imagesc(0:Nsteps, (0:dt:timew)*10^9, ez); % *10^9 to get time in ns colormap(gray); xlabel('Trace no'); ylabel('[ns]'); title(modeltitle); %% Display GPR scan image after mean removal ezmr = mrem(ez); figure(3); imagesc(ezmr); colormap(gray); xlabel('[m]'); ylabel('[ns]'); %% Save data save(filename);    232     Appendix    Appendix B: Chapter 4 B.1 Clutter Reduction Algorithms Code % % % % % % % % % % % % % % % % % % % % % % % % % % %  Analysis of measured or simulated GPR scans on reducing clutter. Basically, GPR image is applied using these methods: 1. Decluttering via clutter subtraction (Difference) 2. Mean subtraction 3. PCA 4. SVDPICA The decluttering via clutter subtraction is only possible in the availability of clutter-only image. PSNR and M-SSIM are used to evaluate the performance of each method. For the SVDPICA method, the following steps are used: 1. Perform PCA on the mean removed image. 2. Get rid-off clutter (first PC) and noise (last n-k PCs) or just retain all significant PCs (dimensionality reduction only). 3. Find and retain the most significant ICs in the reconstructed image by performing ICA on retained PCs set. The GPR data matrix needs to be transposed and scaled in the application of PCA. This is due to the Matlab 'svd' function that assumes the measurements in row instead of columns as with our GPR data. BV, NB December 2011.  clear all; close all; clc; %% Load GPR data disp('Option Data: [1]Simulated, [2]Measured'); current_directory = pwd; select_data = input('Option Data: '); if (select_data == 1) % Simulated data directory_data = 'C:\GPR\Amir_Simulations\Output'; cd(directory_data); data = input('Data: ','s'); load([data '.mat']); X = ez; elseif (select_data == 2) % Measured data directory_data = 'C:\REFLEX\Portsmouth\Portsmouth Data July'; cd(directory_data); data = input('Data: ','s'); X = load([data '.ASC']); end [m, n] = size(X); % X - data matrix % m - number of time samples, i.e. dimensions/ variables    233     Appendix   % n - number of space samples, i.e. trials/ measurements cd(current_directory); figure(1); imagesc(X); colormap(gray); title('Original Image'); %% 1. Decluttering using clutter subtraction (Difference) % Only possible when clutter-only image is available % (i.e. in simulation) if (select_data == 1) % Simulated data directory_data = 'C:\GPR\Amir_Simulations\Output'; cd(directory_data); data = input('Clutter-Only Data: ','s'); load([data '.mat']); Xn = ez; elseif (select_data == 2) % Measured data error('No Clutter-Only Data Available!') end cd(current_directory); Xideal = X - Xn;  % remove clutter from the data  figure(2); imagesc(Xn); colormap(gray); title('Clutter-Only Data'); figure(3); imagesc(Xideal); colormap(gray); title('Decluttered Data - Full Clutter Subtraction'); %% 2. Simple mean subtraction Xmr = mrem(X); figure(4); imagesc(Xmr); colormap(gray); title('Decluttered Data - Mean Removal'); %% 3. PCA method 1 % Uses SVD of data matrix dataX = X'/sqrt(n-1); [U, S, V] = svd(dataX,0); D = diag(S).^2; % Plot eigenvalue spectra figure(5); plot(20*log10(D),'k-*'); grid on; xlabel('Eigenvalue no'); ylabel('Eigenvalue (dB)'); title('Eigenspectra');  % transpose and scale the data matrix % PCA via "economy" SVD % calculate the eigenvalues  % scree plot  k = input('Number of PCs: '); Y = U'*dataX;  % select number of PCs to retain % transform the original data  % Reduce data dimensionality    234     Appendix   % i.e. consider only the first r rows of Y Yr = Y(1:k,:); % Recover the original data % Just for checking Xrec = U*Y; Xrec = Xrec'; % this should now be the same with X % Recover the original data with losses due to dimensionality % reduction % Just for checking Xkrec = U(:,1:k)*Yr; Xkrec = Xkrec'; % Set the largest singular values to zero for clutter reduction % since the clutter usually dominates the largest eigenvalues. Xsvd = U(:,2:k)*Y(2:k,:); Xsvd = Xsvd'; % PCA via SVD Results - Plots % Plot the first k eigenimages E = zeros(k,m,n); for i = 1:k E(i,:,:) = (U(:,i) * S(i,i) * (V(:,i))')'; end figure(6); for i = 1:k subplot(ceil(sqrt(k)),ceil(sqrt(k)),i) colormap(gray); imagesc(reshape(E(i,:,:),m,n)); title(['Eigenimage # ', num2str(i)]); end % Plot the reconstructed image figure(7) imagesc(Xsvd); colormap(gray); title('Decluttered Data - SVD') %% 4. PCA method 2 % Uses eigenvalue decomposition of data covariance matrix dataX2 = X'; cov = 1/(n-1)*dataX2*dataX2'; [U, D] = eig(cov); D = diag(D);  % % % % % %  transpose the data matrix calculate the covariance matrix find the eigenvectors and eigenvalues extract diagonal eigenvalues matrix as vector  % Sort the eigenvalues and eigenvectors in decreasing order [junk, rindices] = sort(-1*D); D = D(rindices); U = U(:,rindices); % Plot eigenvalue spectra figure(8); plot(20*log10(D),'k-*'); grid on; xlabel('Eigenvalue no'); ylabel('Eigenvalue (dB)'); title('Eigenspectra'); k = input('Number of PCs: '); Y = U' * dataX2;  % scree plot  % select number of PCs to retain % project the original data set  % Reduce data dimensionality % i.e. consider only the first r rows of Y    235     Appendix   Yr = Y(1:k,:); % Recover the original data Xrec = U*Y; Xrec = Xrec'; % this should now be the same with X % Recover the original data with losses due to dimensionality % reduction Xkrec = U(:,1:k)*Yr; Xkrec = Xkrec'; % Set the largest singular values to zero for clutter reduction % since the clutter usually dominates the largest eigenvalues. Xeig = U(:,2:k)*Y(2:k,:); Xeig = Xeig'; % PCA via SVD Results - Plots % Plot the first k eigenimages figure(9); Xreceig = zeros(size(dataX2)); for i = 1:k Y1 = zeros(size(Y)); Y1(i,:) = Y(i,:); eigeigen = U * Y1; subplot(ceil(sqrt(k)),ceil(sqrt(k)),i); colormap(gray); imagesc(eigeigen'); title(['Eigenimage # ', num2str(i)]); Xreceig = Xreceig + eigeigen; end % Plot the reconstructed image figure(10); colormap(gray); imagesc(Xeig); title('Decluttered Data - EIG'); % Note - Xeig is identical to Xsvd! %% 5. SVDPICA method k = input('Number of PCs: '); [U, S, V] = svd(Xmr,0); Uk = U(:,1:k); Vk = V(:,1:k); Sk = S(1:k,1:k);  % do the SVD on mean removed data % consider first k PCs only  W = jadeR(Uk',k); Uktil = W * Uk'; B = pinv(W); Tktil = Vk * Sk * B;  % do the ICA % un-mix the mixed PCs % estimate the mixing matrix  % Decompose Tktil into two new matrices such that: % Tktil = Vktil * Sktil % The data has been transposed, thus, we have rows of measurements % instead of columns [m1 n1] = size(Tktil); Vktil = []; Sktil = zeros(n1,n1); for i = 1:n1 beta = norm(Tktil(:,i)); Vktil = [Vktil Tktil(:,i)/beta]; Sktil(i,i) = beta; end % Sort new ICs in descending order of associated singular values % from Sktil    236     Appendix   Stemp = diag(Sktil); [junk, rindices] = sort(-1*Stemp); Uktil = Uktil(rindices,:); Sktil = Sktil(rindices,rindices); Vktil = Vktil(:,rindices); eigentil = diag(Sktil).^2; % Plot the new eigenvalue spectra figure(11); plot(20*log10(eigentil),'k-*'); grid on; xlabel('Eigenvalue no'); ylabel('Eigenvalue (dB)'); title('New Eigenspectra');  % % % %  extract diagonal of matrix as vector sort in decreasing order reorder  % get the eigenvalues  % scree plot  % Obtain independent images and reconstruct the data I = zeros(k,m,n); for i = 1:k I(i,:,:) = (Vktil(:,i) * Sktil(i,i) * (Uktil(i,:)))'; end k1 = input('Number of ICs [nfirst nlast]: '); Xrec1 = sum(I(k1(1):k1(2),:,:)); Xrec1 = reshape(Xrec1,m,n); % SVDPICA Results - Plots % Plot individual independent images figure(12) for i = 1:(k1(2)-k1(1)+1) subplot(ceil(sqrt(k1(2)-k1(1)+1)),ceil(sqrt(k1(2)-k1(1)+1)),i) colormap(gray); imagesc(reshape(I(i,:,:),m,n)); title(['Independent image # ', num2str(i)]); end % Plot reconstructed image figure(13); imagesc(Xrec1); colormap(gray); title('Decluttered Data - PCA via ICA'); %% Evaluation via PSNR % i.e. Compare to "ideal" or reference image % For simulated data "ideal" image can be used as a reference % For measured data original raw image is used as a reference if (select_data == 1) Xref = Xideal; elseif (select_data == 2) Xref = X; end XR = imscale(Xref); XMR = imscale(Xmr); XSVD = imscale(Xsvd); XEIG = imscale(Xeig); XSVDPICA = imscale(Xrec1); % Calculate PSNRs for all obtained images, using XR as reference % image psnr_MR = PSNR(XMR,XR); psnr_SVD = PSNR(XSVD,XR); psnr_EIG = PSNR(XEIG,XR); psnr_SVDPICA = PSNR(XSVDPICA,XR); %% Evaluation via M-SSIM    237     Appendix   % For simulated data = "Ideal" vs. processed images % For measured data = Reflexw vs. processed images if (select_data == 1) XI = XR; elseif (select_data == 2); current_directory = pwd; directory_data = 'C:\REFLEX\Portsmouth\Portsmouth Data July'; cd(directory_data); ideal = input('Ideal data for M-SSIM: ','s'); Xi = load([ideal '.ASC']); figure(14); imagesc(Xi); colormap(gray); title('Ideal Data'); cd(current_directory); XI = imscale(Xi); end [mssim_MR, ssim_map_MR] = ssim(XI, XMR); [mssim_SVD, ssim_map_SVD] = ssim(XI, XSVD); [mssim_EIG, ssim_map_EIG] = ssim(XI, XEIG); [mssim_SVDPICA, ssim_map_SVDPICA] = ssim(XI, XSVDPICA); %% Display results % PSNR results format short disp('PSNR values:'); disp(' MR PCAviaSVD PCAviaEIG SVDPICA disp(' ---------------------------------------  '); ');  disp([psnr_MR psnr_SVD psnr_EIG psnr_SVDPICA]); % Similarity result format short disp('SSIM values:'); disp(' MR PCAviaSVD PCAviaEIG SVDPICA disp(' ---------------------------------------  '); ');  disp([mssim_MR mssim_SVD mssim_EIG mssim_SVDPICA]); % % % % % % % % %  The PSNR result: SIMULATED DATA: Ideal image can be obtained to be used as the "reference" image in the evaluation using PSNR. Thus, higher PSNR indicates better algorithm. MEASURED DATA: Original raw data is used as the "reference" image. Lower values of PSNR indicates better algorithm.  B.2 Unwanted Signals Reduction Algorithms Code % % % % % % %  Program for removing the unwanted signals/features in the image. Technique 1: 2D-PCA Technique 2 : ICA Improved images obtained from these techniques are evaluated using various image quality measures: Measure 1: PSNR    238     Appendix   % % % % % % % % % % % %  Measure 2: M-SSIM This program able to do the shift/align among the images to have similar size of each image. This aligning part is most beneficial in obtaining an "ideal" image from the subtraction of the image contains clutter and target to the image with the clutter only. The subtraction method is known as "Difference" technique which will be used in the evaluation of the proposed techniques of the unwanted signals removal. The original image will be used in calculating both the PSNR and M-SSIM values. BV, NB, September 2012  close all; clear all; clc; stup = input('Select setup to analyse - [1]big [2]medium [3]small [4]all: '); % Setup to analyse: 1 = Big pipe; 2 = Medium pipe; % 3 = Small pipe; 4 = All 3 pipes %% Load GPR data current_directory = pwd; directory_data = 'D:\Users\My Documents\My Dropbox\Nuruls simulation\Aligning'; cd(directory_data); % Empty box scans needed for 2D-PCA load FUN1L51raw.ASC; load FUN1L61raw.ASC; load FUN1L71raw.ASC; load FUN1L81raw.ASC; load FUN1L91raw.ASC; load FUN1L72raw.ASC; % Full box scans if stup == 1 load FUN2B71raw.ASC; elseif stup == 2 load FUN2M71raw.ASC; elseif stup == 3 load FUN2S71raw.ASC; elseif stup == 4 load FUN2L71raw.ASC; end  % Big pipe % Medium pipe % Small pipe % All 3 pipes  cd(current_directory); %% Remove means and select images to process X1 X2 X3 X4 X5 X6  = = = = = =  mrem(FUN1L51raw); mrem(FUN1L61raw); mrem(FUN1L71raw); mrem(FUN1L81raw); mrem(FUN1L91raw); mrem(FUN1L72raw);  if stup == 1 X = mrem(FUN2B71raw); elseif stup == 2 X = mrem(FUN2M71raw); elseif stup == 3 X = mrem(FUN2S71raw); elseif stup == 4 X = mrem(FUN2L71raw);    239     Appendix   end % Empty image Xe = mrem(FUN1L71raw); %% Aligning along the x-axis [Xd, Xed, displ] = align(X, Xe); fprintf('Displacement along x-axis was: %.2f\n', displ); %% Aligning along y-axis [med ned] = size(Xed); [md nd] = size(Xd); if ned~=nd fprintf('Matrices have different number of columns!!!\n'); return end % Upsample each column of both matrices uf = 10; for j = 1:ned Xedi(:,j) = interp(Xed(:,j),uf); Xdi(:,j) = interp(Xd(:,j),uf); end % Transpose both matrices before aligning along the y-axes Xedi = Xedi'; Xdi = Xdi'; [Xdid, Xedid, displ] = align(Xdi, Xedi); fprintf('Displacement along y-axis was: %.2f\n', displ/uf); % Transpose back Xedid = Xedid'; Xdid = Xdid'; %% Display results and calculate PSNR and M-SSIM of "Difference" %% method figure(1) imagesc(Xedid); colormap(gray); title('Empty box'); xlabel('GPR traces'); ylabel('Time samples'); figure(2) imagesc(Xdid); colormap(gray); title('Box with pipe(s)'); xlabel('GPR traces'); ylabel('Time samples'); figure(3) Xdiff = Xdid-Xedid; imagesc(Xdiff); colormap(gray); title('Difference'); xlabel('GPR traces'); ylabel('Time samples'); % PSNR calculation Xdids = imscale(Xdid); % scale to [0 1] for PSNR Xdiffs = imscale(Xdiff); psnr_diff = PSNR(Xdiffs,Xdids);    240     Appendix   % Similarity measure [mssim_diff, ssim_map_diff] = ssim(Xdiffs,Xdids); %% 2D-PCA % The 2D data sets of the individual images will be added in % finding the average total image to be applied to the SVD % Check the size of all images and take the minimum size to be the % reference for all images [m1,n1] = size(X1); [m2,n2] = size(X2); [m3,n3] = size(X3); [m4,n4] = size(X4); [m5,n5] = size(X5); [m6,n6] = size(X6); n = min([n1 n2 n3 n4 n5 n6]); X1 X2 X3 X4 X5 X6  = = = = = =  X1(:,1:n); X2(:,1:n); X3(:,1:n); X4(:,1:n); X5(:,1:n); X6(:,1:n);  % Add all images and calculate the average image Xtotal = (X1 + X2 + X3 + X4 + X5 + X6)/6; % SVD of the total image [V,S,U] = svd(Xtotal); % Plot the eigenvalues to decide on the exact number of eigenimages % to be reconsidered eigen = diag(S).^2; sev = sum(eigen); figure(4); plot(eigen,'k','LineWidth',2); hold on; plot(eigen,'ko','LineWidth',2); title('2D-PCA Eigenvalue Spectrum'); xlabel('Eigenvalue Number'); ylabel('Eigenvalue') %% Construct feature  eigenimage  group  best  representing  the  unwanted  % Obtain first eno eigenimages eno = input('Select number of eigenimages to be removed from the image: '); St = zeros(size(S)); for i = 1:eno St(i,i) = S(i,i); % keep the first eno eigenvalues for end % reconstruction Xeig = V * St * U'; %% Plot the individual eigenimages Xetot = zeros(m2,n); figure(5) for i = 1:eno St = zeros(size(S)); St(i,i) = S(i,i); Xe = V * St * U'; subplot(ceil(sqrt(eno)),ceil(sqrt(eno)),i) imagesc(Xe); colormap(gray); title(['2DPCA Eigenimage #' num2str(i)]); Xetot = Xetot + Xe;    241     Appendix   end % "Total" eigenimage - first eno eigenimages added together figure(6); imagesc(Xetot); % plot the reconstructed total eigenimage colormap(gray); title('Total Eigenimage of the Unwanted Features'); %% Plot 2D-PCA results % Align original and total eigenimage of 2D-PCA [Xd, Xeigd, displ] = align(X, Xeig); % Remove the reconstructed total eigenimage from the selected % individual image Xsvd2 = Xd - Xeigd; figure(7); imagesc(Xsvd2); colormap(gray); title('2D-PCA');  % plot the residual  %% Calculate PSNR for 2D-PCA % % % % %  The dimension of image obtained from 2D-PCA (Xsvd2) must be the same with the image before the application of this method (i.e. Xdids) for PSNR comparison. Thus: 1. Do the upsample to each column of Xsvd2 2. Sort the number of columns  [nsvd2 msvd2] = size(Xsvd2); [ndids mdids] = size(Xdids); m = min(msvd2,mdids); Xdids = Xdids(:,1:m); for j = 1:m Xsvd2i(:,j) = interp(Xsvd2(:,j),uf); end % Sort the number of columns [nsvd2 msvd2] = size(Xsvd2i); [ndids mdids] = size(Xdids); n = min(nsvd2,ndids); Xdids = Xdids(1:n,:); Xsvd2i = Xsvd2i(1:n,:); % Calculate the PSNR psnr_2DPCA = PSNR(imscale(Xsvd2i),Xdids); % Similarity measure [mssim_2DPCA, ssim_map_2DPCA] = ssim(imscale(Xsvd2i),Xdids); %% 2D-ICA % Turn each image into 1D mixture and construct matrix of mixtures [m n] = size(X1); X11D = reshape(X1,m*n,1); X21D = reshape(X2,m*n,1); X31D = reshape(X3,m*n,1); X41D = reshape(X4,m*n,1); X51D = reshape(X5,m*n,1); X61D = reshape(X6,m*n,1); Xm = [X11D X21D X31D X41D X51D X61D]';  % mixtures matrix  % Do PCA and plot the eigenvalues to get some idea of independent % components to be extracted from the mixture [U,S,pc]= svd(Xm',0);    242     Appendix   eigen = diag(S).^2; figure(8) plot(eigen,'k'); hold on; plot (eigen,'rx'); title('Scree Plot'); xlabel('Eigenvalue Number'); ylabel('Eigenvalue') %% Un-mix nu_ICA = 6; W = jadeR(Xm,nu_ICA); ic = (W * Xm)';  % nu_ICA equals to number of mixed images  % Reshape and plot individual images figure(9); for k = 1:nu_ICA subplot(ceil(sqrt(nu_ICA)),ceil(sqrt(nu_ICA)),k) imagesc(reshape(ic(:,k),m,n)); colormap(gray); title(['Independent image #' num2str(k)]); end %% Obtain residual image and plot XO = imscale(X);  % original image scaled to [0 1]  % Select the independent image containing most of the unwanted % features ICselect = input('Select the independent image that contains most of the unwanted features: '); % Reshape and scale to [0 1] XI1 = imscale(reshape(ic(:,ICselect),m,n)); % Align along x-axis before obtaining residual image (resizing % included) [XOd, XI1d, displ] = align(XO, XI1); % Obtain residual image Xica2 = imscale(XOd - XI1d); figure(10); imagesc(Xica2); colormap(gray); title('2D-ICA'); % Calculate PSNR for ICA method psnr_ICA = PSNR(Xica2,XOd); % Similarity measure [mssim_ICA, ssim_map_ICA] = ssim(Xica2,XOd); %% Display results format short disp(' '); disp(' '); if stup == 1 disp(' PSNR values - Big pipe:'); elseif stup == 2 disp(' PSNR values - Medium pipe:'); elseif stup == 3 disp(' PSNR values - Small pipe:'); elseif stup == 4 disp(' PSNR values - All 3 pipes in the box:'); end disp(' Difference 2D-PCA ICA '); disp(' ------------------------------- '); disp([psnr_diff psnr_2DPCA psnr_ICA]);    243     Appendix   %% Similarity measure display format short disp(' '); disp(' '); if stup == 1 disp(' M-SSIM values - Big pipe:'); elseif stup == 2 disp(' M-SSIM values - Medium pipe:'); elseif stup == 3 disp(' M-SSIM values - Small pipe:'); elseif stup == 4 disp(' M-SSIM values - All 3 pipes in the box:'); end disp(' Difference 2D-PCA ICA '); disp(' ------------------------------- '); disp([mssim_diff mssim_2DPCA mssim_ICA]);  B.3 Built-in Functions Code B.3.1 mrem.m function [Xmr] = mrem(Xraw) % % % % %  Simple function for mean removal from GPR image Input: Xraw - raw image Output: Xmr - mean removed image June 2012  [m,n] = size(Xraw); mean_trace = mean(Xraw,2); Xmr = Xraw - repmat(mean_trace,1,n);  B.3.2 imscale.m function [Aout] = imscale(Ain) % % % % % %  Simple [Aout] Scales Scaled  function to scale down GPR image = imscale(Ain) data in Ain from any range to 0-1 range. data is stored in Aout.  June 2012  Amin = min(min(Ain)); Amax = max(max(Ain)); if(Amin < 0) Ain = Ain - Amin; end Amax = max(max(Ain)); Aout = Ain/Amax;    244     Appendix    a) align.m function [X1d, X2d, displ] = align(X1, X2) % % % % % % % % % %  Function to align GPR image X1 with GPR image X2 along the x-axis. Uses 1D correlation of individual image rows to find misalignment between the images (i.e. image rows). Also, it resizes re-aligned images to the same size. July 2012 Output:  X1d - re-aligned and resized image displ - displacement between the images  [m1 n1] = size(X1); [m2 n2] = size(X2); % Autocorrelate to find displacement between the images corsum = 0; for i = 1:min(m1,m2) corsum = corsum + xcorr(X1(i,:),X2(i,:)); end [maxc ind] = max(corsum); d = ind - max(n1,n2); % Align, if needed if d < 0 X2d = X2(:,-d+1:end); X1d = X1; displ = -d; elseif d > 0 X1d = X1(:,d+1:end); X2d = X2; displ = d; else % for d = 0 retain original images X1d = X1; X2d = X2; displ = 0; end % Make both images same size, if needed [m1d n1d] = size(X1d); [m2d n2d] = size(X2d); if n2d > n1d X2d = X2d(:,1:n1d); elseif n1d > n2d X1d = X1d(:,1:n2d); end    245     Appendix    Appendix C: Chapter 5 C.1 One-dimensional Analysis Code % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %  Filename: onedimensionalanalysis Version: 1 Analysis of measured or simulated GPR scans using 3 different methods: 1. PCA - Principal Component Analysis 2. LPSVD - Linear Prediction Singular Value Decomposition 3. MP - Matrix Pencil Method 1. GPR traces are extracted from GPR images and stored into matrix. Single trace from image can be selected or a group of successive traces. 2. Principal components of the stored traces are then obtained and extracted traces (or any new set of traces, from new GPR image) projected on those principal components. In this way dimensionality of selected traces is significantly reduced. Each trace or set of successive traces is now represented with a small number of points. Scatter plots are then produced to show different class memberships. 3. Alternatively, or in addition to this analysis, each trace is also analysed by extracting dominant frequencies, corresponding amplitudes and damping using MP method. Those points are also plotted in 3D space to detect possible clusters or groupings in frequency domain or to just observe frequency properties of extracted traces. BV, NB, December 2012  clear all; close all; clc; %% Set parameters notraces = 0; nsignals = 30; unwrappit = 1;  % % % % %  no. of succesive traces to be used in simulation i.e. before and after the selected trace maximum number of signals/images to be analysed if 1, concatenate traces from the same image in a single trace  seltraces = []; i = 0;  % matrix to hold all selected traces % current number of analysed signals  ColorSet = varycolor(nsignals); Cc = hsv(nsignals); % define colormap %% Select data directory and load images disp('Option Data: [1]Simulated, [2]Measured'); currentFolder = pwd;  % get current directory    246     Appendix   select_data = input('Option Data: '); if (select_data == 1) % ***** Simulated data % GPRdir = 'C:\GPR\Pipes_GPRmax_Simulations\Output'; GPRdir = 'C:\GPR\Amir_Simulations\Output'; cd(GPRdir); % base_name = '1pipemodelv5_'; base_name = 'amirmodelv1_'; nos = [7 9 1 1]; % select image number colsel = [64 77 60 119]; % central column to extract elseif (select_data == 2) % ***** Measured data GPRdir = 'C:\REFLEX\Portsmouth\Portsmouth Data\SRR methods 1'; % GPRdir = 'C:\REFLEX\Amir Data'; cd(GPRdir); base_name = 'FUN2_'; % base_name = 'WB_';  % Portsmouth data % Amir's data  nos = [1 5 9]; colsel = [109 108 107];  % select image number % central column to extract  end %% Extract traces for i = 1:length(nos) no = num2str(nos(i)); load([base_name no '.mat']); if (select_data == 1) X = ezmr; elseif (select_data == 2) X = X; end % Display image figure(1); imagesc(X); colormap(gray); title(['Image #' no]); pause(2); % Extract group of traces from the image tr = X(:,colsel(i)-notraces:colsel(i)+notraces); [m1,n1] = size(tr); % Resample traces if necessary % Get the size of matrix to hold selected traces if(i == 1) % if no size at start, take the size of first trace [m2,n2] = size(tr); elseif(i > 1) [m2,n2] = size(seltraces); end % Check if those sizes are identical % Sort if they are unequal if(~(m1 == m2)&&(i > 1)) tr = tr(1:m1,:); % use the first m1 samples in each trace end % Save traces if(unwrappit == 0) % Save wrapped traces and their labels seltraces = [seltraces tr]; elseif(unwrappit == 1)    247     Appendix   % Or unwrap and save unwrapped traces and their labels trunwrapped = reshape(tr,m1*n1,1); % all traces in 1 column seltraces = [seltraces trunwrapped]; end % Plot unwrapped traces % Option - comment out to speed up the process figure(2) plot(trunwrapped); grid on; title('Selected Trace(s)'); pause(2); end cd(currentFolder); %% ------------- ANALYSIS 1 - PCA ------------% Use PCA to reduce data dimensionality and analyse figure(3); imagesc(seltraces); colormap(gray); dsmplf = 10;  % downsample factor % use it when the data is too large for PCA in % Matlab  [m,n] = size(seltraces); % Downsampling might be needed when unwrapped traces are used input_data = (resample(seltraces,1,dsmplf))'; % downsample and % transpose % After transposition % rows = observations = individual traces % columns = variables = time instants/pixels % Normalise traces input_data = zscore(input_data); [coeff, scores, latent] = myprincomp(input_data); % does it all % Matrix scores contains the projection of input_data onto the PCs c_var = (cumsum(latent) ./ sum(latent)); % cumulative variance % for all dimensions % Plot cumulative variance for complete data set figure(3) plot(c_var); hold on; plot(c_var,'r*'); grid on; xlabel('PC #'); ylabel('% of data explained'); % Plot first 4 PCs from the set figure(4) for i = 1:4 subplot(2,2,i) plot(coeff(:,i)); grid on; title(['PC # ', num2str(i)]); end %% Scatter plot for 2D or 3D PCs set % Different setup will be used different colours and numbers Y = scores(:,1:3); [nosig ndim] = size(Y); % ndim = number of dimensions, plot in 2D or 3D % nosig = number of signals/points to be plotted    248     Appendix   ndim = 3; % change here to select 2D or 3D plot Y = scores(:,1:ndim); figure(6); [m n] = size(Y); traceslab = 1:m; T = traceslab; msize = 15; % marker size spread((Y(1:nosig,:))',(T(1:nosig))',msize, 0); title(['First ' num2str(ndim) ' PCs indicating different setups']); xlabel('PC #1'); ylabel('PC #2'); if ndim == 3 zlabel('PC #3'); end % Print numbers for easier understanding of the plot for i = 1:nosig if ndim == 2 text(Y(i,1),Y(i,2)+0,num2str(i),'HorizontalAlignment','center') end if ndim == 3 text(Y(i,1),Y(i,2)+0,Y(i,3)+0,num2str(i),'HorizontalAlignment','cen ter') end end % Calculate the distance between each point D = squareform(pdist(Y)); %% ------------- ANALYSIS 2 - LPSVD/MP ------------th = 0.1; M = 20;  % % % %  percentage of max signal value used to detect start and end of the actual signal in the considered trace obviously - lower "th" = longer part extracted model order  % Choose the sampling frequency, Fs if (select_data == 1) Fs = 1/dt; elseif (select_data == 2) Fs = 1/3.90625e-11; end % Sampling frequency calculation: % tw = 10e-9; % time window % dt = tw/m; % time step = time window/number of samples % Fs = 1/dt = 1/(time window/number of iterations) % time step or time increment for measured data: 3.90625e-11 [Mtr,Ntr] = size(seltraces); counter = 0; paras = []; % 3D matrix to save all extracted parameters analysis = input('Choose analysis method [1]LPSVD [2]MP: '); for i = 1:Ntr tr = seltraces(:,i); trm = reshape(tr,m1,n1); for j = 1:n1 counter = counter+1;  % extract each "multiple" trace % reshape back to single traces    249     Appendix   tr = trm(:,j); % analyse each trace individually % Extract portion of the signal to be analysed TH = (th/100)*max(abs(tr)); % threshold value sign_ind = find(abs(tr)>=TH); % part of the trace contain % the actual signal sign = tr(min(sign_ind):max(sign_ind)); % Plot the original trace and extracted, % "signal present" part of the trace figure(9) clf; plot(tr); hold on; grid on; plot((min(sign_ind):max(sign_ind)),sign,'r'); % LPSVD/MP analysis figure(10) clf if (analysis == 1) [hpoles, spoles, para] = lpsvd(sign,Fs,M); elseif (analysis == 2) [hpoles, spoles, para, M] = mp(sign,Fs,M); end  % LPSVD % MP  % Check the number of estimated parameters [mpara, npara] = size(para); % Fix for insufficient number of poles estimated if(mpara < M/2) parae = zeros(M/2,4); % create empty matrix of % parameters of proper size parae(1:mpara,:) = para; para = parae; end % Store obtained results - parameter sets paras(:,:,counter) = para; pause; end end %% Plot extracted parameters in 3D parameter space [mp np kp] = size(paras); % Extract and reshape into 1D damps = reshape(paras(:,1,:),mp*kp,1); freqs = reshape(paras(:,2,:),mp*kp,1); amps = reshape(paras(:,3,:),mp*kp,1); % Make matrix of features Z = [damps freqs amps]; % Make vector of parameter labels for same trace % (i.e. give parameters from same trace with the same label/number) trparaslab = []; for i = 1:kp trparaslab = [trparaslab; ones(mp,1)*i]; end % Make vector of parameter labels same for each image % (i.e. give parameters from same signal with the same % label/number) imparaslab = []; j = 1; for i = 1:counter:kp*mp imparaslab = [imparaslab; ones(mp*n1,1)*j]; j = j+1; end    250     Appendix   figure(11); [z1 z2] = size(Z); T = imparaslab(1:z1,1); msize = 10; % marker size spread(Z',T',msize,1); title('Extracted s-plane parameters indicating different setups'); xlabel('Damping'); ylabel('Frequency'); zlabel('Amplitude'); %% Plot extracted parameters in 2D parameter space % For better view and evaluation purposes only Zdim1 = [freqs damps]; figure(12); spread(Zdim1',T',msize,1); title('Extracted 2D parameters indicating different setups'); xlabel('Frequency'); ylabel('Damping'); Zdim2 = [freqs amps]; figure(13); spread(Zdim2',T',msize,1); title('Extracted 2D parameters indicating different setups'); xlabel('Frequency'); ylabel('Amplitude');  C.2 Selecting Model Order Code % % % % % % % % % % %  Analysis of LPSVD & MP in selecting model order Includes: 1. The singular entropy in selecting model order. 2. The threshold part has been removed from the onedimensionalanalysis version 1 in order to select the data manually. 3. Add the FFT and compare with the amplitude of the extracted poles of MP. Version: 2 of onedimensionalanalysis NB, BV 12/02/2013  clear all; close all; clc; %% Set parameters and select data directory notraces = 0; nsignals = 30; unwrappit = 1;  % % % % %  no. of succesive traces to use in simulation i.e. before and after the selected trace maximum number of signals/images to be analysed if 1, concatenate traces from the same image in a single trace  seltraces = []; i = 0;  % matrix to hold all selected traces % current number of analysed signals  ColorSet = varycolor(nsignals); Cc = hsv(nsignals); % define colormap %% Select data directory and load images disp('Option Data: [1]Simulated, [2]Measured'); currentFolder = pwd;  % get current directory    251     Appendix   select_data = input('Option Data: '); if (select_data == 1) % ***** Simulated data % GPRdir = 'C:\GPR\Pipes_GPRmax_Simulations\Output'; GPRdir = 'C:\GPR\Amir_Simulations\Output'; cd(GPRdir); % base_name = '1pipemodelv5_'; base_name = 'amirmodelv1_'; nos = [7 9 1 1]; % select image number colsel = [64 77 60 119]; % central column to extract elseif (select_data == 2) % ***** Measured data GPRdir = 'C:\REFLEX\Portsmouth\Portsmouth Data July'; % GPRdir = 'C:\REFLEX\Amir Data'; cd(GPRdir); base_name = 'FUN2_'; % base_name = 'WB_';  % Portsmouth data % Amir's data  nos = [5]; colsel = [119];  % select image number % central column to extract  end %% Extract traces for i = 1:length(nos) no = num2str(nos(i)); load([base_name no '.mat']); if (select_data == 1) X = ezmr; elseif (select_data == 2) X = X; end % Display image figure(1); imagesc(X); colormap(gray); title(['Image #' no]); pause(2); % Plot selected trace figure(2) plot(X(:,colsel(i))); grid on; title('Selected Trace(s)'); % Extract group of traces from the image Xn = input('Select data samples [xn1, xn2]: '); tr = X(Xn(1):Xn(2),colsel(i)-notraces:colsel(i)+notraces); [m1,n1] = size(tr); % Resample traces if necessary % Get the size of matrix to hold selected traces if(i == 1) % if no size at start, take the size of first trace [m2,n2] = size(tr); elseif(i > 1) [m2,n2] = size(seltraces); end % Check if those sizes are identical % Sort if they are unequal if(~(m1 == m2) && (i > 1)) tr = tr(1:m1,:); % use first m1 samples in each trace    252     Appendix   end % Save traces if(unwrappit == 0) % Save wrapped traces and their labels seltraces = [seltraces tr]; elseif(unwrappit == 1) % Or unwrap and save unwrapped traces and their labels trunwrapped = reshape(tr,m1*n1,1); % all traces in one column seltraces = [seltraces trunwrapped]; end % Plot unwrapped traces % Option - comment out to speed up the process figure(3) plot(trunwrapped); grid on; title('Selected Trace(s)'); pause(2); end cd(currentFolder); %% ------------- ANALYSIS 2 - LPSVD/MP ------------% Choose the sampling frequency, Fs if (select_data == 1) Fs = 1/dt; elseif (select_data == 2) Fs = 1/3.90625e-11; end % Sampling frequency calculation: % tw = 10e-9; % time window % dt = tw/m; % time step = time window/number of samples % Fs = 1/dt = 1/(time window/number of iterations) % time step or time increment for measured data: 3.90625e-11 [Mtr,Ntr] = size(seltraces); counter = 0; paras = []; % 3D matrix to save all extracted parameters analysis = input('Choose analysis method [1]LPSVD [2]MP: '); for i = 1:Ntr tr = seltraces(:,i); trm = reshape(tr,m1,n1);  % extract each "multiple" trace % reshape back to single traces  % Singular Entropy Increment and Differential of Singular % Entropy Increment for simulated signal [dE dEp] = sen(tr); n = 0:80; figure(7) plot(n,dE(1:81)); grid on; xlabel('n'); ylabel('Singular Entropy Increment'); figure(8) plot(n,dEp(1:81)); grid on; xlabel('n'); ylabel('Differential of Singular Entropy Increment'); for j = 1:n1 M = input('Select model order: ');    253     Appendix   counter = counter+1; tr = trm(:,j);  % analyse each trace individually  % MP analysis figure(10) clf if (analysis == 1) [hpoles, spoles, para] = lpsvd(sign,Fs,M); elseif (analysis == 2) [hpoles, spoles, para, M] = mp(tr,Fs,M); end  % LPSVD % MP  % Check the number of estimated parameters [mpara, npara] = size(para); % Fix for insufficient number of poles estimated if(mpara < M/2) parae = zeros(M/2,4); % create empty matrix of % parameters of proper size parae(1:mpara,:) = para; para = parae; end [p1 p2] = size(para); [p3 p4] = size(paras); if(p1 < p3) parase = zeros(p3,4); parase(1:p1,:) = para; para = parase; end % Store obtained results - parameter sets paras(:,:,counter) = para; pause; end end %% Plot extracted parameters in 2D parameter space [mp np kp] = size(paras); % Extract and reshape into 1D damps = reshape(paras(:,1,:),mp*kp,1); freqs = reshape(paras(:,2,:),mp*kp,1); amps = reshape(paras(:,3,:),mp*kp,1); % Make matrix of features Z = [damps freqs amps]; % Make vector of parameter labels for same trace % (i.e. give parameters from same trace with same label/number) trparaslab = []; for i = 1:kp trparaslab = [trparaslab; ones(mp,1)*i]; end % Make vector of parameter labels same for each image % (i.e. give parameters from same signal with same label/number) imparaslab = []; j = 1; for i = 1:counter:kp*mp imparaslab = [imparaslab; ones(mp*n1,1)*j]; j = j+1; end [z1 z2] = size(Z); T = imparaslab(1:z1,1); msize = 10;  % marker size    254     Appendix   Zdim1 = [freqs damps]; figure(12); spread(Zdim1',T',msize,1); title('Extracted 2D parameters indicating different setups'); xlabel('Frequency'); ylabel('Damping'); Zdim2 = [freqs amps]; figure(13); spread(Zdim2',T',msize,1); title('Extracted 2D parameters indicating different setups'); xlabel('Frequency'); ylabel('Amplitude'); %% Power Spectrum of the signal using FFT nfft = 2^15; Y = fft(tr,nfft); Pyy = Y.* conj(Y); Pyy_crop = Pyy(1:nfft/2); f = 0 : Fs/(nfft-1) : Fs/2; % Plot the FFT and amplitude of LPSVD/MP on the same figure figure(14); plot(f,Pyy_crop/max(Pyy_crop),'b','LineWidth', 2); hold on; grid on; plot(freqs,amps/max(amps),'ro','LineWidth', 2); title('Power Spectrum of the Signal'); xlabel('Frequency (Hz)'); ylabel('Power Spectrum (db)');  C.3 Built-in Functions Code C.3.1 myprincomp.m function [coeff, score, latent] = myprincomp(x) % MYPRINCOMP Principal Components Analysis % Input: % x - data matrix (rows are observations, columns are variables) % rows = observations = individual traces % columns = variables = time instants/pixels % % Output: % coeff - principal component axis % score - projection of data matrix onto principal component % axis (rows are observations, columns are components) % latent - principal component variances, % i.e. eigenvalues of the covariance matrix of X % Center x by removing column means [n,p] = size(x); x0 = x - repmat(mean(x,1),n,1); % Calculate principal component coefficients % i.e. eigenvectors of S = x0'*x0./(n-1), but use SVD. [U,sigma,coeff] = svd(x0,0); % put in 1/sqrt(n-1) later % Project x0 onto the principal component axes to get the scores. sigma = diag(sigma); score = x0*coeff; sigma = sigma ./ sqrt(n-1);    255     Appendix   % Calculate the variances of the principal components % i.e. calculate the eigenvalues of S = x0'*x0./(n-1) latent = sigma.^2;  C.3.2 spread.m function spread(X, label, ms, fill) % Plot samples of different labels with different colors. % Written by Michael Chen (sth4nth@gmail.com). % Modified by Branislav Vuksanovic (boban1962@gmail.com) % X - data % label - data labels % ms - marker size % fill - fill in the markers (1) or not (0) [d,n] = size(X); if nargin == 1 label = ones(n,1); end assert(n == length(label)); c = max(label); ColorSet = varycolor(c); set(gca, 'ColorOrder', ColorSet); hold all; figure(gcf); clf; hold on; switch d case 2 view(2); for i = 1:c idc = label==i; if fill == 0 plot(X(1,idc),X(2,idc), 'o','Color', ... ColorSet(i,:),'MarkerSize',ms); elseif fill == 1 plot(X(1,idc),X(2,idc),'o','MarkerEdgeColor','k',... 'MarkerFaceColor', ColorSet(i,:),'MarkerSize',ms); end end case 3 view(3); for i = 1:c idc = label==i; if fill == 0 plot3(X(1,idc),X(2,idc),X(3,idc),'o','Color',... ColorSet(i,:),'MarkerSize',ms); elseif fill == 1 plot3(X(1,idc),X(2,idc),X(3,idc),'o', ... 'MarkerEdgeColor','k','MarkerFaceColor',... ColorSet(i,:),'MarkerSize',ms); end end otherwise error('ERROR: only support data of 2D or 3D.'); end % axis equal grid on hold off    256     Appendix    C.3.3 sortpoles.m function poles = sortpoles(para, criteria, nf) % function poles = sortpoles(para) % Analyse obtained parameter set according to one % of defined criteria and produce a set of poles. % % Inputs: para - matrix of obtained parameters % (using MP algorithm or similar) % criteria - selection criteria % nf - number of poles to retain % (for criteria 1) % - percentage of highest amplitude % to retain (for criteria 2) % % criteria 1 - select nf poles corresponding % to nf highest amplitudes in the set % criteria 2 - select all poles with amplitudes higher than % nf% of highest amplitude in the set % % Output: poles - set of selected poles if para(:,1) < 0 para(:,1) = -para(:,1); else para(:,1) = para(:,1); end [para1 ind] = sort(para(:,3)); paras = para(flipud(ind),:);  % sort according to amplitudes % parameters sorted in descending % order  % Selecting poles according to criteria 1 % i.e. nf poles with highest amplitudes if (criteria == 1) parass = paras(1:nf,:); % selected parameters poles = parass(:,1:2); % select poles end % Selecting poles according to criteria 2 % i.e. all poles with amplitudes higher then % nf of the highest amplitude if(criteria == 2) lim = max(paras(:,3))*nf/100; % find max amplitude to retain ind = find((paras(:,3))>lim); poles = paras(ind,1:2); % select poles end    257     